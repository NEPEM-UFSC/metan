<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Useful functions for biometrical models • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Useful functions for biometrical models">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><a class="dropdown-item" href="../news/index.html">Package news</a></li>
    <li><a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">More</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-more">
<li><a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
    <li><a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a></li>
    <li><a class="dropdown-item" href="../SUPPORT.html">Support</a></li>
    <li><a class="dropdown-item" href="../LICENSE.html">Licence</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TiagoOlivoto"><span class="fa fa-github fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/tolivoto"><span class="fa fab fa-twitter fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/"><span class="fa fab fa-mendeley fa-2x"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="vignettes_biometry_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="vignettes_biometry_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="vignettes_biometry_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="vignettes_biometry_files/datatables-binding-0.33/datatables.js"></script><link href="vignettes_biometry_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="vignettes_biometry_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="vignettes_biometry_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><script src="vignettes_biometry_files/jszip-1.13.6/jszip.min.js"></script><script src="vignettes_biometry_files/pdfmake-1.13.6/pdfmake.js"></script><script src="vignettes_biometry_files/pdfmake-1.13.6/vfs_fonts.js"></script><link href="vignettes_biometry_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="vignettes_biometry_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="vignettes_biometry_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="vignettes_biometry_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="vignettes_biometry_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="vignettes_biometry_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="vignettes_biometry_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Useful functions for biometrical models</h1>
                        <h4 data-toc-skip class="author">Tiago
Olivoto</h4>
            
            <h4 data-toc-skip class="date">2024-12-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nepem-ufsc/metan/blob/HEAD/vignettes/vignettes_biometry.Rmd" class="external-link"><code>vignettes/vignettes_biometry.Rmd</code></a></small>
      <div class="d-none name"><code>vignettes_biometry.Rmd</code></div>
    </div>

    
    
<p>See the section <a href="#rendering">Rendering engine</a> to know how
HTML tables were generated.</p>
<div class="section level2">
<h2 id="find-possible-outliers-in-a-data-frame">Find possible outliers in a data frame<a class="anchor" aria-label="anchor" href="#find-possible-outliers-in-a-data-frame"></a>
</h2>
<p>The function <code>find_outlier()</code> may be used to identify
possible outliers in a dataframe. It is suggested that before applying
any statistical procedures, outliers be checked out.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nepem-ufsc/metan" class="external-link">metan</a></span><span class="op">)</span></span>
<span><span class="va">data_out</span> <span class="op">&lt;-</span> <span class="va">data_ge2</span></span>
<span><span class="va">data_out</span><span class="op">[</span><span class="fl">12</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="fu"><a href="../reference/find_outliers.html">find_outliers</a></span><span class="op">(</span><span class="va">data_out</span>, var <span class="op">=</span> <span class="va">PH</span>, plots <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Trait: PH </span></span>
<span><span class="co"># Number of possible outliers: 1 </span></span>
<span><span class="co"># Line(s): 12 </span></span>
<span><span class="co"># Proportion: 0.6%</span></span>
<span><span class="co"># Mean of the outliers: 5 </span></span>
<span><span class="co"># Maximum of the outliers: 5  | Line 12 </span></span>
<span><span class="co"># Minimum of the outliers: 5  | Line 12 </span></span>
<span><span class="co"># With outliers:    mean = 2.499 | CV = 15.58%</span></span>
<span><span class="co"># Without outliers: mean = 2.483 | CV = 13.46%</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-2-1.png" width="528" style="display: block; margin: auto;"></p>
<p>To check the outliers in different levels of a factor, use the
argument <code>by</code>. As an example, we will find possible outliers
for each level of the factor <code>ENV</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/find_outliers.html">find_outliers</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">PH</span>, by <span class="op">=</span> <span class="va">ENV</span><span class="op">)</span></span>
<span><span class="co"># No possible outlier identified. </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># No possible outlier identified. </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Trait: PH </span></span>
<span><span class="co"># Number of possible outliers: 4 </span></span>
<span><span class="co"># Line(s): 7 11 14 15 </span></span>
<span><span class="co"># Proportion: 11.4%</span></span>
<span><span class="co"># Mean of the outliers: 2.438 </span></span>
<span><span class="co"># Maximum of the outliers: 2.766  | Line 11 </span></span>
<span><span class="co"># Minimum of the outliers: 1.71  | Line 7 </span></span>
<span><span class="co"># With outliers:    mean = 2.167 | CV = 10.309%</span></span>
<span><span class="co"># Without outliers: mean = 2.136 | CV = 7.377%</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># No possible outlier identified.</span></span>
<span><span class="co">#   ENV outliers</span></span>
<span><span class="co"># 1  A1        0</span></span>
<span><span class="co"># 2  A2        0</span></span>
<span><span class="co"># 3  A3        4</span></span>
<span><span class="co"># 4  A4        0</span></span></code></pre></div>
<p>To group by more than one variable, use the function
<code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> is used.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_ge2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ENV</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/find_outliers.html">find_outliers</a></span><span class="op">(</span><span class="va">PH</span><span class="op">)</span></span>
<span><span class="co"># No possible outlier identified. </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># No possible outlier identified. </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Trait: PH </span></span>
<span><span class="co"># Number of possible outliers: 4 </span></span>
<span><span class="co"># Line(s): 7 11 14 15 </span></span>
<span><span class="co"># Proportion: 11.4%</span></span>
<span><span class="co"># Mean of the outliers: 2.438 </span></span>
<span><span class="co"># Maximum of the outliers: 2.766  | Line 11 </span></span>
<span><span class="co"># Minimum of the outliers: 1.71  | Line 7 </span></span>
<span><span class="co"># With outliers:    mean = 2.167 | CV = 10.309%</span></span>
<span><span class="co"># Without outliers: mean = 2.136 | CV = 7.377%</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># No possible outlier identified.</span></span>
<span><span class="co">#   ENV outliers</span></span>
<span><span class="co"># 1  A1        0</span></span>
<span><span class="co"># 2  A2        0</span></span>
<span><span class="co"># 3  A3        4</span></span>
<span><span class="co"># 4  A4        0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="correlations">Correlations<a class="anchor" aria-label="anchor" href="#correlations"></a>
</h2>
<div class="section level3">
<h3 id="linear-and-partial-correlation-coefficients">Linear and partial correlation coefficients<a class="anchor" aria-label="anchor" href="#linear-and-partial-correlation-coefficients"></a>
</h3>
<p>Pearson’s linear correlation does not consider the influence a set of
traits on the relationship between two traits. For example, the
hypothetical correlation of <em>r</em> = 0.9 between <em>x</em> and
<em>y</em> may be due to the influence of a third trait or group of
traits acting together. To identify this linear effect between
<em>x</em> and <em>y</em> controlling statistically the effect of others
traits, the partial correlation is used. From Pearson’s simple
correlation matrix, the partial correlation is calculated by the
following equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>x</mi><mi>y</mi><mi>.</mi><mi>m</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>−</mi><msub><mi>a</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub></mrow><msqrt><mrow><msub><mi>a</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><msub><mi>a</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">
    {r_{xy.m}} = \frac{{ - {a_{xy}}}}{{\sqrt {{a_{xx}}{a_{yy}}} }}
</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mrow><mi>x</mi><mi>y</mi><mi>.</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">{r_{xy.m}}</annotation></semantics></math>
is the partial correlation coefficient between the traits * x * and * y
<em>, excluding the effects of the </em> m * remaining traits of the
set;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">- {a_{ij}}</annotation></semantics></math>
is the inverse element of the correlation matrix corresponding to xy,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><msub><mi>a</mi><mrow><mi>j</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{a_{ii}}{a_{jj}}</annotation></semantics></math>
are the diagonal elements of the inverse matrix of correlation
associated with trait x and y , respectively. The significance of this
correlation is also tested by the test * t * according to the following
expression:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi></mrow></msub><mo>=</mo><msub><mi>r</mi><mrow><mi>x</mi><mi>y</mi><mi>.</mi><mi>m</mi></mrow></msub><mo>√</mo><mfrac><mrow><mi>n</mi><mo>−</mo><mi>v</mi></mrow><mrow><mn>1</mn><mo>−</mo><msubsup><mi>r</mi><mrow><mi>x</mi><mi>y</mi><mi>.</mi><mi>m</mi></mrow><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
t_{calc} = r_{xy.m} \sqrt \frac{n-v}{1-r_{xy.m}^2} 
</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">t_{calc}</annotation></semantics></math>
is the calculated Student * t * statistic; $ r_{xy.m} $ is the partial
correlation coefficient for the traits x and y excluding the effect of
the other * m * traits; * n * is the number of observations; and * v *
is the number of traits. Both the linear and partial correlation
coefficients may be obtained using the function
<code><a href="../reference/lpcor.html">lpcor()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lpc1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data_ge2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"N"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/lpcor.html">lpcor</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">lpc1</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["NR x NKR","NR x NKE","NKR x NKE"],[0.0205509700953081,0.6260854377419131,0.7078331791394559],[-0.7672676531686766,0.8659195822535027,0.891451541776985],[-14.79834220990243,21.41381951941093,24.33514938284467],[0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Pairs<\/th>\n      <th>linear<\/th>\n      <th>partial<\/th>\n      <th>t<\/th>\n      <th>prob<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4]},{"name":"Pairs","targets":0},{"name":"linear","targets":1},{"name":"partial","targets":2},{"name":"t","targets":3},{"name":"prob","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Compute the correlations for each level of the factor ENV</span></span>
<span><span class="va">lpc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lpcor.html">lpcor</a></span><span class="op">(</span><span class="va">data_ge2</span>, by <span class="op">=</span> <span class="va">ENV</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lpc2</span><span class="op">)</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 420 × 6</span></span></span>
<span><span class="co">#    ENV   Pairs      linear partial       t   prob</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> A1    PH x EH   0.425     0.981  25.1   0     </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> A1    PH x EP  -<span style="color: #BB0000;">0.124</span>    -<span style="color: #BB0000;">0.971</span> -<span style="color: #BB0000;">20.1</span>   0     </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> A1    PH x EL  -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">87</span>  -<span style="color: #BB0000;">0.169</span>  -<span style="color: #BB0000;">0.841</span> 0.408 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> A1    PH x ED   0.072<span style="text-decoration: underline;">9</span>    0.301   1.55  0.135 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> A1    PH x CL  -<span style="color: #BB0000;">0.158</span>    -<span style="color: #BB0000;">0.311</span>  -<span style="color: #BB0000;">1.60</span>  0.122 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> A1    PH x CD   0.140     0.183   0.911 0.372 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> A1    PH x CW  -<span style="color: #BB0000;">0.011</span><span style="color: #BB0000; text-decoration: underline;">1</span>    0.155   0.771 0.448 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> A1    PH x KW   0.082<span style="text-decoration: underline;">5</span>    0.155   0.770 0.449 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> A1    PH x NR  -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">2</span>    0.389   2.07  0.049<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> A1    PH x NKR  0.140     0.271   1.38  0.181 </span></span>
<span><span class="co"># <span style="color: #949494;"># ℹ 410 more rows</span></span></span></code></pre></div>
<p>Using the <code><a href="../reference/pairs_mantel.html">pairs_mantel()</a></code> function, it is possible to
compute a Mantel’s test <span class="citation">(<a href="#ref-Mantel1967">Mantel 1967</a>)</span> for all pairwise
correlation matrices of the above example.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lpc2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/pairs_mantel.html">pairs_mantel</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"H"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-6-1.png" width="528" style="display: block; margin: auto;"></p>
<p>This same plot may be obtained by passing correlation matrices with
the same dimension to an object of class <code>lpcor</code> and then
applying the function <code><a href="../reference/pairs_mantel.html">pairs_mantel()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as.lpcor.html">as.lpcor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">5</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">[</span><span class="fl">31</span><span class="op">:</span><span class="fl">60</span>, <span class="fl">5</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">[</span><span class="fl">61</span><span class="op">:</span><span class="fl">90</span>, <span class="fl">5</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">[</span><span class="fl">91</span><span class="op">:</span><span class="fl">120</span>, <span class="fl">5</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">[</span><span class="fl">121</span><span class="op">:</span><span class="fl">150</span>, <span class="fl">5</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/pairs_mantel.html">pairs_mantel</a></span><span class="op">(</span>diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               pan.spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>               shape.point <span class="op">=</span> <span class="fl">21</span>,</span>
<span>               col.point <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>               fill.point <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>               size.point <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>               alpha.point <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>               main <span class="op">=</span> <span class="st">"My own plot"</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-7-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="graphical-and-numerical-visualization-of-a-correlation-matrix">Graphical and numerical visualization of a correlation matrix<a class="anchor" aria-label="anchor" href="#graphical-and-numerical-visualization-of-a-correlation-matrix"></a>
</h3>
<p>The function <code><a href="../reference/corr_coef.html">corr_coef()</a></code> can be used to compute Pearson
producto-moment correlation coefficients with p-values. A correlation
heat map can be created with the function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All numeric variables</span></span>
<span><span class="va">ccoef</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corr_coef.html">corr_coef</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ccoef</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can use a select helper function to select variables. Here, we
will select variables that starts with “C” <strong>OR</strong> ends with
“D” using <code><a href="../reference/Select_helper.html">union_var()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ccoef2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corr_coef.html">corr_coef</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="fu"><a href="../reference/Select_helper.html">union_var</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ccoef2</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Pearson's correlation coefficient</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#        CL    CD   CW   CDED    ED</span></span>
<span><span class="co"># CL   1.00 0.300 0.74  0.708  0.70</span></span>
<span><span class="co"># CD   0.30 1.000 0.48  0.045  0.39</span></span>
<span><span class="co"># CW   0.74 0.484 1.00  0.300  0.74</span></span>
<span><span class="co"># CDED 0.71 0.045 0.30  1.000 -0.01</span></span>
<span><span class="co"># ED   0.70 0.390 0.74 -0.010  1.00</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># p-values for the correlation coefficients</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#           CL      CD      CW    CDED      ED</span></span>
<span><span class="co"># CL   0.0e+00 1.4e-04 3.9e-28 4.9e-25 4.7e-24</span></span>
<span><span class="co"># CD   1.4e-04 0.0e+00 1.5e-10 5.7e-01 4.9e-07</span></span>
<span><span class="co"># CW   3.9e-28 1.5e-10 0.0e+00 1.4e-04 5.3e-28</span></span>
<span><span class="co"># CDED 4.9e-25 5.7e-01 1.4e-04 0.0e+00 9.0e-01</span></span>
<span><span class="co"># ED   4.7e-24 4.9e-07 5.3e-28 9.0e-01 0.0e+00</span></span></code></pre></div>
<p>The function <code><a href="../reference/corr_plot.html">corr_plot()</a></code> may be used to visualize (both
graphically and numerically) a correlation matrix. Pairwise of
scatterplots are produced and may be shown in the upper or lower
diagonal, which may be seen as a nicer and customizable ggplot2-based
version of the <code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs()</a></code>base R function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corr_plot.html">corr_plot</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">CD</span>, <span class="va">EL</span>, <span class="va">PERK</span>, <span class="va">NKR</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-10-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/corr_plot.html">corr_plot</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">CD</span>, <span class="va">EL</span>, <span class="va">PERK</span>, <span class="va">NKR</span>,</span>
<span>          lower <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          upper <span class="op">=</span> <span class="st">"corr"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-10-2.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> </span>
<span><span class="fu"><a href="../reference/corr_plot.html">corr_plot</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">CD</span>, <span class="va">EL</span>, <span class="va">PERK</span>, <span class="va">NKR</span>,</span>
<span>          shape.point <span class="op">=</span> <span class="fl">19</span>,</span>
<span>          size.point <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          alpha.point <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>          alpha.diag <span class="op">=</span> <span class="fl">0</span>,</span>
<span>          pan.spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>          diag.type <span class="op">=</span> <span class="st">"boxplot"</span>,</span>
<span>          col.sign <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>          alpha.sign <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>          axis.labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-10-3.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/corr_plot.html">corr_plot</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">CD</span>, <span class="va">EL</span>, <span class="va">PERK</span>, <span class="va">NKR</span>, <span class="va">CW</span>, <span class="va">NKE</span>,</span>
<span>          prob <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>          shape.point <span class="op">=</span> <span class="fl">21</span>,</span>
<span>          col.point <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>          fill.point <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>          size.point <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          alpha.point <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>          maxsize <span class="op">=</span> <span class="fl">4</span>,</span>
<span>          minsize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          size.smooth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          col.smooth <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>          col.sign <span class="op">=</span> <span class="st">"cyan"</span>,</span>
<span>          col.up.panel <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>          col.lw.panel <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>          col.dia.panel <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>          pan.spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>          lab.position <span class="op">=</span> <span class="st">"tl"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-10-4.png" width="1152" style="display: block; margin: auto;"></p>
<p>It is also possible to use a categorical variable of the data to map
the scatterplot by colors.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corr_plot.html">corr_plot</a></span><span class="op">(</span><span class="va">iris</span>, col.by <span class="op">=</span> <span class="va">Species</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<p>The function <code><a href="../reference/corr_coef.html">corr_coef()</a></code> can be used to compute Pearson
product-moment correlation coefficients with p-values. A correlation
heat map can be created with the function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code></p>
</div>
<div class="section level3">
<h3 id="covariance-and-correlations-for-designed-experiments">(co)variance and correlations for designed experiments<a class="anchor" aria-label="anchor" href="#covariance-and-correlations-for-designed-experiments"></a>
</h3>
<p>The function <code><a href="../reference/covcor_design.html">covcor_design()</a></code> may be used to compute
genetic, phenotypic and residual correlation/(co)variance matrices
through Analysis of Variance (ANOVA) method using randomized complete
block design (RCBD) or completely randomized design (CRD).</p>
<p>The phenotypic
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>p</mi></msub><annotation encoding="application/x-tex">r_p</annotation></semantics></math>),
genotypic
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>g</mi></msub><annotation encoding="application/x-tex">r_g</annotation></semantics></math>)
and residual
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>r</mi></msub><annotation encoding="application/x-tex">r_r</annotation></semantics></math>)
correlations are computed as follows:</p>
<p><span class="math display">$$
r^p_{xy} = \frac{cov^p_{xy}}{\sqrt{var^p_{x}var^p_{y}}} \\
r^g_{xy} = \frac{cov^g_{xy}}{\sqrt{var^g_{x}var^g_{y}}} \\
r^r_{xy} = \frac{cov^r_{xy}}{\sqrt{var^r_{x}var^r_{y}}}
$$</span></p>
<p>Using Mean Squares (<em>MS</em>) from the ANOVA method, the variances
(<em>var</em>) and covariances (<em>cov</em>) are computed as
follows:</p>
<p><span class="math display">$$
cov^p_{xy} = [(MST_{x+y} - MST_x - MST_y)/2]/r \\
var^p_x = MST_x / r \\
var^p_y = MST_y / r \\
cov^r_{xy} = (MSR_{x+y} - MSR_x - MSR_y)/2 \\
var^r_x = MSR_x \\
var^r_y = MSR_y \\
cov^g_{xy} = [(cov^p_{xy} \times r) - cov^r_{xy}]/r \\
var^g_x = (MST_x - MSE_x)/r \\
var^g_y = (MST_x - MSE_y)/r \\
$$</span></p>
<p>where <em>MST</em> is the mean square for treatment, <em>MSR</em> is
the mean square for residuals, and <em>r</em> is the number of
replications.</p>
<p>The function <code><a href="../reference/covcor_design.html">covcor_design()</a></code> returns a list with the
matrices of (co)variances and correlations. Specific matrices may be
returned using the argument <code>type</code>, as shown bellow.</p>
</div>
<div class="section level3">
<h3 id="genetic-correlations">Genetic correlations<a class="anchor" aria-label="anchor" href="#genetic-correlations"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># environment A1</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">ENV</span> <span class="op">==</span> <span class="st">"A1"</span><span class="op">)</span></span>
<span><span class="va">gcor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_design.html">covcor_design</a></span><span class="op">(</span><span class="va">data</span>, gen <span class="op">=</span> <span class="va">GEN</span>, rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span>                      resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span>,</span>
<span>                      type <span class="op">=</span> <span class="st">"gcor"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">gcor</span>, rownames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["PH","EH","NKE","TKW","CL","CD","CW","KW"],[1,-0.00654462344724641,0.2801805601552969,0.2459376565852167,-0.4787073820327835,1.274543788137943,0.1881678511729663,0.4631747391667573],[-0.00654462344724641,1,-0.7752497407879315,0.7247684295348203,0.1482815510926355,1.162159123328462,0.3673279855065509,0.371878516730858],[0.2801805601552969,-0.7752497407879315,1,-0.5117645446775949,-0.8880560463887174,-2.847260660549979,-0.4711246836222129,-0.07957291922406208],[0.2459376565852167,0.7247684295348203,-0.5117645446775949,1,0.7920463764091769,1.048538331991665,0.6378227556855747,0.9318183151382484],[-0.4787073820327835,0.1482815510926355,-0.8880560463887174,0.7920463764091769,1,0.7850417633691477,0.7408723292258106,0.2183064460748723],[1.274543788137943,1.162159123328462,-2.847260660549979,1.048538331991665,0.7850417633691477,1,0.6346041862206916,-0.7087241350683686],[0.1881678511729663,0.3673279855065509,-0.4711246836222129,0.6378227556855747,0.7408723292258106,0.6346041862206916,1,0.3832729454881897],[0.4631747391667573,0.371878516730858,-0.07957291922406208,0.9318183151382484,0.2183064460748723,-0.7087241350683686,0.3832729454881897,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>PH<\/th>\n      <th>EH<\/th>\n      <th>NKE<\/th>\n      <th>TKW<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>CW<\/th>\n      <th>KW<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"PH","targets":1},{"name":"EH","targets":2},{"name":"NKE","targets":3},{"name":"TKW","targets":4},{"name":"CL","targets":5},{"name":"CD","targets":6},{"name":"CW","targets":7},{"name":"KW","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render"],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="phenotypic-correlations">Phenotypic correlations<a class="anchor" aria-label="anchor" href="#phenotypic-correlations"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_design.html">covcor_design</a></span><span class="op">(</span><span class="va">data</span>, gen <span class="op">=</span> <span class="va">GEN</span>, rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span>                      resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span>,</span>
<span>                      type <span class="op">=</span> <span class="st">"pcor"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">pcor</span>, rownames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["PH","EH","NKE","TKW","CL","CD","CW","KW"],[1,0.3307336444036488,0.1417113819239735,0.0008856915564970573,-0.2325352434824966,0.2790497883423511,0.05084927034707898,0.1559143604093134],[0.3307336444036488,1,-0.4388299664214445,0.382862462380367,0.1305909371158631,0.3445835733534663,0.2246554136676434,0.01602622734673176],[0.1417113819239735,-0.4388299664214445,1,-0.5522625652296924,-0.4889322612335488,-0.4126192336300882,-0.2540362798782821,0.3381094398824928],[0.0008856915564970573,0.382862462380367,-0.5522625652296924,1,0.6290481487762123,0.4901820858958312,0.5573426295616348,0.5925536063404834],[-0.2325352434824966,0.1305909371158631,-0.4889322612335488,0.6290481487762123,1,0.3237420592683868,0.7054901077290282,0.178718531463339],[0.2790497883423511,0.3445835733534663,-0.4126192336300882,0.4901820858958312,0.3237420592683868,1,0.4146834276678538,0.1982040232611054],[0.05084927034707898,0.2246554136676434,-0.2540362798782821,0.5573426295616348,0.7054901077290282,0.4146834276678538,1,0.3390796718016665],[0.1559143604093134,0.01602622734673176,0.3381094398824928,0.5925536063404834,0.178718531463339,0.1982040232611054,0.3390796718016665,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>PH<\/th>\n      <th>EH<\/th>\n      <th>NKE<\/th>\n      <th>TKW<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>CW<\/th>\n      <th>KW<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"PH","targets":1},{"name":"EH","targets":2},{"name":"NKE","targets":3},{"name":"TKW","targets":4},{"name":"CL","targets":5},{"name":"CD","targets":6},{"name":"CW","targets":7},{"name":"KW","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render"],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="residual-correlations">Residual correlations<a class="anchor" aria-label="anchor" href="#residual-correlations"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rcor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_design.html">covcor_design</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                      gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span>                      rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span>                      resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span>,</span>
<span>                      type <span class="op">=</span> <span class="st">"rcor"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">rcor</span>, rownames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["PH","EH","NKE","TKW","CL","CD","CW","KW"],[1,0.5343677628228453,0.09568529125662741,-0.1553364599618,-0.08802077886336057,0.06579369968710251,-0.07593889419594967,0.007707804171918205],[0.5343677628228453,1,-0.2317790563696565,-0.04084133532938916,0.1171061408977799,0.04111783893373285,-0.04670674244905601,-0.3474421736854352],[0.09568529125662741,-0.2317790563696565,1,-0.6344318802165014,-0.1360965954994127,0.241638302755906,-0.05479633023785609,0.6257693311759408],[-0.1553364599618,-0.04084133532938916,-0.6344318802165014,1,0.2709103982025182,0.3052487252562803,0.4085472095796164,0.1791327942461187],[-0.08802077886336057,0.1171061408977799,-0.1360965954994127,0.2709103982025182,1,0.1297926351799067,0.5406609978812321,0.1287406873020239],[0.06579369968710251,0.04111783893373285,0.241638302755906,0.3052487252562803,0.1297926351799067,1,0.5043361390076588,0.6007686849447208],[-0.07593889419594967,-0.04670674244905601,-0.05479633023785609,0.4085472095796164,0.5406609978812321,0.5043361390076588,1,0.3139898200671872],[0.007707804171918205,-0.3474421736854352,0.6257693311759408,0.1791327942461187,0.1287406873020239,0.6007686849447208,0.3139898200671872,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>PH<\/th>\n      <th>EH<\/th>\n      <th>NKE<\/th>\n      <th>TKW<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>CW<\/th>\n      <th>KW<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"PH","targets":1},{"name":"EH","targets":2},{"name":"NKE","targets":3},{"name":"TKW","targets":4},{"name":"CL","targets":5},{"name":"CD","targets":6},{"name":"CW","targets":7},{"name":"KW","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render"],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="residual-covariance-matrix">Residual (co)variance matrix<a class="anchor" aria-label="anchor" href="#residual-covariance-matrix"></a>
</h3>
<p>In this example we will obtain the residual (co)variance for each
environment.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_design.html">covcor_design</a></span><span class="op">(</span><span class="va">data_ge2</span>,</span>
<span>                     gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span>                     rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span>                     resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span>,</span>
<span>                     type <span class="op">=</span> <span class="st">"rcov"</span><span class="op">)</span></span></code></pre></div>
<p>The residual (co)variance matrix and the means (obtained using
<code>type = "means"</code>) may be used into the function
<code><a href="../reference/mahala.html">mahala()</a></code> to compute the Mahalanobis distance</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_design.html">covcor_design</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">GEN</span>, <span class="va">REP</span>,</span>
<span>                     resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span>,</span>
<span>                     type <span class="op">=</span> <span class="st">"rcov"</span><span class="op">)</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_design.html">covcor_design</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">GEN</span>, <span class="va">REP</span>,</span>
<span>                       resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"means"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mahala.html">mahala</a></span><span class="op">(</span>.means <span class="op">=</span> <span class="va">means</span>, covar <span class="op">=</span> <span class="va">res</span>, inverted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">D2</span>, rownames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["H1","H10","H11","H12","H13","H2","H3","H4","H5","H6","H7","H8","H9"],[0,24.30445189410958,21.03074321558885,21.4918560647253,19.03975170374914,28.97846970832311,20.2368142863612,10.66975331591478,19.09839761081367,16.69084633448854,26.88644194072839,33.90736931465213,21.88573098393509],[24.30445189410958,0,4.642356278874468,7.627055644784638,28.4355133878166,20.3705925908205,12.41444192176723,24.46329784299842,27.76668811849955,23.62712808730986,18.02376242780689,12.89989092296242,14.03415197727364],[21.03074321558885,4.642356278874468,0,7.04835001448222,35.41962689776203,15.93374012827661,9.211583556538947,17.16740846279226,18.69352546997874,27.05521767953557,15.8837838154697,16.49483612871864,19.69879383032416],[21.4918560647253,7.627055644784638,7.04835001448222,0,18.23832113617302,12.5161485997229,6.661996739476105,13.41290798903304,15.41768721410607,20.63150331917616,6.114015152359947,6.689698183185446,15.52094094270408],[19.03975170374914,28.4355133878166,35.41962689776203,18.23832113617302,0,28.52544735338817,19.08971862553729,15.39896894156017,22.03298101922403,7.334731835789125,17.0712378397523,17.28239761721168,13.26015340593523],[28.97846970832311,20.3705925908205,15.93374012827661,12.5161485997229,28.52544735338817,0,7.00764084895122,19.94109347603627,25.56186872734158,33.1717783038622,24.88162079080395,23.82530317814033,29.07102208751885],[20.2368142863612,12.41444192176723,9.211583556538947,6.661996739476105,19.08971862553729,7.00764084895122,0,6.993175875766299,12.11727977942942,20.02335746717605,11.00160502999242,15.23468762847636,14.15851458286658],[10.66975331591478,24.46329784299842,17.16740846279226,13.41290798903304,15.39896894156017,19.94109347603627,6.993175875766299,0,5.494182355932377,13.78225196115839,11.31422734197007,22.33388811854908,16.11005778850511],[19.09839761081367,27.76668811849955,18.69352546997874,15.41768721410607,22.03298101922403,25.56186872734158,12.11727977942942,5.494182355932377,0,14.0000921128543,6.396492100583782,16.29395016250872,13.55927448399633],[16.69084633448854,23.62712808730986,27.05521767953557,20.63150331917616,7.334731835789125,33.1717783038622,20.02335746717605,13.78225196115839,14.0000921128543,0,14.9755183244082,14.10387841165453,6.279133476959644],[26.88644194072839,18.02376242780689,15.8837838154697,6.114015152359947,17.0712378397523,24.88162079080395,11.00160502999242,11.31422734197007,6.396492100583782,14.9755183244082,0,4.636771500209983,10.9093020360721],[33.90736931465213,12.89989092296242,16.49483612871864,6.689698183185446,17.28239761721168,23.82530317814033,15.23468762847636,22.33388811854908,16.29395016250872,14.10387841165453,4.636771500209983,0,9.913698912127442],[21.88573098393509,14.03415197727364,19.69879383032416,15.52094094270408,13.26015340593523,29.07102208751885,14.15851458286658,16.11005778850511,13.55927448399633,6.279133476959644,10.9093020360721,9.913698912127442,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>H1<\/th>\n      <th>H10<\/th>\n      <th>H11<\/th>\n      <th>H12<\/th>\n      <th>H13<\/th>\n      <th>H2<\/th>\n      <th>H3<\/th>\n      <th>H4<\/th>\n      <th>H5<\/th>\n      <th>H6<\/th>\n      <th>H7<\/th>\n      <th>H8<\/th>\n      <th>H9<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"H1","targets":1},{"name":"H10","targets":2},{"name":"H11","targets":3},{"name":"H12","targets":4},{"name":"H13","targets":5},{"name":"H2","targets":6},{"name":"H3","targets":7},{"name":"H4","targets":8},{"name":"H5","targets":9},{"name":"H6","targets":10},{"name":"H7","targets":11},{"name":"H8","targets":12},{"name":"H9","targets":13}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render"],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="nonparametric-confidence-interval-for-pearsons-correlation">Nonparametric confidence interval for Pearson’s correlation<a class="anchor" aria-label="anchor" href="#nonparametric-confidence-interval-for-pearsons-correlation"></a>
</h3>
<p>Recently, a Gaussian-independent estimator for the confidence
interval of Pearson’s correlation coefficient was proposed by <span class="citation">T. Olivoto et al. (<a href="#ref-Olivoto2018">2018</a>)</span>. This estimator is based on the
sample size and strength of associations and may be estimated using the
function <code><a href="../reference/corr_ci.html">corr_ci()</a></code>. It is possible to estimate the
confidence interval by declaring the sample size (n) and the correlation
coefficient (r), or using a dataframe. The following code computes the
confidence interval and make a plot to show the results.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Use a data frame</span></span>
<span><span class="fu"><a href="../reference/corr_ci.html">corr_ci</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"E"</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="../reference/plot_ci.html">plot_ci</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
<p>In the following examples, the confidence interval is calculated by
declaring the sample size (n) and the correlation coefficient (r). Using
the argument <code>by = ENV</code> the confidence interval can be
calculated within each level of the factor <code>ENV</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inform n and r</span></span>
<span><span class="fu"><a href="../reference/corr_ci.html">corr_ci</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">145</span>, r <span class="op">=</span> <span class="fl">0.34</span><span class="op">)</span></span>
<span><span class="co"># -------------------------------------------------</span></span>
<span><span class="co"># Nonparametric 95% half-width confidence interval </span></span>
<span><span class="co"># -------------------------------------------------</span></span>
<span><span class="co"># Level of significance: 5%</span></span>
<span><span class="co"># Correlation coefficient: 0.34</span></span>
<span><span class="co"># Sample size: 145</span></span>
<span><span class="co"># Confidence interval: 0.1422</span></span>
<span><span class="co"># True parameter range from: 0.1978 to 0.4822 </span></span>
<span><span class="co"># -------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Compute the confidence for each level of ENV</span></span>
<span><span class="va">CI2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corr_ci.html">corr_ci</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"E"</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">ENV</span><span class="op">)</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 21 × 7</span></span></span>
<span><span class="co">#    V1    V2       Corr     n    CI      LL      UL</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> EH    EP     0.839     39 0.185  0.655   1.02  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> EH    EL     0.148     39 0.320 -<span style="color: #BB0000;">0.172</span>   0.467 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> EH    ED    -<span style="color: #BB0000;">0.038</span><span style="color: #BB0000; text-decoration: underline;">5</span>    39 0.349 -<span style="color: #BB0000;">0.387</span>   0.310 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> EH    CDED   0.186     39 0.310 -<span style="color: #BB0000;">0.125</span>   0.496 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> EH    PERK  -<span style="color: #BB0000;">0.205</span>     39 0.306 -<span style="color: #BB0000;">0.510</span>   0.101 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> EH    NKE   -<span style="color: #BB0000;">0.324</span>     39 0.278 -<span style="color: #BB0000;">0.602</span>  -<span style="color: #BB0000;">0.045</span><span style="color: #BB0000; text-decoration: underline;">8</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> EP    EL     0.150     39 0.319 -<span style="color: #BB0000;">0.169</span>   0.469 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> EP    ED    -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">0</span>    39 0.336 -<span style="color: #BB0000;">0.420</span>   0.252 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> EP    CDED   0.328     39 0.277  0.050<span style="text-decoration: underline;">2</span>  0.605 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> EP    PERK  -<span style="color: #BB0000;">0.221</span>     39 0.302 -<span style="color: #BB0000;">0.523</span>   0.080<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co"># <span style="color: #949494;"># ℹ 11 more rows</span></span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 21 × 7</span></span></span>
<span><span class="co">#    V1    V2       Corr     n    CI      LL    UL</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> EH    EP     0.899     39 0.176  0.722  1.08 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> EH    EL     0.498     39 0.242  0.255  0.740</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> EH    ED     0.748     39 0.199  0.549  0.947</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> EH    CDED   0.211     39 0.304 -<span style="color: #BB0000;">0.093</span><span style="color: #BB0000; text-decoration: underline;">5</span> 0.515</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> EH    PERK   0.018<span style="text-decoration: underline;">7</span>    39 0.354 -<span style="color: #BB0000;">0.335</span>  0.373</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> EH    NKE    0.269     39 0.290 -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">7</span> 0.559</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> EP    EL     0.365     39 0.269  0.096<span style="text-decoration: underline;">0</span> 0.634</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> EP    ED     0.600     39 0.224  0.376  0.823</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> EP    CDED   0.249     39 0.295 -<span style="color: #BB0000;">0.046</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.544</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> EP    PERK  -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">5</span>    39 0.345 -<span style="color: #BB0000;">0.396</span>  0.295</span></span>
<span><span class="co"># <span style="color: #949494;"># ℹ 11 more rows</span></span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 21 × 7</span></span></span>
<span><span class="co">#    V1    V2        Corr     n    CI       LL      UL</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> EH    EP     0.844      39 0.184  0.659   1.03   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> EH    EL    -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">7</span>     39 0.333 -<span style="color: #BB0000;">0.430</span>   0.235  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> EH    ED     0.363      39 0.270  0.093<span style="text-decoration: underline;">5</span>  0.633  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> EH    CDED  -<span style="color: #BB0000;">0.282</span>      39 0.287 -<span style="color: #BB0000;">0.569</span>   0.005<span style="text-decoration: underline;">44</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> EH    PERK   0.126      39 0.325 -<span style="color: #BB0000;">0.199</span>   0.451  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> EH    NKE    0.279      39 0.288 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">76</span> 0.567  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> EP    EL    -<span style="color: #BB0000;">0.194</span>      39 0.308 -<span style="color: #BB0000;">0.502</span>   0.114  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> EP    ED     0.200      39 0.307 -<span style="color: #BB0000;">0.107</span>   0.507  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> EP    CDED  -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">56</span>    39 0.357 -<span style="color: #BB0000;">0.366</span>   0.347  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> EP    PERK   0.036<span style="text-decoration: underline;">5</span>     39 0.349 -<span style="color: #BB0000;">0.313</span>   0.386  </span></span>
<span><span class="co"># <span style="color: #949494;"># ℹ 11 more rows</span></span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 21 × 7</span></span></span>
<span><span class="co">#    V1    V2     Corr     n    CI      LL    UL</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> EH    EP    0.781    39 0.194  0.587  0.975</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> EH    EL    0.250    39 0.295 -<span style="color: #BB0000;">0.044</span><span style="color: #BB0000; text-decoration: underline;">6</span> 0.545</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> EH    ED    0.404    39 0.261  0.143  0.665</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> EH    CDED  0.143    39 0.321 -<span style="color: #BB0000;">0.178</span>  0.464</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> EH    PERK  0.250    39 0.295 -<span style="color: #BB0000;">0.044</span><span style="color: #BB0000; text-decoration: underline;">7</span> 0.545</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> EH    NKE   0.246    39 0.296 -<span style="color: #BB0000;">0.049</span><span style="color: #BB0000; text-decoration: underline;">2</span> 0.542</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> EP    EL    0.241    39 0.297 -<span style="color: #BB0000;">0.055</span><span style="color: #BB0000; text-decoration: underline;">9</span> 0.538</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> EP    ED    0.210    39 0.304 -<span style="color: #BB0000;">0.094</span><span style="color: #BB0000; text-decoration: underline;">2</span> 0.514</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> EP    CDED  0.236    39 0.298 -<span style="color: #BB0000;">0.062</span><span style="color: #BB0000; text-decoration: underline;">6</span> 0.534</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> EP    PERK  0.156    39 0.318 -<span style="color: #BB0000;">0.162</span>  0.473</span></span>
<span><span class="co"># <span style="color: #949494;"># ℹ 11 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sample-size-planning">Sample size planning<a class="anchor" aria-label="anchor" href="#sample-size-planning"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/corr_ss.html">corr_ss</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">0.6</span>, CI <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co"># ------------------------------------------------- </span></span>
<span><span class="co"># Sample size planning for correlation coefficient </span></span>
<span><span class="co"># ------------------------------------------------- </span></span>
<span><span class="co"># Level of significance: 5%</span></span>
<span><span class="co"># Correlation coefficient: 0.6</span></span>
<span><span class="co"># 95% half-width CI: 0.1</span></span>
<span><span class="co"># Required sample size: 194</span></span>
<span><span class="co"># -------------------------------------------------</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="collinearity-diagnostic">Collinearity diagnostic<a class="anchor" aria-label="anchor" href="#collinearity-diagnostic"></a>
</h2>
<p>The following codes compute a complete collinearity diagnostic of a
correlation matrix of predictor traits. Several indicators, such as
Variance Inflation Factor, Condition Number, and Matrix Determinant are
considered <span class="citation">(<a href="#ref-Olivoto2017f">T.
Olivoto et al. 2017</a>; <a href="#ref-Olivoto2017c">Olivoto T. et al.
2017</a>)</span> The diagnostic may be performed using: (i) correlation
matrices; (ii) dataframes, or (iii) an object of class
<code>group_factor</code>, which split a dataframe into subsets based on
one or more grouping factors.</p>
<div class="section level3">
<h3 id="using-a-correlation-matrix-which-was-estimated-earlier">Using a correlation matrix, which was estimated earlier<a class="anchor" aria-label="anchor" href="#using-a-correlation-matrix-which-was-estimated-earlier"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor_data</span> <span class="op">&lt;-</span> <span class="va">lpc1</span><span class="op">$</span><span class="va">linear.mat</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span></span>
<span><span class="va">cold1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/colindiag.html">colindiag</a></span><span class="op">(</span><span class="va">cor_data</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-a-dataframe">Using a dataframe<a class="anchor" aria-label="anchor" href="#using-a-dataframe"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cold2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/colindiag.html">colindiag</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="perform-the-diagnostic-for-each-level-of-the-factor-env">Perform the diagnostic for each level of the factor ENV<a class="anchor" aria-label="anchor" href="#perform-the-diagnostic-for-each-level-of-the-factor-env"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cold3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/colindiag.html">colindiag</a></span><span class="op">(</span><span class="va">data_ge2</span> , by <span class="op">=</span> <span class="va">ENV</span><span class="op">)</span></span>
<span>         </span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="path-analysis">Path analysis<a class="anchor" aria-label="anchor" href="#path-analysis"></a>
</h2>
<div class="section level3">
<h3 id="using-kw-as-response-trait-and-all-other-ones-as-predictors-">Using KW as response trait and all other ones as predictors.<a class="anchor" aria-label="anchor" href="#using-kw-as-response-trait-and-all-other-ones-as-predictors-"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcoeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/path_coeff.html">path_coeff</a></span><span class="op">(</span><span class="va">data_ge2</span>, resp <span class="op">=</span> <span class="va">KW</span><span class="op">)</span></span>
<span><span class="co"># Severe multicollinearity. </span></span>
<span><span class="co"># Condition Number: 7865.84</span></span>
<span><span class="co"># Consider using a correction factor with 'correction' argument.</span></span>
<span><span class="co"># Consider identifying collinear traits with `non_collinear_vars()`</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="declaring-the-predictor-traits">Declaring the predictor traits<a class="anchor" aria-label="anchor" href="#declaring-the-predictor-traits"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcoeff2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/path_coeff.html">path_coeff</a></span><span class="op">(</span><span class="va">data_ge2</span>,</span>
<span>             resp <span class="op">=</span> <span class="va">KW</span>,</span>
<span>             pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">NKE</span>, <span class="va">TKW</span><span class="op">)</span>,</span>
<span>             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pcoeff2</span><span class="op">)</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># Correlation matrix between the predictor traits</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co">#         PH      NKE      TKW</span></span>
<span><span class="co"># PH  1.0000  0.45838  0.56854</span></span>
<span><span class="co"># NKE 0.4584  1.00000 -0.06516</span></span>
<span><span class="co"># TKW 0.5685 -0.06516  1.00000</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># Vector of correlations between dependent and each predictor</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co">#           PH       NKE       TKW</span></span>
<span><span class="co"># KW 0.7534439 0.6810756 0.6730371</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># Multicollinearity diagnosis and goodness-of-fit</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># Condition number:  7.1689 </span></span>
<span><span class="co"># Determinant:       0.4284438 </span></span>
<span><span class="co"># R-square:          0.981 </span></span>
<span><span class="co"># Residual:          0.1379 </span></span>
<span><span class="co"># Response:          KW </span></span>
<span><span class="co"># Predictors:        PH NKE TKW </span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># Variance inflation factors</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#   VAR     VIF</span></span>
<span><span class="co">#   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;">1</span> PH    2.324</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">2</span> NKE   1.580</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">3</span> TKW   1.844</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># Eigenvalues and eigenvectors</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#   Eigenvalues       PH     NKE     TKW</span></span>
<span><span class="co">#         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;">1</span>      1.699   0.722<span style="text-decoration: underline;">2</span>   0.422<span style="text-decoration: underline;">3</span>  0.547<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;">2</span>      1.064  -<span style="color: #BB0000;">0.019</span><span style="color: #BB0000; text-decoration: underline;">21</span> -<span style="color: #BB0000;">0.779</span><span style="color: #BB0000; text-decoration: underline;">4</span>  0.626<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;">3</span>      0.237<span style="text-decoration: underline;">0</span>  0.691<span style="text-decoration: underline;">4</span>  -<span style="color: #BB0000;">0.462</span><span style="color: #BB0000; text-decoration: underline;">8</span> -<span style="color: #BB0000;">0.554</span><span style="color: #BB0000; text-decoration: underline;">8</span></span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># Variables with the largest weight in the eigenvalue of smallest magnitude</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># PH &gt; TKW &gt; NKE </span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># Direct (diagonal) and indirect (off-diagonal) effects</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span>
<span><span class="co">#             PH         NKE         TKW    linear</span></span>
<span><span class="co"># PH  0.02350989  0.32834888  0.40158514 0.7534439</span></span>
<span><span class="co"># NKE 0.01077646  0.71632454 -0.04602544 0.6810756</span></span>
<span><span class="co"># TKW 0.01336628 -0.04667561  0.70634648 0.6730371</span></span>
<span><span class="co"># ----------------------------------------------------------------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="selecting-traits-to-be-excluded-from-the-analysis-">Selecting traits to be excluded from the analysis.<a class="anchor" aria-label="anchor" href="#selecting-traits-to-be-excluded-from-the-analysis-"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcoeff2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/path_coeff.html">path_coeff</a></span><span class="op">(</span><span class="va">data_ge2</span>, </span>
<span>             resp <span class="op">=</span> <span class="va">KW</span>,</span>
<span>             pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span><span class="op">)</span>,</span>
<span>             exclude <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="selecting-a-set-of-predictors-with-minimal-multicollinearity">Selecting a set of predictors with minimal multicollinearity<a class="anchor" aria-label="anchor" href="#selecting-a-set-of-predictors-with-minimal-multicollinearity"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcoeff3</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/path_coeff.html">path_coeff</a></span><span class="op">(</span><span class="va">data_ge2</span>,</span>
<span>             resp <span class="op">=</span> <span class="va">KW</span>,</span>
<span>             brutstep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             maxvif <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span>
<span><span class="co"># The algorithm has selected a set of 8 predictors with largest VIF = 3.346. </span></span>
<span><span class="co"># Selected predictors: NR PERK EP CDED EL NKR TKW PH </span></span>
<span><span class="co"># A forward stepwise-based selection procedure will fit 6 models.</span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span>
<span><span class="co"># Adjusting the model 1 with 7 predictors (16.67% concluded)</span></span>
<span><span class="co"># Adjusting the model 2 with 6 predictors (33.33% concluded)</span></span>
<span><span class="co"># Adjusting the model 3 with 5 predictors (50% concluded)</span></span>
<span><span class="co"># Adjusting the model 4 with 4 predictors (66.67% concluded)</span></span>
<span><span class="co"># Adjusting the model 5 with 3 predictors (83.33% concluded)</span></span>
<span><span class="co"># Adjusting the model 6 with 2 predictors (100% concluded)</span></span>
<span><span class="co"># Done!</span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span>
<span><span class="co"># Summary of the adjusted models </span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span>
<span><span class="co">#    Model  AIC Numpred    CN Determinant    R2 Residual maxVIF</span></span>
<span><span class="co">#  MODEL_1 1127       7 13.67      0.0841 0.933    0.259   2.59</span></span>
<span><span class="co">#  MODEL_2 1125       6 12.26      0.1383 0.933    0.259   2.46</span></span>
<span><span class="co">#  MODEL_3 1126       5 12.05      0.1989 0.932    0.261   2.31</span></span>
<span><span class="co">#  MODEL_4 1251       4  6.66      0.4016 0.846    0.393   1.98</span></span>
<span><span class="co">#  MODEL_5 1308       3  3.05      0.7438 0.774    0.475   1.34</span></span>
<span><span class="co">#  MODEL_6 1329       2  2.23      0.8555 0.738    0.512   1.17</span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compute-the-analysis-for-each-level-of-environment">Compute the analysis for each level of environment<a class="anchor" aria-label="anchor" href="#compute-the-analysis-for-each-level-of-environment"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcoeff4</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/path_coeff.html">path_coeff</a></span><span class="op">(</span><span class="va">data_ge2</span>,</span>
<span>             resp <span class="op">=</span> <span class="va">KW</span>,</span>
<span>             pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span><span class="op">)</span>,</span>
<span>             by <span class="op">=</span> <span class="va">ENV</span><span class="op">)</span></span>
<span><span class="co"># Weak multicollinearity. </span></span>
<span><span class="co"># Condition Number: 5.183</span></span>
<span><span class="co"># You will probably have path coefficients close to being unbiased. </span></span>
<span><span class="co"># Weak multicollinearity. </span></span>
<span><span class="co"># Condition Number: 81.987</span></span>
<span><span class="co"># You will probably have path coefficients close to being unbiased. </span></span>
<span><span class="co"># Weak multicollinearity. </span></span>
<span><span class="co"># Condition Number: 24.788</span></span>
<span><span class="co"># You will probably have path coefficients close to being unbiased. </span></span>
<span><span class="co"># Weak multicollinearity. </span></span>
<span><span class="co"># Condition Number: 10.276</span></span>
<span><span class="co"># You will probably have path coefficients close to being unbiased.</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="canonical-correlation-analysis">Canonical correlation analysis<a class="anchor" aria-label="anchor" href="#canonical-correlation-analysis"></a>
</h2>
<p>First of all, we will rename the plant-related traits
<code>PH, EH EP</code> with the suffix <code>_PLA</code> to show the
usability of the select helper <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains()</a></code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="va">data_ge2</span>,</span>
<span>                  PH_PLA <span class="op">=</span> <span class="va">PH</span>,</span>
<span>                  EH_PLA <span class="op">=</span> <span class="va">EH</span>,</span>
<span>                  EP_PLA <span class="op">=</span> <span class="va">EP</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Type the variable names</span></span>
<span><span class="va">cc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/can_corr.html">can_corr</a></span><span class="op">(</span><span class="va">data_cc</span>,</span>
<span>                FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH_PLA</span>, <span class="va">EH_PLA</span>, <span class="va">EP_PLA</span><span class="op">)</span>,</span>
<span>                SG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">EL</span>, <span class="va">ED</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Matrix (correlation/covariance) between variables of first group (FG)</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#           PH_PLA    EH_PLA    EP_PLA</span></span>
<span><span class="co"># PH_PLA 1.0000000 0.9318282 0.6384123</span></span>
<span><span class="co"># EH_PLA 0.9318282 1.0000000 0.8695460</span></span>
<span><span class="co"># EP_PLA 0.6384123 0.8695460 1.0000000</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Collinearity within first group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># The multicollinearity in the matrix should be investigated.</span></span>
<span><span class="co"># cn = 977.586</span></span>
<span><span class="co"># Largest VIF = 229.164618380199</span></span>
<span><span class="co"># Matrix determinant: 0.0025852 </span></span>
<span><span class="co"># Largest correlation: PH_PLA x EH_PLA = 0.932 </span></span>
<span><span class="co"># Smallest correlation: PH_PLA x EP_PLA = 0.638 </span></span>
<span><span class="co"># Number of VIFs &gt; 10: 3 </span></span>
<span><span class="co"># Number of correlations with r &gt;= |0.8|:  </span></span>
<span><span class="co"># Variables with largest weight in the last eigenvalues: </span></span>
<span><span class="co"># EH_PLA &gt; PH_PLA &gt; EP_PLA </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Matrix (correlation/covariance) between variables of second group (SG)</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#           EL        ED        CL        CD        CW        KW</span></span>
<span><span class="co"># EL 1.0000000 0.3851451 0.2554068 0.9118653 0.4581728 0.6685601</span></span>
<span><span class="co"># ED 0.3851451 1.0000000 0.6974629 0.3897128 0.7371305 0.8241426</span></span>
<span><span class="co"># CL 0.2554068 0.6974629 1.0000000 0.3003636 0.7383379 0.4709310</span></span>
<span><span class="co"># CD 0.9118653 0.3897128 0.3003636 1.0000000 0.4840299 0.6259806</span></span>
<span><span class="co"># CW 0.4581728 0.7371305 0.7383379 0.4840299 1.0000000 0.7348622</span></span>
<span><span class="co"># KW 0.6685601 0.8241426 0.4709310 0.6259806 0.7348622 1.0000000</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Collinearity within second group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Weak multicollinearity in the matrix</span></span>
<span><span class="co"># cn = 66.084</span></span>
<span><span class="co"># Matrix determinant: 0.0028626 </span></span>
<span><span class="co"># Largest correlation: EL x CD = 0.912 </span></span>
<span><span class="co"># Smallest correlation: EL x CL = 0.255 </span></span>
<span><span class="co"># Number of VIFs &gt; 10: 0 </span></span>
<span><span class="co"># Number of correlations with r &gt;= |0.8|:  </span></span>
<span><span class="co"># Variables with largest weight in the last eigenvalues: </span></span>
<span><span class="co"># KW &gt; EL &gt; ED &gt; CD &gt; CL &gt; CW </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Matrix (correlation/covariance) between FG and SG</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#               EL        ED        CL        CD        CW        KW</span></span>
<span><span class="co"># PH_PLA 0.3801960 0.6613148 0.3251648 0.3153910 0.5047388 0.7534439</span></span>
<span><span class="co"># EH_PLA 0.3626537 0.6302561 0.3971935 0.2805118 0.5193136 0.7029469</span></span>
<span><span class="co"># EP_PLA 0.2634237 0.4580196 0.3908239 0.1750448 0.4248098 0.4974193</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Correlation of the canonical pairs and hypothesis testing </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#              Var   Percent       Sum      Corr  Lambda     Chisq DF   p_val</span></span>
<span><span class="co"># U1V1 0.630438540 78.617161  78.61716 0.7940016 0.30668 177.29224 18 0.00000</span></span>
<span><span class="co"># U2V2 0.163384310 20.374406  98.99157 0.4042083 0.82985  27.97651 10 0.00182</span></span>
<span><span class="co"># U3V3 0.008086721  1.008433 100.00000 0.0899262 0.99191   1.21794  4 0.87514</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Canonical coefficients of the first group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#               U1        U2         U3</span></span>
<span><span class="co"># PH_PLA -2.609792  5.490798   7.575090</span></span>
<span><span class="co"># EH_PLA  2.559005 -7.646096 -12.812234</span></span>
<span><span class="co"># EP_PLA -1.191023  2.428742   6.604968</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Canonical coefficients of the second group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#             V1         V2          V3</span></span>
<span><span class="co"># EL  0.01008726 -1.0481893  0.60553720</span></span>
<span><span class="co"># ED -0.14629899  0.7853469 -1.30457763</span></span>
<span><span class="co"># CL  0.09112023 -1.2989864 -0.07497186</span></span>
<span><span class="co"># CD  0.29105227  1.1513083 -1.50589651</span></span>
<span><span class="co"># CW  0.12527616 -0.0361706  0.21180796</span></span>
<span><span class="co"># KW -1.16041981 -0.1022916  1.34278026</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Canonical loads of the first group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#                U1          U2         U3</span></span>
<span><span class="co"># PH_PLA -0.9856022 -0.08351129 -0.1470178</span></span>
<span><span class="co"># EH_PLA -0.9085216 -0.41771278 -0.0102277</span></span>
<span><span class="co"># EP_PLA -0.6319736 -0.71449671  0.3001730</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Canonical loads of the second group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#            V1          V2         V3</span></span>
<span><span class="co"># EL -0.4759982 -0.11260907 -0.2944636</span></span>
<span><span class="co"># ED -0.8294407 -0.18663860 -0.4477426</span></span>
<span><span class="co"># CL -0.3749015 -0.74801793 -0.4937819</span></span>
<span><span class="co"># CD -0.3951578  0.02985218 -0.5415818</span></span>
<span><span class="co"># CW -0.6225367 -0.41451273 -0.2698904</span></span>
<span><span class="co"># KW -0.9570820 -0.07344796 -0.1498587</span></span>
<span></span>
<span><span class="co"># Use select helpers</span></span>
<span><span class="va">cc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/can_corr.html">can_corr</a></span><span class="op">(</span><span class="va">data_cc</span>,</span>
<span>                FG <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"_PLA"</span><span class="op">)</span>,</span>
<span>                SG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">EL</span>, <span class="va">ED</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Matrix (correlation/covariance) between variables of first group (FG)</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#           PH_PLA    EH_PLA    EP_PLA</span></span>
<span><span class="co"># PH_PLA 1.0000000 0.9318282 0.6384123</span></span>
<span><span class="co"># EH_PLA 0.9318282 1.0000000 0.8695460</span></span>
<span><span class="co"># EP_PLA 0.6384123 0.8695460 1.0000000</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Collinearity within first group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># The multicollinearity in the matrix should be investigated.</span></span>
<span><span class="co"># cn = 977.586</span></span>
<span><span class="co"># Largest VIF = 229.164618380199</span></span>
<span><span class="co"># Matrix determinant: 0.0025852 </span></span>
<span><span class="co"># Largest correlation: PH_PLA x EH_PLA = 0.932 </span></span>
<span><span class="co"># Smallest correlation: PH_PLA x EP_PLA = 0.638 </span></span>
<span><span class="co"># Number of VIFs &gt; 10: 3 </span></span>
<span><span class="co"># Number of correlations with r &gt;= |0.8|:  </span></span>
<span><span class="co"># Variables with largest weight in the last eigenvalues: </span></span>
<span><span class="co"># EH_PLA &gt; PH_PLA &gt; EP_PLA </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Matrix (correlation/covariance) between variables of second group (SG)</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#           EL        ED        CL        CD        CW        KW</span></span>
<span><span class="co"># EL 1.0000000 0.3851451 0.2554068 0.9118653 0.4581728 0.6685601</span></span>
<span><span class="co"># ED 0.3851451 1.0000000 0.6974629 0.3897128 0.7371305 0.8241426</span></span>
<span><span class="co"># CL 0.2554068 0.6974629 1.0000000 0.3003636 0.7383379 0.4709310</span></span>
<span><span class="co"># CD 0.9118653 0.3897128 0.3003636 1.0000000 0.4840299 0.6259806</span></span>
<span><span class="co"># CW 0.4581728 0.7371305 0.7383379 0.4840299 1.0000000 0.7348622</span></span>
<span><span class="co"># KW 0.6685601 0.8241426 0.4709310 0.6259806 0.7348622 1.0000000</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Collinearity within second group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Weak multicollinearity in the matrix</span></span>
<span><span class="co"># cn = 66.084</span></span>
<span><span class="co"># Matrix determinant: 0.0028626 </span></span>
<span><span class="co"># Largest correlation: EL x CD = 0.912 </span></span>
<span><span class="co"># Smallest correlation: EL x CL = 0.255 </span></span>
<span><span class="co"># Number of VIFs &gt; 10: 0 </span></span>
<span><span class="co"># Number of correlations with r &gt;= |0.8|:  </span></span>
<span><span class="co"># Variables with largest weight in the last eigenvalues: </span></span>
<span><span class="co"># KW &gt; EL &gt; ED &gt; CD &gt; CL &gt; CW </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Matrix (correlation/covariance) between FG and SG</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#               EL        ED        CL        CD        CW        KW</span></span>
<span><span class="co"># PH_PLA 0.3801960 0.6613148 0.3251648 0.3153910 0.5047388 0.7534439</span></span>
<span><span class="co"># EH_PLA 0.3626537 0.6302561 0.3971935 0.2805118 0.5193136 0.7029469</span></span>
<span><span class="co"># EP_PLA 0.2634237 0.4580196 0.3908239 0.1750448 0.4248098 0.4974193</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Correlation of the canonical pairs and hypothesis testing </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#              Var   Percent       Sum      Corr  Lambda     Chisq DF   p_val</span></span>
<span><span class="co"># U1V1 0.630438540 78.617161  78.61716 0.7940016 0.30668 177.29224 18 0.00000</span></span>
<span><span class="co"># U2V2 0.163384310 20.374406  98.99157 0.4042083 0.82985  27.97651 10 0.00182</span></span>
<span><span class="co"># U3V3 0.008086721  1.008433 100.00000 0.0899262 0.99191   1.21794  4 0.87514</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Canonical coefficients of the first group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#               U1        U2         U3</span></span>
<span><span class="co"># PH_PLA -2.609792  5.490798   7.575090</span></span>
<span><span class="co"># EH_PLA  2.559005 -7.646096 -12.812234</span></span>
<span><span class="co"># EP_PLA -1.191023  2.428742   6.604968</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Canonical coefficients of the second group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#             V1         V2          V3</span></span>
<span><span class="co"># EL  0.01008726 -1.0481893  0.60553720</span></span>
<span><span class="co"># ED -0.14629899  0.7853469 -1.30457763</span></span>
<span><span class="co"># CL  0.09112023 -1.2989864 -0.07497186</span></span>
<span><span class="co"># CD  0.29105227  1.1513083 -1.50589651</span></span>
<span><span class="co"># CW  0.12527616 -0.0361706  0.21180796</span></span>
<span><span class="co"># KW -1.16041981 -0.1022916  1.34278026</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Canonical loads of the first group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#                U1          U2         U3</span></span>
<span><span class="co"># PH_PLA -0.9856022 -0.08351129 -0.1470178</span></span>
<span><span class="co"># EH_PLA -0.9085216 -0.41771278 -0.0102277</span></span>
<span><span class="co"># EP_PLA -0.6319736 -0.71449671  0.3001730</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Canonical loads of the second group </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#            V1          V2         V3</span></span>
<span><span class="co"># EL -0.4759982 -0.11260907 -0.2944636</span></span>
<span><span class="co"># ED -0.8294407 -0.18663860 -0.4477426</span></span>
<span><span class="co"># CL -0.3749015 -0.74801793 -0.4937819</span></span>
<span><span class="co"># CD -0.3951578  0.02985218 -0.5415818</span></span>
<span><span class="co"># CW -0.6225367 -0.41451273 -0.2698904</span></span>
<span><span class="co"># KW -0.9570820 -0.07344796 -0.1498587</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="clustering-analysis">Clustering analysis<a class="anchor" aria-label="anchor" href="#clustering-analysis"></a>
</h2>
<div class="section level3">
<h3 id="using-function-clustering">Using function clustering()<a class="anchor" aria-label="anchor" href="#using-function-clustering"></a>
</h3>
<div class="section level4">
<h4 id="all-rows-and-all-numeric-variables-from-data">All rows and all numeric variables from data<a class="anchor" aria-label="anchor" href="#all-rows-and-all-numeric-variables-from-data"></a>
</h4>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="based-on-the-mean-for-each-genotype">Based on the mean for each genotype<a class="anchor" aria-label="anchor" href="#based-on-the-mean-for-each-genotype"></a>
</h4>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_gen</span> <span class="op">&lt;-</span></span>
<span> <span class="va">data_ge2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu"><a href="../reference/utils_stats.html">mean_by</a></span><span class="op">(</span><span class="va">GEN</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu"><a href="../reference/utils_rows_cols.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"GEN"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">mean_gen</span><span class="op">)</span></span></code></pre></div>
<p>The S3 generic function plot() may be used to plot the dendrogram
generated by the function <code><a href="../reference/clustering.html">clustering()</a></code>. A dashed line is
draw at the cutpoint suggested according to <span class="citation">Mojena (<a href="#ref-Mojena1977">1977</a>)</span>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-31-1.png" width="528" style="display: block; margin: auto;">
According to the suggested cutpoint, two clusters are formed. The number
of clusters may also be found using intensive computation. I suggest the
package <a href="http://stat.sys.i.kyoto-u.ac.jp/prog/pvclust/" class="external-link">pcvlust</a>, an R
package for assessing the uncertainty in hierarchical cluster analysis.
The implementation may be see below.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stat.sys.i.kyoto-u.ac.jp/prog/pvclust/" class="external-link">pvclust</a></span><span class="op">)</span></span>
<span><span class="va">pv_clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html" class="external-link">pvclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">d2</span><span class="op">$</span><span class="va">de</span><span class="op">)</span><span class="op">)</span>, nboot <span class="op">=</span> <span class="fl">100</span>, method.dist <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span><span class="co"># Bootstrap (r = 0.46)... Done.</span></span>
<span><span class="co"># Bootstrap (r = 0.54)... Done.</span></span>
<span><span class="co"># Bootstrap (r = 0.69)... Done.</span></span>
<span><span class="co"># Bootstrap (r = 0.77)... Done.</span></span>
<span><span class="co"># Bootstrap (r = 0.85)... Done.</span></span>
<span><span class="co"># Bootstrap (r = 1.0)... Done.</span></span>
<span><span class="co"># Bootstrap (r = 1.08)... Done.</span></span>
<span><span class="co"># Bootstrap (r = 1.15)... Done.</span></span>
<span><span class="co"># Bootstrap (r = 1.23)... Done.</span></span>
<span><span class="co"># Bootstrap (r = 1.38)... Done.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pv_clust</span>, hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvpick.html" class="external-link">pvrect</a></span><span class="op">(</span><span class="va">pv_clust</span>, alpha <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-32-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="indicating-the-variables-to-compute-the-distances">Indicating the variables to compute the distances<a class="anchor" aria-label="anchor" href="#indicating-the-variables-to-compute-the-distances"></a>
</h4>
<p>It is possible to indicate the variables from the data_ge2 to compute
the distances. To do that is easy. You should only provide a
comma-separated list of unquoted variable names after the .data
argument. For example, to compute the distances between the genotypes
based on the variables NKR, TKW, and NKE, the following arguments should
be used.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">mean_gen</span>, <span class="va">NKR</span>, <span class="va">TKW</span>, <span class="va">NKE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="select-variables-for-compute-the-distances">Select variables for compute the distances<a class="anchor" aria-label="anchor" href="#select-variables-for-compute-the-distances"></a>
</h4>
<p>When <code>selvar = TRUE</code> is used, an algorithm for variable
selection is implemented. See <code><a href="../reference/clustering.html">?clustering</a></code> for more
details.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">mean_gen</span>, selvar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># EP excluded in this step |===                                             | 7% EH excluded in this step |=======                                         | 14% CDED excluded in this step |==========                                    | 21% PH excluded in this step |==============                                  | 29% CL excluded in this step |=================                               | 36% NR excluded in this step |=====================                           | 43% PERK excluded in this step |=======================                       | 50% EL excluded in this step |===========================                     | 57% CD excluded in this step |===============================                 | 64% ED excluded in this step |==================================              | 71% KW excluded in this step |======================================          | 79% CW excluded in this step |=========================================       | 86% NKR excluded in this step |============================================   | 93% TKW excluded in this step |===============================================| 100% </span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Summary of the adjusted models </span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span>
<span><span class="co">#     Model excluded cophenetic remaining cormantel    pvmantel</span></span>
<span><span class="co">#   Model 1        -  0.8656190        15 1.0000000 0.000999001</span></span>
<span><span class="co">#   Model 2       EP  0.8656191        14 1.0000000 0.000999001</span></span>
<span><span class="co">#   Model 3       EH  0.8656191        13 1.0000000 0.000999001</span></span>
<span><span class="co">#   Model 4     CDED  0.8656191        12 1.0000000 0.000999001</span></span>
<span><span class="co">#   Model 5       PH  0.8656189        11 1.0000000 0.000999001</span></span>
<span><span class="co">#   Model 6       CL  0.8655939        10 0.9999996 0.000999001</span></span>
<span><span class="co">#   Model 7       NR  0.8656719         9 0.9999982 0.000999001</span></span>
<span><span class="co">#   Model 8     PERK  0.8657259         8 0.9999977 0.000999001</span></span>
<span><span class="co">#   Model 9       EL  0.8657904         7 0.9999972 0.000999001</span></span>
<span><span class="co">#  Model 10       CD  0.8658997         6 0.9999964 0.000999001</span></span>
<span><span class="co">#  Model 11       ED  0.8658274         5 0.9999931 0.000999001</span></span>
<span><span class="co">#  Model 12       KW  0.8643556         4 0.9929266 0.000999001</span></span>
<span><span class="co">#  Model 13       CW  0.8640355         3 0.9927593 0.000999001</span></span>
<span><span class="co">#  Model 14      NKR  0.8648384         2 0.9925396 0.000999001</span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span>
<span><span class="co"># Suggested variables to be used in the analysis</span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span>
<span><span class="co"># The clustering was calculated with the  Model 10 </span></span>
<span><span class="co"># The variables included in this model were...</span></span>
<span><span class="co">#  ED CW KW NKR TKW NKE </span></span>
<span><span class="co"># --------------------------------------------------------------------------</span></span></code></pre></div>
<p>The distances were computed using the variables ED, CW, KW, NKR, TKW,
and NKE. By using these variables the highest cophenetic correlation
coefficient (0.8658) was observed. The Mantel’s correlation estimated
with the distance matrix of Model 10 (selected variables) with the
original distance matrix (estimated with all variables) was near to 1,
suggesting that the deletion of the variables to compute the distance
don’t affect significantly the computation of the distances.</p>
</div>
<div class="section level4">
<h4 id="extending-the-dendrogram-functionality">Extending the dendrogram Functionality<a class="anchor" aria-label="anchor" href="#extending-the-dendrogram-functionality"></a>
</h4>
<p>The package <a href="https://cran.r-project.org/web/packages/dendextend/vignettes/introduction.html" class="external-link">dendextend</a>
offers a set of functions for extending ‘dendrogram’ objects in R. A
simple example is given bellow.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span><span class="va">d4</span><span class="op">$</span><span class="va">hc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/color_labels.html" class="external-link">color_labels</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/color_branches.html" class="external-link">branches_color</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/highlight_branches.html" class="external-link">highlight_branches_lwd</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>horiz <span class="op">=</span> <span class="cn">TRUE</span>, xlab <span class="op">=</span> <span class="st">"Euclidean distance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-35-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="compute-the-distances-for-each-environment">Compute the distances for each environment<a class="anchor" aria-label="anchor" href="#compute-the-distances-for-each-environment"></a>
</h4>
<ul>
<li>All rows of each environment and all numeric variables used</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">data_ge2</span>,</span>
<span>                 by <span class="op">=</span> <span class="va">ENV</span>,</span>
<span>                 nclust <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="check-the-correlation-between-distance-matrices">Check the correlation between distance matrices<a class="anchor" aria-label="anchor" href="#check-the-correlation-between-distance-matrices"></a>
</h4>
<p>The function <code><a href="../reference/pairs_mantel.html">pairs_mantel()</a></code> may be used to check the
relationships between the distance matrices when the clustering is
performed for each level of a grouping factor. In this example, we have
four distance matrices corresponding to four environments.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pairs_mantel.html">pairs_mantel</a></span><span class="op">(</span><span class="va">d6</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>, <span class="st">"A4"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-37-1.png" width="528" style="display: block; margin: auto;"></p>
<p>The low values of correlation between the distance matrices suggest
that the genotype clustering should vary significantly among
environments.</p>
</div>
</div>
<div class="section level3">
<h3 id="mahalanobis-distance">Mahalanobis distance<a class="anchor" aria-label="anchor" href="#mahalanobis-distance"></a>
</h3>
<div class="section level4">
<h4 id="based-on-designed-experiments">Based on designed experiments<a class="anchor" aria-label="anchor" href="#based-on-designed-experiments"></a>
</h4>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Environment E1</span></span>
<span><span class="va">data_E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">ENV</span> <span class="op">==</span> <span class="st">"A1"</span><span class="op">)</span></span>
<span><span class="va">D2_des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mahala_design.html">mahala_design</a></span><span class="op">(</span><span class="va">data_E1</span>,</span>
<span>                        gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span>                        rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span>                        resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">D2_des</span>, rownames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-10b3b7155e8045a1b2ad" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["H1","H10","H11","H12","H13","H2","H3","H4","H5","H6","H7","H8","H9"],[0,24.30445189410958,21.03074321558885,21.4918560647253,19.03975170374914,28.97846970832311,20.2368142863612,10.66975331591478,19.09839761081367,16.69084633448854,26.88644194072839,33.90736931465213,21.88573098393509],[24.30445189410958,0,4.642356278874468,7.627055644784638,28.4355133878166,20.3705925908205,12.41444192176723,24.46329784299842,27.76668811849955,23.62712808730986,18.02376242780689,12.89989092296242,14.03415197727364],[21.03074321558885,4.642356278874468,0,7.04835001448222,35.41962689776203,15.93374012827661,9.211583556538947,17.16740846279226,18.69352546997874,27.05521767953557,15.8837838154697,16.49483612871864,19.69879383032416],[21.4918560647253,7.627055644784638,7.04835001448222,0,18.23832113617302,12.5161485997229,6.661996739476105,13.41290798903304,15.41768721410607,20.63150331917616,6.114015152359947,6.689698183185446,15.52094094270408],[19.03975170374914,28.4355133878166,35.41962689776203,18.23832113617302,0,28.52544735338817,19.08971862553729,15.39896894156017,22.03298101922403,7.334731835789125,17.0712378397523,17.28239761721168,13.26015340593523],[28.97846970832311,20.3705925908205,15.93374012827661,12.5161485997229,28.52544735338817,0,7.00764084895122,19.94109347603627,25.56186872734158,33.1717783038622,24.88162079080395,23.82530317814033,29.07102208751885],[20.2368142863612,12.41444192176723,9.211583556538947,6.661996739476105,19.08971862553729,7.00764084895122,0,6.993175875766299,12.11727977942942,20.02335746717605,11.00160502999242,15.23468762847636,14.15851458286658],[10.66975331591478,24.46329784299842,17.16740846279226,13.41290798903304,15.39896894156017,19.94109347603627,6.993175875766299,0,5.494182355932377,13.78225196115839,11.31422734197007,22.33388811854908,16.11005778850511],[19.09839761081367,27.76668811849955,18.69352546997874,15.41768721410607,22.03298101922403,25.56186872734158,12.11727977942942,5.494182355932377,0,14.0000921128543,6.396492100583782,16.29395016250872,13.55927448399633],[16.69084633448854,23.62712808730986,27.05521767953557,20.63150331917616,7.334731835789125,33.1717783038622,20.02335746717605,13.78225196115839,14.0000921128543,0,14.9755183244082,14.10387841165453,6.279133476959644],[26.88644194072839,18.02376242780689,15.8837838154697,6.114015152359947,17.0712378397523,24.88162079080395,11.00160502999242,11.31422734197007,6.396492100583782,14.9755183244082,0,4.636771500209983,10.9093020360721],[33.90736931465213,12.89989092296242,16.49483612871864,6.689698183185446,17.28239761721168,23.82530317814033,15.23468762847636,22.33388811854908,16.29395016250872,14.10387841165453,4.636771500209983,0,9.913698912127442],[21.88573098393509,14.03415197727364,19.69879383032416,15.52094094270408,13.26015340593523,29.07102208751885,14.15851458286658,16.11005778850511,13.55927448399633,6.279133476959644,10.9093020360721,9.913698912127442,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>H1<\/th>\n      <th>H10<\/th>\n      <th>H11<\/th>\n      <th>H12<\/th>\n      <th>H13<\/th>\n      <th>H2<\/th>\n      <th>H3<\/th>\n      <th>H4<\/th>\n      <th>H5<\/th>\n      <th>H6<\/th>\n      <th>H7<\/th>\n      <th>H8<\/th>\n      <th>H9<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"H1","targets":1},{"name":"H10","targets":2},{"name":"H11","targets":3},{"name":"H12","targets":4},{"name":"H13","targets":5},{"name":"H2","targets":6},{"name":"H3","targets":7},{"name":"H4","targets":8},{"name":"H5","targets":9},{"name":"H6","targets":10},{"name":"H7","targets":11},{"name":"H8","targets":12},{"name":"H9","targets":13}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render"],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="compute-one-distance-for-each-environment">Compute one distance for each environment<a class="anchor" aria-label="anchor" href="#compute-one-distance-for-each-environment"></a>
</h4>
<p>To compute the Mahalanobis distance for each environment (or any
grouping variable) we can use the argument <code>by</code>. Note that
<code><a href="../reference/pairs_mantel.html">pairs_mantel()</a></code> is used to compare compute the Mantel’s test
for each combination of distance matrices. Let’s do it.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_ge2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="../reference/mahala_design.html">mahala_design</a></span><span class="op">(</span>gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span>              rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span>              resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span>,</span>
<span>              by <span class="op">=</span> <span class="va">ENV</span><span class="op">)</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 52 × 14</span></span></span>
<span><span class="co">#    ENV      H1   H10   H11   H12   H13    H2    H3    H4    H5    H6    H7    H8</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> A1      0   24.3  21.0  21.5  19.0  29.0  20.2  10.7  19.1  16.7  26.9  33.9 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> A1     24.3  0     4.64  7.63 28.4  20.4  12.4  24.5  27.8  23.6  18.0  12.9 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> A1     21.0  4.64  0     7.05 35.4  15.9   9.21 17.2  18.7  27.1  15.9  16.5 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> A1     21.5  7.63  7.05  0    18.2  12.5   6.66 13.4  15.4  20.6   6.11  6.69</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> A1     19.0 28.4  35.4  18.2   0    28.5  19.1  15.4  22.0   7.33 17.1  17.3 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> A1     29.0 20.4  15.9  12.5  28.5   0     7.01 19.9  25.6  33.2  24.9  23.8 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> A1     20.2 12.4   9.21  6.66 19.1   7.01  0     6.99 12.1  20.0  11.0  15.2 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> A1     10.7 24.5  17.2  13.4  15.4  19.9   6.99  0     5.49 13.8  11.3  22.3 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> A1     19.1 27.8  18.7  15.4  22.0  25.6  12.1   5.49  0    14.0   6.40 16.3 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> A1     16.7 23.6  27.1  20.6   7.33 33.2  20.0  13.8  14.0   0    15.0  14.1 </span></span>
<span><span class="co"># <span style="color: #949494;"># ℹ 42 more rows</span></span></span>
<span><span class="co"># <span style="color: #949494;"># ℹ 1 more variable: H9 &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="if-i-have-the-matrices-of-means-and-covariances">If I have the matrices of means and covariances<a class="anchor" aria-label="anchor" href="#if-i-have-the-matrices-of-means-and-covariances"></a>
</h4>
<p>Lets suppose we want compute the Mahalanobis’ distance for each
pairwise genotype comparison based on cob-related traits. Note that the
function <code>select(contains("C"))</code> is used to select the
cob-relate traits, after computing the mean for each genotype.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">means</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data_ge2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/utils_stats.html">mean_by</a></span><span class="op">(</span><span class="va">GEN</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/utils_rows_cols.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"GEN"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The next step is to compute the variance-covariance matrix for the
means. The first approach combines R base functions with some functions
from <strong>metan</strong> package to compute the covariance matrix. Of
course, the simplest way is by using <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov()</a></code>.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the covariance matrix (by hand)</span></span>
<span><span class="va">cov_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">dev_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">means</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="va">comb_v</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/comb_vars.html">comb_vars</a></span><span class="op">(</span><span class="va">dev_scores</span>, FUN <span class="op">=</span> <span class="st">"*"</span><span class="op">)</span></span>
<span><span class="va">cov_mat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">cov_mat</span>, diag <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">comb_v</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cov_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cov_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span></span>
<span><span class="va">cov_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_mat.html">make_sym</a></span><span class="op">(</span><span class="va">cov_mat</span>, diag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute the covariance using cov()</span></span>
<span><span class="va">covmat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if the two matrices are equal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cov_mat</span>, <span class="va">covmat2</span><span class="op">)</span></span>
<span><span class="co"># [1] TRUE</span></span></code></pre></div>
<p>After computing the means and covariance matrices we are able to
compute the Mahalanobis distance using the function
<code><a href="../reference/mahala.html">mahala()</a></code>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mahala.html">mahala</a></span><span class="op">(</span><span class="va">means</span>, covar <span class="op">=</span> <span class="va">cov_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dendrogram</span></span>
<span><span class="va">D2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_biometry_files/figure-html/unnamed-chunk-42-1.png" width="528" style="display: block; margin: auto;"></p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="rendering">Rendering engine<a class="anchor" aria-label="anchor" href="#rendering"></a>
</h2>
<p>This vignette was built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>. All tables were produced
with the package <a href="https://rstudio.github.io/DT/" class="external-link"><code>DT</code></a> using the
following function.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span> <span class="co"># Used to make the tables</span></span>
<span><span class="co"># Function to make HTML tables</span></span>
<span><span class="va">print_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table</span>, <span class="va">rownames</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">table</span>, rownames <span class="op">=</span> <span class="va">rownames</span>, extensions <span class="op">=</span> <span class="st">'Buttons'</span>,</span>
<span>          options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scrollX <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                         dom <span class="op">=</span> <span class="st">'&lt;&lt;t&gt;Bp&gt;'</span>,</span>
<span>                         buttons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'copy'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html" class="external-link">formatSignif</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">class</span><span class="op">)</span> <span class="op">==</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>#References</p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Mantel1967" class="csl-entry">
Mantel, N. 1967. <span>“<span class="nocase">The detection of disease
clustering and a generalized regression approach.</span>”</span>
<em>Cancer Research</em> 27 (2): 209–20. <a href="http://www.ncbi.nlm.nih.gov/pubmed/6018555" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/6018555</a>.
</div>
<div id="ref-Mojena1977" class="csl-entry">
Mojena, R. 1977. <span>“<span class="nocase">Hierarchical grouping
methods and stopping rules: an evaluation</span>.”</span> <em>The
Computer Journal</em> 20 (4): 359–63. <a href="https://doi.org/10.1093/comjnl/20.4.359" class="external-link">https://doi.org/10.1093/comjnl/20.4.359</a>.
</div>
<div id="ref-Olivoto2018" class="csl-entry">
Olivoto, T., A. D. C Lúcio, V. Q. Souza, M. Nardino, M. I. Diel, B. G.
Sari, D .K. Krysczun, D. Meira, and C. Meier. 2018. <span>“<span class="nocase">Confidence interval width for Pearson’s correlation
coefficient: a Gaussian-independent estimator based on sample size and
strength of association</span>.”</span> <em>Agronomy Journal</em> 110
(1): 1–8. <a href="https://doi.org/10.2134/agronj2017.09.0566" class="external-link">https://doi.org/10.2134/agronj2017.09.0566</a>.
</div>
<div id="ref-Olivoto2017c" class="csl-entry">
Olivoto, T., Nardino M., Carvalho I. R., Follmann D. N., Ferrari M., de
Pelegrin A. J., V. J. Szareski, de Oliveira A. C., Caron B. O., and V.
Q. Souza. 2017. <span>“<span class="nocase">Optimal sample size and data
arrangement method in estimating correlation matrices with lesser
collinearity: A statistical focus in maize breeding</span>.”</span>
<em>African Journal of Agricultural Research</em> 12 (2): 93–103. <a href="https://doi.org/10.5897/AJAR2016.11799" class="external-link">https://doi.org/10.5897/AJAR2016.11799</a>.
</div>
<div id="ref-Olivoto2017f" class="csl-entry">
Olivoto, T., V. Q. Souza, M. Nardino, I. R. Carvalho, M. Ferrari, A. J.
Pelegrin, V. J. Szareski, and D. Schmidt. 2017. <span>“<span class="nocase">Multicollinearity in path analysis: a simple method to
reduce its effects</span>.”</span> <em>Agronomy Journal</em> 109 (1):
131–42. <a href="https://doi.org/10.2134/agronj2016.04.0196" class="external-link">https://doi.org/10.2134/agronj2016.04.0196</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
