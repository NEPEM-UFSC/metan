<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing multienvironment trials using GGE • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Analyzing multienvironment trials using GGE">
<meta property="og:description" content="metan">
<meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.13.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignettes_helper.html">Helper functions</a>
    </li>
    <li>
      <a href="../articles/vignettes_utilities.html">Utilities</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    </li>
    <li>
      <a href="../articles/vignettes_biometry.html">Biometry</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/vignettes_ammi.html">AMMI</a>
    </li>
    <li>
      <a href="../articles/vignettes_blup.html">BLUP</a>
    </li>
    <li>
      <a href="../articles/vignettes_gge.html">GGE</a>
    </li>
    <li>
      <a href="../articles/vignettes_stability.html">Stability</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/vignettes_indexes.html">Multivariate indexes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="../CONTRIBUTING.html">Contributing</a>
    </li>
    <li>
      <a href="../ISSUE_TEMPLATE.html">Issues</a>
    </li>
    <li>
      <a href="../SUPPORT.html">Support</a>
    </li>
    <li>
      <a href="../LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">RG</a>
</li>
<li>
  <a href="https://github.com/TiagoOlivoto">
    <span class="fas fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/tolivoto">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa-mendeley"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignettes_gge_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analyzing multienvironment trials using GGE</h1>
                        <h4 class="author">Tiago Olivoto</h4>
            
            <h4 class="date">2021-03-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/master/vignettes/vignettes_gge.Rmd"><code>vignettes/vignettes_gge.Rmd</code></a></small>
      <div class="hidden name"><code>vignettes_gge.Rmd</code></div>

    </div>

    
    
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>Genotype plus Genotype-vs-Environment interaction (GGE) model has been widely used to genotype evaluation and mega-environment identification in multi-environment trials (MET). This model considers a GGE (i.e., G + GE) biplot, which is constructed by the first two symmetrically scaled principal components (PC1 and PC2) derived from singular value decomposition of environment-centered MET data. The GGE biplot graphically displays G plus GE of a MET in a way that facilitates visual genotype evaluation and mega-environment identification <span class="citation">(<a href="#ref-Yan2007" role="doc-biblioref">W. Yan et al. 2007</a>)</span></p>
<p>In this section, we will use the data in <code>data_ge</code>. For more information, please, see <code><a href="../reference/data_ge.html">?data_ge</a></code>. Other data sets can be used provided that the following columns are in the dataset: environment, genotype, block/replicate and response variable(s).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan">metan</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="the-gge-model" class="section level1">
<h1 class="hasAnchor">
<a href="#the-gge-model" class="anchor"></a>The GGE model</h1>
<p>The mean yield of genotype <em>i</em> in environment <em>j</em> is commonly described by a general linear model</p>
<p><span class="math display">\[
\hat y_{ij} + \mu + \alpha_i + \beta_j + \phi_{ij}
\]</span> where <span class="math inline">\(\hat y_{ij}\)</span> is the mean yield of genotype <em>i</em> in environment <em>j</em>, <span class="math inline">\(i = 1, ... g; j = 1, ...e\)</span> being <em>g</em> and <em>e</em> the numbers of genotypes and environments, respectively; <span class="math inline">\(\mu\)</span> is the grand mean; <span class="math inline">\(\alpha_i\)</span> is the main effect of the genotype <em>i</em>; <span class="math inline">\(\beta_j\)</span> is the main effect of the environment <em>j</em>, and <span class="math inline">\(\phi_{ij}\)</span> is the interaction effect between genotype <em>i</em> and environment <em>j</em>. Subjecting the <span class="math inline">\(\phi_{ij}\)</span> to Singular Value Decomposition (SVD) results in the AMMI model. The deletion of <span class="math inline">\(\alpha_i\)</span> allows the variation explained by this term to be absorbed into the <span class="math inline">\(\phi_{ij}\)</span> term. In the Genotype plus Genotype-vs-Environment interaction (GGE) model the <span class="math inline">\(\alpha_i\)</span> term is is deleted from the above model and then the environment-centered data matrix, <span class="math inline">\(\phi_{ij}\)</span>, is subjected to SVD <span class="citation">(<a href="#ref-Yan2007" role="doc-biblioref">W. Yan et al. 2007</a>; <a href="#ref-Yan2003" role="doc-biblioref">Weikai. Yan and Kang 2003</a>)</span>. Explicitly, we have</p>
<p><span class="math display">\[
{\phi_{ij} =  \hat y_{ij}} - \mu - \beta_j  = \sum\limits_{k = 1}^p \xi_{ik}^*\eta_{jk}^*
\]</span></p>
<p>where <span class="math inline">\(\xi_{ik}^* = \lambda_k^\alpha\xi_{ik}\)</span>; <span class="math inline">\(\eta_{jk}^* = \lambda_k^{1-\alpha}\eta_{jk}\)</span> being <span class="math inline">\(\lambda_k\)</span> the <em>k</em>th eigenvalue from the SVD (<span class="math inline">\(k = 1, ...p\)</span>), with <span class="math inline">\(p \le min(e, g)\)</span>; <span class="math inline">\(\alpha\)</span> is the the singular value partition factor for the Principal Component (PC) <em>k</em>; <span class="math inline">\(\xi_{ik}^*\)</span> and <span class="math inline">\(\eta_{jk}^*\)</span> are the PC scores for genotype <em>i</em> and environment <em>j</em>, respectively.</p>
<p>The function <code><a href="../reference/gge.html">gge()</a></code> is used to produce a GGE model. According to <span class="citation"><a href="#ref-Yan2003" role="doc-biblioref">Weikai. Yan and Kang</a> (<a href="#ref-Yan2003" role="doc-biblioref">2003</a>)</span>, the function supports four methods of data centering, two methods of data scaling and three options for singular value partitioning:</p>
</div>
<div id="centering-methods-available" class="section level1">
<h1 class="hasAnchor">
<a href="#centering-methods-available" class="anchor"></a>Centering methods available</h1>
<ul>
<li>
<code>0</code> or <code>"none"</code> for no centering;</li>
<li>
<code>1</code> or <code>"global"</code> for global centered (E+G+GE);</li>
<li>
<code>2</code> or <code>"environment"</code> (default), for environment-centered (G+GE);</li>
<li>
<code>3</code> or <code>"double"</code> for double centred (GE). A biplot cannot be produced with models produced without centering.</li>
</ul>
</div>
<div id="scaling-methods-available" class="section level1">
<h1 class="hasAnchor">
<a href="#scaling-methods-available" class="anchor"></a>Scaling methods available</h1>
<ul>
<li>
<code>0</code> or <code>"none"</code> (default) for no scaling;</li>
<li>
<code>1</code> or <code>"sd"</code> where each value is divided by the standard deviation of its corresponding environment (column). This will put all testers roughly the same range of values.</li>
</ul>
</div>
<div id="singular-value-partitioning-methods-available" class="section level1">
<h1 class="hasAnchor">
<a href="#singular-value-partitioning-methods-available" class="anchor"></a>Singular Value Partitioning methods available</h1>
<ul>
<li>
<code>1</code> or <code>"genotype"</code> The singular value is entirely partitioned into the genotype eigenvectors, also called row metric preserving;</li>
<li>
<code>2</code> or <code>"environment"</code> (default) the singular value is entirely partitioned into the environment eigenvectors, also called column metric preserving;</li>
<li>
<code>3</code> or <code>"symmetrical"</code> The singular value is symmetrically partitioned into the genotype and the environment eigenvectors This SVP is most often used in AMMI analysis and other biplot analysis, but it is not ideal for visualizing either the relationship among entries or that among the testers.</li>
</ul>
</div>
<div id="a-numerical-example" class="section level1">
<h1 class="hasAnchor">
<a href="#a-numerical-example" class="anchor"></a>A numerical example</h1>
<div id="fitting-the-gge-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-the-gge-model" class="anchor"></a>Fitting the GGE model</h2>
<p>To fit the GGE model we will use the data in <code>data_ge</code>, which contains data for grain yield evaluated in 10 genotypes conducted in 14 environments. First of all, let’s inspect this data for possible problems.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data_ge</span><span class="op">)</span>
<span class="co"># # A tibble: 5 x 9</span>
<span class="co">#   Variable Class   Missing Levels Valid_n   Min Median   Max Outlier</span>
<span class="co">#   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co"># 1 ENV      factor  No      14         420 NA     NA    NA         NA</span>
<span class="co"># 2 GEN      factor  No      10         420 NA     NA    NA         NA</span>
<span class="co"># 3 REP      factor  No      3          420 NA     NA    NA         NA</span>
<span class="co"># 4 GY       numeric No      -          420  0.67   2.61  5.09       0</span>
<span class="co"># 5 HM       numeric No      -          420 38     48    58          0</span>
<span class="co"># No issues detected while inspecting data.</span></code></pre></div>
<p>The GGE model is fitted with the function <code><a href="../reference/gge.html">gge()</a></code>. This function produces a GGE model using a data frame containing at least the columns for genotypes, environments and the response variable(s).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span><span class="op">)</span></code></pre></div>
<p>The model above was fitted considering (i) column metric preserving (where the singular value is entirely partitioned into the environment eigenvectors); (ii) environment centered (the biplot will contain a mixed information of G + GEI); and no scaling method. To change these default settings, use the arguments <code>svp</code>, <code>centering</code>, and <code>scaling</code>, respectively. Please, note that in the second example the argument <code>table</code> was set to <code>TRUE</code> to indicate that the input data is a two-way table.</p>
</div>
<div id="visualizing-the-biplot" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-the-biplot" class="anchor"></a>Visualizing the Biplot</h2>
<p>The generic function <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> is used to generate a biplot using as input a fitted model of class <code>gge</code>. The type of biplot is chosen by the argument <code>type</code> in the function. Ten biplots type are available according to <span class="citation"><a href="#ref-Yan2003" role="doc-biblioref">Weikai. Yan and Kang</a> (<a href="#ref-Yan2003" role="doc-biblioref">2003</a>)</span>.</p>
<ul>
<li>
<code>type = 1</code> A basic biplot.</li>
<li>
<code>type =  2</code> Mean performance vs. stability.</li>
<li>
<code>type =  3</code> Which-won-where.</li>
<li>
<code>type =  4</code> Discriminativeness vs. representativeness.</li>
<li>
<code>type =  5</code> Examine an environment.</li>
<li>
<code>type =  6</code> Ranking environments.</li>
<li>
<code>type =  7</code> Examine a genotype.</li>
<li>
<code>type =  8</code> Ranking genotypes</li>
<li>
<code>type =  9</code> Compare two genotypes.</li>
<li>
<code>type =  10</code> Relationship among environments.</li>
</ul>
<p>In this material, for each biplot type, two graphics are produced. One with the default settings and the other to show some graphical options of the function.</p>
</div>
<div id="biplot-type-1-a-basic-biplot" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-1-a-basic-biplot" class="anchor"></a>Biplot type 1: A basic biplot</h2>
<p>This is the default setting in the function plot, thus, this biplot is produced by just calling <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot(model)</a></code>, as shown below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          col.gen <span class="op">=</span> <span class="st">"orange"</span>,
          size.text.env <span class="op">=</span> <span class="fl">2</span>,
          plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>grid <span class="op">=</span>  <span class="st">"both"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-2-mean-performance-vs--stability" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-2-mean-performance-vs--stability" class="anchor"></a>Biplot type 2: Mean performance vs. stability</h2>
<p>In this biplot, the visualization of the mean and stability of genotypes is achieved by drawing an average environment coordinate (AEC) on the genotype-focused biplot. First, an average environment, represented by the small circle, is defined by the mean PC1 and PC2 scores of the environments. The line that passes through the biplot origin and the AEC may be called the average. The projections of genotype markers onto this axis should, therefore, approximate the mean yield of the genotypes. Thus, the G8 was clearly the highest-yielding genotype, on average.</p>
<p>The AEC ordinate is the line that passes through the biplot origin and is perpendicular to the AEC abscissa. Therefore, if the AEC abscissa represents the G, the AEC ordinate must approximate the GEI associated with each genotype, which is a measure of variability or instability of the genotypes <span class="citation">(<a href="#ref-Yan2007" role="doc-biblioref">W. Yan et al. 2007</a>)</span>. A greater projection onto the AEC ordinate, regardless of the direction, means greater instability. In our example, G3 was found to be the most stable and the second most productive genotype, while G9 had great instability.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span>, svp <span class="op">=</span> <span class="st">"genotype"</span><span class="op">)</span>
<span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          type <span class="op">=</span> <span class="fl">2</span>,
          col.gen <span class="op">=</span> <span class="st">"black"</span>,
          col.env <span class="op">=</span> <span class="st">"red"</span>,
          axis_expand <span class="op">=</span> <span class="fl">1.5</span>,
          plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">d</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-3-which-won-where" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-3-which-won-where" class="anchor"></a>Biplot type 3: Which-won-where</h2>
<p>In this biplot a polygon is drawn joining the genotypes (G7, G8, G9, G10, and G4) that are located farthest from the biplot origin so that all other genotypes are contained in the polygon. The vertex genotypes have the longest vectors, in their respective directions, which is a measure of responsiveness to environments. The vertex genotypes are, therefore, among the most responsive genotypes; all other genotypes are less responsive in their respective directions. A genotype located at the origin would rank the same in all environments and is not at all responsive to the environments.</p>
<p>The perpendicular lines to the sides of the polygon divide the biplot into sectors. Each sector has a vertex genotype. For example, the sector with the vertex genotype G4 may be referred to as the G4 sector; and one environment (E9), fell in this sector. As a rule, the vertex genotype is the highest-yielding genotype in all environments that share the sector with it <span class="citation">(<a href="#ref-Yan2007" role="doc-biblioref">W. Yan et al. 2007</a>)</span>. In this case, G4 was the highest-yielding in E9, as shown in the two-way table above.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span>, svp <span class="op">=</span> <span class="st">"symmetrical"</span><span class="op">)</span>
<span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          type <span class="op">=</span> <span class="fl">3</span>,
          size.shape.win <span class="op">=</span> <span class="fl">5</span>,
          large_label <span class="op">=</span> <span class="fl">6</span>,
          col.gen <span class="op">=</span> <span class="st">"black"</span>,
          col.env <span class="op">=</span> <span class="st">"gray"</span>,
          title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">e</span>, <span class="va">f</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-4-discriminativeness-vs--representativeness" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-4-discriminativeness-vs--representativeness" class="anchor"></a>Biplot type 4: Discriminativeness vs. representativeness</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          type <span class="op">=</span> <span class="fl">4</span>,
          plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">h</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="st">"h"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-5-examine-an-environment" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-5-examine-an-environment" class="anchor"></a>Biplot type 5: Examine an environment</h2>
<p>Identifying genotypes most adapted to an environment can be easily achieved via a GGE biplot. For example, to visualize the performance of different genotypes in a given environment, e.g., E10, simply draw a line that passes through the biplot origin and the marker of E10. The genotypes can be ranked according to their projections onto the E10 axis based on their performance in E10, in the direction pointed by the arrow. In our example, at E10, the highest-yielding genotype G8, and the lowest-yielding genotype was G10, and the order of the genotypes were G8 &gt; G7 &gt; G3 &gt; G2 &gt; G4 &gt; G1 &gt; G6 &gt; G5 &gt; G9 &gt; G10.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span>, svp <span class="op">=</span> <span class="st">"symmetrical"</span><span class="op">)</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">5</span>, sel_env <span class="op">=</span> <span class="st">"E10"</span><span class="op">)</span>
<span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          type <span class="op">=</span> <span class="fl">5</span>,
          sel_env <span class="op">=</span> <span class="st">"E10"</span>,
          col.gen <span class="op">=</span> <span class="st">"black"</span>,
          col.env <span class="op">=</span> <span class="st">"black"</span>,
          size.text.env <span class="op">=</span> <span class="fl">10</span>,
          axis_expand <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="st">"j"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-6-ranking-environments" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-6-ranking-environments" class="anchor"></a>Biplot type 6: Ranking environments</h2>
<p>In this biplot the “ideal” environment is used as the center of a set of concentric lines that serve as a ruler to measure the distance between an environment and the ideal environment. since the main focus in this biplot is environments, then, the singular value partition used is “environment” (default). It can be seen that E13 is the closest to the ideal environment, and, therefore, is most desirable of all 14 environments. E4 and E9 were the least desirable test environments.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">gge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span><span class="op">)</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
<span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          type <span class="op">=</span> <span class="fl">6</span>,
          col.gen <span class="op">=</span> <span class="st">"black"</span>,
          col.env <span class="op">=</span> <span class="st">"black"</span>,
          col.circle <span class="op">=</span> <span class="st">"red"</span>,
          col.alpha.circle <span class="op">=</span> <span class="fl">0.5</span>,
          size.text.env <span class="op">=</span> <span class="fl">10</span>,
          axis_expand <span class="op">=</span> <span class="fl">1.5</span>,
          plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>color.background <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">l</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="st">"l"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-7-examine-a-genotype" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-7-examine-a-genotype" class="anchor"></a>Biplot type 7: Examine a genotype</h2>
<p>Analogous to visualizing genotype performances in a given environment (biplot 5) visualization of the mean and stability of genotypes is achieved by drawing an average environment coordinate (AEC) on the genotype-focused biplot <span class="citation">(<a href="#ref-Yan2007" role="doc-biblioref">W. Yan et al. 2007</a>)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span>, svp <span class="op">=</span> <span class="st">"genotype"</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">7</span>, sel_gen <span class="op">=</span> <span class="st">"G8"</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          type <span class="op">=</span> <span class="fl">7</span>,
          sel_gen <span class="op">=</span> <span class="st">"G8"</span>,
          col.gen <span class="op">=</span> <span class="st">"black"</span>,
          col.env <span class="op">=</span> <span class="st">"black"</span>,
          size.text.env <span class="op">=</span> <span class="fl">10</span>,
          axis_expand <span class="op">=</span> <span class="fl">1.5</span>,
          plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">n</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"n"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-8-ranking-genotypes" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-8-ranking-genotypes" class="anchor"></a>Biplot type 8: Ranking genotypes</h2>
<p>This biplot compares all genotypes with the “ideal” genotype The ideal genotype, represented by the small circle with an arrow pointing to it, is defined as having the highest yield in all environments. That is, it has the highest mean yield and is absolutely stable. The genotypes are ranked based on their distance from the ideal genotype <span class="citation">(<a href="#ref-Yan2007" role="doc-biblioref">W. Yan et al. 2007</a>)</span>. In our example, G3 and G8 were found to outperform the other genotypes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          type <span class="op">=</span> <span class="fl">8</span>,
          col.gen <span class="op">=</span> <span class="st">"black"</span>,
          col.env <span class="op">=</span> <span class="st">"gray"</span>,
          size.text.gen <span class="op">=</span> <span class="fl">6</span>,
          plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">o</span>, <span class="va">p</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"p"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-9-compare-two-genotypes" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-9-compare-two-genotypes" class="anchor"></a>Biplot type 9: Compare two genotypes</h2>
<p>To compare two genotypes, for example, G10 and G8, draw a connector line to connect them and draw a perpendicular line that passes through the biplot origin and is perpendicular to the connector line. We see one environment, E9, is on the same side of the perpendicular line as G10, and the other 13 environments are on the other side of the perpendicular line, together with G8. This indicates that G10 yielded more than G8 in E9, but G8. yielded more than G10 in the other 13 environments <span class="citation">(<a href="#ref-Yan2007" role="doc-biblioref">W. Yan et al. 2007</a>)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span>, svp <span class="op">=</span> <span class="st">"symmetrical"</span><span class="op">)</span>
<span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">9</span>, sel_gen1 <span class="op">=</span> <span class="st">"G8"</span>, sel_gen2 <span class="op">=</span> <span class="st">"G10"</span><span class="op">)</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          type <span class="op">=</span> <span class="fl">9</span>,
          sel_gen1 <span class="op">=</span> <span class="st">"G8"</span>,
          sel_gen2 <span class="op">=</span> <span class="st">"G10"</span>,
          col.gen <span class="op">=</span> <span class="st">"black"</span>,
          title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">r</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="st">"r"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-10-relationship-among-environments" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot-type-10-relationship-among-environments" class="anchor"></a>Biplot type 10: Relationship among environments</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span><span class="op">)</span>
<span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gge_model</span>,
          type <span class="op">=</span> <span class="fl">10</span>,
          col.gen <span class="op">=</span> <span class="st">"black"</span>,
          title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">t</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"t"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_gge_files/figure-html/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Yan2007" class="csl-entry">
Yan, W., M. S. Kang, B. Ma, S. Woods, and P. L. Cornelius. 2007. <span>“<span class="nocase">GGE Biplot vs. AMMI Analysis of Genotype-by-Environment Data</span>.”</span> <em>Crop Science</em> 47 (2): 641–53. <a href="https://doi.org/10.2135/cropsci2006.06.0374">https://doi.org/10.2135/cropsci2006.06.0374</a>.
</div>
<div id="ref-Yan2003" class="csl-entry">
Yan, Weikai., and Manjit S. Kang. 2003. <em><span class="nocase">GGE biplot analysis : a graphical tool for breeders, geneticists, and agronomists</span></em>. CRC Press.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ef40e3bab94bb0e1d687fd3844052701',
    indexName: 'metan',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
