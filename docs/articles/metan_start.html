<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metan">
<title>Multi-environment Trial Analysis • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-environment Trial Analysis">
<meta property="og:description" content="metan">
<meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a>
    <a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    <a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    <a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a>
    <a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a>
    <a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a>
    <a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="../SUPPORT.html">Support</a>
    <a class="dropdown-item" href="../LICENSE.html">Licence</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multi-environment Trial Analysis</h1>
                        <h4 data-toc-skip class="author">Tiago
Olivoto</h4>
            
            <h4 data-toc-skip class="date">2022-06-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/HEAD/vignettes/metan_start.Rmd" class="external-link"><code>vignettes/metan_start.Rmd</code></a></small>
      <div class="d-none name"><code>metan_start.Rmd</code></div>
    </div>

    
    
<p><code>metan</code> provides tools for computing several world-known
stability statistics. The following stability methods are
implemented.</p>
<ul>
<li>Parametric methods
<ul>
<li>AMMI analysis with <a href="https://tiagoolivoto.github.io/metan/reference/performs_ammi.html"><code>performs_ammi()</code></a>.</li>
<li>AMMI-based stability statistics with <a href="https://tiagoolivoto.github.io/metan/reference/ammi_indexes.html"><code>ammi_indexes()</code></a>.</li>
<li>BLUP prediction for multi-environment trials with <a href="https://tiagoolivoto.github.io/metan/reference/waasb.html"><code>waasb()</code></a>.</li>
<li>BLUP-based stability indexes with <a href="https://tiagoolivoto.github.io/metan/reference/blup_indexes.html"><code>blup_indexes()</code></a>.</li>
<li>Ecovalence <span class="citation">(<a href="#ref-Wricke1965" role="doc-biblioref">Wricke 1965</a>)</span> using <a href="https://tiagoolivoto.github.io/metan/reference/ecovalence.html"><code>ecovalence()</code></a>.</li>
<li>GGE biplot analysis with <a href="https://tiagoolivoto.github.io/metan/reference/gge.html"><code>gge()</code></a>.</li>
<li>Genotypic confidence index <span class="citation">(<a href="#ref-Annicchiarico1992" role="doc-biblioref">Annicchiarico
1992</a>)</span> using <a href="https://tiagoolivoto.github.io/metan/reference/Annicchiarico.html"><code>Annicchiarico()</code></a>.</li>
<li>Geometric adaptability index <span class="citation">(<a href="#ref-Mohammadi2008" role="doc-biblioref">Mohammadi and Amri
2008</a>)</span> with <a href="https://tiagoolivoto.github.io/metan/reference/gai.html"><code>gai()</code></a>.</li>
<li>Joint regression analysis <span class="citation">(<a href="#ref-Eberhart1966" role="doc-biblioref">Eberhart and Russell
1966</a>)</span> using <a href="https://tiagoolivoto.github.io/metan/reference/ge_reg.html"><code>ge_reg()</code></a>.</li>
<li>Modified genotypic confidence index <span class="citation">(<a href="#ref-Schmildt2011" role="doc-biblioref">Schmildt et al.
2011</a>)</span> using <a href="https://tiagoolivoto.github.io/metan/reference/Schmildt.html"><code>Schmildt()</code></a>.</li>
<li>Power law residuals (POLAR) statistics <span class="citation">(<a href="#ref-Doring2015" role="doc-biblioref">Döring, Knapp, and Cohen
2015</a>)</span> using <code><a href="../reference/ge_polar.html">ge_polar()</a></code>.</li>
<li>Stability analysis and environmental stratification <span class="citation">(<a href="#ref-murakami2004" role="doc-biblioref">Murakami and Cruz 2004</a>)</span> using <a href="https://tiagoolivoto.github.io/metan/reference/ge_factanal.html"><code>ge_factanal()</code></a>.</li>
<li>Shukla’s stability variance <span class="citation">(<a href="#ref-Shukla1972" role="doc-biblioref">Shukla 1972</a>)</span>
using <a href="https://tiagoolivoto.github.io/metan/reference/Shukla.html"><code>Shukla()</code></a>.</li>
<li>Scale-adjusted coefficient of variation <span class="citation">(<a href="#ref-Doring2018" role="doc-biblioref">Döring and Reckling
2018</a>)</span> using <code><a href="../reference/ge_acv.html">ge_acv()</a></code>.</li>
<li>Weighted Average of Absolute Scores <span class="citation">(<a href="#ref-Olivoto2019" role="doc-biblioref">Olivoto, Lúcio, Da silva,
Marchioro, et al. 2019</a>)</span> using <a href="https://tiagoolivoto.github.io/metan/reference/waas.html"><code>waas()</code></a>
(fixed-effect model) and <a href="https://tiagoolivoto.github.io/metan/reference/waasb.html"><code>waasb()</code></a>
(mixed-effect model).</li>
</ul>
</li>
<li>Non-parametric methods
<ul>
<li>Superiority index <span class="citation">(<a href="#ref-Lin1988" role="doc-biblioref">Lin and Binns 1988</a>)</span>, using the function
<a href="https://tiagoolivoto.github.io/metan/reference/superiority.html"><code>superiority()</code></a>.</li>
<li>Fox’s stability statistic <span class="citation">(<a href="#ref-Fox1990" role="doc-biblioref">Fox et al. 1990</a>)</span>
with <a href="https://tiagoolivoto.github.io/metan/reference/Fox.html"><code>Fox()</code></a>.</li>
<li>Huehn’s stability statistic <span class="citation">(<a href="#ref-Huehn1979" role="doc-biblioref">Huehn 1979</a>)</span> with
<a href="https://tiagoolivoto.github.io/metan/reference/Huehn.html"><code>Huehn()</code></a>.</li>
<li>Thennarasu’s stability statistics <span class="citation">(<a href="#ref-Thennarasu1995" role="doc-biblioref">Thennarasu
1995</a>)</span> with <a href="https://tiagoolivoto.github.io/metan/reference/Thennarasu.html"><code>Thennarasu()</code></a>.</li>
</ul>
</li>
</ul>
<p>The easiest way to compute the above-mentioned stability indexes is
by using the function <a href="https://tiagoolivoto.github.io/metan/reference/ge_stats.html"><code>ge_stats()</code></a>.
This is a wrapper that basically returns a summary of each method. If
you are looking for more details from each method like
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> and <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>, I’d suggest computing the
methods using their own function.</p>
<p>The complete functionality of the package is described at <a href="https://tiagoolivoto.github.io/metan/index.html" class="uri">https://tiagoolivoto.github.io/metan/index.html</a>. You’re
welcome to check it out!</p>
<div class="section level2">
<h2 id="brief-examples">Brief examples<a class="anchor" aria-label="anchor" href="#brief-examples"></a>
</h2>
<p>Brief examples will be shown using the dataset <a href="https://tiagoolivoto.github.io/metan/reference/data_ge.html"><code>data_ge</code></a>
that contains data on two variables assessed in 10 genotypes growing in
14 environments.</p>
</div>
<div class="section level2">
<h2 id="checking-data">Checking data<a class="anchor" aria-label="anchor" href="#checking-data"></a>
</h2>
<p>First of all, we will check the data for possible problems with the
function <a href="https://tiagoolivoto.github.io/metan/reference/inspect.html"><code>inspect()</code></a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data_ge</span><span class="op">)</span>
<span class="co"># <span style="color: #949494;"># A tibble: 5 × 10</span></span>
<span class="co">#   Variable Class   Missing Levels Valid_n   Min Median   Max Outlier Text </span>
<span class="co">#   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span>
<span class="co"># <span style="color: #BCBCBC;">1</span> ENV      factor  No      14         420 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>   </span>
<span class="co"># <span style="color: #BCBCBC;">2</span> GEN      factor  No      10         420 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>   </span>
<span class="co"># <span style="color: #BCBCBC;">3</span> REP      factor  No      3          420 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>   </span>
<span class="co"># <span style="color: #BCBCBC;">4</span> GY       numeric No      -          420  0.67   2.61  5.09       0 <span style="color: #BB0000;">NA</span>   </span>
<span class="co"># <span style="color: #BCBCBC;">5</span> HM       numeric No      -          420 38     48    58          0 <span style="color: #BB0000;">NA</span></span></code></pre></div>
<p>Then, the details of the multi-environment trial can be obtained with
the function <a href="https://tiagoolivoto.github.io/metan/reference/ge_details.html"><code>ge_details()</code></a>.
Note that to apply the function to all numeric variables quickly, we can
use the <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_helper.html#select-helpers">select
helper</a> <code><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything()</a></code> in the argument
<code>resp</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ge_details.html">ge_details</a></span><span class="op">(</span><span class="va">data_ge</span>,
           env <span class="op">=</span> <span class="va">ENV</span>,
           gen <span class="op">=</span> <span class="va">GEN</span>,
           resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="co">#    Parameters GY                  HM              </span>
<span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span>
<span class="co"># <span style="color: #BCBCBC;"> 1</span> Mean       <span style="color: #949494;">"</span>2.67<span style="color: #949494;">"</span>              <span style="color: #949494;">"</span>48.09<span style="color: #949494;">"</span>         </span>
<span class="co"># <span style="color: #BCBCBC;"> 2</span> SE         <span style="color: #949494;">"</span>0.05<span style="color: #949494;">"</span>              <span style="color: #949494;">"</span>0.21<span style="color: #949494;">"</span>          </span>
<span class="co"># <span style="color: #BCBCBC;"> 3</span> SD         <span style="color: #949494;">"</span>0.92<span style="color: #949494;">"</span>              <span style="color: #949494;">"</span>4.37<span style="color: #949494;">"</span>          </span>
<span class="co"># <span style="color: #BCBCBC;"> 4</span> CV         <span style="color: #949494;">"</span>34.56<span style="color: #949494;">"</span>             <span style="color: #949494;">"</span>9.09<span style="color: #949494;">"</span>          </span>
<span class="co"># <span style="color: #BCBCBC;"> 5</span> Min        <span style="color: #949494;">"</span>0.67 (G10 in E11)<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>38 (G2 in E14)<span style="color: #949494;">"</span></span>
<span class="co"># <span style="color: #BCBCBC;"> 6</span> Max        <span style="color: #949494;">"</span>5.09 (G8 in E5)<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>58 (G8 in E11)<span style="color: #949494;">"</span></span>
<span class="co"># <span style="color: #BCBCBC;"> 7</span> MinENV     <span style="color: #949494;">"</span>E11 (1.37)<span style="color: #949494;">"</span>        <span style="color: #949494;">"</span>E14 (41.03)<span style="color: #949494;">"</span>   </span>
<span class="co"># <span style="color: #BCBCBC;"> 8</span> MaxENV     <span style="color: #949494;">"</span>E3 (4.06)<span style="color: #949494;">"</span>         <span style="color: #949494;">"</span>E11 (54.2)<span style="color: #949494;">"</span>    </span>
<span class="co"># <span style="color: #BCBCBC;"> 9</span> MinGEN     <span style="color: #949494;">"</span>G10 (2.47) <span style="color: #949494;">"</span>       <span style="color: #949494;">"</span>G2 (46.66) <span style="color: #949494;">"</span>   </span>
<span class="co"># <span style="color: #BCBCBC;">10</span> MaxGEN     <span style="color: #949494;">"</span>G8 (3) <span style="color: #949494;">"</span>           <span style="color: #949494;">"</span>G5 (49.3) <span style="color: #949494;">"</span></span></code></pre></div>
<p>We can create a plot to show the performance of the genotypes across
the environments with <a href="https://tiagoolivoto.github.io/metan/reference/ge_plot.html"><code>ge_plot()</code></a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ge_plot.html">ge_plot</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">GEN</span>, <span class="va">ENV</span>, <span class="va">GY</span><span class="op">)</span></code></pre></div>
<p><img src="metan_start_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<p>Or obtain the means for genotypes, environments or
genotype-environment interaction with <a href="https://tiagoolivoto.github.io/metan/reference/ge_means.html"><code>ge_means()</code></a>.
Note that the function <a href="https://tiagoolivoto.github.io/metan/reference/utils_num_str.html"><code>round_cols()</code></a>
provided by <code>metan</code> round all numeric columns of a data frame
to two (default) significant figures.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ge_means.html">ge_means</a></span><span class="op">(</span><span class="va">data_ge</span>,
                env <span class="op">=</span> <span class="va">ENV</span>,
                gen <span class="op">=</span> <span class="va">GEN</span>,
                resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Genotype-environment means</span>
<span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">mge</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/utils_num_str.html">round_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Class of the model: ge_means</span>
<span class="co"># Variable extracted: ge_means</span>
<span class="co"># <span style="color: #949494;"># A tibble: 140 × 4</span></span>
<span class="co">#    ENV   GEN      GY    HM</span>
<span class="co">#    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co"># <span style="color: #BCBCBC;"> 1</span> E1    G1     2.37  46.5</span>
<span class="co"># <span style="color: #BCBCBC;"> 2</span> E1    G10    1.97  46.9</span>
<span class="co"># <span style="color: #BCBCBC;"> 3</span> E1    G2     2.9   45.3</span>
<span class="co"># <span style="color: #BCBCBC;"> 4</span> E1    G3     2.89  45.9</span>
<span class="co"># <span style="color: #BCBCBC;"> 5</span> E1    G4     2.59  48.3</span>
<span class="co"># <span style="color: #BCBCBC;"> 6</span> E1    G5     2.19  49.9</span>
<span class="co"># <span style="color: #BCBCBC;"> 7</span> E1    G6     2.3   48.2</span>
<span class="co"># <span style="color: #BCBCBC;"> 8</span> E1    G7     2.77  47.4</span>
<span class="co"># <span style="color: #BCBCBC;"> 9</span> E1    G8     2.9   48.0</span>
<span class="co"># <span style="color: #BCBCBC;">10</span> E1    G9     2.33  47.7</span>
<span class="co"># <span style="color: #949494;"># … with 130 more rows</span></span>
<span class="co"># Environment means</span>
<span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">mge</span>, what <span class="op">=</span> <span class="st">"env_means"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/utils_num_str.html">round_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Class of the model: ge_means</span>
<span class="co"># Variable extracted: env_means</span>
<span class="co"># <span style="color: #949494;"># A tibble: 14 × 3</span></span>
<span class="co">#    ENV      GY    HM</span>
<span class="co">#    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co"># <span style="color: #BCBCBC;"> 1</span> E1     2.52  47.4</span>
<span class="co"># <span style="color: #BCBCBC;"> 2</span> E10    2.18  44.3</span>
<span class="co"># <span style="color: #BCBCBC;"> 3</span> E11    1.37  54.2</span>
<span class="co"># <span style="color: #BCBCBC;"> 4</span> E12    1.61  49.6</span>
<span class="co"># <span style="color: #BCBCBC;"> 5</span> E13    2.91  46.6</span>
<span class="co"># <span style="color: #BCBCBC;"> 6</span> E14    1.78  41.0</span>
<span class="co"># <span style="color: #BCBCBC;"> 7</span> E2     3.18  44.1</span>
<span class="co"># <span style="color: #BCBCBC;"> 8</span> E3     4.06  52.9</span>
<span class="co"># <span style="color: #BCBCBC;"> 9</span> E4     3.68  50  </span>
<span class="co"># <span style="color: #BCBCBC;">10</span> E5     3.91  52.2</span>
<span class="co"># <span style="color: #BCBCBC;">11</span> E6     2.66  45.9</span>
<span class="co"># <span style="color: #BCBCBC;">12</span> E7     1.99  48.5</span>
<span class="co"># <span style="color: #BCBCBC;">13</span> E8     2.54  45.2</span>
<span class="co"># <span style="color: #BCBCBC;">14</span> E9     3.06  51.3</span>
<span class="co"># Genotype means</span>
<span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">mge</span>, what <span class="op">=</span> <span class="st">"gen_means"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/utils_num_str.html">round_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Class of the model: ge_means</span>
<span class="co"># Variable extracted: gen_means</span>
<span class="co"># <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="co">#    GEN      GY    HM</span>
<span class="co">#    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co"># <span style="color: #BCBCBC;"> 1</span> G1     2.6   47.1</span>
<span class="co"># <span style="color: #BCBCBC;"> 2</span> G10    2.47  48.5</span>
<span class="co"># <span style="color: #BCBCBC;"> 3</span> G2     2.74  46.7</span>
<span class="co"># <span style="color: #BCBCBC;"> 4</span> G3     2.96  47.6</span>
<span class="co"># <span style="color: #BCBCBC;"> 5</span> G4     2.64  48.0</span>
<span class="co"># <span style="color: #BCBCBC;"> 6</span> G5     2.54  49.3</span>
<span class="co"># <span style="color: #BCBCBC;"> 7</span> G6     2.53  48.7</span>
<span class="co"># <span style="color: #BCBCBC;"> 8</span> G7     2.74  48.0</span>
<span class="co"># <span style="color: #BCBCBC;"> 9</span> G8     3     49.1</span>
<span class="co"># <span style="color: #BCBCBC;">10</span> G9     2.51  47.9</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ammi-model">AMMI model<a class="anchor" aria-label="anchor" href="#ammi-model"></a>
</h2>
<div class="section level3">
<h3 id="fitting-the-model">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h3>
<p>The AMMI model may be fitted with with both functions <a href="https://tiagoolivoto.github.io/metan/reference/performs_ammi.html"><code>performs_ammi()</code></a>
and <a href="https://tiagoolivoto.github.io/metan/reference/waas.html"><code>waas()</code></a>,
which is the acronym for the weighted average of absolute scores <span class="citation">(<a href="#ref-Olivoto2019" role="doc-biblioref">Olivoto, Lúcio, Da silva, Marchioro, et al.
2019</a>)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ammi_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">GY</span>, <span class="va">HM</span><span class="op">)</span><span class="op">)</span>
<span class="co"># variable GY </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># AMMI analysis table</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="co">#        ENV  13 279.574 21.5057   62.33 0.00e+00         NA          NA</span>
<span class="co">#   REP(ENV)  28   9.662  0.3451    3.57 3.59e-08         NA          NA</span>
<span class="co">#        GEN   9  12.995  1.4439   14.93 2.19e-19         NA          NA</span>
<span class="co">#    GEN:ENV 117  31.220  0.2668    2.76 1.01e-11         NA          NA</span>
<span class="co">#        PC1  21  10.749  0.5119    5.29 0.00e+00       34.4        34.4</span>
<span class="co">#        PC2  19   9.924  0.5223    5.40 0.00e+00       31.8        66.2</span>
<span class="co">#        PC3  17   4.039  0.2376    2.46 1.40e-03       12.9        79.2</span>
<span class="co">#        PC4  15   3.074  0.2049    2.12 9.60e-03        9.8        89.0</span>
<span class="co">#        PC5  13   1.446  0.1113    1.15 3.18e-01        4.6        93.6</span>
<span class="co">#        PC6  11   0.932  0.0848    0.88 5.61e-01        3.0        96.6</span>
<span class="co">#        PC7   9   0.567  0.0630    0.65 7.53e-01        1.8        98.4</span>
<span class="co">#        PC8   7   0.362  0.0518    0.54 8.04e-01        1.2        99.6</span>
<span class="co">#        PC9   5   0.126  0.0252    0.26 9.34e-01        0.4       100.0</span>
<span class="co">#  Residuals 252  24.367  0.0967      NA       NA         NA          NA</span>
<span class="co">#      Total 536 389.036  0.7258      NA       NA         NA          NA</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># variable HM </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># AMMI analysis table</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="co">#        ENV  13 5710.32 439.255   57.22 1.11e-16         NA          NA</span>
<span class="co">#   REP(ENV)  28  214.93   7.676    2.70 2.20e-05         NA          NA</span>
<span class="co">#        GEN   9  269.81  29.979   10.56 7.41e-14         NA          NA</span>
<span class="co">#    GEN:ENV 117 1100.73   9.408    3.31 1.06e-15         NA          NA</span>
<span class="co">#        PC1  21  381.13  18.149    6.39 0.00e+00       34.6        34.6</span>
<span class="co">#        PC2  19  319.43  16.812    5.92 0.00e+00       29.0        63.6</span>
<span class="co">#        PC3  17  114.26   6.721    2.37 2.10e-03       10.4        74.0</span>
<span class="co">#        PC4  15   81.96   5.464    1.92 2.18e-02        7.4        81.5</span>
<span class="co">#        PC5  13   68.11   5.240    1.84 3.77e-02        6.2        87.7</span>
<span class="co">#        PC6  11   59.07   5.370    1.89 4.10e-02        5.4        93.0</span>
<span class="co">#        PC7   9   46.69   5.188    1.83 6.33e-02        4.2        97.3</span>
<span class="co">#        PC8   7   26.65   3.808    1.34 2.32e-01        2.4        99.7</span>
<span class="co">#        PC9   5    3.41   0.682    0.24 9.45e-01        0.3       100.0</span>
<span class="co">#  Residuals 252  715.69   2.840      NA       NA         NA          NA</span>
<span class="co">#      Total 536 9112.21  17.000      NA       NA         NA          NA</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="co"># Done!</span>
<span class="va">waas_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/waas.html">waas</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cross-validation-procedures">Cross-validation procedures<a class="anchor" aria-label="anchor" href="#cross-validation-procedures"></a>
</h3>
<p>The cross-validation procedures implemented in the <code>metan</code>
are based on the splitting of the original data into a training set and
a validation set. The model is fitted using the training set and the
predicted value is compared with the validation set. This process is
iterated many times, say, 1000 times. The lesser the difference between
predicted and validation data, the higher the predictive accuracy of the
model. More information may be found <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_cross-validation.html">here.</a></p>
</div>
<div class="section level3">
<h3 id="biplots">Biplots<a class="anchor" aria-label="anchor" href="#biplots"></a>
</h3>
<p>The well-known AMMI2 biplot may be obtained using the function <a href="https://tiagoolivoto.github.io/metan/reference/plot_scores.html"><code>plot_scores()</code></a>.
ggplot2-based graphics are obtained. Please, note that since <a href="https://tiagoolivoto.github.io/metan/reference/performs_ammi.html"><code>performs_ammi()</code></a>
and , <a href="https://tiagoolivoto.github.io/metan/reference/waas.html"><code>waas()</code></a>
functions allow analyzing multiple variables at the same time, e.g.,
<code>resp = c(v1, v2, ...)</code>, the output <code>ammi_model</code>
is a list that in this case has two elements, (GY and HM). To produce an
AMMI2 biplot with IPCA1 and IPCA3, for example, we use the argument
<code>second</code> to change the default value of the y axis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">ammi_model</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">ammi_model</span>,
                 type <span class="op">=</span> <span class="fl">2</span>,
                 second <span class="op">=</span> <span class="st">"PC3"</span><span class="op">)</span>
<span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">ammi_model</span>,
                 type <span class="op">=</span> <span class="fl">2</span>,
                 polygon <span class="op">=</span> <span class="cn">TRUE</span>,
                 col.gen <span class="op">=</span> <span class="st">"black"</span>,
                 col.env <span class="op">=</span> <span class="st">"gray70"</span>,
                 col.segm.env <span class="op">=</span> <span class="st">"gray70"</span>,
                 axis.expand <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, tag_levels <span class="op">=</span> <span class="st">"a"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="metan_start_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="predict-the-response-variable">Predict the response variable<a class="anchor" aria-label="anchor" href="#predict-the-response-variable"></a>
</h3>
<p>The S3 method <a href="https://tiagoolivoto.github.io/metan/reference/predict.performs_ammi.html"><code>predict()</code></a>
is implemented for objects of class <code>performs_ammi</code> and may
be used to estimate the response of each genotype in each environment
considering different number of Interaction Principal Component Axis
(IPCA). As a example, to predict the variables GY and HM we will use
four and six IPCA (number of significant IPCAs, respectively). In
addition, we will create a two way table with <a href="https://tiagoolivoto.github.io/metan/reference/make_mat.html"><code>make_mat()</code></a>
to show the predicted values for the variable GY.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ammi_model</span>, naxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="va">predicted</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
   <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">TRAIT</span> <span class="op">==</span> <span class="st">"GY"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
   <span class="fu"><a href="../reference/make_mat.html">make_mat</a></span><span class="op">(</span><span class="va">GEN</span>, <span class="va">ENV</span>, <span class="va">YpredAMMI</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/utils_num_str.html">round_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#       E1  E10  E11  E12  E13  E14   E2   E3   E4   E5   E6   E7   E8   E9</span>
<span class="co"># G1  2.52 2.15 1.30 1.60 3.05 1.62 3.01 4.06 3.53 4.02 2.63 1.87 2.39 2.71</span>
<span class="co"># G10 1.96 1.52 0.89 1.04 1.83 1.90 3.13 4.16 4.21 3.34 2.54 2.18 2.75 3.15</span>
<span class="co"># G2  2.88 2.28 1.48 1.93 3.02 1.48 3.23 4.62 3.62 3.84 2.69 1.90 2.05 3.39</span>
<span class="co"># G3  2.76 2.46 1.71 1.84 3.28 2.07 3.62 4.22 4.05 4.21 2.94 2.09 2.88 3.24</span>
<span class="co"># G4  2.54 2.24 1.41 1.66 2.70 1.78 3.16 3.88 3.38 3.61 2.51 2.06 2.40 3.65</span>
<span class="co"># G5  2.31 2.09 1.32 1.44 2.64 1.77 3.21 3.62 3.47 3.55 2.44 1.83 2.49 3.34</span>
<span class="co"># G6  2.30 2.17 1.40 1.43 2.88 1.77 3.26 3.40 3.41 3.68 2.43 1.67 2.56 3.12</span>
<span class="co"># G7  2.75 2.48 1.36 1.88 3.12 1.88 2.63 4.05 3.05 4.20 2.70 2.57 2.50 3.19</span>
<span class="co"># G8  2.84 2.57 1.72 1.92 3.62 2.10 3.43 4.26 3.97 4.59 3.06 2.19 2.97 2.79</span>
<span class="co"># G9  2.34 1.79 1.10 1.34 2.96 1.43 3.11 4.38 4.06 4.07 2.69 1.53 2.37 1.99</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="blup-model">BLUP model<a class="anchor" aria-label="anchor" href="#blup-model"></a>
</h2>
<p>The implementation of linear-mixed effect models to predict the
response variable in MET is made with the function <a href="https://tiagoolivoto.github.io/metan/reference/gamem_met.html"><code>gamem_met()</code></a>.
By default, genotype and genotype-vs-environment interaction are assumed
to have random effects. Use the argument <code>random</code> to change
this default. In the following example the model is fitted to all
numeric variables in <a href="https://tiagoolivoto.github.io/metan/reference/data_ge.html"><code>data_ge</code></a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">gamem_met</span>(data_ge, ENV, GEN, REP, <span class="fu">everything</span>())</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluating trait GY |======================                      | 50% 00:00:00 </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>Evaluating trait HM <span class="sc">|</span><span class="er">============================================|</span> <span class="dv">100</span>% <span class="dv">00</span><span class="sc">:</span><span class="dv">00</span><span class="sc">:</span><span class="dv">01</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Method: REML/BLUP</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effects: GEN, GEN:ENV</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed effects: ENV, REP(ENV)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Denominador DF: Satterthwaite's method</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------------------------------------------------------</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------------------------------------------------------</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     model       GY       HM</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  COMPLETE       NA       NA</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#       GEN 1.11e-05 5.07e-03</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   GEN:ENV 2.15e-11 2.27e-15</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------------------------------------------------------</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></span></code></pre></div>
<div class="section level3">
<h3 id="residual-plots">Residual plots<a class="anchor" aria-label="anchor" href="#residual-plots"></a>
</h3>
<p>Several residual plots may be obtained using the S3 generic function
<a href="https://tiagoolivoto.github.io/metan/reference/plot.waasb.html"><code>plot()</code></a>..</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model2</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="metan_start_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="distribution-of-random-effects">Distribution of random effects<a class="anchor" aria-label="anchor" href="#distribution-of-random-effects"></a>
</h3>
<p>The distribution of the random effects may be obtained using the
argument <code>type = "re"</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model2</span>, type <span class="op">=</span> <span class="st">"re"</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="metan_start_files/figure-html/unnamed-chunk-10-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="genetic-parameters-and-variance-components">Genetic parameters and variance components<a class="anchor" aria-label="anchor" href="#genetic-parameters-and-variance-components"></a>
</h3>
<p>We can get easily the model results such as the Likelihood Ration
Test for random effects, the variance components, and the BLUPs for
genotypes with <a href="https://tiagoolivoto.github.io/metan/reference/get_model_data.html"><code>get_model_data()</code></a>.
By default, the function returns the genetic parameters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/utils_num_str.html">round_cols</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co"># Class of the model: waasb</span>
<span class="co"># Variable extracted: genpar</span>
<span class="co"># <span style="color: #949494;"># A tibble: 9 × 3</span></span>
<span class="co">#   Parameters              GY    HM</span>
<span class="co">#   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co"># <span style="color: #BCBCBC;">1</span> Phenotypic variance  0.181 5.52 </span>
<span class="co"># <span style="color: #BCBCBC;">2</span> Heritability         0.154 0.089</span>
<span class="co"># <span style="color: #BCBCBC;">3</span> GEIr2                0.313 0.397</span>
<span class="co"># <span style="color: #BCBCBC;">4</span> h2mg                 0.815 0.686</span>
<span class="co"># <span style="color: #BCBCBC;">5</span> Accuracy             0.903 0.828</span>
<span class="co"># <span style="color: #BCBCBC;">6</span> rge                  0.37  0.435</span>
<span class="co"># <span style="color: #BCBCBC;">7</span> CVg                  6.26  1.46 </span>
<span class="co"># <span style="color: #BCBCBC;">8</span> CVr                 11.6   3.50 </span>
<span class="co"># <span style="color: #BCBCBC;">9</span> CV ratio             0.538 0.415</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-the-blups-for-genotypes">Plotting the BLUPs for genotypes<a class="anchor" aria-label="anchor" href="#plotting-the-blups-for-genotypes"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_blup.html">plot_blup</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span>
<span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_blup.html">plot_blup</a></span><span class="op">(</span><span class="va">model2</span>,
               prob <span class="op">=</span> <span class="fl">0.1</span>,
               col.shape  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray20"</span>, <span class="st">"gray80"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">e</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"e"</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="metan_start_files/figure-html/unnamed-chunk-12-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="blups-for-genotype-vs-environment-interaction">BLUPS for genotype-vs-environment interaction<a class="anchor" aria-label="anchor" href="#blups-for-genotype-vs-environment-interaction"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model2</span>, what <span class="op">=</span> <span class="st">"blupge"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/utils_num_str.html">round_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Class of the model: waasb</span>
<span class="co"># Variable extracted: blupge</span>
<span class="co"># <span style="color: #949494;"># A tibble: 140 × 4</span></span>
<span class="co">#    ENV   GEN      GY    HM</span>
<span class="co">#    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co"># <span style="color: #BCBCBC;"> 1</span> E1    G1     2.4   46.6</span>
<span class="co"># <span style="color: #BCBCBC;"> 2</span> E1    G10    2.11  47.2</span>
<span class="co"># <span style="color: #BCBCBC;"> 3</span> E1    G2     2.78  45.7</span>
<span class="co"># <span style="color: #BCBCBC;"> 4</span> E1    G3     2.84  46.2</span>
<span class="co"># <span style="color: #BCBCBC;"> 5</span> E1    G4     2.55  48.0</span>
<span class="co"># <span style="color: #BCBCBC;"> 6</span> E1    G5     2.27  49.4</span>
<span class="co"># <span style="color: #BCBCBC;"> 7</span> E1    G6     2.34  48.1</span>
<span class="co"># <span style="color: #BCBCBC;"> 8</span> E1    G7     2.7   47.4</span>
<span class="co"># <span style="color: #BCBCBC;"> 9</span> E1    G8     2.86  48.0</span>
<span class="co"># <span style="color: #BCBCBC;">10</span> E1    G9     2.35  47.6</span>
<span class="co"># <span style="color: #949494;"># … with 130 more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="blup-based-stability-index">BLUP-based stability index<a class="anchor" aria-label="anchor" href="#blup-based-stability-index"></a>
</h3>
<p>The WAASB index <span class="citation">(<a href="#ref-Olivoto2019" role="doc-biblioref">Olivoto, Lúcio, Da silva, Marchioro, et al.
2019</a>)</span> is a quantitative stability measure based on the
weighted average of the absolute scores from the singular value
decomposition of the BLUPs for genotype-vs-interaction effects. We can
obtain this statistic with the function <a href="https://tiagoolivoto.github.io/metan/reference/waasb.html"><code>waasb()</code></a>
combined with <a href="https://tiagoolivoto.github.io/metan/reference/get_model_data.html"><code>get_model_data()</code></a>
using <code>what = "WAASB"</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/waasb.html">waasb</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model3</span>, what <span class="op">=</span> <span class="st">"WAASB"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/utils_num_str.html">round_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Class of the model: waasb</span>
<span class="co"># Variable extracted: WAASB</span>
<span class="co"># <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="co">#    GEN      GY    HM</span>
<span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co"># <span style="color: #BCBCBC;"> 1</span> G1     0.13  0.38</span>
<span class="co"># <span style="color: #BCBCBC;"> 2</span> G10    0.46  1.03</span>
<span class="co"># <span style="color: #BCBCBC;"> 3</span> G2     0.21  0.79</span>
<span class="co"># <span style="color: #BCBCBC;"> 4</span> G3     0.1   0.36</span>
<span class="co"># <span style="color: #BCBCBC;"> 5</span> G4     0.25  0.6 </span>
<span class="co"># <span style="color: #BCBCBC;"> 6</span> G5     0.22  0.88</span>
<span class="co"># <span style="color: #BCBCBC;"> 7</span> G6     0.17  0.41</span>
<span class="co"># <span style="color: #BCBCBC;"> 8</span> G7     0.32  0.68</span>
<span class="co"># <span style="color: #BCBCBC;"> 9</span> G8     0.26  0.44</span>
<span class="co"># <span style="color: #BCBCBC;">10</span> G9     0.37  0.56</span></code></pre></div>
<p>The function <a href="https://tiagoolivoto.github.io/metan/reference/blup_indexes.html"><code>blup_indexes()</code></a>
can be used to compute the harmonic mean of genotypic values (HMGV), the
relative performance of the genotypic values (RPGV) and the harmonic
mean of the relative performance of genotypic values (HMRPGV). See <span class="citation">Alves et al. (<a href="#ref-Alves2018" role="doc-biblioref">2018</a>)</span> for more details. We use the
function <a href="https://tiagoolivoto.github.io/metan/reference/get_model_data.html"><code>get_model_data()</code></a>
to get the HMRPGV (default) for all analyzed variables.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blup_indexes.html">blup_indexes</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span>
<span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/utils_num_str.html">round_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Class of the model: blup_ind</span>
<span class="co"># Variable extracted: HMRPGV</span>
<span class="co"># <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="co">#    GEN      GY    HM</span>
<span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co"># <span style="color: #BCBCBC;"> 1</span> G1     0.97  0.98</span>
<span class="co"># <span style="color: #BCBCBC;"> 2</span> G10    0.9   1.01</span>
<span class="co"># <span style="color: #BCBCBC;"> 3</span> G2     1.02  0.97</span>
<span class="co"># <span style="color: #BCBCBC;"> 4</span> G3     1.1   0.99</span>
<span class="co"># <span style="color: #BCBCBC;"> 5</span> G4     0.99  1   </span>
<span class="co"># <span style="color: #BCBCBC;"> 6</span> G5     0.95  1.02</span>
<span class="co"># <span style="color: #BCBCBC;"> 7</span> G6     0.95  1.01</span>
<span class="co"># <span style="color: #BCBCBC;"> 8</span> G7     1.03  1   </span>
<span class="co"># <span style="color: #BCBCBC;"> 9</span> G8     1.12  1.02</span>
<span class="co"># <span style="color: #BCBCBC;">10</span> G9     0.92  1</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="gge-model">GGE model<a class="anchor" aria-label="anchor" href="#gge-model"></a>
</h2>
<div class="section level3">
<h3 id="fitting-the-model-1">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model-1"></a>
</h3>
<p>The GGE model is fitted with the function <a href="https://tiagoolivoto.github.io/metan/reference/gge.html"><code>gge()</code></a>.
This function produces a GGE model based on both a two-way table (in our
case the object <code>table</code>) with genotypes in the rows and
environments in columns, or a data.frame containing at least the columns
for genotypes, environments and the response variable(s).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-the-biplot">Visualizing the Biplot<a class="anchor" aria-label="anchor" href="#visualizing-the-biplot"></a>
</h3>
<p>The generic function <a href="https://tiagoolivoto.github.io/metan/reference/plot.gge.html"><code>plot()</code></a>
is used to generate a biplot using as input a fitted model of class
<code>gge</code>. The type of biplot is chosen by the argument
<code>type</code> in the function. Ten biplots type are available
according to {<span class="citation">Yan and Kang (<a href="#ref-Yan2003" role="doc-biblioref">2003</a>)</span>}.</p>
<ul>
<li>
<code>type = 1</code> A basic biplot.</li>
<li>
<code>type =  2</code> Mean performance vs. stability.</li>
<li>
<code>type =  3</code> Which-won-where.</li>
<li>
<code>type =  4</code> Discriminativeness
vs. representativeness.</li>
<li>
<code>type =  5</code> Examine an environment.</li>
<li>
<code>type =  6</code> Ranking environments.</li>
<li>
<code>type =  7</code> Examine a genotype.</li>
<li>
<code>type =  8</code> Ranking gentoypes.</li>
<li>
<code>type =  9</code> Compare two genotypes.</li>
<li>
<code>type =  10</code> Relationship among environments.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gge_model</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gge_model</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">e</span>, <span class="va">f</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="metan_start_files/figure-html/unnamed-chunk-17-1.png" width="384"></p>
</div>
</div>
<div class="section level2">
<h2 id="wrapper-function-ge_stats">Wrapper function <code>ge_stats()</code><a class="anchor" aria-label="anchor" href="#wrapper-function-ge_stats"></a>
</h2>
<p>To compute all the stability statistics at once, we can use the
function <a href="https://tiagoolivoto.github.io/metan/reference/ge_stats.html"><code>ge_stats()</code></a>.
Again we get the results with <a href="https://tiagoolivoto.github.io/metan/reference/get_model_data.html"><code>get_model_data()</code></a>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stat_ge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ge_stats.html">ge_stats</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span><span class="op">)</span>
<span class="co"># Evaluating trait GY |============================================| 100% 00:00:06 </span>
<span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">stat_ge</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/utils_num_str.html">round_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Class of the model: ge_stats</span>
<span class="co"># Variable extracted: stats</span>
<span class="co"># <span style="color: #949494;"># A tibble: 10 × 44</span></span>
<span class="co">#    var   GEN       Y    CV   ACV POLAR   Var Shukla  Wi_g  Wi_f  Wi_u Ecoval</span>
<span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co"># <span style="color: #BCBCBC;"> 1</span> GY    G1     2.6   35.2  34.1  0.03 10.9    0.03  84.4  89.2  81.1   1.22</span>
<span class="co"># <span style="color: #BCBCBC;"> 2</span> GY    G10    2.47  42.4  38.6  0.14 14.2    0.24  59.2  64.6  54.4   7.96</span>
<span class="co"># <span style="color: #BCBCBC;"> 3</span> GY    G2     2.74  34.0  35.2  0.06 11.3    0.09  82.8  95.3  75.6   3.03</span>
<span class="co"># <span style="color: #BCBCBC;"> 4</span> GY    G3     2.96  29.9  33.8  0.02 10.1    0.01 104.   99.7 107.    0.72</span>
<span class="co"># <span style="color: #BCBCBC;"> 5</span> GY    G4     2.64  31.4  31   -<span style="color: #BB0000;">0.05</span>  8.93   0.06  85.9  79.6  91.9   2.34</span>
<span class="co"># <span style="color: #BCBCBC;"> 6</span> GY    G5     2.54  30.6  28.8 -<span style="color: #BB0000;">0.12</span>  7.82   0.05  82.7  82.2  82.4   1.84</span>
<span class="co"># <span style="color: #BCBCBC;"> 7</span> GY    G6     2.53  29.6  27.8 -<span style="color: #BB0000;">0.15</span>  7.34   0.05  83.0  83.7  81.8   1.81</span>
<span class="co"># <span style="color: #BCBCBC;"> 8</span> GY    G7     2.74  27.4  28.3 -<span style="color: #BB0000;">0.13</span>  7.33   0.12  83.9  77.6  93.4   4.16</span>
<span class="co"># <span style="color: #BCBCBC;"> 9</span> GY    G8     3     30.4  35.0  0.05 10.8    0.07  98.8  90.5 107.    2.57</span>
<span class="co"># <span style="color: #BCBCBC;">10</span> GY    G9     2.51  42.4  39.4  0.15 14.8    0.17  68.8  68.9  70.3   5.56</span>
<span class="co"># <span style="color: #949494;"># … with 32 more variables: bij &lt;dbl&gt;, Sij &lt;dbl&gt;, R2 &lt;dbl&gt;, ASTAB &lt;dbl&gt;,</span></span>
<span class="co"># <span style="color: #949494;">#   ASI &lt;dbl&gt;, ASV &lt;dbl&gt;, AVAMGE &lt;dbl&gt;, DA &lt;dbl&gt;, DZ &lt;dbl&gt;, EV &lt;dbl&gt;, FA &lt;dbl&gt;,</span></span>
<span class="co"># <span style="color: #949494;">#   MASI &lt;dbl&gt;, MASV &lt;dbl&gt;, SIPC &lt;dbl&gt;, ZA &lt;dbl&gt;, WAAS &lt;dbl&gt;, WAASB &lt;dbl&gt;,</span></span>
<span class="co"># <span style="color: #949494;">#   HMGV &lt;dbl&gt;, RPGV &lt;dbl&gt;, HMRPGV &lt;dbl&gt;, Pi_a &lt;dbl&gt;, Pi_f &lt;dbl&gt;, Pi_u &lt;dbl&gt;,</span></span>
<span class="co"># <span style="color: #949494;">#   Gai &lt;dbl&gt;, S1 &lt;dbl&gt;, S2 &lt;dbl&gt;, S3 &lt;dbl&gt;, S6 &lt;dbl&gt;, N1 &lt;dbl&gt;, N2 &lt;dbl&gt;,</span></span>
<span class="co"># <span style="color: #949494;">#   N3 &lt;dbl&gt;, N4 &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="selection-based-on-multiple-traits">Selection based on multiple traits<a class="anchor" aria-label="anchor" href="#selection-based-on-multiple-traits"></a>
</h2>
<p>The multi-trait stability index (MTSI) was proposed by <span class="citation">Olivoto, Lúcio, Da silva, Sari, et al. (<a href="#ref-Olivoto2019a" role="doc-biblioref">2019</a>)</span> and is
used for simultaneous selection considering mean performance and
stability (of several traits) in the analysis of METs using both fixed
and mixed-effect models. For more details see the <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_indexes.html">complete
vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<ul>
<li>If you encounter a clear bug, please file a minimal reproducible
example on <a href="https://github.com/TiagoOlivoto/metan/issues" class="external-link">github</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Alves2018" class="csl-entry">
Alves, Rodrigo Silva, Leonardo de Azevedo Peixoto, Paulo Eduardo
Teodoro, Lidiane Aparecida Silva, Erina Vitório Rodrigues, Marcos Deon
Vilela de Resende, Bruno Galveas Laviola, and Leonardo Lopes Bhering.
2018. <span>“<span class="nocase">Selection of Jatropha curcas families
based on temporal stability and adaptability of genetic
values</span>.”</span> <em>Industrial Crops and Products</em> 119
(September): 290–93. <a href="https://doi.org/10.1016/J.INDCROP.2018.04.029" class="external-link">https://doi.org/10.1016/J.INDCROP.2018.04.029</a>.
</div>
<div id="ref-Annicchiarico1992" class="csl-entry">
Annicchiarico, P. 1992. <span>“<span class="nocase">Cultivar adaptation
and recommendation from alfalfa trials in Northern Italy</span>.”</span>
<em>Journal of Genetics and Breeding</em> 46: 269–78.
</div>
<div id="ref-Doring2015" class="csl-entry">
Döring, Thomas F., Samuel Knapp, and Joel E. Cohen. 2015. <span>“<span class="nocase">Taylor’s power law and the stability of crop
yields</span>.”</span> <em>Field Crops Research</em> 183 (November):
294–302. <a href="https://doi.org/10.1016/j.fcr.2015.08.005" class="external-link">https://doi.org/10.1016/j.fcr.2015.08.005</a>.
</div>
<div id="ref-Doring2018" class="csl-entry">
Döring, Thomas F., and Moritz Reckling. 2018. <span>“<span class="nocase">Detecting global trends of cereal yield stability by
adjusting the coefficient of variation</span>.”</span> <em>European
Journal of Agronomy</em> 99 (September): 30–36. <a href="https://doi.org/10.1016/j.eja.2018.06.007" class="external-link">https://doi.org/10.1016/j.eja.2018.06.007</a>.
</div>
<div id="ref-Eberhart1966" class="csl-entry">
Eberhart, S. A., and W. A. Russell. 1966. <span>“<span class="nocase">Stability parameters for comparing
Varieties</span>.”</span> <em>Crop Science</em> 6 (1): 36–40. <a href="https://doi.org/10.2135/cropsci1966.0011183X000600010011x" class="external-link">https://doi.org/10.2135/cropsci1966.0011183X000600010011x</a>.
</div>
<div id="ref-Fox1990" class="csl-entry">
Fox, P. N., B. Skovmand, B. K. Thompson, H. J. Braun, and R. Cormier.
1990. <span>“<span class="nocase">Yield and adaptation of hexaploid
spring triticale</span>.”</span> <em>Euphytica</em> 47 (1): 57–64. <a href="https://doi.org/10.1007/BF00040364" class="external-link">https://doi.org/10.1007/BF00040364</a>.
</div>
<div id="ref-Huehn1979" class="csl-entry">
Huehn, M. 1979. <span>“<span class="nocase">Beitrage zur erfassung der
phanotypischen stabilitat</span>.”</span> <em>EDV in Medizin Und
Biologie</em> 10: 112–17.
</div>
<div id="ref-Lin1988" class="csl-entry">
Lin, C. S., and M. R. Binns. 1988. <span>“<span class="nocase">A
superiority measure of cultivar performance for cultivar x location
data</span>.”</span> <em>Canadian Journal of Plant Science</em> 68 (1):
193–98. <a href="https://doi.org/10.4141/cjps88-018" class="external-link">https://doi.org/10.4141/cjps88-018</a>.
</div>
<div id="ref-Mohammadi2008" class="csl-entry">
Mohammadi, Reza, and Ahmed Amri. 2008. <span>“<span class="nocase">Comparison of parametric and non-parametric methods for
selecting stable and adapted durum wheat genotypes in variable
environments</span>.”</span> <em>Euphytica</em> 159 (3): 419–32. <a href="https://doi.org/10.1007/s10681-007-9600-6" class="external-link">https://doi.org/10.1007/s10681-007-9600-6</a>.
</div>
<div id="ref-murakami2004" class="csl-entry">
Murakami, D. M., and C. D. Cruz. 2004. <span>“<span class="nocase">Proposal of methodologies for environment stratification
and analysis of genotype adaptability</span>.”</span> <em>Crop Breeding
and Applied Biotechnology</em> 4 (1): 7–11.
</div>
<div id="ref-Olivoto2019" class="csl-entry">
Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, V. S. Marchioro, V. Q. de
Souza, and E. Jost. 2019. <span>“<span class="nocase">Mean performance
and stability in multi-environment trials I: Combining features of AMMI
and BLUP techniques</span>.”</span> <em>Agronomy Journal</em> 111 (6):
2949–60. <a href="https://doi.org/10.2134/agronj2019.03.0220" class="external-link">https://doi.org/10.2134/agronj2019.03.0220</a>.
</div>
<div id="ref-Olivoto2019a" class="csl-entry">
Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, B. G. Sari, and M. I.
Diel. 2019. <span>“<span class="nocase">Mean performance and stability
in multi-environment trials II: Selection based on multiple
traits</span>.”</span> <em>Agronomy Journal</em> 111 (6): 2961–69. <a href="https://doi.org/10.2134/agronj2019.03.0221" class="external-link">https://doi.org/10.2134/agronj2019.03.0221</a>.
</div>
<div id="ref-Schmildt2011" class="csl-entry">
Schmildt, Edilson Romais, Adriel Lima Nascimento, Cosme Damião Cruz, and
Jaqueline Aparecida Raminelli Oliveira. 2011. <span>“<span class="nocase">Avalia<span class="nocase">ç</span><span class="nocase">ã</span>o de metodologias de adaptabilidade e
estabilidade de cultivares milho</span>.”</span> <em>Acta Scientiarum -
Agronomy</em> 33 (1): 51–58. <a href="https://doi.org/10.4025/actasciagron.v33i1.5817" class="external-link">https://doi.org/10.4025/actasciagron.v33i1.5817</a>.
</div>
<div id="ref-Shukla1972" class="csl-entry">
Shukla, G. K. 1972. <span>“<span class="nocase">Some statistical aspects
of partitioning genotype-environmental components of
variability</span>.”</span> <em>Heredity</em> 29 (2): 238–45. <a href="https://doi.org/10.1038/hdy.1972.87" class="external-link">https://doi.org/10.1038/hdy.1972.87</a>.
</div>
<div id="ref-Thennarasu1995" class="csl-entry">
Thennarasu, K. 1995. <span>“<span class="nocase">On certain
non-parametric procedures for studying genotype-environment
interactions</span>.”</span> Thesis, IARI.
</div>
<div id="ref-Wricke1965" class="csl-entry">
Wricke, G. 1965. <span>“<span class="nocase">Zur berechnung der
okovalenz bei sommerweizen und hafer</span>.”</span> <em>Z.
Pflanzenzuchtg</em> 52: 127–38.
</div>
<div id="ref-Yan2003" class="csl-entry">
Yan, Weikai., and Manjit S. Kang. 2003. <em><span class="nocase">GGE
biplot analysis : a graphical tool for breeders, geneticists, and
agronomists</span></em>. CRC Press.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
