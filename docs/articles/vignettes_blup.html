<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing multienvironment trials using BLUP ‚Ä¢ metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing multienvironment trials using BLUP">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><a class="dropdown-item" href="../news/index.html">Package news</a></li>
    <li><a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">More</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-more">
<li><a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
    <li><a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a></li>
    <li><a class="dropdown-item" href="../SUPPORT.html">Support</a></li>
    <li><a class="dropdown-item" href="../LICENSE.html">Licence</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TiagoOlivoto"><span class="fa fa-github fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/tolivoto"><span class="fa fab fa-twitter fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/"><span class="fa fab fa-mendeley fa-2x"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="vignettes_blup_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="vignettes_blup_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="vignettes_blup_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="vignettes_blup_files/datatables-binding-0.33/datatables.js"></script><link href="vignettes_blup_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="vignettes_blup_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="vignettes_blup_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><script src="vignettes_blup_files/jszip-1.13.6/jszip.min.js"></script><script src="vignettes_blup_files/pdfmake-1.13.6/pdfmake.js"></script><script src="vignettes_blup_files/pdfmake-1.13.6/vfs_fonts.js"></script><link href="vignettes_blup_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="vignettes_blup_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="vignettes_blup_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="vignettes_blup_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="vignettes_blup_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="vignettes_blup_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="vignettes_blup_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyzing multienvironment trials using BLUP</h1>
                        <h4 data-toc-skip class="author">Tiago
Olivoto</h4>
            
            <h4 data-toc-skip class="date">2024-11-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nepem-ufsc/metan/blob/HEAD/vignettes/vignettes_blup.Rmd" class="external-link"><code>vignettes/vignettes_blup.Rmd</code></a></small>
      <div class="d-none name"><code>vignettes_blup.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>In this section, we will use the data in <code>data_ge</code>. For
more information, please, see <code><a href="../reference/data_ge.html">?data_ge</a></code>. Other data sets can
be used provided that the following columns are in the dataset:
environment, genotype, block/replicate and response variable(s). See the
section <a href="#rendering">Rendering engine</a> to know how HTML
tables were generated.</p>
<p>The first step is to inspect the data with the function
<code><a href="../reference/inspect.html">inspect()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span></span>
<span><span class="va">inspect</span> <span class="op">&lt;-</span> </span>
<span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data_ge</span>,</span>
<span>        verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">inspect</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["ENV","GEN","REP","GY","HM"],["factor","factor","factor","numeric","numeric"],["No","No","No","No","No"],["14","10","3","-","-"],[420,420,420,420,420],[null,null,null,0.67,38],[null,null,null,2.61,48],[null,null,null,5.09,58],[null,null,null,0,0],[null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Class<\/th>\n      <th>Missing<\/th>\n      <th>Levels<\/th>\n      <th>Valid_n<\/th>\n      <th>Min<\/th>\n      <th>Median<\/th>\n      <th>Max<\/th>\n      <th>Outlier<\/th>\n      <th>Text<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[4,5,6,7,8]},{"name":"Variable","targets":0},{"name":"Class","targets":1},{"name":"Missing","targets":2},{"name":"Levels","targets":3},{"name":"Valid_n","targets":4},{"name":"Min","targets":5},{"name":"Median","targets":6},{"name":"Max","targets":7},{"name":"Outlier","targets":8},{"name":"Text","targets":9}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="analysis-of-single-experiments-using-mixed-models">Analysis of single experiments using mixed-models<a class="anchor" aria-label="anchor" href="#analysis-of-single-experiments-using-mixed-models"></a>
</h2>
<p>The function <code><a href="../reference/gamem.html">gamem()</a></code> may be used to analyze single
experiments (one-way experiments) using a mixed-effect model according
to the following model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>Œº</mi><mo>+</mo><msub><mi>Œ±</mi><mi>i</mi></msub><mo>+</mo><msub><mi>œÑ</mi><mi>j</mi></msub><mo>+</mo><msub><mi>Œµ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
y_{ij}= \mu  + \alpha_i + \tau_j + \varepsilon_{ij}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
is the value observed for the <em>i</em>th genotype in the <em>j</em>th
replicate (<em>i</em> = 1, 2, ‚Ä¶ <em>g</em>; <em>j</em> = 1, 2, ..,
<em>r</em>); being <em>g</em> and <em>r</em> the number of genotypes and
replicates, respectively;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ±</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math>
is the random effect of the <em>i</em>th genotype;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÑ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\tau_j</annotation></semantics></math>
is the fixed effect of the <em>j</em>th replicate; and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œµ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\varepsilon_{ij}</annotation></semantics></math>
is the random error associated to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>.
In this example, we will use the example data <code>data_g</code> from
metan package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gamem.html">gamem</a></span><span class="op">(</span><span class="va">data_g</span>, <span class="va">GEN</span>, <span class="va">REP</span>,</span>
<span>                 resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ED</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">KW</span>, <span class="va">TKW</span>, <span class="va">NKR</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Evaluating trait ED |=======                                     | 17% 00:00:00 Evaluating trait CL |===============                             | 33% 00:00:00 Evaluating trait CD |======================                      | 50% 00:00:00 Evaluating trait KW |=============================               | 67% 00:00:00 Evaluating trait TKW |====================================       | 83% 00:00:00 Evaluating trait NKR |===========================================| 100% 00:00:00 </span></span>
<span><span class="co"># Method: REML/BLUP</span></span>
<span><span class="co"># Random effects: GEN</span></span>
<span><span class="co"># Fixed effects: REP</span></span>
<span><span class="co"># Denominador DF: Satterthwaite's method</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     model       ED       CL    CD     KW     TKW   NKR</span></span>
<span><span class="co">#  Complete       NA       NA    NA     NA      NA    NA</span></span>
<span><span class="co">#  Genotype 2.73e-05 2.25e-06 0.118 0.0253 0.00955 0.216</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Variables with nonsignificant Genotype effect</span></span>
<span><span class="co"># CD NKR </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span></code></pre></div>
<p>The easiest way of obtaining the results of the model above is by
using the function <code><a href="../reference/get_model_data.html">get_model_data()</a></code>. Let‚Äôs do it.</p>
<ul>
<li>Details of the analysis</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"details"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">print_table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: gamem</span></span>
<span><span class="co"># Variable extracted: details</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["Ngen","OVmean","Min","Max","MinGEN","MaxGEN"],["13","47.8727","43.482 (H9 in 1)","52.64 (H1 in 3)","43.8547 (H9)","50.6753 (H13)"],["13","28.4487","23.492 (H10 in 2)","33.16 (H6 in 1)","24.7773 (H10)","31.9033 (H6)"],["13","15.7703","14 (H6 in 1)","17.56 (H9 in 3)","14.6533 (H12)","16.6733 (H2)"],["13","146.8108","114.1174 (H11 in 2)","199.139 (H13 in 1)","120.5581 (H10)","181.6017 (H13)"],["13","317.7178","232.5912 (H10 in 2)","422.1651 (H1 in 3)","247.2608 (H10)","368.7677 (H1)"],["13","30.4","24.8 (H1 in 2)","36.2 (H5 in 3)","26.4 (H6)","33.5333 (H4)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>ED<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>KW<\/th>\n      <th>TKW<\/th>\n      <th>NKR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"name":"Parameters","targets":0},{"name":"ED","targets":1},{"name":"CL","targets":2},{"name":"CD","targets":3},{"name":"KW","targets":4},{"name":"TKW","targets":5},{"name":"NKR","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><ul>
<li>Likelihood ratio test for genotype effect</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"lrt"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">print_table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: gamem</span></span>
<span><span class="co"># Variable extracted: lrt</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["ED","CL","CD","KW","TKW","NKR"],["Genotype","Genotype","Genotype","Genotype","Genotype","Genotype"],[4,4,4,4,4,4],[-91.9011476019754,-86.20710261742877,-52.48946036557452,-165.3452416544291,-190.4330834106985,-96.27546409456315],[191.8022952039508,180.4142052348575,112.978920731149,338.6904833088582,388.866166821397,200.5509281891263],[17.59540372204336,22.36735782430208,2.448631640287815,5.00187190013321,6.716497402654511,1.529588631856996],[1,1,1,1,1,1],[2.732479703705286e-05,2.25168687359611e-06,0.1176273685527871,0.02531992012142806,0.009552505014956032,0.2161741942610104]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>VAR<\/th>\n      <th>model<\/th>\n      <th>npar<\/th>\n      <th>logLik<\/th>\n      <th>AIC<\/th>\n      <th>LRT<\/th>\n      <th>Df<\/th>\n      <th>Pr(&gt;Chisq)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7]},{"name":"VAR","targets":0},{"name":"model","targets":1},{"name":"npar","targets":2},{"name":"logLik","targets":3},{"name":"AIC","targets":4},{"name":"LRT","targets":5},{"name":"Df","targets":6},{"name":"Pr(>Chisq)","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render"],"jsHooks":[]}</script><ul>
<li>Variance components and genetic parameters</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"genpar"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">print_table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: gamem</span></span>
<span><span class="co"># Variable extracted: genpar</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["Gen_var","Gen (%)","Res_var","Res (%)","Phen_var","H2","h2mg","Accuracy","CVg","CVr","CV ratio"],[5.368793171595023,68.83944087594098,2.430214349791437,31.16055912405901,7.799007521386461,0.6883944087594098,0.8688963912385443,0.9321461211840901,4.840059682292226,3.2563769402656,1.486332746815685],[4.269046851373008,75.10597477744085,1.414984098259613,24.89402522255915,5.68403094963262,0.7510597477744085,0.9005082480399328,0.9489511304803492,7.262790951996946,4.181324401793481,1.736959454492873],[0.239629919044064,27.4413870158187,0.633612817942694,72.55861298418131,0.873242736986758,0.274413870158187,0.5315256106572575,0.7290580296912293,3.104071854047001,5.047463912508658,0.6149765323441877],[180.9718872756852,39.22396740457827,280.4089960221169,60.77603259542174,461.380883297802,0.3922396740457827,0.6594186833239654,0.8120459859662909,9.163207067074932,11.40611941868551,0.8033588577078864],[840.9393318672637,45.22711539885665,1018.430483012689,54.77288460114335,1859.369814879953,0.4522711539885665,0.7124091999861156,0.8440433638066919,9.127267451004363,10.04440322419963,0.9086918602604835],[2.146666666938193,21.58659218129209,7.797777777602665,78.41340781870791,9.944444444540858,0.2158659218129209,0.4523177774678322,0.6725457437734865,4.81957477570742,9.185691246004644,0.5246828623598376]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>ED<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>KW<\/th>\n      <th>TKW<\/th>\n      <th>NKR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6]},{"name":"Parameters","targets":0},{"name":"ED","targets":1},{"name":"CL","targets":2},{"name":"CD","targets":3},{"name":"KW","targets":4},{"name":"TKW","targets":5},{"name":"NKR","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render"],"jsHooks":[]}</script><ul>
<li>Predicted means</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"blupg"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">print_table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: gamem</span></span>
<span><span class="co"># Variable extracted: blupg</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["H1","H10","H11","H12","H13","H2","H3","H4","H5","H6","H7","H8","H9"],[50.23374779379222,44.39534330893002,47.15553751176446,47.75739307876236,50.3078936191779,50.27313776352836,47.17697028941502,46.0879534790627,49.83115913251835,49.71878186591816,48.68131957477936,46.34398828234767,44.3814409666702],[30.65431153553253,25.14260071869611,26.55639866811881,26.08813437913804,27.39867404945216,29.97532831651042,28.55732799526354,27.755875654508,30.0989981159079,31.55962249422867,30.04556795985754,28.97576416118609,27.02406261826754],[15.78960939402906,15.45652001135051,15.56991214162406,15.17658318973768,15.88882750801841,16.25026492326534,16.11206826449446,16.19002535405752,16.16522082556018,15.23682275894551,15.53802060498462,15.81087041845535,15.82858793881059],[153.4087661224955,129.4992934046425,142.7912953766248,147.8334865081163,169.7525495621289,155.710874733229,141.6514733233617,144.5974888040027,156.2449218130566,140.3856857721553,152.6430939878902,143.2630536137613,130.7586446118677],[354.0861963962208,267.5235528216436,296.9959144484965,293.4356107576549,319.0778944475625,337.8144502823294,330.7803196861644,309.8889856250079,309.0118009065942,325.0700858091268,346.4478880928654,339.1219290992442,301.0768618424044],[29.49536444506433,31.72679881390564,31.30463555493566,30.03814577802573,31.15386296244638,29.64613703755361,30.188918370515,31.8172623693992,31.27448103643781,28.59072889012867,30.03814577802573,29.52551896356218,30.39999999999999]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>GEN<\/th>\n      <th>ED<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>KW<\/th>\n      <th>TKW<\/th>\n      <th>NKR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6]},{"name":"GEN","targets":0},{"name":"ED","targets":1},{"name":"CL","targets":2},{"name":"CD","targets":3},{"name":"KW","targets":4},{"name":"TKW","targets":5},{"name":"NKR","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render"],"jsHooks":[]}</script><p>In the above example, the experimental design was a complete
randomized block. It is also possible to analyze an experiment conducted
in an alpha-lattice design with the function <code><a href="../reference/gamem.html">gamem()</a></code>. In
this case, the following model is fitted:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mi>Œº</mi><mo>+</mo><msub><mi>Œ±</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Œ≥</mi><mi>j</mi></msub><mo>+</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≥</mi><mi>œÑ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>Œµ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
y_{ijk}= \mu  + \alpha_i + \gamma_j + (\gamma \tau)_{jk} + \varepsilon_{ijk}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{ijk}</annotation></semantics></math>
is the observed value of the <em>i</em>th genotype in the <em>k</em>th
block of the <em>j</em>th replicate (<em>i</em> = 1, 2, ‚Ä¶ <em>g</em>;
<em>j</em> = 1, 2, .., <em>r</em>; <em>k</em> = 1, 2, .., <em>b</em>);
respectively;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ±</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\alpha_i</annotation></semantics></math>
is the random effect of the <em>i</em>th genotype;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≥</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\gamma_j</annotation></semantics></math>
is the fixed effect of the <em>j</em>th complete replicate;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ≥</mi><mi>œÑ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">(\gamma \tau)_{jk}</annotation></semantics></math>
is the random effect of the <em>k</em>th incomplete block nested within
the <em>j</em> replicate; and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œµ</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\varepsilon_{ijk}</annotation></semantics></math>
is the random error associated to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">y_{ijk}</annotation></semantics></math>.
In this example, we will use the example data <code>data_alpha</code>
from metan package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gamem.html">gamem</a></span><span class="op">(</span><span class="va">data_alpha</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">YIELD</span>, block <span class="op">=</span> <span class="va">BLOCK</span><span class="op">)</span></span>
<span><span class="co"># Evaluating trait YIELD |=========================================| 100% 00:00:00 </span></span>
<span><span class="co"># Method: REML/BLUP</span></span>
<span><span class="co"># Random effects: GEN, BLOCK(REP)</span></span>
<span><span class="co"># Fixed effects: REP</span></span>
<span><span class="co"># Denominador DF: Satterthwaite's method</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#      model    YIELD</span></span>
<span><span class="co">#   Complete       NA</span></span>
<span><span class="co">#   Genotype 1.18e-06</span></span>
<span><span class="co">#  rep:block 3.35e-03</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># All variables with significant (p &lt; 0.05) genotype effect</span></span>
<span><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_alpha</span>, <span class="st">"lrt"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">print_table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: gamem</span></span>
<span><span class="co"># Variable extracted: lrt</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-10b3b7155e8045a1b2ad" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["YIELD","YIELD"],["Genotype","rep:block"],[5,5],[-58.40512841552563,-50.89980945174369],[126.8102568310513,111.7996189034874],[23.61643658907141,8.605798661507535],[1,1],[1.175788858944315e-06,0.003350943918886665]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>VAR<\/th>\n      <th>model<\/th>\n      <th>npar<\/th>\n      <th>logLik<\/th>\n      <th>AIC<\/th>\n      <th>LRT<\/th>\n      <th>Df<\/th>\n      <th>Pr(&gt;Chisq)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7]},{"name":"VAR","targets":0},{"name":"model","targets":1},{"name":"npar","targets":2},{"name":"logLik","targets":3},{"name":"AIC","targets":4},{"name":"LRT","targets":5},{"name":"Df","targets":6},{"name":"Pr(>Chisq)","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_alpha</span>, <span class="st">"details"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">print_table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: gamem</span></span>
<span><span class="co"># Variable extracted: details</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-4018eef1a407a0df6b52" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4018eef1a407a0df6b52">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["Ngen","OVmean","Min","Max","MinGEN","MaxGEN"],["24","4.4795","2.8873 (G03 in B6 of R3)","5.8757 (G05 in B1 of R1)","3.3431 (G03)","5.1625 (G01)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>YIELD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"name":"Parameters","targets":0},{"name":"YIELD","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_alpha</span>, <span class="st">"genpar"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">print_table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: gamem</span></span>
<span><span class="co"># Variable extracted: genpar</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-5b1b2f4ad92281566982" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5b1b2f4ad92281566982">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["Gen_var","Gen (%)","rep:block_var","rep:block (%)","Res_var","Res (%)","Phen_var","H2","h2mg","Accuracy","CVg","CVr","CV ratio"],[0.142902103629106,48.48452252466823,0.07021833183534772,23.82401801691968,0.08161713477025261,27.6914594584121,0.2947375702347063,0.4848452252466823,0.7979967619865973,0.8933066449918512,8.438944957027578,6.377632871425824,1.323209586873086]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>YIELD<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":1},{"name":"Parameters","targets":0},{"name":"YIELD","targets":1}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="the-blup-model-for-met-trials">The BLUP model for MET trials<a class="anchor" aria-label="anchor" href="#the-blup-model-for-met-trials"></a>
</h2>
<p>The simplest and well-known linear model with interaction effect used
to analyze data from multi-environment trials is <span class="math display">$$
    {y_{ijk}} = {\rm{ }}\mu {\rm{ }} + \mathop \alpha \nolimits_i  +
\mathop \tau \nolimits_j  + \mathop {(\alpha \tau )}\nolimits_{ij}  +
\mathop \gamma \nolimits_{jk}  + {\rm{ }}\mathop \varepsilon
\nolimits_{ijk}
    $$</span></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">{y_{ijk}}</annotation></semantics></math>
is the response variable (e.g., grain yield) observed in the
<em>k</em>th block of the <em>i</em>th genotype in the <em>j</em>th
environment (<em>i</em> = 1, 2, ‚Ä¶, <em>g</em>; <em>j</em> = 1, 2, ‚Ä¶,
<em>e</em>; <em>k</em> = 1, 2, ‚Ä¶, <em>b</em>);
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is the grand mean;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Œ±</mo><mi>i</mi></msub><annotation encoding="application/x-tex">\mathop \alpha \nolimits_i</annotation></semantics></math>
is the effect of the ith genotype;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>œÑ</mo><mi>j</mi></msub><annotation encoding="application/x-tex">\mathop \tau \nolimits_j</annotation></semantics></math>
is the effect of the <em>j</em>th environment;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo></mo><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mathop {(\alpha \tau )}\nolimits_{ij}</annotation></semantics></math>
is the interaction effect of the <em>i</em>th genotype with the
<em>j</em>th environment;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Œ≥</mo><mrow><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\mathop \gamma \nolimits_{jk}</annotation></semantics></math>
is the effect of the <em>k</em>th block within the <em>j</em>th
environment; and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Œµ</mo><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">\mathop \varepsilon \nolimits_{ijk}</annotation></semantics></math>
is the random error. In a mixed-effect model assuming
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ±</mi><mi>i</mi></msub><annotation encoding="application/x-tex">{\alpha _i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo></mo><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mathop {(\alpha \tau )}\nolimits_{ij}</annotation></semantics></math>
to be random effects, the above model can be rewritten as follows</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùê≤</mi><mo mathvariant="bold">=</mo><mi>ùêó</mi><mi>ùõÉ</mi><mo mathvariant="bold">+</mo><mi>ùêô</mi><mi>ùêÆ</mi><mo mathvariant="bold">+</mo><mi>ùõÜ</mi></mrow><annotation encoding="application/x-tex">
{\boldsymbol{y  = X\beta  + Zu + \varepsilon }}
</annotation></semantics></math></p>
<p>where <strong>y </strong> is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false" form="prefix">[</mo><mo>=</mo><msubsup><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>e</mi></msubsup><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">]</mo></mrow><mo>√ó</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n[ = \sum\nolimits_{j = 1}^e {(gb)]}  \times 1</annotation></semantics></math>
vector of response variable <span class="math inline">${\bf{y}} = {\rm{
}}{\left[ {{y_{111}},{\rm{ }}{y_{112}},{\rm{ }} \ldots ,{\rm{
}}{y_{geb}}} \right]^\prime }$</span>; <span class="math inline">${\bf{\beta }}$</span> is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>√ó</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">(eb) \times 1</annotation></semantics></math>
vector of unknown fixed effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùõÉ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mo>Œ≥</mo><mn>11</mn></msub><mo>,</mo><msub><mo>Œ≥</mo><mn>12</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mo>Œ≥</mo><mrow><mi>e</mi><mi>b</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mi>‚Ä≤</mi></mrow><annotation encoding="application/x-tex">{\boldsymbol{\beta }} = [\mathop \gamma \nolimits_{11} ,\mathop \gamma \nolimits_{12} ,...,\mathop \gamma \nolimits_{eb} ]'</annotation></semantics></math>;
<strong>u</strong> is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mrow><mo stretchy="true" form="prefix">[</mo><mo>=</mo><mi>g</mi><mo>+</mo><mi>g</mi><mi>e</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>√ó</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m[ = g + ge] \times 1</annotation></semantics></math>
vector of random effects <span class="math inline">${\boldsymbol{u}} =
{\rm{ }}{\left[ {{\alpha _1},{\alpha _2},...,{\alpha _g},\mathop
{(\alpha \tau )}\nolimits_{11} ,\mathop {(\alpha \tau )}\nolimits_{12}
,...,\mathop {(\alpha \tau )}\nolimits_{ge} } \right]^\prime }$</span>;
<strong>X </strong> is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>√ó</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">n \times (eb)</annotation></semantics></math>
design matrix relating <strong>y</strong> to <span class="math inline">${\bf{\beta }}$</span>; <strong>Z </strong> is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>√ó</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math>
design matrix relating <strong>y</strong> to <strong>u </strong>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÜ</mi><annotation encoding="application/x-tex">{\boldsymbol{\varepsilon }}</annotation></semantics></math>
is an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>√ó</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \times 1</annotation></semantics></math>
vector of random errors <span class="math inline">${\boldsymbol{\varepsilon }} = {\rm{ }}{\left[
{{y_{111}},{\rm{ }}{y_{112}},{\rm{ }} \ldots ,{\rm{ }}{y_{geb}}}
\right]^\prime }$</span>;</p>
<p>The vectors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÉ</mi><annotation encoding="application/x-tex">{\boldsymbol{\beta }}</annotation></semantics></math>
and <strong>u</strong> are estimated using the well-known mixed model
equation <span class="citation">(<a href="#ref-Henderson1975">Henderson
1975</a>)</span>. <span class="math display">$$
    \left[ {\begin{array}{*{20}{c}}{{\boldsymbol{\hat \beta
}}}\\{{\bf{\hat u}}}\end{array}} \right]{\bf{ = }}{\left[
{\begin{array}{*{20}{c}}{{\bf{X'}}{{\bf{R }}^{ -
{\bf{1}}}}{\bf{X}}}&amp;{{\bf{X'}}{{\bf{R }}^{ -
{\bf{1}}}}{\bf{Z}}}\\{{\bf{Z'}}{{\bf{R }}^{ -
{\bf{1}}}}{\bf{X}}}&amp;{{\bf{Z'}}{{\bf{R }}^{ - {\bf{1}}}}{\bf{Z +
}}{{\bf{G}}^{ - {\bf{1}}}}}\end{array}} \right]^ - }\left[
{\begin{array}{*{20}{c}}{{\bf{X'}}{{\bf{R }}^{ -
{\bf{1}}}}{\bf{y}}}\\{{\bf{Z'}}{{\bf{R }}^{ -
{\bf{1}}}}{\bf{y}}}\end{array}} \right]
    $$</span> where <strong>G</strong> and <strong>R</strong> are the
variance-covariance matrices for random-effect vector <strong>u</strong>
and residual vector <span class="math inline">${\bf{\varepsilon
}}$</span>, respectively.</p>
<p>The function <code><a href="../reference/gamem_met.html">gamem_met()</a></code> is used to fit the linear
mixed-effect model. The first argument is the data, in our example
<code>data_ge</code>. The arguments (<code>env</code>, <code>gen</code>,
and <code>rep</code>) are the name of the columns that contains the
levels for environments, genotypes, and replications, respectively.The
argument (<code>resp</code>) is the response variable to be analyzed.
The function allow a single variable (in this case GY) or a vector of
response variables. Here, we will use <code><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything()</a></code> to
analyse all numeric variables in the data. By default, genotype and
genotype-vs-environment interaction are assumed to be random effects.
Other effects may be considered using the <code>random</code> argument.
The last argument (<code>verbose</code>) control if the code is run
silently or not.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mixed_mod</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/gamem_met.html">gamem_met</a></span><span class="op">(</span><span class="va">data_ge</span>,</span>
<span>            env <span class="op">=</span> <span class="va">ENV</span>,</span>
<span>            gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span>            rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span>            resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            random <span class="op">=</span> <span class="st">"gen"</span>, <span class="co">#Default</span></span>
<span>            verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#Default</span></span>
<span><span class="co"># Evaluating trait GY |======================                      | 50% 00:00:00 Evaluating trait HM |============================================| 100% 00:00:01 </span></span>
<span><span class="co"># Method: REML/BLUP</span></span>
<span><span class="co"># Random effects: GEN, GEN:ENV</span></span>
<span><span class="co"># Fixed effects: ENV, REP(ENV)</span></span>
<span><span class="co"># Denominador DF: Satterthwaite's method</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     model       GY       HM</span></span>
<span><span class="co">#  COMPLETE       NA       NA</span></span>
<span><span class="co">#       GEN 1.11e-05 5.07e-03</span></span>
<span><span class="co">#   GEN:ENV 2.15e-11 2.27e-15</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></span></code></pre></div>
<div class="section level3">
<h3 id="diagnostic-plot-for-residuals">Diagnostic plot for residuals<a class="anchor" aria-label="anchor" href="#diagnostic-plot-for-residuals"></a>
</h3>
<p>The S3 generic function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> is used to generate
diagnostic plots of residuals of the model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mixed_mod</span><span class="op">)</span></span>
<span><span class="co"># `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co"># `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The normality of the random effects of genotype and interaction
effects may be also obtained by using <code>type = "re"</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mixed_mod</span>, type <span class="op">=</span> <span class="st">"re"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="printing-the-model-outputs">Printing the model outputs<a class="anchor" aria-label="anchor" href="#printing-the-model-outputs"></a>
</h3>
<div class="section level4">
<h4 id="likelihood-ratio-tests">Likelihood Ratio Tests<a class="anchor" aria-label="anchor" href="#likelihood-ratio-tests"></a>
</h4>
<p>The output <code>LRT</code> contains the Likelihood Ratio Tests for
genotype and genotype-vs-environment random effects. We can get these
values with <code><a href="../reference/get_model_data.html">get_model_data()</a></code></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">mixed_mod</span>, <span class="st">"lrt"</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-25c3e940e6859592f801" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-25c3e940e6859592f801">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["GY","GY","HM","HM"],["GEN","GEN:ENV","GEN","GEN:ENV"],[44,44,44,44],[-224.374969720055,-237.1332463581321,-866.5942625502252,-894.0761596919943],[536.74993944011,562.2664927162641,1821.18852510045,1876.152319383989],[19.31543772566931,44.83199100182344,7.855093280250912,62.8188875637893],[1,1,1,1],[1.108068288967389e-05,2.146863349677747e-11,0.005067773766051375,2.26615216587401e-15]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>VAR<\/th>\n      <th>model<\/th>\n      <th>npar<\/th>\n      <th>logLik<\/th>\n      <th>AIC<\/th>\n      <th>LRT<\/th>\n      <th>Df<\/th>\n      <th>Pr(&gt;Chisq)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7]},{"name":"VAR","targets":0},{"name":"model","targets":1},{"name":"npar","targets":2},{"name":"logLik","targets":3},{"name":"AIC","targets":4},{"name":"LRT","targets":5},{"name":"Df","targets":6},{"name":"Pr(>Chisq)","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="variance-components-and-genetic-parameters">Variance components and genetic parameters<a class="anchor" aria-label="anchor" href="#variance-components-and-genetic-parameters"></a>
</h4>
<p>In the output <code>ESTIMATES</code>, beyond the variance components
for the declared random effects, some important parameters are also
shown. <strong>Heribatility</strong> is the broad-sense heritability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>h</mo><mi>g</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\mathop h\nolimits_g^2</annotation></semantics></math>,
estimated by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>h</mo><mi>g</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><msubsup><mo></mo><mi>g</mi><mn>2</mn></msubsup><mrow><msubsup><mo></mo><mi>g</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mo></mo><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mo></mo><mi>e</mi><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\mathop h\nolimits_g^2  = \frac{\mathop {\hat\sigma} \nolimits_g^2} {\mathop {\hat\sigma} \nolimits_g^2  + \mathop {\hat\sigma} \nolimits_i^2  + \mathop {\hat\sigma} \nolimits_e^2 }
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo></mo><mi>g</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\mathop {\hat\sigma} \nolimits_g^2</annotation></semantics></math>
is the genotypic variance;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo></mo><mi>i</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\mathop {\hat\sigma} \nolimits_i^2</annotation></semantics></math>
is the genotype-by-environment interaction variance; and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo></mo><mi>e</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\mathop {\hat\sigma} \nolimits_e^2</annotation></semantics></math>
is the residual variance.</p>
<p><strong>GEIr2</strong> is the coefficient of determination of the
interaction effects,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>r</mo><mi>i</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\mathop r\nolimits_i^2</annotation></semantics></math>,
estimated by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>r</mo><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><msubsup><mo></mo><mi>i</mi><mn>2</mn></msubsup><mrow><msubsup><mo></mo><mi>g</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mo></mo><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mo></mo><mi>e</mi><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\mathop r\nolimits_i^2  = \frac{\mathop {\hat\sigma} \nolimits_i^2}
{\mathop {\hat\sigma} \nolimits_g^2  + \mathop {\hat\sigma} \nolimits_i^2  + \mathop {\hat\sigma} \nolimits_e^2 }
</annotation></semantics></math><strong>Heribatility of means</strong>
is the heribability on the mean basis,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>h</mo><mrow><mi>g</mi><mi>m</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\mathop h\nolimits_{gm}^2</annotation></semantics></math>,
estimated by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>h</mo><mrow><mi>g</mi><mi>m</mi></mrow><mn>2</mn></msubsup><mo>=</mo><mfrac><msubsup><mo></mo><mi>g</mi><mn>2</mn></msubsup><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mo></mo><mi>g</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mo></mo><mi>i</mi><mn>2</mn></msubsup><mi>/</mi><mi>e</mi><mo>+</mo><msubsup><mo></mo><mi>e</mi><mn>2</mn></msubsup><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\mathop h\nolimits_{gm}^2  = \frac{\mathop {\hat\sigma} \nolimits_g^2}{[\mathop {\hat\sigma} \nolimits_g^2  + \mathop {\hat\sigma} \nolimits_i^2 /e + \mathop {\hat\sigma} \nolimits_e^2 /\left( {eb} \right)]}
</annotation></semantics></math></p>
<p>where <em>e</em> and <em>b</em> are the number of environments and
blocks, respectively; <strong>Accuracy</strong> is the accuracy of
selection, <em>Ac</em>, estimated by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>c</mi><mo>=</mo><msqrt><msubsup><mo>h</mo><mrow><mi>g</mi><mi>m</mi></mrow><mn>2</mn></msubsup></msqrt></mrow><annotation encoding="application/x-tex">
Ac = \sqrt{\mathop h\nolimits_{gm}^2}
</annotation></semantics></math></p>
<p><strong>rge</strong> is the genotype-environment correlation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>r</mo><mrow><mi>g</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">\mathop r\nolimits_{ge}</annotation></semantics></math>,
estimated by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>r</mo><mrow><mi>g</mi><mi>e</mi></mrow></msub><mo>=</mo><mfrac><msubsup><mo></mo><mi>g</mi><mn>2</mn></msubsup><mrow><msubsup><mo></mo><mi>g</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mo></mo><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\mathop r\nolimits_{ge} = \frac{\mathop {\hat\sigma} \nolimits_g^2}{\mathop {\hat\sigma} \nolimits_g^2  + \mathop {\hat\sigma} \nolimits_i^2}
</annotation></semantics></math></p>
<p><strong>CVg</strong> and <strong>CVr</strong> are the the genotypic
coefficient of variation and the residual coefficient of variation
estimated, respectively, by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>V</mi><mi>g</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><msubsup><mo></mo><mi>g</mi><mn>2</mn></msubsup></msqrt><mi>/</mi><mi>Œº</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>√ó</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">
CVg  = \left( {\sqrt {\mathop {\hat \sigma }\nolimits_g^2 } /\mu } \right) \times 100
</annotation></semantics></math> and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>V</mi><mi>r</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><msubsup><mo></mo><mi>e</mi><mn>2</mn></msubsup></msqrt><mi>/</mi><mi>Œº</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>√ó</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">
CVr = \left( {\sqrt {\mathop {\hat \sigma }\nolimits_e^2 } /\mu } \right) \times 100
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is the grand mean.</p>
<p><strong>CV ratio</strong> is the ratio between genotypic and residual
coefficient of variation.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">mixed_mod</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: waasb</span></span>
<span><span class="co"># Variable extracted: genpar</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-3f27c09be0c60bb52829" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3f27c09be0c60bb52829">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["Phenotypic variance","Heritability","GEIr2","h2mg","Accuracy","rge","CVg","CVr","CV ratio"],[0.181432000763573,0.1544668207683121,0.3125890817601761,0.8151982143794125,0.9028832783806623,0.3696946369913206,6.25999359129676,11.62778821085492,0.5383649476392124],[5.519135548467292,0.08874427077482952,0.3966789906721892,0.6861830745145414,0.8283616809791128,0.4353102844241984,1.455346471973681,3.504461634710475,0.4152838934114674]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>GY<\/th>\n      <th>HM<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2]},{"name":"Parameters","targets":0},{"name":"GY","targets":1},{"name":"HM","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="blup-for-genotypes">BLUP for genotypes<a class="anchor" aria-label="anchor" href="#blup-for-genotypes"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_table</span><span class="op">(</span><span class="va">mixed_mod</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">BLUPgen</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-416566eb193bf50d04e6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-416566eb193bf50d04e6">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[[1,2,3,4,5,6,7,8,9,10],["G8","G3","G2","G7","G4","G1","G5","G6","G9","G10"],[3.003637504409171,2.955344109347443,2.744146975308642,2.740909329805997,2.641915440917108,2.603676181657848,2.537344479717813,2.534030476190476,2.510191860670194,2.471220873015873],[0.2685228527440556,0.2291541633234151,0.05698663677293678,0.05434731394038614,-0.02635232751631222,-0.05752490338365034,-0.1115983883619132,-0.1142999581198465,-0.133733154925258,-0.165502234473662],[2.942764575848112,2.903395886427472,2.731228359876993,2.728589037044443,2.647889395587744,2.616716819720406,2.562643334742143,2.55994176498421,2.540508568178799,2.508739488630395],[2.776736077262794,2.737367387842153,2.565199861291675,2.562560538459124,2.481860897002426,2.450688321135088,2.396614836156825,2.393913266398892,2.37448006959348,2.342710990045076],[3.10879307443343,3.06942438501279,2.897256858462312,2.894617535629761,2.813917894173063,2.782745318305724,2.728671833327462,2.725970263569528,2.706537066764117,2.674767987215713]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Rank<\/th>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>BLUPg<\/th>\n      <th>Predicted<\/th>\n      <th>LL<\/th>\n      <th>UL<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":0,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[0,2,3,4,5,6]},{"name":"Rank","targets":0},{"name":"GEN","targets":1},{"name":"Y","targets":2},{"name":"BLUPg","targets":3},{"name":"Predicted","targets":4},{"name":"LL","targets":5},{"name":"UL","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render"],"jsHooks":[]}</script><p>The function <code><a href="../reference/get_model_data.html">get_model_data()</a></code> may be used to easily get
the data from a model fitted with the function <code><a href="../reference/gamem_met.html">gamem_met()</a></code>,
especially when more than one variables are used. The following code
return the predicted mean of each genotype for five variables of the
data <code>data_ge2</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">mixed_mod</span>, what <span class="op">=</span> <span class="st">"blupg"</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: waasb</span></span>
<span><span class="co"># Variable extracted: blupg</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 10 √ó 3</span></span></span>
<span><span class="co">#    GEN      GY    HM</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> G1     2.62  47.4</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> G10    2.51  48.4</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> G2     2.73  47.1</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> G3     2.90  47.8</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> G4     2.65  48.0</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> G5     2.56  48.9</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> G6     2.56  48.5</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> G7     2.73  48.0</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> G8     2.94  48.8</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> G9     2.54  48.0</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plotting-the-blup-for-genotypes">Plotting the BLUP for genotypes<a class="anchor" aria-label="anchor" href="#plotting-the-blup-for-genotypes"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_blup.html">plot_blup</a></span><span class="op">(</span><span class="va">mixed_mod</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_blup.html">plot_blup</a></span><span class="op">(</span><span class="va">mixed_mod</span>, </span>
<span>               col.shape  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray20"</span>, <span class="st">"gray80"</span><span class="op">)</span>,</span>
<span>               plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This output shows the predicted means for genotypes.
<strong>BLUPg</strong> is the genotypic effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>g</mi><mo accent="true">ÃÇ</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\hat{g}_{i})</annotation></semantics></math>,
which considering balanced data and genotype as random effect is
estimated by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>g</mi><mo accent="true">ÃÇ</mo></mover><mi>i</mi></msub><mo>=</mo><msubsup><mi>h</mi><mi>g</mi><mn>2</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>y</mi><mo accent="true">‚Äæ</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>‚àí</mo><msub><mover><mi>y</mi><mo accent="true">‚Äæ</mo></mover><mrow><mi>.</mi><mi>.</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\hat{g}_{i} = h_g^2(\bar{y}_{i.}-\bar{y}_{..})
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>h</mi><mi>g</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">h_g^2</annotation></semantics></math>
is the shrinkage effect for genotype. <strong>Predicted</strong> is the
predicted mean estimated by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>g</mi><mo accent="true">ÃÇ</mo></mover><mi>i</mi></msub><mo>+</mo><mi>Œº</mi></mrow><annotation encoding="application/x-tex">
\hat{g}_{i}+\mu
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is the grand mean. <strong>LL</strong> and <strong>UL</strong> are the
lower and upper limits, respectively, estimated by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>g</mi><mo accent="true">ÃÇ</mo></mover><mi>i</mi></msub><mo>+</mo><mi>Œº</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>¬±</mo><mrow><mi>C</mi><mi>I</mi></mrow></mrow><annotation encoding="application/x-tex">
(\hat{g}_{i}+\mu)\pm{CI}
</annotation></semantics></math> with
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>I</mi><mo>=</mo><mi>t</mi><mo>√ó</mo><msqrt><mrow><mo stretchy="false" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>A</mi><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>√ó</mo><mrow><msubsup><mo>œÉ</mo><mi>g</mi><mn>2</mn></msubsup><mo stretchy="false" form="postfix">)</mo></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">
CI = t\times\sqrt{((1-Ac)\times{\mathop \sigma \nolimits_g^2)}}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is the Student‚Äôs <em>t</em> value for a two-tailed <em>t</em> test at a
given probability error;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">Ac</annotation></semantics></math>
is the accuracy of selection and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>œÉ</mo><mi>g</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\mathop \sigma \nolimits_g^2</annotation></semantics></math>
is the genotypic variance.</p>
</div>
<div class="section level4">
<h4 id="blup-for-genotypes-x-environment-combination">BLUP for genotypes X environment combination<a class="anchor" aria-label="anchor" href="#blup-for-genotypes-x-environment-combination"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_table</span><span class="op">(</span><span class="va">mixed_mod</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">BLUPint</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-72cbf064100ce560a04c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-72cbf064100ce560a04c">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14"],["G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10","G1","G1","G1","G2","G2","G2","G3","G3","G3","G4","G4","G4","G5","G5","G5","G6","G6","G6","G7","G7","G7","G8","G8","G8","G9","G9","G9","G10","G10","G10"],["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],[-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662,-0.05752490338365034,-0.05752490338365034,-0.05752490338365034,0.05698663677293678,0.05698663677293678,0.05698663677293678,0.2291541633234151,0.2291541633234151,0.2291541633234151,-0.02635232751631222,-0.02635232751631222,-0.02635232751631222,-0.1115983883619132,-0.1115983883619132,-0.1115983883619132,-0.1142999581198465,-0.1142999581198465,-0.1142999581198465,0.05434731394038614,0.05434731394038614,0.05434731394038614,0.2685228527440556,0.2685228527440556,0.2685228527440556,-0.133733154925258,-0.133733154925258,-0.133733154925258,-0.165502234473662,-0.165502234473662,-0.165502234473662],[-0.06208699665773938,-0.06208699665773938,-0.06208699665773938,0.2066404889653264,0.2066404889653264,0.2066404889653264,0.08847040419349993,0.08847040419349993,0.08847040419349993,0.06008732884107391,0.06008732884107391,0.06008732884107391,-0.1408042450719781,-0.1408042450719781,-0.1408042450719781,-0.06732295321529216,-0.06732295321529216,-0.06732295321529216,0.1266942147911499,0.1266942147911499,0.1266942147911499,0.07023719450353356,0.07023719450353356,0.07023719450353356,-0.03891032103956226,-0.03891032103956226,-0.03891032103956226,-0.2430051153095855,-0.2430051153095855,-0.2430051153095855,-0.0521223533629678,-0.0521223533629678,-0.0521223533629678,-0.003757099713775791,-0.003757099713775791,-0.003757099713775791,0.1269944212383364,0.1269944212383364,0.1269944212383364,0.02325642760543179,0.02325642760543179,0.02325642760543179,0.045766447462979,0.045766447462979,0.045766447462979,0.1437943053269203,0.1437943053269203,0.1437943053269203,-0.3963686856577489,-0.3963686856577489,-0.3963686856577489,-0.002349779114138984,-0.002349779114138984,-0.002349779114138984,0.03101264133605509,0.03101264133605509,0.03101264133605509,0.08377367487890382,0.08377367487890382,0.08377367487890382,0.0468815627522142,0.0468815627522142,0.0468815627522142,0.2852409355419903,0.2852409355419903,0.2852409355419903,-0.1027564630884514,-0.1027564630884514,-0.1027564630884514,-0.1170989621967061,-0.1170989621967061,-0.1170989621967061,-0.1347956605969521,-0.1347956605969521,-0.1347956605969521,-0.3286124234813266,-0.3286124234813266,-0.3286124234813266,-0.01106113914674155,-0.01106113914674155,-0.01106113914674155,-0.1420994219847615,-0.1420994219847615,-0.1420994219847615,0.36689123823543,0.36689123823543,0.36689123823543,0.1374103339653496,0.1374103339653496,0.1374103339653496,-0.07869253920704739,-0.07869253920704739,-0.07869253920704739,-0.01063944756970004,-0.01063944756970004,-0.01063944756970004,0.1463823613596981,0.1463823613596981,0.1463823613596981,-0.221099971682711,-0.221099971682711,-0.221099971682711,-0.1176812906252158,-0.1176812906252158,-0.1176812906252158,-0.1004260665801102,-0.1004260665801102,-0.1004260665801102,-0.4531412009643889,-0.4531412009643889,-0.4531412009643889,0.1236857532269891,0.1236857532269891,0.1236857532269891,0.2262308495396967,0.2262308495396967,0.2262308495396967,0.485381552502805,0.485381552502805,0.485381552502805,0.20248255978656,0.20248255978656,0.20248255978656,-0.08930274383452808,-0.08930274383452808,-0.08930274383452808,-0.00828906800532447,-0.00828906800532447,-0.00828906800532447,-0.06474652596485593,-0.06474652596485593,-0.06474652596485593,-0.2103546199491036,-0.2103546199491036,-0.2103546199491036,-0.14491641931797,-0.14491641931797,-0.14491641931797,0.05296540623958334,0.05296540623958334,0.05296540623958334,0.4036671489756978,0.4036671489756978,0.4036671489756978,0.1003665243462433,0.1003665243462433,0.1003665243462433,-0.2418722622763035,-0.2418722622763035,-0.2418722622763035,0.1296921669817023,0.1296921669817023,0.1296921669817023,-0.1140505957292282,-0.1140505957292282,-0.1140505957292282,0.05888389776471695,0.05888389776471695,0.05888389776471695,0.04101476284985067,0.04101476284985067,0.04101476284985067,-0.07542773813552149,-0.07542773813552149,-0.07542773813552149,-0.1360431517259771,-0.1360431517259771,-0.1360431517259771,-0.03293966347111144,-0.03293966347111144,-0.03293966347111144,-0.01505630302904429,-0.01505630302904429,-0.01505630302904429,0.1521104584623592,0.1521104584623592,0.1521104584623592,-0.008183833967744204,-0.008183833967744204,-0.008183833967744204,-0.02135487264044292,-0.02135487264044292,-0.02135487264044292,-0.03714565803610538,-0.03714565803610538,-0.03714565803610538,-0.03794111633077444,-0.03794111633077444,-0.03794111633077444,0.01169601309594468,0.01169601309594468,0.01169601309594468,-0.140616782337426,-0.140616782337426,-0.140616782337426,-0.07448096906079706,-0.07448096906079706,-0.07448096906079706,0.3236410334487858,0.3236410334487858,0.3236410334487858,0.002780791124402685,0.002780791124402685,0.002780791124402685,-0.2945308501977524,-0.2945308501977524,-0.2945308501977524,0.2679524109341593,0.2679524109341593,0.2679524109341593,-0.1319364192305265,-0.1319364192305265,-0.1319364192305265,-0.3494621870990158,-0.3494621870990158,-0.3494621870990158,0.05412837894664679,0.05412837894664679,0.05412837894664679,-0.1335406342602921,-0.1335406342602921,-0.1335406342602921,0.1808012537785919,0.1808012537785919,0.1808012537785919,0.07479654168560856,0.07479654168560856,0.07479654168560856,-0.00467996717310259,-0.00467996717310259,-0.00467996717310259,0.04715568589937198,0.04715568589937198,0.04715568589937198,0.05267925263382908,0.05267925263382908,0.05267925263382908,0.2100580948189104,0.2100580948189104,0.2100580948189104,-0.1373505215415742,-0.1373505215415742,-0.1373505215415742,0.1592455737868468,0.1592455737868468,0.1592455737868468,0.005045236442934917,0.005045236442934917,0.005045236442934917,0.4427812367496345,0.4427812367496345,0.4427812367496345,0.22614449347285,0.22614449347285,0.22614449347285,0.06208372020676144,0.06208372020676144,0.06208372020676144,0.01852481624515104,0.01852481624515104,0.01852481624515104,-0.3169796238270887,-0.3169796238270887,-0.3169796238270887,-0.624578335845851,-0.624578335845851,-0.624578335845851,0.1650834043103523,0.1650834043103523,0.1650834043103523,0.1211168056519086,0.1211168056519086,0.1211168056519086,0.04135489343259251,0.04135489343259251,0.04135489343259251,-0.0431271602356757,-0.0431271602356757,-0.0431271602356757,0.01179378277611918,0.01179378277611918,0.01179378277611918,0.04860155564525272,0.04860155564525272,0.04860155564525272,0.09388267105512303,0.09388267105512303,0.09388267105512303,0.1353918905565318,0.1353918905565318,0.1353918905565318,0.08361506235030587,0.08361506235030587,0.08361506235030587,-0.190741958409172,-0.190741958409172,-0.190741958409172,-0.3018875428229901,-0.3018875428229901,-0.3018875428229901,0.0286466672285594,0.0286466672285594,0.0286466672285594,0.04174469689659267,0.04174469689659267,0.04174469689659267,-0.01893256507704649,-0.01893256507704649,-0.01893256507704649,0.01790948881380979,0.01790948881380979,0.01790948881380979,0.04399660370904093,0.04399660370904093,0.04399660370904093,0.1573041622419722,0.1573041622419722,0.1573041622419722,-0.037160117640944,-0.037160117640944,-0.037160117640944,0.02974269331753241,0.02974269331753241,0.02974269331753241,-0.06962785420812673,-0.06962785420812673,-0.06962785420812673,-0.1936237752813845,-0.1936237752813845,-0.1936237752813845,-0.1330437750018485,-0.1330437750018485,-0.1330437750018485,0.209036475885951,0.209036475885951,0.209036475885951,-0.04674356781625597,-0.04674356781625597,-0.04674356781625597,-0.03495904852686761,-0.03495904852686761,-0.03495904852686761,0.1224795062547959,0.1224795062547959,0.1224795062547959,-0.06921182879970081,-0.06921182879970081,-0.06921182879970081,0.1841279192078058,0.1841279192078058,0.1841279192078058,0.07840584341010541,0.07840584341010541,0.07840584341010541,-0.04173013401345749,-0.04173013401345749,-0.04173013401345749,-0.2683613906005167,-0.2683613906005167,-0.2683613906005167,0.09319148638327245,0.09319148638327245,0.09319148638327245,0.03933602038458608,0.03933602038458608,0.03933602038458608,0.2106488911638843,0.2106488911638843,0.2106488911638843,-0.1578528600413734,-0.1578528600413734,-0.1578528600413734,-0.146612252135583,-0.146612252135583,-0.146612252135583,0.07417897894974804,0.07417897894974804,0.07417897894974804,0.1401898155957882,0.1401898155957882,0.1401898155957882,0.2179551371559233,0.2179551371559233,0.2179551371559233,0.1114140258886518,0.1114140258886518,0.1114140258886518,-0.5824492433448961,-0.5824492433448961,-0.5824492433448961,-0.1218348983834684,-0.1218348983834684,-0.1218348983834684,-0.2629194969113134,-0.2629194969113134,-0.2629194969113134,0.03096758401251471,0.03096758401251471,0.03096758401251471,0.06743068199325906,0.06743068199325906,0.06743068199325906,0.07266498829091397,0.07266498829091397,0.07266498829091397,0.08366862061240599,0.08366862061240599,0.08366862061240599,0.06379642902154192,0.06379642902154192,0.06379642902154192,-0.03735991291938431,-0.03735991291938431,-0.03735991291938431,-0.05121662689414422,-0.05121662689414422,-0.05121662689414422,0.1548026311776844,0.1548026311776844,0.1548026311776844],[-0.1196119000413897,-0.1196119000413897,-0.1196119000413897,0.2636271257382632,0.2636271257382632,0.2636271257382632,0.317624567516915,0.317624567516915,0.317624567516915,0.03373500132476169,0.03373500132476169,0.03373500132476169,-0.2524026334338912,-0.2524026334338912,-0.2524026334338912,-0.1816229113351386,-0.1816229113351386,-0.1816229113351386,0.1810415287315361,0.1810415287315361,0.1810415287315361,0.3387600472475891,0.3387600472475891,0.3387600472475891,-0.1726434759648203,-0.1726434759648203,-0.1726434759648203,-0.4085073497832474,-0.4085073497832474,-0.4085073497832474,-0.1096472567466181,-0.1096472567466181,-0.1096472567466181,0.05322953705916099,0.05322953705916099,0.05322953705916099,0.3561485845617515,0.3561485845617515,0.3561485845617515,-0.003095899910880429,-0.003095899910880429,-0.003095899910880429,-0.06583194089893421,-0.06583194089893421,-0.06583194089893421,0.02949434720707385,0.02949434720707385,0.02949434720707385,-0.3420213717173627,-0.3420213717173627,-0.3420213717173627,0.2661730736299166,0.2661730736299166,0.2661730736299166,-0.1027205135892029,-0.1027205135892029,-0.1027205135892029,-0.08172855959475815,-0.08172855959475815,-0.08172855959475815,-0.01064334063143615,-0.01064334063143615,-0.01064334063143615,0.3422275723149271,0.3422275723149271,0.3422275723149271,0.1263977002349636,0.1263977002349636,0.1263977002349636,-0.1434512897130183,-0.1434512897130183,-0.1434512897130183,-0.2463940489588653,-0.2463940489588653,-0.2463940489588653,-0.4429123816011731,-0.4429123816011731,-0.4429123816011731,0.04328617479364459,0.04328617479364459,0.04328617479364459,0.126423430759294,0.126423430759294,0.126423430759294,0.233158083310172,0.233158083310172,0.233158083310172,-0.02809190050831234,-0.02809190050831234,-0.02809190050831234,-0.1362174425906977,-0.1362174425906977,-0.1362174425906977,0.04634718920323673,0.04634718920323673,0.04634718920323673,0.3755365246831132,0.3755365246831132,0.3755365246831132,-0.2474522991990232,-0.2474522991990232,-0.2474522991990232,-0.229279678987129,-0.229279678987129,-0.229279678987129,-0.2147260246999567,-0.2147260246999567,-0.2147260246999567,-0.3987938870240028,-0.3987938870240028,-0.3987938870240028,0.3922086059710447,0.3922086059710447,0.3922086059710447,0.09249769461443871,0.09249769461443871,0.09249769461443871,0.319879318029143,0.319879318029143,0.319879318029143,0.1449576564029097,0.1449576564029097,0.1449576564029097,-0.0323161070615913,-0.0323161070615913,-0.0323161070615913,0.2208650953180906,0.2208650953180906,0.2208650953180906,-0.09109885348116814,-0.09109885348116814,-0.09109885348116814,-0.3219530083110168,-0.3219530083110168,-0.3219530083110168,-0.2592163774378165,-0.2592163774378165,-0.2592163774378165,0.1073127201799695,0.1073127201799695,0.1073127201799695,0.6721900017197534,0.6721900017197534,0.6721900017197534,-0.03336663057901468,-0.03336663057901468,-0.03336663057901468,-0.4073744967499654,-0.4073744967499654,-0.4073744967499654,0.07216726359805195,0.07216726359805195,0.07216726359805195,-0.05706395895629139,-0.05706395895629139,-0.05706395895629139,0.288038061088132,0.288038061088132,0.288038061088132,0.01466243533353845,0.01466243533353845,0.01466243533353845,-0.1870261264974347,-0.1870261264974347,-0.1870261264974347,-0.2503431098458235,-0.2503431098458235,-0.2503431098458235,0.0214076504692747,0.0214076504692747,0.0214076504692747,0.2534665497150113,0.2534665497150113,0.2534665497150113,0.01837730353710115,0.01837730353710115,0.01837730353710115,-0.1736860684414062,-0.1736860684414062,-0.1736860684414062,-0.07887977602409327,-0.07887977602409327,-0.07887977602409327,0.0198409787368314,0.0198409787368314,0.0198409787368314,0.1912130469926406,0.1912130469926406,0.1912130469926406,-0.01465631442036754,-0.01465631442036754,-0.01465631442036754,-0.2522151706993392,-0.2522151706993392,-0.2522151706993392,-0.1887809271806435,-0.1887809271806435,-0.1887809271806435,0.377988347389172,0.377988347389172,0.377988347389172,0.2713036438684582,0.2713036438684582,0.2713036438684582,-0.4282640051230104,-0.4282640051230104,-0.4282640051230104,0.1024501764604974,0.1024501764604974,0.1024501764604974,-0.1894613226141769,-0.1894613226141769,-0.1894613226141769,-0.292475550326079,-0.292475550326079,-0.292475550326079,0.2832825422700618,0.2832825422700618,0.2832825422700618,-0.1598929617766044,-0.1598929617766044,-0.1598929617766044,0.06920286541667864,0.06920286541667864,0.06920286541667864,-0.03950341643423792,-0.03950341643423792,-0.03950341643423792,0.04966734676728355,0.04966734676728355,0.04966734676728355,0.3156785386434275,0.3156785386434275,0.3156785386434275,-0.08105390229142892,-0.08105390229142892,-0.08105390229142892,0.04455586034524842,0.04455586034524842,0.04455586034524842,-0.1948754249252245,-0.1948754249252245,-0.1948754249252245,0.2162322105597835,0.2162322105597835,0.2162322105597835,0.23419939976635,0.23419939976635,0.23419939976635,0.4164289092333223,0.4164289092333223,0.4164289092333223,0.1145461051109367,0.1145461051109367,0.1145461051109367,-0.05221623791308504,-0.05221623791308504,-0.05221623791308504,0.07287213018553718,0.07287213018553718,0.07287213018553718,-0.04845677108303315,-0.04845677108303315,-0.04845677108303315,-0.758311490771109,-0.758311490771109,-0.758311490771109,-0.0004188301633096803,-0.0004188301633096803,-0.0004188301633096803,0.06359190226825828,0.06359190226825828,0.06359190226825828,0.09834153020552928,0.09834153020552928,0.09834153020552928,0.1860270030877394,0.1860270030877394,0.1860270030877394,-0.01455854474019303,-0.01455854474019303,-0.01455854474019303,-0.0629968327166605,-0.0629968327166605,-0.0629968327166605,-0.02041728706472346,-0.02041728706472346,-0.02041728706472346,0.1897392044969179,0.1897392044969179,0.1897392044969179,0.3521379150943614,0.3521379150943614,0.3521379150943614,-0.32447511333443,-0.32447511333443,-0.32447511333443,-0.467389777296652,-0.467389777296652,-0.467389777296652,-0.02887823615509094,-0.02887823615509094,-0.02887823615509094,0.09873133366952944,0.09873133366952944,0.09873133366952944,0.2102215982463686,0.2102215982463686,0.2102215982463686,-0.008442838702502429,-0.008442838702502429,-0.008442838702502429,-0.06760178465287228,-0.06760178465287228,-0.06760178465287228,0.04300420412212576,0.04300420412212576,0.04300420412212576,0.01718719629944214,0.01718719629944214,0.01718719629944214,0.298265546061588,0.298265546061588,0.298265546061588,-0.2033610091333847,-0.2033610091333847,-0.2033610091333847,-0.3591260097550465,-0.3591260097550465,-0.3591260097550465,-0.1905686783854989,-0.1905686783854989,-0.1905686783854989,0.2660231126588878,0.2660231126588878,0.2660231126588878,0.1824105955071591,0.1824105955071591,0.1824105955071591,-0.06131137604317983,-0.06131137604317983,-0.06131137604317983,0.01088111789288272,0.01088111789288272,0.01088111789288272,-0.1835117869195473,-0.1835117869195473,-0.1835117869195473,0.2384752331481919,0.2384752331481919,0.2384752331481919,0.346928696154161,0.346928696154161,0.346928696154161,-0.1754632889387155,-0.1754632889387155,-0.1754632889387155,-0.4338636250741787,-0.4338636250741787,-0.4338636250741787,0.0356665829996221,0.0356665829996221,0.0356665829996221,0.09632265715752286,0.09632265715752286,0.09632265715752286,0.4398030544872993,0.4398030544872993,0.4398030544872993,-0.1842051875576857,-0.1842051875576857,-0.1842051875576857,-0.2582106404974963,-0.2582106404974963,-0.2582106404974963,-0.04012097917009845,-0.04012097917009845,-0.04012097917009845,0.1945371295361744,0.1945371295361744,0.1945371295361744,0.4864779898999789,0.4864779898999789,0.4864779898999789,-0.02231912903660624,-0.02231912903660624,-0.02231912903660624,-0.7479514778185581,-0.7479514778185581,-0.7479514778185581,-0.1793598017671188,-0.1793598017671188,-0.1793598017671188,-0.2059328601383767,-0.2059328601383767,-0.2059328601383767,0.2601217473359298,0.2601217473359298,0.2601217473359298,0.04107835447694685,0.04107835447694685,0.04107835447694685,-0.03893340007099924,-0.03893340007099924,-0.03893340007099924,-0.0306313375074405,-0.0306313375074405,-0.0306313375074405,0.1181437429619281,0.1181437429619281,0.1181437429619281,0.2311629398246713,0.2311629398246713,0.2311629398246713,-0.1849497818194022,-0.1849497818194022,-0.1849497818194022,-0.01069960329597758,-0.01069960329597758,-0.01069960329597758],[2.457508099958481,2.437144099958552,2.308562099958552,2.840747125738134,2.820383125738205,2.691801125738206,2.894744567516786,2.874380567516857,2.745798567516857,2.610855001324633,2.590491001324704,2.461909001324704,2.32471736656598,2.304353366566051,2.175771366566051,2.395497088664732,2.375133088664803,2.246551088664804,2.758161528731407,2.737797528731478,2.609215528731478,2.91588004724746,2.895516047247531,2.766934047247531,2.404476524035051,2.384112524035122,2.255530524035122,2.168612650216624,2.148248650216694,2.019666650216695,2.765999743253369,3.241820743253367,3.203114743253368,2.928876537059148,3.404697537059147,3.365991537059147,3.231795584561739,3.707616584561737,3.668910584561737,2.872551100089106,3.348372100089105,3.309666100089105,2.809815059101053,3.285636059101051,3.246930059101051,2.905141347207061,3.380962347207059,3.342256347207059,2.533625628282624,3.009446628282623,2.970740628282623,3.141820073629904,3.617641073629902,3.578935073629902,2.772926486410784,3.248747486410783,3.210041486410783,2.793918440405229,3.269739440405227,3.231033440405227,4.304956659368537,3.889156659368545,3.966956659368544,4.657827572314901,4.242027572314909,4.319827572314908,4.441997700234936,4.026197700234944,4.103997700234943,4.172148710286955,3.756348710286963,3.834148710286962,4.069205951041108,3.653405951041116,3.731205951041115,3.8726876183988,3.456887618398808,3.534687618398807,4.358886174793618,3.943086174793626,4.020886174793625,4.442023430759267,4.026223430759275,4.104023430759274,4.548758083310145,4.132958083310153,4.210758083310152,4.287508099491661,3.871708099491669,3.949508099491668,3.613754557409286,3.588082557409285,3.415328557409285,3.796319189203221,3.770647189203219,3.597893189203219,4.125508524683097,4.099836524683096,3.927082524683096,3.502519700800961,3.476847700800959,3.304093700800959,3.520692321012855,3.495020321012854,3.322266321012854,3.535245975300028,3.509573975300026,3.336819975300026,3.351178112975981,3.32550611297598,3.15275211297598,4.142180605971029,4.116508605971028,3.943754605971027,3.842469694614423,3.816797694614421,3.644043694614421,4.069851318029127,4.044179318029125,3.871425318029126,4.050157656402894,4.205957656402894,3.910257656402895,3.872883892938393,4.028683892938393,3.732983892938394,4.126065095318075,4.281865095318075,3.986165095318076,3.814101146518817,3.969901146518817,3.674201146518817,3.583246991688968,3.739046991688968,3.443346991688968,3.645983622562168,3.801783622562168,3.506083622562169,4.012512720179954,4.168312720179954,3.872612720179955,4.577390001719738,4.733190001719739,4.437490001719739,3.87183336942097,4.02763336942097,3.73193336942097,3.497825503250019,3.653625503250019,3.35792550325002,2.879267263598038,2.684830226561,2.642045041375815,2.750036041043694,2.555599004006656,2.512813818821471,3.095138061088118,2.90070102405108,2.857915838865895,2.821762435333524,2.627325398296486,2.584540213111301,2.620073873502551,2.425636836465513,2.382851651280328,2.556756890154162,2.362319853117124,2.319534667931939,2.828507650469261,2.634070613432222,2.591285428247037,3.060566549714997,2.866129512677959,2.823344327492774,2.825477303537087,2.631040266500049,2.588255081314864,2.63341393155858,2.438976894521541,2.396191709336356,1.718802223975894,1.902296223975891,2.108950223975892,1.817522978736819,2.001016978736816,2.207670978736816,1.988895046992628,2.172389046992625,2.379043046992626,1.78302568557962,1.966519685579617,2.173173685579617,1.545466829300648,1.728960829300646,1.935614829300646,1.608901072819344,1.792395072819341,1.999049072819341,2.175670347389159,2.359164347389157,2.565818347389157,2.068985643868445,2.252479643868443,2.459133643868443,1.369417994876977,1.552911994876974,1.759565994876974,1.900132176460485,2.083626176460482,2.290280176460482,2.025985677385804,2.440814677385806,2.573942677385806,1.922971449673902,2.337800449673904,2.470928449673904,2.498729542270043,2.913558542270045,3.046686542270045,2.055554038223376,2.470383038223378,2.603511038223378,2.284649865416659,2.699478865416661,2.832606865416661,2.175943583565743,2.590772583565744,2.723900583565745,2.265114346767264,2.679943346767266,2.813071346767266,2.531125538643408,2.94595453864341,3.07908253864341,2.134393097708552,2.549222097708554,2.682350097708554,2.260002860345229,2.674831860345231,2.807959860345231,2.938824575074758,3.055124575074759,2.591224575074758,3.349932210559766,3.466232210559767,3.002332210559767,3.367899399766332,3.484199399766333,3.020299399766333,3.550128909233305,3.666428909233305,3.202528909233305,3.248246105110919,3.36454610511092,2.90064610511092,3.081483762086898,3.197783762086898,2.733883762086898,3.20657213018552,3.32287213018552,2.85897213018552,3.085243228916949,3.20154322891695,2.73764322891695,2.375388509228873,2.491688509228874,2.027788509228874,3.133281169836673,3.249581169836674,2.785681169836673,2.378955902268245,2.393745902268243,1.943701902268243,2.413705530205517,2.428495530205514,1.978451530205514,2.501391003087727,2.516181003087725,2.066137003087724,2.300805455259794,2.315595455259792,1.865551455259792,2.252367167283327,2.267157167283325,1.817113167283324,2.294946712935264,2.309736712935262,1.859692712935261,2.505103204496905,2.519893204496903,2.069849204496903,2.667501915094349,2.682291915094347,2.232247915094346,1.990888886665557,2.005678886665555,1.555634886665555,1.847974222703335,1.862764222703333,1.412720222703333,1.340539763844893,1.533051763844893,1.144567763844893,1.468149333669513,1.660661333669514,1.272177333669514,1.579639598246352,1.772151598246353,1.383667598246353,1.360975161297481,1.553487161297482,1.165003161297482,1.301816215347112,1.494328215347112,1.105844215347112,1.41242220412211,1.60493420412211,1.21645020412211,1.386605196299426,1.579117196299426,1.190633196299427,1.667683546061572,1.860195546061572,1.471711546061572,1.166056990866599,1.358568990866599,0.9700849908665997,1.010291990244937,1.202803990244937,0.814319990244938,1.361768358651521,1.528631321614484,1.363431321614484,1.818360149695908,1.985223112658871,1.820023112658871,1.73474763254418,1.901610595507142,1.736410595507142,1.491025660993841,1.657888623956803,1.492688623956803,1.563218154929903,1.730081117892866,1.564881117892866,1.368825250117473,1.535688213080436,1.370488213080436,1.790812270185212,1.957675233148175,1.792475233148175,1.899265733191181,2.066128696154144,1.900928696154144,1.376873748098305,1.543736711061267,1.378536711061268,1.118473411962842,1.285336374925804,1.120136374925804,2.98587028670331,3.005255471888495,2.844766582999606,3.046526360861211,3.065911546046396,2.905422657157507,3.390006758190988,3.409391943376173,3.248903054487284,2.765998516146003,2.785383701331187,2.624894812442299,2.691993063206192,2.711378248391377,2.550889359502488,2.91008272453359,2.929467909718775,2.768979020829886,3.144740833239863,3.164126018425047,3.003637129536159,3.436681693603667,3.456066878788852,3.295577989899964,2.927884574667082,2.947269759852267,2.786780870963378,2.20225222588513,2.221637411070315,2.061148522181426,1.661240198232864,1.661392050084717,1.485088346381013,1.634667139861606,1.634818991713459,1.458515288009755,2.100721747335913,2.100873599187766,1.924569895484062,1.88167835447693,1.881830206328783,1.705526502625079,1.801666599928984,1.801818451780836,1.625514748077133,1.809968662492543,1.810120514344395,1.633816810640691,1.958743742961911,1.958895594813764,1.78259189111006,2.071762939824654,2.071914791676507,1.895611087972803,1.655650218180581,1.655802070032434,1.47949836632873,1.829900396704006,1.830052248555858,1.653748544852154]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ENV<\/th>\n      <th>GEN<\/th>\n      <th>REP<\/th>\n      <th>BLUPg<\/th>\n      <th>BLUPge<\/th>\n      <th>BLUPg+ge<\/th>\n      <th>Predicted<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[3,4,5,6]},{"name":"ENV","targets":0},{"name":"GEN","targets":1},{"name":"REP","targets":2},{"name":"BLUPg","targets":3},{"name":"BLUPge","targets":4},{"name":"BLUPg+ge","targets":5},{"name":"Predicted","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script><p>This output shows the predicted means for each genotype and
environment combination. <strong>BLUPg</strong> is the genotypic effect
described above. <strong>BLUPge</strong> is the genotypic effect of the
<em>i</em>th genotype in the <em>j</em>th environment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>g</mi><mo accent="true">ÃÇ</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\hat{g}_{ij})</annotation></semantics></math>,
which considering balanced data and genotype as random effect is
estimated by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>g</mi><mo accent="true">ÃÇ</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msubsup><mi>h</mi><mi>g</mi><mn>2</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>y</mi><mo accent="true">‚Äæ</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>‚àí</mo><msub><mover><mi>y</mi><mo accent="true">‚Äæ</mo></mover><mrow><mi>.</mi><mi>.</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>h</mi><mrow><mi>g</mi><mi>e</mi></mrow><mn>2</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>‚àí</mo><msub><mover><mi>y</mi><mo accent="true">‚Äæ</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>‚àí</mo><msub><mover><mi>y</mi><mo accent="true">‚Äæ</mo></mover><mrow><mi>.</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mover><mi>y</mi><mo accent="true">‚Äæ</mo></mover><mrow><mi>.</mi><mi>.</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{g}_{ij} = h_g^2(\bar{y}_{i.}-\bar{y}_{..})+h_{ge}^2(y_{ij}-\bar{y}_{i.}-\bar{y}_{.j}+\bar{y}_{..})</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>h</mi><mrow><mi>g</mi><mi>e</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">h_{ge}^2</annotation></semantics></math>
is the shrinkage effect for the genotype-by-environment interaction;
<strong>BLUPg+ge</strong> is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>L</mi><mi>U</mi><msub><mi>P</mi><mi>g</mi></msub><mo>+</mo><mi>B</mi><mi>L</mi><mi>U</mi><msub><mi>P</mi><mrow><mi>g</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">BLUP_g+BLUP_{ge}</annotation></semantics></math>;
<strong>Predicted</strong> is the predicted mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>y</mi><mo accent="true">ÃÇ</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\hat{y}_{ij}</annotation></semantics></math>)
estimated by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>y</mi><mo accent="true">ÃÇ</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover><mi>y</mi><mo accent="true">‚Äæ</mo></mover><mrow><mi>.</mi><mi>j</mi></mrow></msub><mo>+</mo><mi>B</mi><mi>L</mi><mi>U</mi><msub><mi>P</mi><mrow><mi>g</mi><mo>+</mo><mi>g</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\hat{y}_{ij} = \bar{y}_{.j}+BLUP_{g+ge}
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="some-useful-information">Some useful information<a class="anchor" aria-label="anchor" href="#some-useful-information"></a>
</h4>
<p>The following pieces of information are provided in
<code>Details</code> output. <strong>Nenv</strong>, the number of
environments in the analysis; <strong>Ngen</strong> the number of
genotypes in the analysis; <strong>mresp</strong> The value attributed
to the highest value of the response variable after rescaling it;
<strong>wresp</strong> The weight of the response variable for
estimating the WAASBY index. <strong>Mean</strong> the grand mean;
<strong>SE</strong> the standard error of the mean; <strong>SD</strong>
the standard deviation. <strong>CV</strong> the coefficient of variation
of the phenotypic means, estimating WAASB, <strong>Min</strong> the
minimum value observed (returning the genotype and environment),
<strong>Max</strong> the maximum value observed (returning the genotype
and environment); <strong>MinENV</strong> the environment with the lower
mean, <strong>MaxENV</strong> the environment with the larger mean
observed, <strong>MinGEN</strong> the genotype with the lower mean,
<strong>MaxGEN</strong> the genotype with the larger.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">mixed_mod</span>, <span class="st">"details"</span><span class="op">)</span></span>
<span><span class="co"># Class of the model: waasb</span></span>
<span><span class="co"># Variable extracted: details</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-d11fc4360aa0230696d7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d11fc4360aa0230696d7">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["Mean","SE","SD","CV","Min","Max","MinENV","MaxENV","MinGEN","MaxGEN","Ngen","Nenv"],["2.67","0.05","0.92","34.56","0.67 (G10 in E11)","5.09 (G8 in E5)","E11 (1.37)","E3 (4.06)","G10 (2.47) ","G8 (3) ","10","14"],["48.09","0.21","4.37","9.09","38 (G2 in E14)","58 (G8 in E11)","E14 (41.03)","E11 (54.2)","G2 (46.66) ","G5 (49.3) ","10","14"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Parameters<\/th>\n      <th>GY<\/th>\n      <th>HM<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"name":"Parameters","targets":0},{"name":"GY","targets":1},{"name":"HM","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level3">
<h3 id="the-waasb-object">The WAASB object<a class="anchor" aria-label="anchor" href="#the-waasb-object"></a>
</h3>
<p>The function <code><a href="../reference/waasb.html">waasb()</a></code> function computes the Weighted
Average of the Absolute Scores considering all possible IPCA from the
Singular Value Decomposition of the BLUPs for genotype-vs-environment
interaction effects obtained by an Linear Mixed-effect Model <span class="citation">(<a href="#ref-Olivoto2019">Olivoto et al.
2019</a>)</span>, as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>A</mi><mi>A</mi><mi>S</mi><msub><mi>B</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mrow><mo stretchy="true" form="prefix">|</mo><mi>I</mi><mi>P</mi><mi>C</mi><msub><mi>A</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>√ó</mo><mi>E</mi><msub><mi>P</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mi>/</mi><munderover><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mi>E</mi><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">
        WAASB_i  = 
        \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k = 1}^{p}EP_k
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>A</mi><mi>A</mi><mi>S</mi><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">WAASB_i</annotation></semantics></math>
is the weighted average of absolute scores of the <em>i</em>th genotype;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>P</mi><mi>C</mi><msub><mi>A</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">IPCA_{ik}</annotation></semantics></math>
is the scores of the <em>i</em>th genotype in the <em>k</em>th IPCA; and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">EP_k</annotation></semantics></math>
is the explained variance of the <em>k</em>th PCA for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mo>,</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">k = 1,2,..,p</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mo>‚àí</mo><mn>1</mn><mo>;</mo><mi>e</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p = min(g-1; e-1)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">waasb_model</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/waasb.html">waasb</a></span><span class="op">(</span><span class="va">data_ge</span>,</span>
<span>        env <span class="op">=</span> <span class="va">ENV</span>,</span>
<span>        gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span>        rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span>        resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        random <span class="op">=</span> <span class="st">"gen"</span>, <span class="co">#Default</span></span>
<span>        verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#Default</span></span>
<span><span class="co"># Evaluating trait GY |======================                      | 50% 00:00:01 Evaluating trait HM |============================================| 100% 00:00:02 </span></span>
<span><span class="co"># Method: REML/BLUP</span></span>
<span><span class="co"># Random effects: GEN, GEN:ENV</span></span>
<span><span class="co"># Fixed effects: ENV, REP(ENV)</span></span>
<span><span class="co"># Denominador DF: Satterthwaite's method</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     model       GY       HM</span></span>
<span><span class="co">#  COMPLETE       NA       NA</span></span>
<span><span class="co">#       GEN 1.11e-05 5.07e-03</span></span>
<span><span class="co">#   GEN:ENV 2.15e-11 2.27e-15</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">waasb_model</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">model</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-21c7483268bafca56cec" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-21c7483268bafca56cec">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV"],["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","E1","E10","E11","E12","E13","E14","E2","E3","E4","E5","E6","E7","E8","E9"],[2.603676181657848,2.471220873015873,2.744146975308642,2.955344109347443,2.641915440917108,2.537344479717813,2.534030476190476,2.740909329805997,3.003637504409171,2.510191860670194,2.520683333333333,2.175209333333333,1.368264666666667,1.608512345679012,2.909630864197531,1.781933333333333,3.179959,4.064333333333334,3.675272666666667,3.9105,2.663213580246913,1.988896,2.536375666666667,3.0566],[0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2352804553410876,0.2153628801302379,0.1004496348222608,0.21055417439975,0.6132162243858651,-0.2013994713453189,-0.1591916863400819,0.0645996602261778,-0.2529186818639979,0.4344998486732777,0.06900709445843989,-0.1722746636838427,-0.1876880846520825,-0.5372627076353238],[-0.04816098517185899,-0.4208722786446949,0.1539501352066167,-0.07925517687190937,0.3928214451437436,0.2061267530012323,0.1954274327487481,0.4580151354173185,-0.1662078850485946,-0.6918445757805567,0.1592122924207069,0.2965022690848288,0.1388157342740876,0.2183582884944772,0.08891115930149805,0.0228057064599316,-0.1717646521412762,-0.3285867321871045,-0.628267373227232,-0.1123949241121396,-0.1455184850775834,0.170737745883481,-0.1612636166478489,0.5921825978588067],[-0.03137240783689807,-0.1280065156341047,-0.5848990354693586,0.18737223350425,-0.07226137028172352,0.1931594814240976,0.4448246391114866,-0.1662881029769637,0.2592241156817204,-0.1017530375226345,-0.1778205005596572,0.09651734660625727,0.1270940887624751,-0.1393536887605435,0.1702675786883022,0.2362771949042595,0.2028859808433778,-0.5961043581761886,0.009397805074752777,0.08172675657760776,-0.02328023996842923,-0.1395283678886783,0.3746058414285418,-0.1235010537878417],[-0.05134534025620319,-0.2660607848342432,0.3762627939364287,0.1383792503739817,0.112815771972172,0.1454579797099744,0.1920259511704144,-0.5648923020839328,-0.136372462121406,0.05372914213286398,0.07431194215638343,0.01857328055018487,0.1780850641536159,0.05275056927466132,0.1027322988863684,-0.199884672289975,0.4017580227469899,0.005514011672064626,0.1255948287313621,-0.1953515319602994,-0.06643167019479933,-0.4986644736515758,-0.2300153283015429,0.1823719835347166],[-0.1459575848301794,-0.1162045845443323,-0.08101842032668966,-0.1754212756983504,-0.1130338955122945,0.3650365870664545,0.06849336521053523,0.1724613799318361,-0.3097997416247741,0.335444170327675,-0.1533805135157208,-0.04788719742361436,0.008867649447161856,0.1718801534507716,-0.04906744567573126,0.09909513415937825,-0.1244858695966867,0.1709258571708859,-0.2931185352510027,-0.334861819234841,-0.02287473596281681,-0.2601436869596135,0.2215043777982422,-0.1827892753204963],[-0.418772802003137,0.05745834020816745,0.2017642602974813,0.1545257958087508,-0.2788961336148435,0.05456022188508901,0.03531055128642788,0.1032394832633742,0.1753116055601534,-0.08450132269123185,0.1852998261187876,-0.05070842510778874,-0.01980519514912012,0.3357902948785366,0.1335153154723338,0.01105080881009938,0.007067144518729234,-0.03590270104184861,0.2375568668702319,-0.1304784753510524,-0.2887803119190772,0.1503633628266627,0.1558543154843235,-0.0265531124314258],[0.1168316032410299,0.0479717778733852,0.0975222581340454,-0.3702226215199364,-0.1263092469337024,0.186518433548406,0.0179992449370971,-0.09300667387686273,0.2218235142271516,-0.09912828963093995,-0.2094840238745367,0.1912587995084151,0.1097496592853372,0.1411145184243538,-0.2595744705767377,-0.1653714663799888,-0.02843094180508592,-0.01848125937699862,0.03620834958001263,0.1685725370695896,-0.1963042894423964,-0.03039639535385081,-0.006567954380769076,-0.06121495071326428],[-0.140024766266872,-0.06228295821034549,-0.08373445400076183,0.02938609150162764,0.2235086778617943,0.1779656993910749,-0.3019240824230788,-0.05586575752683322,0.1706794053570137,0.04229214431657657,0.08853658393121974,-0.08945183711827565,-0.115274267642853,0.2211602756830449,-0.09893587446471461,0.08807637181572778,-0.003740348193592941,-0.004582633056240256,0.008119320739804715,0.235007198788565,0.1517779156209672,-0.175023760516937,0.1113736770094829,0.1455982799031816],[-0.1655979418777871,0.005907630199654187,0.001612208202940679,-0.1646895163248467,0.1625535550542376,-0.1551186189927629,0.1400608312832292,0.00594387059520889,0.06921969344069431,0.100108288419789,0.1326415398695919,-0.1407958472931955,0.07370192677442622,-0.02543992410069782,-0.1358497864989058,0.140756401332931,0.04022466957552408,-0.04940153131170238,-0.08214606527977221,0.04567818073348836,-0.1297462984670884,-0.01991824725490583,-0.1229495616302315,-0.1119342566350718],[0.134109971386396,0.4645871146247883,0.2138208463607211,0.09889563074062166,0.2475081814733213,0.2177823955308233,0.1721158053886417,0.3190439444186688,0.2648965942701769,0.3719756920891218,0.1798745716437861,0.1904383637725969,0.1165129127146012,0.1887718594437291,0.2834913834525098,0.1359518468186263,0.1805902779061104,0.2121930936116578,0.3207457783461743,0.2410090698702022,0.09551794932424761,0.1996729407054981,0.2033672183435733,0.4171329612048621],[24.87813130392806,0,51.26175370940985,90.92939772836399,32.06033730661993,12.4195231333963,11.7970776025975,50.65364995912451,100,7.319641302777598,42.74441081248425,29.93041967526543,0,8.911037095704984,57.17088057095222,15.34340248010498,67.1976331957915,100,85.56933391656938,94.29416115267092,48.03100639054865,23.01986373739739,43.32645582963639,62.62211916956615],[90.3704783409918,0,68.57317693061124,100,59.36122188183828,67.48987328677876,79.9776101236165,39.79944204886668,54.60628129307593,25.32501483272202,73.77093132989322,70.48632341714686,93.47202008152934,71.00449087429479,41.55327730844879,87.42785753129333,73.54839623797095,63.72210873952589,29.96973999909785,54.76233534771637,100,67.61500939517292,66.46634484233591,0],[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],[6,10,3,2,5,7,8,4,1,9,9,10,14,13,6,12,4,1,3,2,7,11,8,5],[2,10,4,1,6,5,3,8,7,9,4,7,2,6,12,3,5,10,13,11,1,8,9,14],[5,10,3,1,4,7,2,6,9,8,10,9,3,8,14,7,4,1,11,12,2,5,6,13],[57.62430482245993,0,59.91746532001054,95.464698864182,45.71077959422909,39.95469821008753,45.887343863107,45.2265460039956,77.30314064653795,16.32232806774981,58.25767107118873,50.20837154620614,46.73601004076467,39.95776398499989,49.3620789397005,51.38563000569915,70.37301471688123,81.86105436976295,57.76953695783361,74.52824825019364,74.01550319527432,45.31743656628515,54.89640033598614,31.31105958478307],[4,10,3,1,6,8,5,7,2,9,5,9,11,13,10,8,4,1,6,2,3,12,7,14]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>type<\/th>\n      <th>Code<\/th>\n      <th>Y<\/th>\n      <th>PC1<\/th>\n      <th>PC2<\/th>\n      <th>PC3<\/th>\n      <th>PC4<\/th>\n      <th>PC5<\/th>\n      <th>PC6<\/th>\n      <th>PC7<\/th>\n      <th>PC8<\/th>\n      <th>PC9<\/th>\n      <th>WAASB<\/th>\n      <th>PctResp<\/th>\n      <th>PctWAASB<\/th>\n      <th>wRes<\/th>\n      <th>wWAASB<\/th>\n      <th>OrResp<\/th>\n      <th>OrWAASB<\/th>\n      <th>OrPC1<\/th>\n      <th>WAASBY<\/th>\n      <th>OrWAASBY<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":21,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]},{"name":"type","targets":0},{"name":"Code","targets":1},{"name":"Y","targets":2},{"name":"PC1","targets":3},{"name":"PC2","targets":4},{"name":"PC3","targets":5},{"name":"PC4","targets":6},{"name":"PC5","targets":7},{"name":"PC6","targets":8},{"name":"PC7","targets":9},{"name":"PC8","targets":10},{"name":"PC9","targets":11},{"name":"WAASB","targets":12},{"name":"PctResp","targets":13},{"name":"PctWAASB","targets":14},{"name":"wRes","targets":15},{"name":"wWAASB","targets":16},{"name":"OrResp","targets":17},{"name":"OrWAASB","targets":18},{"name":"OrPC1","targets":19},{"name":"WAASBY","targets":20},{"name":"OrWAASBY","targets":21}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render"],"jsHooks":[]}</script><p>The output generated by the <code><a href="../reference/waasb.html">waasb()</a></code> function is very
similar to those generated by the <code><a href="../reference/waas.html">waas()</a></code> function. The main
difference here, is that the singular value decomposition is based on
the BLUP for GEI effects matrix.</p>
</div>
<div class="section level3">
<h3 id="eigenvalues-of-the-blup_gei-matrix">Eigenvalues of the BLUP_GEI matrix<a class="anchor" aria-label="anchor" href="#eigenvalues-of-the-blup_gei-matrix"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">waasb_model</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">PCA</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1834a22cd196f3aa03a1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1834a22cd196f3aa03a1">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["PC1","PC2","PC3","PC4","PC5","PC6","PC7","PC8","PC9"],[1.472215304171095,1.346703693659931,0.5478796640072026,0.4166627138351456,0.2126178596044709,0.1397256090703744,0.07911604792754616,0.05673363850621106,0.01946964230037057],[34.30838271719346,31.38347060911508,12.76774201604277,9.7098731481325,4.954828875337483,3.256153945552418,1.843713785395227,1.322115982149704,0.453718921081358],[34.30838271719346,65.69185332630853,78.45959534235131,88.16946849048381,93.12429736582128,96.3804513113737,98.22416509676893,99.54628107891864,99.99999999999999]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>PC<\/th>\n      <th>Eigenvalue<\/th>\n      <th>Proportion<\/th>\n      <th>Accumulated<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3]},{"name":"PC","targets":0},{"name":"Eigenvalue","targets":1},{"name":"Proportion","targets":2},{"name":"Accumulated","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render"],"jsHooks":[]}</script><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_eigen.html">plot_eigen</a></span><span class="op">(</span><span class="va">waasb_model</span>, size.lab <span class="op">=</span> <span class="fl">14</span>, size.tex.lab <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-21-1.png" width="528" style="display: block; margin: auto;"></p>
<p>The above output shows the eigenvalues and the proportion of variance
explained by each principal component axis of the BLUP interaction
effects matrix.</p>
<div class="section level4">
<h4 id="phenotypic-means">Phenotypic means<a class="anchor" aria-label="anchor" href="#phenotypic-means"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">waasb_model</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">MeansGxE</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-28515d92cb327f90c9eb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-28515d92cb327f90c9eb">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9"],["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9"],[2.365786666666667,1.974073333333333,2.901746666666667,2.888586666666667,2.588566666666667,2.18826,2.3008,2.773726666666667,2.89936,2.325926666666667,2.307633333333333,1.536253333333333,2.297053333333333,2.336726666666666,2.167353333333333,2.139833333333333,2.208146666666666,2.441893333333333,2.574866666666667,1.742333333333333,1.355666666666667,0.8991,1.49072,1.567726666666666,1.37,1.325666666666667,1.500666666666667,1.364333333333333,1.683433333333333,1.125333333333333,1.342333333333333,1.022135802469136,1.993333333333333,1.764358024691358,1.527333333333333,1.689,1.385666666666667,1.95162962962963,2,1.409333333333333,2.99825925925926,1.830666666666667,3.028308641975308,3.469148148148149,2.635716049382716,2.568098765432099,2.911666666666667,3.18383950617284,3.519975308641975,2.950629629629629,1.533333333333333,1.85920987654321,1.42658024691358,2.059654320987654,1.861333333333333,1.784296296296296,1.798851851851852,1.936333333333333,1.991864197530864,1.567876543209877,3.04069,3.14584,3.231053333333333,3.60828,3.19008,3.140136666666667,3.291173333333334,2.612676666666667,3.444796666666667,3.094863333333333,4.080333333333334,4.114333333333333,4.568666666666667,4.132333333333333,3.854333333333333,3.741333333333333,3.434666666666667,4.101333333333334,4.11,4.506,3.494333333333334,4.271,3.715573333333333,4.134,3.302166666666666,3.379113333333333,3.403473333333333,3.018953333333333,4.137773333333334,3.89634,4.170530864197531,3.365666666666667,3.827432098765432,4.126654320987654,3.782604938271605,3.469,3.568925925925926,4.047913580246914,4.812098765432099,3.934172839506173,2.809086419753086,2.484876543209876,2.541333333333333,2.984716049382716,2.701185185185185,2.433320987654321,2.335555555555556,2.665901234567901,2.908123456790123,2.768037037037037,1.89788,2.243626666666667,1.987626666666667,2.158546666666667,1.980886666666667,1.656766666666667,1.757786666666667,2.550813333333333,2.26178,1.393246666666667,2.271933333333333,2.70031,2.045296666666667,2.85042,2.30059,2.70833,2.53938,2.583383333333333,2.878853333333334,2.48526,2.783666666666667,3.15,3.363333333333333,3.293666666666667,3.724666666666667,3.299666666666667,3.039666666666667,3.14,2.828,1.943333333333333],[0.2352804553410876,0.2352804553410876,0.2352804553410876,0.2352804553410876,0.2352804553410876,0.2352804553410876,0.2352804553410876,0.2352804553410876,0.2352804553410876,0.2352804553410876,0.2153628801302379,0.2153628801302379,0.2153628801302379,0.2153628801302379,0.2153628801302379,0.2153628801302379,0.2153628801302379,0.2153628801302379,0.2153628801302379,0.2153628801302379,0.1004496348222608,0.1004496348222608,0.1004496348222608,0.1004496348222608,0.1004496348222608,0.1004496348222608,0.1004496348222608,0.1004496348222608,0.1004496348222608,0.1004496348222608,0.21055417439975,0.21055417439975,0.21055417439975,0.21055417439975,0.21055417439975,0.21055417439975,0.21055417439975,0.21055417439975,0.21055417439975,0.21055417439975,0.6132162243858651,0.6132162243858651,0.6132162243858651,0.6132162243858651,0.6132162243858651,0.6132162243858651,0.6132162243858651,0.6132162243858651,0.6132162243858651,0.6132162243858651,-0.2013994713453189,-0.2013994713453189,-0.2013994713453189,-0.2013994713453189,-0.2013994713453189,-0.2013994713453189,-0.2013994713453189,-0.2013994713453189,-0.2013994713453189,-0.2013994713453189,-0.1591916863400819,-0.1591916863400819,-0.1591916863400819,-0.1591916863400819,-0.1591916863400819,-0.1591916863400819,-0.1591916863400819,-0.1591916863400819,-0.1591916863400819,-0.1591916863400819,0.0645996602261778,0.0645996602261778,0.0645996602261778,0.0645996602261778,0.0645996602261778,0.0645996602261778,0.0645996602261778,0.0645996602261778,0.0645996602261778,0.0645996602261778,-0.2529186818639979,-0.2529186818639979,-0.2529186818639979,-0.2529186818639979,-0.2529186818639979,-0.2529186818639979,-0.2529186818639979,-0.2529186818639979,-0.2529186818639979,-0.2529186818639979,0.4344998486732777,0.4344998486732777,0.4344998486732777,0.4344998486732777,0.4344998486732777,0.4344998486732777,0.4344998486732777,0.4344998486732777,0.4344998486732777,0.4344998486732777,0.06900709445843989,0.06900709445843989,0.06900709445843989,0.06900709445843989,0.06900709445843989,0.06900709445843989,0.06900709445843989,0.06900709445843989,0.06900709445843989,0.06900709445843989,-0.1722746636838427,-0.1722746636838427,-0.1722746636838427,-0.1722746636838427,-0.1722746636838427,-0.1722746636838427,-0.1722746636838427,-0.1722746636838427,-0.1722746636838427,-0.1722746636838427,-0.1876880846520825,-0.1876880846520825,-0.1876880846520825,-0.1876880846520825,-0.1876880846520825,-0.1876880846520825,-0.1876880846520825,-0.1876880846520825,-0.1876880846520825,-0.1876880846520825,-0.5372627076353238,-0.5372627076353238,-0.5372627076353238,-0.5372627076353238,-0.5372627076353238,-0.5372627076353238,-0.5372627076353238,-0.5372627076353238,-0.5372627076353238,-0.5372627076353238],[0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806,0.2459450009474101,-0.8189301521513632,0.118910936569499,0.04365679265244801,-0.2429245381656535,-0.2563446174045569,-0.07532193376954484,0.2472695363122093,0.4042080245387447,0.3335309504708806],[2.423652718478438,1.781395074242615,2.929724085967774,2.898858256720666,2.531411270713528,2.127947121692819,2.28307822112553,2.831904355762183,2.994462248065997,2.404399980563801,2.360600757091002,1.359886177140522,2.322662335111925,2.346128719269546,2.11503640513967,2.084626218223204,2.191925118073078,2.495146012841999,2.661918071003085,1.814163519439318,1.380371752198194,0.8168387652714572,1.502664560154779,1.572111975546116,1.345598318851894,1.299916943459727,1.493100605925409,1.389171467958564,1.724035881790478,1.158836395510055,1.394118079955561,0.8497066403918438,2.018370527409825,1.773550144625235,1.476184557758424,1.635025570720564,1.369807319087627,2.003693262702056,2.085107686892509,1.479559667246493,3.149076724146809,1.328485410728666,3.101226757536644,3.495919201707279,2.486750781278094,2.410904087005637,2.865478034827064,3.335469197635856,3.767842227316093,3.155156219793212,1.483800140162501,2.024141976255236,1.402631647151306,2.050861866026819,1.910258206896702,1.835923966723792,1.814021649493745,1.886533379440252,1.910456915075225,1.50070358610774,3.001537600552268,3.276206871915715,3.212123700816556,3.601330201557458,3.228751566883976,3.180944598595501,3.303163958988503,2.573313412200596,3.380450109608151,3.041767978881263,4.096221296828864,4.061430723755382,4.576348272766233,4.135153547305246,3.838640490707231,3.724773558148189,3.429800895337575,4.117306861363387,4.136111701045897,4.527545986075333,3.432129247882675,4.478122734620806,3.685498535996962,4.122958381547933,3.363606820651944,3.443947676070225,3.422523657537774,2.956414248144127,4.035541572568143,3.811983791646059,4.277393929891129,3.009841639482915,3.879098882710477,4.145623190788703,3.677054263199603,3.357618302529511,3.53619855710128,4.155352156356081,4.987727090926708,4.079091987013625,2.826058369665045,2.428364552845503,2.549539031565326,2.987728677797036,2.684421668633715,2.415631390427172,2.330357807757128,2.682964586816892,2.936016678120328,2.791053038840994,1.855509907677062,2.384707583209101,1.967141325060825,2.151025707394951,2.022736409779708,1.7009283494172,1.770762727474832,2.508215057125887,2.192145198514277,1.335787734346143,2.225772387175759,2.854013431721128,2.022978500737752,2.842226140205009,2.346184041283303,2.756442830251532,2.553517029481497,2.536973787670086,2.802988303406655,2.422660214733932,2.651529589528288,3.589980630909049,3.299446921584552,3.270211500039538,3.855180961792606,3.43739106990118,3.080134332748021,3.007151299405172,2.610834102288389,1.764139591803165]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ENV<\/th>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>envPC1<\/th>\n      <th>genPC1<\/th>\n      <th>nominal<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[2,3,4,5]},{"name":"ENV","targets":0},{"name":"GEN","targets":1},{"name":"Y","targets":2},{"name":"envPC1","targets":3},{"name":"genPC1","targets":4},{"name":"nominal","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script><p>In this output, <em>Y</em> is the phenotypic mean for each genotype
and environment combination
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>),
estimated by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mo>‚àë</mo><mi>k</mi></msub><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>/</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">y_{ij} = \sum_k{y_{ij}}/B</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">k = 1,2,...B</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level3">
<h3 id="biplots">Biplots<a class="anchor" aria-label="anchor" href="#biplots"></a>
</h3>
<p>Provided that an object of class <code>waasb</code> is available in
the global environment, the graphics may be obtained using the function
<code><a href="../reference/plot_scores.html">plot_scores()</a></code>. To do that, we will revisit the previusly
fitted model <code>WAASB</code> . Please, refer to
<code><a href="../reference/plot_scores.html">?plot_scores</a></code> for more details. Four types of graphics can
be generated: 1 =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>C</mi><mn>1</mn><mo>√ó</mo><mi>P</mi><mi>C</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">PC1 \times PC2</annotation></semantics></math>;
2 =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>Y</mi><mo>√ó</mo><mi>P</mi><mi>C</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">GY \times PC1</annotation></semantics></math>;
3 =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>Y</mi><mo>√ó</mo><mi>W</mi><mi>A</mi><mi>A</mi><mi>S</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">GY \times WAASB</annotation></semantics></math>;
and 4 = a graphic with nominal yield as a function of the environment
PCA1 scores.</p>
<div class="section level4">
<h4 id="biplot-type-1-gy-x-pc1">biplot type 1: GY x PC1<a class="anchor" aria-label="anchor" href="#biplot-type-1-gy-x-pc1"></a>
</h4>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waasb_model</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waasb_model</span>,</span>
<span>                 type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 col.gen <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 col.env <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                 col.segm.env <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                 axis.expand <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">d</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-23-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="biplot-type-2-pc1-x-pc2">biplot type 2: PC1 x PC2<a class="anchor" aria-label="anchor" href="#biplot-type-2-pc1-x-pc2"></a>
</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waasb_model</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waasb_model</span>,</span>
<span>                 type <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 polygon <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 col.segm.env <span class="op">=</span> <span class="st">"transparent"</span>,</span>
<span>                 plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">e</span>, <span class="va">f</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-24-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="biplot-type-3-gy-x-waasb">biplot type 3: GY x WAASB<a class="anchor" aria-label="anchor" href="#biplot-type-3-gy-x-waasb"></a>
</h4>
<p>The quadrants proposed by <span class="citation">Olivoto et al. (<a href="#ref-Olivoto2019">2019</a>)</span> in the following biplot
represent four classifications regarding the joint interpretation of
mean performance and stability. The genotypes or environments included
in quadrant I can be considered unstable genotypes or environments with
high discrimination ability, and with productivity below the grand mean.
In quadrant II are included unstable genotypes, although with
productivity above the grand mean. The environments included in this
quadrant deserve special attention since, in addition to providing high
magnitudes of the response variable, they present a good discrimination
ability. Genotypes within quadrant III have low productivity, but can be
considered stable due to the lower values of WAASB. The lower this
value, the more stable the genotype can be considered. The environments
included in this quadrant can be considered as poorly productive and
with low discrimination ability. The genotypes within the quadrant IV
are highly productive and broadly adapted due to the high magnitude of
the response variable and high stability performance (lower values of
WAASB).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waasb_model</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waasb_model</span>, type <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 x.lab <span class="op">=</span> <span class="st">"My customized x label"</span>,</span>
<span>                 size.shape.gen <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 size.tex.gen <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 x.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">4.7</span><span class="op">)</span>,</span>
<span>                 x.breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">4.5</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                 plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>color.background <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">h</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="st">"h"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-25-1.png" width="960" style="display: block; margin: auto;"></p>
<p>To obtain the WAASB index for a set of variables, the function
<code><a href="../reference/get_model_data.html">get_model_data()</a></code> is used, as shown bellow.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/waasb.html">waasb</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>,</span>
<span>     resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">ED</span>, <span class="va">TKW</span>, <span class="va">NKR</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"WAASB"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu">print_table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Evaluating trait PH |===========                                 | 25% 00:00:00 Evaluating trait ED |======================                      | 50% 00:00:01 Evaluating trait TKW |================================           | 75% 00:00:01 Evaluating trait NKR |===========================================| 100% 00:00:02 </span></span>
<span><span class="co"># Method: REML/BLUP</span></span>
<span><span class="co"># Random effects: GEN, GEN:ENV</span></span>
<span><span class="co"># Fixed effects: ENV, REP(ENV)</span></span>
<span><span class="co"># Denominador DF: Satterthwaite's method</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     model       PH       ED      TKW     NKR</span></span>
<span><span class="co">#  COMPLETE       NA       NA       NA      NA</span></span>
<span><span class="co">#       GEN 9.39e-01 2.99e-01 1.00e+00 0.78738</span></span>
<span><span class="co">#   GEN:ENV 1.09e-13 1.69e-08 4.21e-10 0.00404</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></span>
<span><span class="co"># Class of the model: waasb</span></span>
<span><span class="co"># Variable extracted: WAASB</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-0caf26d4e3c00206b0c5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0caf26d4e3c00206b0c5">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["H1","H10","H11","H12","H13","H2","H3","H4","H5","H6","H7","H8","H9"],[0.3190436177875539,0.2867158973698122,0.2104715080712942,0.2977978317388378,0.258064029977818,0.312151418177168,0.3396943799022847,0.2676969510412276,0.170667913030321,0.2315127881954588,0.2093656321575365,0.3336038358448531,0.207517045719823],[0.6950123237443409,0.8789293255649614,0.5787613495312758,0.3438457547725708,0.757599707755534,0.9899183091871053,0.363535582121738,0.3210867298820429,0.4651977762027018,0.5275910965299007,0.301303577826903,0.6400922652237311,0.9126263189931335],[3.48764022556178,2.473396841562841,0.8009374880383919,1.589006000555855,0.4229907362291416,3.857222609449769,3.080230701279433,2.768873012784836,0.4757152692049803,0.591003019103907,2.549703162670991,4.495761846645699,5.12715507858781],[0.5450318535451466,0.2914687651630433,0.5329423765297192,0.432568767299897,0.5473892928484344,0.2707819298335798,0.1719288319792454,0.6150119697765365,0.5614800798980738,1.068340185096938,0.368684068363796,0.6119194742590364,0.6319782224623737]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>GEN<\/th>\n      <th>PH<\/th>\n      <th>ED<\/th>\n      <th>TKW<\/th>\n      <th>NKR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4]},{"name":"GEN","targets":0},{"name":"PH","targets":1},{"name":"ED","targets":2},{"name":"TKW","targets":3},{"name":"NKR","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="biplot-type-4-nominal-yield-and-environment-ipca1">biplot type 4 : nominal yield and environment IPCA1<a class="anchor" aria-label="anchor" href="#biplot-type-4-nominal-yield-and-environment-ipca1"></a>
</h4>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waasb_model</span>, type <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waasb_model</span>,</span>
<span>                 type <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                 size.tex.gen <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>                 color <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 col.alpha.gen <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                 col.alpha.env <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                 plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>color.background <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="st">"j"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-27-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simultaneous-selection-for-mean-performance-and-stability">Simultaneous selection for mean performance and stability<a class="anchor" aria-label="anchor" href="#simultaneous-selection-for-mean-performance-and-stability"></a>
</h2>
<p>The <strong>waasby</strong> index is used for genotype ranking
considering both the stability (<strong>waasb</strong>) and mean
performance (<strong>y</strong>) based on the following model <span class="citation">(<a href="#ref-Olivoto2019">Olivoto et al.
2019</a>)</span>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>a</mi><mi>a</mi><mi>s</mi><mi>b</mi><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><msub><mi>Y</mi><mi>i</mi></msub><mo>√ó</mo><msub><mi>Œ∏</mi><mi>Y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><msub><mi>W</mi><mi>i</mi></msub><mo>√ó</mo><msub><mi>Œ∏</mi><mi>W</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>Œ∏</mi><mi>Y</mi></msub><mo>+</mo><msub><mi>Œ∏</mi><mi>W</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
waasby_i = \frac{{\left( {r {Y_i} \times {\theta _Y}} \right) + \left( {r {W_i} \times {\theta _W}} \right)}}{{{\theta _Y} + {\theta _W}}}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>a</mi><mi>a</mi><mi>s</mi><mi>b</mi><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">waasby_i</annotation></semantics></math>
is the superiority index for the <em>i</em>-th genotype;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><msub><mi>Y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">rY_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">rW_i</annotation></semantics></math>
are the rescaled values (0-100) for the response variable (y) and the
stability (WAAS or WAASB), respectively;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∏</mi><mi>Y</mi></msub><annotation encoding="application/x-tex">\theta _Y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∏</mi><mi>W</mi></msub><annotation encoding="application/x-tex">\theta_W</annotation></semantics></math>
are the weights for mean performance and stability, respectively.</p>
<p>This index was also already computed and stored into
AMMI_model&gt;GY&gt;model. An intuitively plot may be obtained by
running</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_waasby.html">plot_waasby</a></span><span class="op">(</span><span class="va">waasb_model</span><span class="op">)</span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_waasby.html">plot_waasby</a></span><span class="op">(</span><span class="va">waasb_model</span>, col.shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray20"</span>, <span class="st">"gray80"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-28-1.png" width="960" style="display: block; margin: auto;"></p>
<p>In the following example, we will apply the function
<code><a href="../reference/wsmp.html">wsmp()</a></code> to the previously fitted model
<strong>waasb_model</strong> aiming at planning different scenarios of
<strong>waasby</strong> estimation by changing the weights assigned to
the stability and the mean performance.vThe number of scenarios is
defined by the arguments <code>increment</code>. By default, twenty-one
different scenarios are computed. In this case, the the superiority
index <strong>waasby</strong> is computed considering the following
weights: stability (waasb or waas) = 100; mean performance = 0. In other
words, only stability is considered for genotype ranking. In the next
iteration, the weights becomes 95/5 (since increment = 5). In the third
scenario, the weights become 90/10, and so on up to these weights become
0/100. In the last iteration, the genotype ranking for WAASY or WAASBY
matches perfectly with the ranks of the response variable.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wsmp.html">wsmp</a></span><span class="op">(</span><span class="va">waasb_model</span><span class="op">)</span></span>
<span><span class="co"># Ranks considering 0 for Y and 100 for WAASB |                    | 1% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |                    | 1% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |                    | 2% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |                    | 2% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 3% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 3% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 4% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 4% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 5% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |=                    | 5% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |=                    | 6% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |=                    | 6% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |=                    | 7% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 7% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 8% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 8% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 9% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 10% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 10% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 11% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 11% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 12% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 12% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 13% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 13% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 14% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 14% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 15% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 15% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 16% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 16% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 17% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 17% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |====                | 18% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |====                | 19% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |====                | 19% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 20% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 20% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 21% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 21% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 22% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 22% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |=====               | 23% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |=====               | 23% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |=====               | 24% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 24% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 25% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 25% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 26% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 26% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 27% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |======              | 28% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |======              | 28% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |======              | 29% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 29% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 30% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 30% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 31% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 31% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 32% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 32% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |=======             | 33% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |=======             | 33% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 34% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 34% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 35% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 35% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 36% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 37% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 37% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |========            | 38% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |========            | 38% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 39% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 39% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 40% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 40% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 41% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 41% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 42% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 42% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |=========           | 43% 00:00:00 Ranks considering 45 for Y and 55 for WAASB |=========           | 43% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 44% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 44% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 45% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 46% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 46% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 47% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 47% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |==========          | 48% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 48% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 49% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 49% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 50% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 50% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 51% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 51% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 52% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 52% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 53% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 53% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 54% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 54% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 55% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 56% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 56% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 57% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 57% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 58% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 58% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 59% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 59% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 60% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 60% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 61% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 61% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 62% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |============        | 62% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 63% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 63% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 64% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 65% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 65% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 66% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 66% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 67% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |=============       | 67% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 68% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 68% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 69% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 69% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 70% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 70% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 71% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 71% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |==============      | 72% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |==============      | 72% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 73% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 74% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 74% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 75% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 75% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 76% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 76% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |===============     | 77% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |===============     | 77% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 78% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 78% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 79% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 79% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 80% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 80% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 81% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |================    | 81% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |================    | 82% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |=================   | 83% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |=================   | 83% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |=================   | 84% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |=================   | 84% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |=================   | 85% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |=================   | 85% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |=================   | 86% 00:00:01 Ranks considering 90 for Y and 10 for WAASB |=================   | 86% 00:00:01 Ranks considering 90 for Y and 10 for WAASB |=================   | 87% 00:00:01 Ranks considering 90 for Y and 10 for WAASB |=================   | 87% 00:00:01 Ranks considering 90 for Y and 10 for WAASB |==================  | 88% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 88% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 89% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 89% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 90% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 90% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |===================  | 91% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |===================  | 92% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |===================  | 92% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |===================  | 93% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 93% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 94% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 94% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 95% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 95% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |=================== | 96% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |=================== | 96% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |=================== | 97% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |=================== | 97% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 98% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 98% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 99% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 99% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 100% 00:00:02 </span></span>
<span><span class="co"># Ranks considering 0 for Y and 100 for WAASB |                    | 1% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |                    | 1% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |                    | 2% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |                    | 2% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 3% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 3% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 4% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 4% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 5% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |=                    | 5% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |=                    | 6% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |=                    | 6% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |=                    | 7% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 7% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 8% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 8% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 9% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 10% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 10% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 11% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 11% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 12% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 12% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 13% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 13% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 14% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 14% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 15% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 15% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 16% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 16% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 17% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 17% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |====                | 18% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |====                | 19% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |====                | 19% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 20% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 20% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 21% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 21% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 22% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 22% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |=====               | 23% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |=====               | 23% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |=====               | 24% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 24% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 25% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 25% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 26% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 26% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 27% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |======              | 28% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |======              | 28% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |======              | 29% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 29% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 30% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 30% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 31% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 31% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 32% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 32% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |=======             | 33% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |=======             | 33% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 34% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 34% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 35% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 35% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 36% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 37% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 37% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |========            | 38% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |========            | 38% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 39% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 39% 00:00:01 Ranks considering 40 for Y and 60 for WAASB |========            | 40% 00:00:01 Ranks considering 40 for Y and 60 for WAASB |========            | 40% 00:00:01 Ranks considering 40 for Y and 60 for WAASB |========            | 41% 00:00:01 Ranks considering 40 for Y and 60 for WAASB |========            | 41% 00:00:01 Ranks considering 40 for Y and 60 for WAASB |========            | 42% 00:00:01 Ranks considering 40 for Y and 60 for WAASB |========            | 42% 00:00:01 Ranks considering 40 for Y and 60 for WAASB |=========           | 43% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 43% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 44% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 44% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 45% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 46% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 46% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 47% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |=========           | 47% 00:00:01 Ranks considering 45 for Y and 55 for WAASB |==========          | 48% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 48% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 49% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 49% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 50% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 50% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 51% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 51% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 52% 00:00:01 Ranks considering 50 for Y and 50 for WAASB |==========          | 52% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 53% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 53% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 54% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 54% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 55% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 56% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 56% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 57% 00:00:01 Ranks considering 55 for Y and 45 for WAASB |===========         | 57% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 58% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 58% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 59% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 59% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 60% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 60% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 61% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 61% 00:00:01 Ranks considering 60 for Y and 40 for WAASB |============        | 62% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |============        | 62% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 63% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 63% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 64% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 65% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 65% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 66% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 66% 00:00:01 Ranks considering 65 for Y and 35 for WAASB |=============       | 67% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |=============       | 67% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 68% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 68% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 69% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 69% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 70% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 70% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 71% 00:00:01 Ranks considering 70 for Y and 30 for WAASB |==============      | 71% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |==============      | 72% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |==============      | 72% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 73% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 74% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 74% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 75% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 75% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 76% 00:00:01 Ranks considering 75 for Y and 25 for WAASB |===============     | 76% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |===============     | 77% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |===============     | 77% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 78% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 78% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 79% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 79% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 80% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 80% 00:00:01 Ranks considering 80 for Y and 20 for WAASB |================    | 81% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |================    | 81% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |================    | 82% 00:00:01 Ranks considering 85 for Y and 15 for WAASB |=================   | 83% 00:00:02 Ranks considering 85 for Y and 15 for WAASB |=================   | 83% 00:00:02 Ranks considering 85 for Y and 15 for WAASB |=================   | 84% 00:00:02 Ranks considering 85 for Y and 15 for WAASB |=================   | 84% 00:00:02 Ranks considering 85 for Y and 15 for WAASB |=================   | 85% 00:00:02 Ranks considering 85 for Y and 15 for WAASB |=================   | 85% 00:00:02 Ranks considering 85 for Y and 15 for WAASB |=================   | 86% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |=================   | 86% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |=================   | 87% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |=================   | 87% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 88% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 88% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 89% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 89% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 90% 00:00:02 Ranks considering 90 for Y and 10 for WAASB |==================  | 90% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |===================  | 91% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |===================  | 92% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |===================  | 92% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |===================  | 93% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 93% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 94% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 94% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 95% 00:00:02 Ranks considering 95 for Y and 5 for WAASB |==================== | 95% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |=================== | 96% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |=================== | 96% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |=================== | 97% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |=================== | 97% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 98% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 98% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 99% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 99% 00:00:02 Ranks considering 100 for Y and 0 for WAASB |====================| 100% 00:00:02 </span></span></code></pre></div>
<div class="section level3">
<h3 id="printing-the-model-outputs-1">Printing the model outputs<a class="anchor" aria-label="anchor" href="#printing-the-model-outputs-1"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_table</span><span class="op">(</span><span class="va">scenarios</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">hetcomb</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-da0b268a2927f570ebf3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-da0b268a2927f570ebf3">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,7,5,3,8,6,9],[2,10,4,1,7,6,3,8,5,9],[2,10,4,1,7,6,3,8,5,9],[2,10,4,1,7,6,5,8,3,9],[2,10,4,1,6,7,5,8,3,9],[3,10,4,1,6,7,5,8,2,9],[3,10,4,1,6,7,5,8,2,9],[3,10,4,1,6,8,5,7,2,9],[4,10,3,1,6,8,5,7,2,9],[4,10,3,1,6,8,7,5,2,9],[4,10,3,1,6,8,7,5,2,9],[4,10,3,1,6,8,7,5,2,9],[5,10,3,1,6,8,7,4,2,9],[5,10,3,1,6,8,7,4,2,9],[5,10,3,1,6,8,7,4,2,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,7,8,4,1,9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>100/0<\/th>\n      <th>95/5<\/th>\n      <th>90/10<\/th>\n      <th>85/15<\/th>\n      <th>80/20<\/th>\n      <th>75/25<\/th>\n      <th>70/30<\/th>\n      <th>65/35<\/th>\n      <th>60/40<\/th>\n      <th>55/45<\/th>\n      <th>50/50<\/th>\n      <th>45/55<\/th>\n      <th>40/60<\/th>\n      <th>35/65<\/th>\n      <th>30/70<\/th>\n      <th>25/75<\/th>\n      <th>20/80<\/th>\n      <th>15/85<\/th>\n      <th>10/90<\/th>\n      <th>5/95<\/th>\n      <th>0/100<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":0,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{"name":"100/0","targets":0},{"name":"95/5","targets":1},{"name":"90/10","targets":2},{"name":"85/15","targets":3},{"name":"80/20","targets":4},{"name":"75/25","targets":5},{"name":"70/30","targets":6},{"name":"65/35","targets":7},{"name":"60/40","targets":8},{"name":"55/45","targets":9},{"name":"50/50","targets":10},{"name":"45/55","targets":11},{"name":"40/60","targets":12},{"name":"35/65","targets":13},{"name":"30/70","targets":14},{"name":"25/75","targets":15},{"name":"20/80","targets":16},{"name":"15/85","targets":17},{"name":"10/90","targets":18},{"name":"5/95","targets":19},{"name":"0/100","targets":20}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render","options.columnDefs.20.render"],"jsHooks":[]}</script><p>In addition, the genotype ranking depending on the number of
multiplicative terms used to estimate the WAAS index is also
computed.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_table</span><span class="op">(</span><span class="va">scenarios</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">hetdata</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-0ed12bb554391c49c2e3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0ed12bb554391c49c2e3">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[2,10,5,1,6,4,3,8,7,9],[2,10,4,1,6,5,3,8,7,9],[4,10,3,1,7,5,2,8,6,9],[5,10,3,1,4,7,2,6,9,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>9PCA<\/th>\n      <th>8PCA<\/th>\n      <th>7PCA<\/th>\n      <th>6PCA<\/th>\n      <th>5PCA<\/th>\n      <th>4PCA<\/th>\n      <th>3PCA<\/th>\n      <th>2PCA<\/th>\n      <th>1PCA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":0,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8]},{"name":"9PCA","targets":0},{"name":"8PCA","targets":1},{"name":"7PCA","targets":2},{"name":"6PCA","targets":3},{"name":"5PCA","targets":4},{"name":"4PCA","targets":5},{"name":"3PCA","targets":6},{"name":"2PCA","targets":7},{"name":"1PCA","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render"],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="plotting-the-heat-map-graphics">Plotting the heat map graphics<a class="anchor" aria-label="anchor" href="#plotting-the-heat-map-graphics"></a>
</h3>
<p>The first type of heatmap shows the genotype ranking depending on the
number of principal component axes used for estimating the WAASB index.
An euclidean distance-based dendrogram is used for grouping the
genotypes based on their ranks. The second type of heatmap shows the
genotype ranking depending on the WAASB/GY ratio. The ranks obtained
with a ratio of 100/0 considers exclusively the stability for genotype
ranking. On the other hand, a ratio of 0/100 considers exclusively the
productivity for genotype ranking. Four clusters are estimated (1)
unproductive and unstable genotypes; (2) productive, but unstable
genotypes; (3) stable, but unproductive genotypes; and (4), productive
and stable genotypes <span class="citation">(<a href="#ref-Olivoto2019">Olivoto et al. 2019</a>)</span>.</p>
<div class="section level4">
<h4 id="ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waasb">Ranks of genotypes depending on the number of PCA used to estimate
the WAASB<a class="anchor" aria-label="anchor" href="#ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waasb"></a>
</h4>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scenarios</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-32-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="ranks-of-genotypes-depending-on-the-waasbgy-ratio">Ranks of genotypes depending on the WAASB/GY ratio<a class="anchor" aria-label="anchor" href="#ranks-of-genotypes-depending-on-the-waasbgy-ratio"></a>
</h4>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scenarios</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-33-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="others-blup-based-stability-indexes">Others BLUP-based stability indexes<a class="anchor" aria-label="anchor" href="#others-blup-based-stability-indexes"></a>
</h2>
<p><span class="citation">Colombari Filho et al. (<a href="#ref-ColombariFilho2013">2013</a>)</span> have shown the use of
three BLUP-based indexes for selecting genotypes with performance and
stability. The first is the harmonic mean of genotypic values -or BLUPS-
(HMGV) a stability index that considers the genotype with the highest
harmonic mean across environments as the most stable, as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>M</mi><mi>G</mi><msub><mi>V</mi><mi>i</mi></msub><mo>=</mo><mfrac><mi>E</mi><mrow><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>E</mi></munderover><mfrac><mn>1</mn><mrow><mi>B</mi><mi>L</mi><mi>U</mi><mi>P</mi><msub><mi></mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow></mfrac></mrow><annotation encoding="application/x-tex">
HMG{V_i} = \frac{E}{{\sum\limits_{j = 1}^E {\frac{1}{{BLUP{_{ij}}}}}}}
</annotation></semantics></math></p>
<p>The second is the relative performance of genotypic values (RPGV), an
adaptability index estimated as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>P</mi><mi>G</mi><msub><mi>V</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>e</mi></mfrac><mrow><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>e</mi></munderover><mrow><mi>B</mi><mi>L</mi><mi>U</mi><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mi>/</mi><msub><mo>Œº</mo><mi>j</mi></msub></mrow></mrow><annotation encoding="application/x-tex">
RPGV_i = \frac{1}{e}{\sum\limits_{j = 1}^e {BLUP_{ij}} /\mathop \mu \nolimits_j }
</annotation></semantics></math></p>
<p>The third and last is the harmonic mean of relative performance of
genotypic values (HMRPGV), a simultaneous selection index for stability,
adaptability and mean performance, estimated as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>M</mi><mi>R</mi><mi>P</mi><mi>G</mi><msub><mi>V</mi><mi>i</mi></msub><mo>=</mo><mfrac><mi>E</mi><mrow><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>E</mi></munderover><mfrac><mn>1</mn><mrow><mi>B</mi><mi>L</mi><mi>U</mi><mi>P</mi><msub><mi></mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>/</mi><msub><mi>Œº</mi><mi>j</mi></msub></mrow></mfrac></mrow></mfrac></mrow><annotation encoding="application/x-tex">
HMRPG{V_i} = \frac{E}{{\sum\limits_{j = 1}^E {\frac{1}{{BLUP{_{ij}}/{\mu _j}}}} }}
</annotation></semantics></math></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Res_ind</span> <span class="op">&lt;-</span> </span>
<span><span class="va">data_ge</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="../reference/gamem_met.html">gamem_met</a></span><span class="op">(</span><span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="../reference/blup_indexes.html">blup_indexes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Warning: The WAASB index was not computed.</span></span>
<span><span class="co"># Use an object computed with `waasb()` to get this index.</span></span>
<span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">Res_ind</span><span class="op">$</span><span class="va">GY</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ec658d41f8c4f2d124e9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ec658d41f8c4f2d124e9">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9"],[2.603676181657848,2.471220873015873,2.744146975308642,2.955344109347443,2.641915440917108,2.537344479717813,2.534030476190476,2.740909329805997,3.003637504409171,2.510191860670194],[2.316069375067554,2.111862174883766,2.466165892329863,2.680772158096092,2.387640737324237,2.301790511373774,2.304409144806225,2.51990520503866,2.740128085398287,2.176601466418986],[6,10,4,2,5,8,7,3,1,9],[0.9689782826532675,0.9129839810303356,1.025295986698669,1.105004596891766,0.9904706495075417,0.9542394878987036,0.9542096896272078,1.03689792893014,1.125748542802147,0.9261708539602143],[2.591282152253084,2.441539854596966,2.741889306160721,2.95504939722974,2.648757936423042,2.551867052372162,2.551787364591251,2.772915704145165,3.010523722885095,2.476804740383319],[6,10,4,2,5,7,8,3,1,9],[0.9667170219635123,0.8964261948865789,1.01970096165815,1.103961535076373,0.9881876229185593,0.9519869960506546,0.9520644867793807,1.030835889014822,1.122180876153921,0.9172443194098414],[2.585234994569725,2.397260332049098,2.726926856755555,2.952259997803239,2.64265257146383,2.545843344691157,2.54605057363107,2.7567043440765,3.000982919880281,2.452933029245982],[6,10,4,2,5,8,7,3,1,9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>HMGV<\/th>\n      <th>HMGV_R<\/th>\n      <th>RPGV<\/th>\n      <th>RPGV_Y<\/th>\n      <th>RPGV_R<\/th>\n      <th>HMRPGV<\/th>\n      <th>HMRPGV_Y<\/th>\n      <th>HMRPGV_R<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9]},{"name":"GEN","targets":0},{"name":"Y","targets":1},{"name":"HMGV","targets":2},{"name":"HMGV_R","targets":3},{"name":"RPGV","targets":4},{"name":"RPGV_Y","targets":5},{"name":"RPGV_R","targets":6},{"name":"HMRPGV","targets":7},{"name":"HMRPGV_Y","targets":8},{"name":"HMRPGV_R","targets":9}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render"],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="fai-blup-selection-index">FAI-BLUP selection index<a class="anchor" aria-label="anchor" href="#fai-blup-selection-index"></a>
</h2>
<p>The FAI-BLUP is a multi-trait index based on factor analysis and
ideotype-design recentely proposed by <span class="citation">Rocha,
Machado, and Carneiro (<a href="#ref-Rocha2018">2018</a>)</span>. It is
based on factor analysis, when the factorial scores of each ideotype are
designed according to the desirable and undesirable factors. Then, a
spatial probability is estimated based on genotype-ideotype distance,
enabling genotype ranking. Here we will use the mixed-model
<code>mod</code> as inpute data. By default, the selection is made to
increase the value of all traits. Change this default with the arguments
<code>DI</code> and <code>UI</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_g</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/gamem.html">gamem</a></span><span class="op">(</span><span class="va">GEN</span>, <span class="va">REP</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/fai_blup.html">fai_blup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Evaluating trait PH |===                                         | 7% 00:00:00 Evaluating trait EH |======                                      | 13% 00:00:00 Evaluating trait EP |=========                                   | 20% 00:00:00 Evaluating trait EL |============                                | 27% 00:00:00 Evaluating trait ED |===============                             | 33% 00:00:00 Evaluating trait CL |==================                          | 40% 00:00:00 Evaluating trait CD |=====================                       | 47% 00:00:00 Evaluating trait CW |=======================                     | 53% 00:00:00 Evaluating trait KW |==========================                  | 60% 00:00:00 Evaluating trait NR |=============================               | 67% 00:00:01 Evaluating trait NKR |================================           | 73% 00:00:01 Evaluating trait CDED |==================================        | 80% 00:00:01 Evaluating trait PERK |====================================      | 87% 00:00:01 Evaluating trait TKW |========================================   | 93% 00:00:01 Evaluating trait NKE |===========================================| 100% 00:00:01 </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     model    PH    EH    EP    EL       ED       CL    CD       CW     KW</span></span>
<span><span class="co">#  Complete    NA    NA    NA    NA       NA       NA    NA       NA     NA</span></span>
<span><span class="co">#  Genotype 0.051 0.454 0.705 0.786 2.73e-05 2.25e-06 0.118 1.24e-05 0.0253</span></span>
<span><span class="co">#      NR   NKR     CDED     PERK     TKW     NKE</span></span>
<span><span class="co">#      NA    NA       NA       NA      NA      NA</span></span>
<span><span class="co">#  0.0056 0.216 9.14e-06 4.65e-07 0.00955 0.00952</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Variables with nonsignificant Genotype effect</span></span>
<span><span class="co"># PH EH EP EL CD NKR </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># -----------------------------------------------------------------------------------</span></span>
<span><span class="co"># Principal Component Analysis</span></span>
<span><span class="co"># -----------------------------------------------------------------------------------</span></span>
<span><span class="co">#      eigen.values cumulative.var</span></span>
<span><span class="co"># PC1          5.35          35.67</span></span>
<span><span class="co"># PC2          4.76          67.41</span></span>
<span><span class="co"># PC3          3.06          87.80</span></span>
<span><span class="co"># PC4          0.87          93.61</span></span>
<span><span class="co"># PC5          0.39          96.24</span></span>
<span><span class="co"># PC6          0.30          98.25</span></span>
<span><span class="co"># PC7          0.10          98.91</span></span>
<span><span class="co"># PC8          0.08          99.44</span></span>
<span><span class="co"># PC9          0.05          99.74</span></span>
<span><span class="co"># PC10         0.04          99.98</span></span>
<span><span class="co"># PC11         0.00         100.00</span></span>
<span><span class="co"># PC12         0.00         100.00</span></span>
<span><span class="co"># PC13         0.00         100.00</span></span>
<span><span class="co"># PC14         0.00         100.00</span></span>
<span><span class="co"># PC15         0.00         100.00</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># -----------------------------------------------------------------------------------</span></span>
<span><span class="co"># Factor Analysis</span></span>
<span><span class="co"># -----------------------------------------------------------------------------------</span></span>
<span><span class="co">#        FA1   FA2   FA3 comunalits</span></span>
<span><span class="co"># PH   -0.05 -0.90  0.20       0.85</span></span>
<span><span class="co"># EH    0.03 -0.77  0.57       0.91</span></span>
<span><span class="co"># EP    0.14 -0.31  0.85       0.83</span></span>
<span><span class="co"># EL    0.08 -0.13 -0.88       0.80</span></span>
<span><span class="co"># ED    0.63 -0.70 -0.02       0.90</span></span>
<span><span class="co"># CL    0.97 -0.02 -0.04       0.94</span></span>
<span><span class="co"># CD    0.17  0.04 -0.95       0.94</span></span>
<span><span class="co"># CW    0.89 -0.32 -0.14       0.91</span></span>
<span><span class="co"># KW    0.36 -0.87 -0.29       0.98</span></span>
<span><span class="co"># NR    0.03 -0.87  0.12       0.78</span></span>
<span><span class="co"># NKR  -0.73 -0.10 -0.47       0.77</span></span>
<span><span class="co"># CDED  0.74  0.62 -0.07       0.94</span></span>
<span><span class="co"># PERK -0.92 -0.12  0.00       0.86</span></span>
<span><span class="co"># TKW   0.91 -0.09 -0.13       0.85</span></span>
<span><span class="co"># NKE  -0.49 -0.79 -0.19       0.90</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># -----------------------------------------------------------------------------------</span></span>
<span><span class="co"># Comunalit Mean: 0.8780411 </span></span>
<span><span class="co"># Selection differential</span></span>
<span><span class="co"># -----------------------------------------------------------------------------------</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 15 √ó 9</span></span></span>
<span><span class="co">#    VAR   Factor      Xo      Xs       SD SDperc    h2        SG  SGperc</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> CL         1  28.4    30.0    1.59     5.58  0.901  1.43      5.03  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> CW         1  20.8    24.0    3.17    15.3   0.880  2.79     13.4   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> NKR        1  30.4    30.5    0.060<span style="text-decoration: underline;">3</span>   0.198 0.452  0.027<span style="text-decoration: underline;">3</span>    0.089<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> CDED       1   0.595   0.599  0.004<span style="text-decoration: underline;">87</span>  0.819 0.884  0.004<span style="text-decoration: underline;">31</span>   0.724 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> PERK       1  87.6    86.9   -<span style="color: #BB0000;">0.706</span>   -<span style="color: #BB0000;">0.806</span> 0.916 -<span style="color: #BB0000;">0.647</span>    -<span style="color: #BB0000;">0.738</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> TKW        1 318.    323.     5.70     1.79  0.712  4.06      1.28  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> PH         2   2.17    2.14  -<span style="color: #BB0000;">0.025</span><span style="color: #BB0000; text-decoration: underline;">8</span>  -<span style="color: #BB0000;">1.19</span>  0.610 -<span style="color: #BB0000;">0.015</span><span style="color: #BB0000; text-decoration: underline;">7</span>   -<span style="color: #BB0000;">0.726</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> EH         2   1.08    1.05  -<span style="color: #BB0000;">0.023</span><span style="color: #BB0000; text-decoration: underline;">1</span>  -<span style="color: #BB0000;">2.14</span>  0.308 -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">10</span>  -<span style="color: #BB0000;">0.658</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> ED         2  47.9    50.1    2.18     4.55  0.869  1.89      3.96  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> KW         2 147.    156.     9.17     6.24  0.659  6.04      4.12  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">11</span> NR         2  15.8    16.4    0.600    3.80  0.736  0.442     2.80  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">12</span> NKE        2 468.    492.    23.9      5.10  0.713 17.0       3.64  </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">13</span> EP         3   0.496   0.492 -<span style="color: #BB0000;">0.003</span><span style="color: #BB0000; text-decoration: underline;">85</span> -<span style="color: #BB0000;">0.776</span> 0.171 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">657</span> -<span style="color: #BB0000;">0.132</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">14</span> EL         3  14.7    14.7    0.047<span style="text-decoration: underline;">7</span>   0.325 0.126  0.006<span style="text-decoration: underline;">00</span>   0.040<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;">15</span> CD         3  15.8    16.2    0.437    2.77  0.532  0.233     1.47  </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># -----------------------------------------------------------------------------------</span></span>
<span><span class="co"># Selected genotypes</span></span>
<span><span class="co"># H5 H2</span></span>
<span><span class="co"># -----------------------------------------------------------------------------------</span></span></code></pre></div>
<p><img src="vignettes_blup_files/figure-html/unnamed-chunk-35-1.png" width="528" style="display: block; margin: auto;"></p>
<blockquote>
<ul>
<li>
<strong>IMPORTANT</strong> <code><a href="../reference/fai_blup.html">fai_blup()</a></code> recognizes models
fitted with both <code><a href="../reference/gamem_met.html">gamem_met()</a></code> and <code><a href="../reference/waasb.html">waasb()</a></code>. For
balanced data (all genotypes in all environments) <code><a href="../reference/waasb.html">waasb()</a></code>
and <code><a href="../reference/gamem_met.html">gamem_met()</a></code> will return the same model. In case of
unbalanced trials, the function <code><a href="../reference/waasb.html">waasb()</a></code> will return an
error since a complete two-way table is required to the singular value
decomposition procedure.</li>
</ul>
</blockquote>
<hr>
</div>
<div class="section level2">
<h2 id="rendering">Rendering engine<a class="anchor" aria-label="anchor" href="#rendering"></a>
</h2>
<p>This vignette was built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>. All tables were produced
with the package <a href="https://rstudio.github.io/DT/" class="external-link"><code>DT</code></a> using the
following function.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span> <span class="co"># Used to make the tables</span></span>
<span><span class="co"># Function to make HTML tables</span></span>
<span><span class="va">print_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table</span>, <span class="va">rownames</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">table</span>, rownames <span class="op">=</span> <span class="va">rownames</span>, extensions <span class="op">=</span> <span class="st">'Buttons'</span>,</span>
<span>                  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scrollX <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                 dom <span class="op">=</span> <span class="st">'&lt;&lt;t&gt;Bp&gt;'</span>,</span>
<span>                                 buttons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'copy'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">num_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">class</span><span class="op">)</span> <span class="op">==</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">num_cols</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html" class="external-link">formatSignif</a></span><span class="op">(</span><span class="va">df</span>, columns <span class="op">=</span> <span class="va">num_cols</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">df</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ColombariFilho2013" class="csl-entry">
Colombari Filho, J. M., M. D. V. Resende, O. P. Morais, A. P. Castro, √â.
P. Guimar√£es, J. A. Pereira, M. M. Utumi, and F. Breseghello. 2013.
<span>‚Äú<span class="nocase">Upland rice breeding in Brazil: a
simultaneous genotypic evaluation of stability, adaptability and grain
yield</span>.‚Äù</span> <em>Euphytica</em> 192 (1): 117‚Äì29. <a href="https://doi.org/10.1007/s10681-013-0922-2" class="external-link">https://doi.org/10.1007/s10681-013-0922-2</a>.
</div>
<div id="ref-Henderson1975" class="csl-entry">
Henderson, C. R. 1975. <span>‚Äú<span class="nocase">Best Linear Unbiased
Estimation and Prediction under a Selection Model</span>.‚Äù</span>
<em>Biometrics</em> 31 (2): 423‚Äì47. <a href="https://doi.org/10.2307/2529430" class="external-link">https://doi.org/10.2307/2529430</a>.
</div>
<div id="ref-Olivoto2019" class="csl-entry">
Olivoto, T., A. D. C L√∫cio, J. A. G. Da silva, V. S. Marchioro, V. Q. de
Souza, and E. Jost. 2019. <span>‚Äú<span class="nocase">Mean performance
and stability in multi-environment trials I: Combining features of AMMI
and BLUP techniques</span>.‚Äù</span> <em>Agronomy Journal</em> 111 (6):
2949‚Äì60. <a href="https://doi.org/10.2134/agronj2019.03.0220" class="external-link">https://doi.org/10.2134/agronj2019.03.0220</a>.
</div>
<div id="ref-Rocha2018" class="csl-entry">
Rocha, Jo√£o Romero do Amaral Santos de Car, Juarez Campolina Machado,
and Pedro Cresc√™ncio Souza Carneiro. 2018. <span>‚Äú<span class="nocase">Multitrait index based on factor analysis and
ideotype-design: proposal and application on elephant grass breeding for
bioenergy</span>.‚Äù</span> <em>GCB Bioenergy</em> 10 (1): 52‚Äì60. <a href="https://doi.org/10.1111/gcbb.12443" class="external-link">https://doi.org/10.1111/gcbb.12443</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
