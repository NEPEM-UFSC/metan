<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing multienvironment trials using AMMI • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing multienvironment trials using AMMI">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><a class="dropdown-item" href="../news/index.html">Package news</a></li>
    <li><a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">More</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-more">
<li><a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
    <li><a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a></li>
    <li><a class="dropdown-item" href="../SUPPORT.html">Support</a></li>
    <li><a class="dropdown-item" href="../LICENSE.html">Licence</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TiagoOlivoto"><span class="fa fa-github fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/tolivoto"><span class="fa fab fa-twitter fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/"><span class="fa fab fa-mendeley fa-2x"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="vignettes_ammi_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="vignettes_ammi_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="vignettes_ammi_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="vignettes_ammi_files/datatables-binding-0.33/datatables.js"></script><link href="vignettes_ammi_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="vignettes_ammi_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="vignettes_ammi_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><script src="vignettes_ammi_files/jszip-1.13.6/jszip.min.js"></script><script src="vignettes_ammi_files/pdfmake-1.13.6/pdfmake.js"></script><script src="vignettes_ammi_files/pdfmake-1.13.6/vfs_fonts.js"></script><link href="vignettes_ammi_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="vignettes_ammi_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="vignettes_ammi_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="vignettes_ammi_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="vignettes_ammi_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="vignettes_ammi_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="vignettes_ammi_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyzing multienvironment trials using AMMI</h1>
                        <h4 data-toc-skip class="author">Tiago
Olivoto</h4>
            
            <h4 data-toc-skip class="date">2024-11-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nepem-ufsc/metan/blob/HEAD/vignettes/vignettes_ammi.Rmd" class="external-link"><code>vignettes/vignettes_ammi.Rmd</code></a></small>
      <div class="d-none name"><code>vignettes_ammi.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>In this section, we will use the data in <code>data_ge</code>. For
more information, please, see <code><a href="../reference/data_ge.html">?data_ge</a></code>. Other data sets can
be used provided that the following columns are in the dataset:
environment, genotype, block/replicate and response variable(s). See the
section <a href="#rendering">Rendering engine</a> to know how HTML
tables were generated.</p>
<p>The first step is to inspect the data with the function
<code><a href="../reference/inspect.html">inspect()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span></span>
<span><span class="va">insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data_ge</span>,</span>
<span>                verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_table</span><span class="op">(</span><span class="va">insp</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["ENV","GEN","REP","GY","HM"],["factor","factor","factor","numeric","numeric"],["No","No","No","No","No"],["14","10","3","-","-"],[420,420,420,420,420],[null,null,null,0.67,38],[null,null,null,2.61,48],[null,null,null,5.09,58],[null,null,null,0,0],[null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Class<\/th>\n      <th>Missing<\/th>\n      <th>Levels<\/th>\n      <th>Valid_n<\/th>\n      <th>Min<\/th>\n      <th>Median<\/th>\n      <th>Max<\/th>\n      <th>Outlier<\/th>\n      <th>Text<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[4,5,6,7,8]},{"name":"Variable","targets":0},{"name":"Class","targets":1},{"name":"Missing","targets":2},{"name":"Levels","targets":3},{"name":"Valid_n","targets":4},{"name":"Min","targets":5},{"name":"Median","targets":6},{"name":"Max","targets":7},{"name":"Outlier","targets":8},{"name":"Text","targets":9}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="individual-and-joint-anova">Individual and joint ANOVA<a class="anchor" aria-label="anchor" href="#individual-and-joint-anova"></a>
</h2>
<p>It is suggested to check if genotype-vs-environment interaction is
significant before proceeding with the AMMI analysis. A
within-environment ANOVA considering a fixed-effect model is computed
with the function <code><a href="../reference/anova_ind.html">anova_ind()</a></code>. For each environment the
Mean Squares for block, genotypes and error are shown. Estimated F-value
and the probability error are also shown for block and genotype effects.
Some measures of experimental precision are calculated, namely,
coefficient of variation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>V</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mrow><mi>M</mi><msub><mi>S</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi></mrow></msub></mrow></msqrt><mi>/</mi><mi>M</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">CV = (\sqrt{MS_{res}}/Mean) \times 100</annotation></semantics></math>;
the heritability,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mn>2</mn><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><msub><mi>S</mi><mrow><mi>g</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>−</mo><mi>M</mi><msub><mi>S</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>M</mi><msub><mi>S</mi><mrow><mi>g</mi><mi>e</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h2 = (MS_{gen} - MS_{res})/MS_{gen}</annotation></semantics></math>,
and the accuracy of selection,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>s</mi><mo>=</mo><msqrt><mrow><mi>h</mi><mn>2</mn></mrow></msqrt></mrow><annotation encoding="application/x-tex">As = \sqrt{h2}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anova_ind.html">anova_ind</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span><span class="op">)</span></span>
<span><span class="co"># Evaluating trait GY |============================================| 100% 00:00:00 </span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">indiv</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">individual</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["E1","E10","E11","E12","E13","E14","E2","E3","E4","E5","E6","E7","E8","E9"],[2.520683333333333,2.175209333333333,1.368264666666667,1.608512345679012,2.909630864197531,1.781933333333333,3.179959,4.064333333333334,3.675272666666667,3.9105,2.663213580246913,1.988896,2.536375666666667,3.0566],[9,9,9,9,9,9,9,9,9,9,9,9,9,9],[0.3373856005111111,0.2957869041244445,0.1509216197644444,0.3201522031448459,0.713410667220444,0.1305017347152364,0.2066252863855557,0.335055037037037,0.5313370078355559,0.52611928407763,0.1346432908652133,0.3369183491318518,0.2146241081633334,0.6792531703703708],[2.342818452090545,11.08983055327908,1.437682305972743,5.982141307433706,7.179014026265448,1.732332251793119,1.157469101391255,1.872483558486384,3.858834616427411,7.928600858891081,2.299010843853072,3.701152307657075,7.71741966353918,6.124129061066109],[0.05935749179527415,1.097035032019893e-05,0.244311554211092,0.0006473653561996399,0.00020950844519714,0.1534700923987055,0.3763217234864661,0.1230334334428028,0.007122696211775615,0.0001101302784656218,0.06345403049375452,0.008726631667971652,0.0001314195499590997,0.0005621780715608286],[2,2,2,2,2,2,2,2,2,2,2,2,2,2],[0.06522155689333316,0.653673984253333,0.3773095219733335,0.09189508975765925,0.07673787343392782,0.1035208231824418,0.69828883617,0.488644133333333,0.1164597892933333,0.2188069000000001,0.1598511935985362,0.3809856427599994,0.8167717291233326,0.5825910999999997],[0.4529009736405213,24.50796036394634,3.594257896666778,1.717087707001998,0.77220918475238,1.374176834679111,3.911659438453591,2.730829280194802,0.8457891314170268,3.297413015971712,2.729431411876158,4.18524516257069,29.36934837796651,5.252626328240838],[0.6428307005638019,7.275295663933099e-06,0.04859922511432083,0.2077263167642995,0.4767028961519174,0.2783554737449471,0.03884579579645543,0.09209247701603474,0.4455821792576004,0.06023636428502246,0.09219130114706803,0.03216538106066062,2.149427355279181e-06,0.01596351384933321],[18,18,18,18,18,18,18,18,18,18,18,18,18,18],[0.1440084272044447,0.02667190474222215,0.1049756397066667,0.05351799409134801,0.0993744634862572,0.07533297067012142,0.1785147319588888,0.1789361703703704,0.1376936460488889,0.06635714086775389,0.05856574849362401,0.09103066318962967,0.02781034562333333,0.110914248148148],[15.0548233431901,7.508029280712761,23.67958859747597,14.38220633470189,10.83426623750111,15.40285031274061,13.28665047888771,10.40781945862833,10.09641946108127,6.587362185535167,9.086902168046597,15.16986720478283,6.574907012939827,10.89569809509503],[0.3092043719774054,0.7708144511275983,0.1273190094420008,0.6241610008574863,0.6731675110839139,0.196213038493903,0.04987193740767579,0.2253033603136605,0.4879527762076796,0.6978426222750718,0.3021650540171256,0.4737905886199927,0.6912760687637761,0.6307296477628437],[0.5731636827823002,0.909827296711552,0.304436038584063,0.8328357775906513,0.8607051056953842,0.4227435303101293,0.1360460518574364,0.4659499169069625,0.74085440310323,0.873874342043766,0.5650303248139403,0.7298138750109893,0.8704230113693981,0.836711475210825],[0.7570757444155111,0.9538486760024107,0.5517572279400271,0.9125983659807042,0.9277419391702545,0.6501873040210254,0.3688442108227217,0.6826052423670378,0.860728995156565,0.9348124635689053,0.751684990414163,0.8542914461768825,0.9329646356477818,0.9147193423180823]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ENV<\/th>\n      <th>MEAN<\/th>\n      <th>DFG<\/th>\n      <th>MSG<\/th>\n      <th>FCG<\/th>\n      <th>PFG<\/th>\n      <th>DFB<\/th>\n      <th>MSB<\/th>\n      <th>FCB<\/th>\n      <th>PFB<\/th>\n      <th>DFE<\/th>\n      <th>MSE<\/th>\n      <th>CV<\/th>\n      <th>h2<\/th>\n      <th>h2mg<\/th>\n      <th>AS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]},{"name":"ENV","targets":0},{"name":"MEAN","targets":1},{"name":"DFG","targets":2},{"name":"MSG","targets":3},{"name":"FCG","targets":4},{"name":"PFG","targets":5},{"name":"DFB","targets":6},{"name":"MSB","targets":7},{"name":"FCB","targets":8},{"name":"PFB","targets":9},{"name":"DFE","targets":10},{"name":"MSE","targets":11},{"name":"CV","targets":12},{"name":"h2","targets":13},{"name":"h2mg","targets":14},{"name":"AS","targets":15}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render"],"jsHooks":[]}</script><p>The joint ANOVA is performed with the function
<code><a href="../reference/anova_joint.html">anova_joint()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span></span>
<span><span class="va">joint</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anova_joint.html">anova_joint</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">joint</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">anova</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["ENV","REP(ENV)","GEN","GEN:ENV","ENV/GEN","   ENV/G1","   ENV/G10","   ENV/G2","   ENV/G3","   ENV/G4","   ENV/G5","   ENV/G6","   ENV/G7","   ENV/G8","   ENV/G9","Residuals","CV(%)","MSR+/MSR-","OVmean"],[13,28,9,117,130,13,13,13,13,13,13,13,13,13,13,252,11.62779035830142,6.708788596080688,2.674241723104057],[279.5735520252489,9.661516347545119,12.99504370353098,31.21956466659275,310.7931166918414,32.69000587533742,42.71092484242712,34.03387864623829,30.39412569917903,26.80300579442769,23.46560305589463,22.01780179242093,21.99167192046235,32.44975853102738,44.23634053442657,24.36667370283055,null,null,null],[21.50565784809607,0.3450541552694685,1.443893744836776,0.2668338860392543,2.390716282244934,2.514615836564417,3.285455757109778,2.617990665095253,2.338009669167618,2.061769676494438,1.805046388914972,1.693677060955456,1.691667070804796,2.496135271617491,3.402795425725121,0.09669314961440693,null,null,null],[62.32545680054575,3.568548099275656,5.411208322410606,2.759594522500661,24.72477411045804,26.00614259223332,33.97816463949641,27.07524447735212,24.1796826196182,21.32281019613453,18.6677794250486,17.51599847258574,17.49521116594948,25.8150166953045,35.19169082085745,null,null,null,null],[3.897252292458347e-17,3.593191014179642e-08,3.441249075645755e-06,1.005190935131533e-11,9.581857259913233e-95,1.900818974942834e-39,4.71668306962005e-48,1.109382047008528e-40,2.828854206430151e-37,1.064020956179774e-33,3.661530375804101e-30,1.472928349609353e-28,1.575982925377378e-28,3.179842759464089e-39,2.970939272366006e-49,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Source<\/th>\n      <th>Df<\/th>\n      <th>Sum Sq<\/th>\n      <th>Mean Sq<\/th>\n      <th>F value<\/th>\n      <th>Pr(&gt;F)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5]},{"name":"Source","targets":0},{"name":"Df","targets":1},{"name":"Sum Sq","targets":2},{"name":"Mean Sq","targets":3},{"name":"F value","targets":4},{"name":"Pr(>F)","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script><p>The genotype-vs-environment interaction was highly significant. So
we’ll proceed with the AMMI analysis.</p>
<div class="section level3">
<h3 id="the-ammi-model">The AMMI model<a class="anchor" aria-label="anchor" href="#the-ammi-model"></a>
</h3>
<p>The estimate of the response variable for the <em>i</em>th genotype
in the <em>j</em>th environment using The Additive Main Effect and
Multiplicative interaction (AMMI) model, is given as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>μ</mi><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msub><mi>τ</mi><mi>j</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mrow><msub><mi>λ</mi><mi>k</mi></msub><msub><mi>a</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mrow><msub><mi>t</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>ρ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>ε</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
{y_{ij}} = \mu  + {\alpha_i} + {\tau_j} + \sum\limits_{k = 1}^p {{\lambda _k}{a_{ik}}} {t_{jk}} + {\rho _{ij}} + {\varepsilon _{ij}}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{\lambda_k}</annotation></semantics></math>
is the singular value for the <em>k</em>-th interaction principal
component axis (IPCA);
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">a_{ik}</annotation></semantics></math>
is the <em>i</em>-th element of the <em>k</em>-th eigenvector;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><annotation encoding="application/x-tex">t_{jk}</annotation></semantics></math>
is the <em>j</em>th element of the <em>k</em>th eigenvector. A residual
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\rho _{ij}</annotation></semantics></math>
remains, if not all <em>p</em> IPCA are used, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≤</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mo>−</mo><mn>1</mn><mo>;</mo><mi>e</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p \le min(g - 1; e - 1)</annotation></semantics></math>.</p>
<p>The AMMI model is fitted with the <code><a href="../reference/performs_ammi.html">performs_ammi()</a></code>
function. The first argument is the data, in our example
<code>data_ge</code>. The second argument (<code>resp</code>) is the
response variable to be analyzed. The function allow a single variable
(in this case GY) or a vector of response variables. The arguments
(<code>gen</code>, <code>env</code>, and <code>rep</code>) are the name
of the columns that contains the levels for genotypes, environments, and
replications, respectively. The last argument (<code>verbose</code>)
control if the code will run silently.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AMMI_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">data_ge</span>,</span>
<span>                            env <span class="op">=</span> <span class="va">ENV</span>,</span>
<span>                            gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span>                            rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span>                            resp <span class="op">=</span> <span class="va">GY</span>,</span>
<span>                            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Note that using the arguments in the correct order, the model above
may be fitted cleanly with:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AMMI_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-ammi-table">The AMMI table<a class="anchor" aria-label="anchor" href="#the-ammi-table"></a>
</h3>
<p>The following comand creates the well-known ANOVA table for the AMMI
model. Note that since</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AMMI_model</span></span>
<span><span class="co"># Variable GY </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#       Source  Df     Sum Sq     Mean Sq   F value       Pr(&gt;F) Proportion</span></span>
<span><span class="co"># 1        ENV  13 279.573552 21.50565785 62.325457 0.000000e+00         NA</span></span>
<span><span class="co"># 2   REP(ENV)  28   9.661516  0.34505416  3.568548 3.593191e-08         NA</span></span>
<span><span class="co"># 3        GEN   9  12.995044  1.44389374 14.932741 2.190118e-19         NA</span></span>
<span><span class="co"># 4    GEN:ENV 117  31.219565  0.26683389  2.759595 1.005191e-11         NA</span></span>
<span><span class="co"># 5        PC1  21  10.749140  0.51186000  5.290000 0.000000e+00       34.4</span></span>
<span><span class="co"># 6        PC2  19   9.923920  0.52231000  5.400000 0.000000e+00       31.8</span></span>
<span><span class="co"># 7        PC3  17   4.039180  0.23760000  2.460000 1.400000e-03       12.9</span></span>
<span><span class="co"># 8        PC4  15   3.073770  0.20492000  2.120000 9.600000e-03        9.8</span></span>
<span><span class="co"># 9        PC5  13   1.446440  0.11126000  1.150000 3.176000e-01        4.6</span></span>
<span><span class="co"># 10       PC6  11   0.932240  0.08475000  0.880000 5.606000e-01        3.0</span></span>
<span><span class="co"># 11       PC7   9   0.566700  0.06297000  0.650000 7.535000e-01        1.8</span></span>
<span><span class="co"># 12       PC8   7   0.362320  0.05176000  0.540000 8.037000e-01        1.2</span></span>
<span><span class="co"># 13       PC9   5   0.125860  0.02517000  0.260000 9.345000e-01        0.4</span></span>
<span><span class="co"># 14 Residuals 252  24.366674  0.09669315        NA           NA         NA</span></span>
<span><span class="co"># 15     Total 536 389.035920  0.72581328        NA           NA         NA</span></span>
<span><span class="co">#    Accumulated</span></span>
<span><span class="co"># 1           NA</span></span>
<span><span class="co"># 2           NA</span></span>
<span><span class="co"># 3           NA</span></span>
<span><span class="co"># 4           NA</span></span>
<span><span class="co"># 5         34.4</span></span>
<span><span class="co"># 6         66.2</span></span>
<span><span class="co"># 7         79.2</span></span>
<span><span class="co"># 8         89.0</span></span>
<span><span class="co"># 9         93.6</span></span>
<span><span class="co"># 10        96.6</span></span>
<span><span class="co"># 11        98.4</span></span>
<span><span class="co"># 12        99.6</span></span>
<span><span class="co"># 13       100.0</span></span>
<span><span class="co"># 14          NA</span></span>
<span><span class="co"># 15          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># Scores for genotypes and environments</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 24 × 12</span></span></span>
<span><span class="co">#    type  Code      Y      PC1      PC2      PC3      PC4      PC5      PC6</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> GEN   G1    2.604  0.316<span style="text-decoration: underline;">6</span>  -<span style="color: #BB0000;">0.044</span><span style="color: #BB0000; text-decoration: underline;">17</span> -<span style="color: #BB0000;">0.036</span><span style="color: #BB0000; text-decoration: underline;">00</span> -<span style="color: #BB0000;">0.065</span><span style="color: #BB0000; text-decoration: underline;">95</span> -<span style="color: #BB0000;">0.312</span><span style="color: #BB0000; text-decoration: underline;">5</span>  -<span style="color: #BB0000;">0.427</span><span style="color: #BB0000; text-decoration: underline;">2</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> GEN   G10   2.471 -<span style="color: #BB0000;">1.001</span>   -<span style="color: #BB0000;">0.571</span><span style="color: #BB0000; text-decoration: underline;">8</span>  -<span style="color: #BB0000;">0.165</span><span style="color: #BB0000; text-decoration: underline;">2</span>  -<span style="color: #BB0000;">0.330</span><span style="color: #BB0000; text-decoration: underline;">9</span>  -<span style="color: #BB0000;">0.124</span><span style="color: #BB0000; text-decoration: underline;">3</span>   0.106<span style="text-decoration: underline;">4</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> GEN   G2    2.744  0.139<span style="text-decoration: underline;">0</span>   0.198<span style="text-decoration: underline;">8</span>  -<span style="color: #BB0000;">0.733</span><span style="color: #BB0000; text-decoration: underline;">1</span>   0.473<span style="text-decoration: underline;">5</span>  -<span style="color: #BB0000;">0.048</span><span style="color: #BB0000; text-decoration: underline;">16</span>  0.284<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> GEN   G3    2.955  0.043<span style="text-decoration: underline;">40</span> -<span style="color: #BB0000;">0.102</span><span style="color: #BB0000; text-decoration: underline;">8</span>   0.228<span style="text-decoration: underline;">4</span>   0.176<span style="text-decoration: underline;">9</span>  -<span style="color: #BB0000;">0.127</span><span style="color: #BB0000; text-decoration: underline;">0</span>   0.140<span style="text-decoration: underline;">0</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> GEN   G4    2.642 -<span style="color: #BB0000;">0.325</span><span style="color: #BB0000; text-decoration: underline;">1</span>   0.478<span style="text-decoration: underline;">2</span>  -<span style="color: #BB0000;">0.090</span><span style="color: #BB0000; text-decoration: underline;">73</span>  0.141<span style="text-decoration: underline;">7</span>  -<span style="color: #BB0000;">0.192</span><span style="color: #BB0000; text-decoration: underline;">4</span>  -<span style="color: #BB0000;">0.355</span><span style="color: #BB0000; text-decoration: underline;">0</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> GEN   G5    2.537 -<span style="color: #BB0000;">0.326</span><span style="color: #BB0000; text-decoration: underline;">0</span>   0.246<span style="text-decoration: underline;">1</span>   0.245<span style="text-decoration: underline;">2</span>   0.179<span style="text-decoration: underline;">4</span>   0.466<span style="text-decoration: underline;">2</span>  -<span style="color: #BB0000;">0.033</span><span style="color: #BB0000; text-decoration: underline;">15</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> GEN   G6    2.534 -<span style="color: #BB0000;">0.098</span><span style="color: #BB0000; text-decoration: underline;">36</span>  0.242<span style="text-decoration: underline;">9</span>   0.560<span style="text-decoration: underline;">7</span>   0.237<span style="text-decoration: underline;">7</span>   0.050<span style="text-decoration: underline;">94</span>  0.101<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> GEN   G7    2.741  0.284<span style="text-decoration: underline;">9</span>   0.587<span style="text-decoration: underline;">1</span>  -<span style="color: #BB0000;">0.206</span><span style="color: #BB0000; text-decoration: underline;">8</span>  -<span style="color: #BB0000;">0.708</span><span style="color: #BB0000; text-decoration: underline;">5</span>   0.231<span style="text-decoration: underline;">5</span>   0.084<span style="text-decoration: underline;">06</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> GEN   G8    3.004  0.499<span style="text-decoration: underline;">5</span>  -<span style="color: #BB0000;">0.191</span><span style="color: #BB0000; text-decoration: underline;">6</span>   0.319<span style="text-decoration: underline;">1</span>  -<span style="color: #BB0000;">0.167</span><span style="color: #BB0000; text-decoration: underline;">6</span>  -<span style="color: #BB0000;">0.326</span><span style="color: #BB0000; text-decoration: underline;">1</span>   0.288<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> GEN   G9    2.510  0.466<span style="text-decoration: underline;">8</span>  -<span style="color: #BB0000;">0.842</span><span style="color: #BB0000; text-decoration: underline;">7</span>  -<span style="color: #BB0000;">0.121</span><span style="color: #BB0000; text-decoration: underline;">7</span>   0.063<span style="text-decoration: underline;">85</span>  0.381<span style="text-decoration: underline;">9</span>  -<span style="color: #BB0000;">0.188</span><span style="color: #BB0000; text-decoration: underline;">9</span> </span></span>
<span><span class="co"># <span style="color: #949494;"># ℹ 14 more rows</span></span></span>
<span><span class="co"># <span style="color: #949494;"># ℹ 3 more variables: PC7 &lt;dbl&gt;, PC8 &lt;dbl&gt;, PC9 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Nine interaction principal component axis (IPCA) were fitted and four
were significant at 5% probability error. Based on this result, the
AMMI4 model would be the best model to predict the yielding of the
genotypes in the studied environments.</p>
</div>
</div>
<div class="section level2">
<h2 id="estimating-the-response-variable-based-on-significant-ipca-axes">Estimating the response variable based on significant IPCA axes<a class="anchor" aria-label="anchor" href="#estimating-the-response-variable-based-on-significant-ipca-axes"></a>
</h2>
<p>The response variable of a two-way table (for example, the yield of
<em>m</em> genotypes in <em>n</em> environments) may be estimated using
the S3 method <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> applyed to an object of class
<code>waas</code>. This estimation is based on the number of
multiplicative terms declared in the function. If
<code>naxis = 1</code>, the AMMI1 (with one multiplicative term) is used
for estimating the response variable. If
<code>naxis = min(g - 1; e - 1)</code>, the AMMIF is fitted. A summary
of all possible AMMI models is presented below.</p>
<table class="table">
<colgroup>
<col width="24%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th align="left">Member of AMMI family</th>
<th align="left">Espected response of the <em>i</em>-th genotype in the
<em>j</em>th environment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AMMI0</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>+</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>.</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left">AMMI1</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>+</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>.</mi></mrow></msub><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><msub><mi>a</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>t</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..} +\lambda_1 a_{i1}t_{j1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="left">AMMI2</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>+</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>.</mi></mrow></msub><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><msub><mi>a</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>t</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><msub><mi>a</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><msub><mi>t</mi><mrow><mi>j</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..} +\lambda_1 a_{i1}t_{j1}+\lambda_2 a_{i2}t_{j2}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">AMMIF</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>+</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>.</mi></mrow></msub><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><msub><mi>a</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>t</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><msub><mi>a</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><msub><mi>t</mi><mrow><mi>j</mi><mn>2</mn></mrow></msub><mo>+</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>+</mo><msub><mi>λ</mi><mi>p</mi></msub><msub><mi>a</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub><msub><mi>t</mi><mrow><mi>j</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..} +\lambda_1 a_{i1}t_{j1}+\lambda_2 a_{i2}t_{j2}+...+\lambda_p a_{ip}t_{jp}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>Procedures based on postdictive success, such as Gollobs’s test <span class="citation">(<a href="#ref-Gollob:1968">Gollob 1968</a>)</span> or
predictive success, such as cross-validation <span class="citation">(<a href="#ref-Piepho:1994">Piepho 1994</a>)</span> should be used to define
the number of IPCA used for estimating the response variable in AMMI
analysis. This package provides both. The <code><a href="../reference/waas.html">waas()</a></code> function
compute traditional AMMI analysis showing the number of significant axes
according to Gollobs’s test. On the other hand, <code><a href="../reference/cv_ammif.html">cv_ammif()</a></code>
function provides cross-validation of AMMI-model family, considering a
completely randomized design (CRD) or a randomized complete block design
(RCBD).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">AMMI_model</span>, naxis <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">predicted</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY","GY"],["E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9"],["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9"],[2.365786666666667,1.974073333333333,2.901746666666667,2.888586666666667,2.588566666666667,2.18826,2.3008,2.773726666666667,2.89936,2.325926666666667,2.307633333333333,1.536253333333333,2.297053333333333,2.336726666666666,2.167353333333333,2.139833333333333,2.208146666666666,2.441893333333333,2.574866666666667,1.742333333333333,1.355666666666667,0.8991,1.49072,1.567726666666666,1.37,1.325666666666667,1.500666666666667,1.364333333333333,1.683433333333333,1.125333333333333,1.342333333333333,1.022135802469136,1.993333333333333,1.764358024691358,1.527333333333333,1.689,1.385666666666667,1.95162962962963,2,1.409333333333333,2.99825925925926,1.830666666666667,3.028308641975308,3.469148148148149,2.635716049382716,2.568098765432099,2.911666666666667,3.18383950617284,3.519975308641975,2.950629629629629,1.533333333333333,1.85920987654321,1.42658024691358,2.059654320987654,1.861333333333333,1.784296296296296,1.798851851851852,1.936333333333333,1.991864197530864,1.567876543209877,3.04069,3.14584,3.231053333333333,3.60828,3.19008,3.140136666666667,3.291173333333334,2.612676666666667,3.444796666666667,3.094863333333333,4.080333333333334,4.114333333333333,4.568666666666667,4.132333333333333,3.854333333333333,3.741333333333333,3.434666666666667,4.101333333333334,4.11,4.506,3.494333333333334,4.271,3.715573333333333,4.134,3.302166666666666,3.379113333333333,3.403473333333333,3.018953333333333,4.137773333333334,3.89634,4.170530864197531,3.365666666666667,3.827432098765432,4.126654320987654,3.782604938271605,3.469,3.568925925925926,4.047913580246914,4.812098765432099,3.934172839506173,2.809086419753086,2.484876543209876,2.541333333333333,2.984716049382716,2.701185185185185,2.433320987654321,2.335555555555556,2.665901234567901,2.908123456790123,2.768037037037037,1.89788,2.243626666666667,1.987626666666667,2.158546666666667,1.980886666666667,1.656766666666667,1.757786666666667,2.550813333333333,2.26178,1.393246666666667,2.271933333333333,2.70031,2.045296666666667,2.85042,2.30059,2.70833,2.53938,2.583383333333333,2.878853333333334,2.48526,2.783666666666667,3.15,3.363333333333333,3.293666666666667,3.724666666666667,3.299666666666667,3.039666666666667,3.14,2.828,1.943333333333333],[-0.08433112522045287,-0.3435891499118118,0.3111580811287478,0.08680094708993658,0.1002096155202816,-0.1955260899470844,-0.07967208641975175,0.1863757266313743,0.04928088536155289,-0.0307068042327962,0.202989541446209,-0.4359351499118164,0.05193874779541513,-0.1195850529100514,0.02447028218694964,0.101521243386243,0.1731485802469145,0.2000163932980618,0.07026155202821946,-0.2688261375661372,0.05796754144620763,-0.2661438165784828,0.05255008112874792,-0.08164038624338538,0.03406161552028236,0.09429924338624325,0.2726132469135801,-0.07059894003527191,-0.01422711463844788,-0.07888147089947149,-0.1956134708994713,-0.3833556931216934,0.3149157354497357,-0.1252567072310396,-0.04885273015872996,0.2173848977072309,-0.08263443209876559,0.2764496772486787,0.06209187301587305,-0.03512914991181705,0.1591939365079368,-0.8759433474426814,0.04877252557319191,0.278414897707232,-0.2415885326278661,-0.2046348553791895,0.1422470493827156,0.2075410352733697,0.2809486631393293,0.2050486278659603,-0.1780344585537924,0.2802973932980592,-0.4252583386243385,-0.003381398589064482,0.1117262821869488,0.139260206349206,0.1571297654320987,0.08773239329806146,-0.1194649171075839,-0.05000692768959482,-0.0687034585537928,0.1689018500881832,-0.01881091887125236,0.1472186137566147,0.04244728218694888,0.09707491005290984,0.2514255802469135,-0.6339499400352722,-0.06455811463844825,0.07895419576719485,0.08656554144620766,0.2530208500881818,0.4344280811287479,-0.2131023862433856,-0.1776737178130517,-0.1861027566137574,-0.4894554197530872,-0.02966760670193878,-0.2837291146384482,0.6057165291005281,-0.1103737918871258,0.7987481834215161,-0.02960458553791882,0.1776249470899481,-0.3407797178130515,-0.1592620899470906,-0.1315880864197534,-0.7229869400352718,0.1331048853615522,0.3851171957671953,0.3305964056437383,-0.3418124832451502,-0.1529731534391531,-0.06494806525573173,-0.09556877954144614,-0.3046027566137572,-0.201362827160494,0.07074597354497529,0.5722029841269838,0.1877227019400347,0.2164383809523804,0.02468381305114608,-0.1917854991181656,0.04040008289241712,0.07029788712522006,-0.09299534920634925,-0.1874467777777778,-0.06397995238095117,-0.0844859047619049,0.2688733192239854,-0.02045045855379259,0.4577515167548495,-0.07117458553791896,-0.1114517195767189,0.02431694885361546,-0.1952320899470904,-0.09089808641975321,0.4952497266313946,-0.05651178130511478,-0.4315994708994715,-0.1938767918871261,0.3669551834215161,-0.5609842522045856,0.03294194708994807,-0.2034593844797178,0.3088515767195764,0.1432155802469134,-0.0196599400352719,0.01308188536155228,0.1129341957671951,-0.2023677918871259,0.2964208500881829,0.2368280811287477,-0.04403571957671863,0.7003929488536155,0.3799639100529096,0.1232779135802467,0.01673239329806153,-0.5579957813051148,-0.949216804232805],[2.45011779188712,2.317662483245145,2.590588585537919,2.80178571957673,2.488357051146386,2.383786089947085,2.380472086419751,2.587350940035293,2.850079114638447,2.356633470899463,2.104643791887125,1.97218848324515,2.245114585537918,2.456311719576718,2.142883051146383,2.03831208994709,2.034998086419752,2.241876940035271,2.504605114638447,2.011159470899471,1.297699125220459,1.165243816578483,1.438169918871252,1.649367052910052,1.335938384479718,1.231367423280423,1.228053419753087,1.434932273368605,1.697660447971781,1.204214804232805,1.537946804232805,1.405491495590829,1.678417597883598,1.889614731922397,1.576186063492063,1.471615102292769,1.468301098765432,1.675179952380951,1.937908126984127,1.44446248324515,2.839065322751324,2.706610014109348,2.979536116402116,3.190733250440917,2.877304582010582,2.772733620811288,2.769419617283951,2.97629847089947,3.239026645502646,2.745581001763669,1.711367791887126,1.57891248324515,1.851838585537919,2.063035719576719,1.749607051146384,1.64503608994709,1.641722086419753,1.848600940035272,2.111329114638448,1.617883470899472,3.109393458553793,2.976938149911817,3.249864252204585,3.461061386243386,3.147632717813051,3.043061756613757,3.03974775308642,3.246626606701939,3.509354781305115,3.015909137566138,3.993767791887126,3.861312483245151,4.134238585537919,4.345435719576719,4.032007051146385,3.927436089947091,3.924122086419754,4.131000940035272,4.393729114638449,3.900283470899472,3.604707125220459,3.472251816578484,3.745177918871252,3.956375052910052,3.642946384479718,3.538375423280424,3.535061419753087,3.741940273368605,4.004668447971781,3.511222804232805,3.839934458553792,3.707479149911817,3.980405252204585,4.191602386243385,3.878173717813051,3.773602756613757,3.77028875308642,3.977167606701939,4.239895781305115,3.746450137566138,2.592648038800706,2.460192730158731,2.733118832451499,2.944315966490299,2.630887298059965,2.52631633686067,2.523002333333333,2.729881186948852,2.992609361552028,2.499163717813051,1.918330458553793,1.785875149911817,2.058801252204586,2.269998386243385,1.956569717813051,1.851998756613757,1.84868475308642,2.055563606701939,2.318291781305115,1.824846137566138,2.465810125220459,2.333354816578484,2.606280918871252,2.817478052910052,2.504049384479718,2.399478423280424,2.396164419753087,2.603043273368605,2.865771447971782,2.372325804232805,2.986034458553792,2.853579149911817,3.126505252204586,3.337702386243385,3.024273717813051,2.919702756613757,2.91638875308642,3.123267606701939,3.385995781305115,2.892550137566138],[[0.071154844897097],[-0.3539114123439639],[0.2903501574578539],[-0.04518794594397622],[0.04942369982322901],[-0.07091880921332276],[-0.08293017101152561],[0.1643348170516763],[-0.005355415527657122],[-0.01695976518941082],[0.04658790580353951],[-0.4561780720257497],[0.03208425120063292],[0.002194249909733751],[0.0994656572223077],[0.05292507482166118],[0.1388193624218608],[0.2366383134475082],[0.06980925415819893],[-0.2223459969596918],[-0.001667498516874352],[-0.2772191072635182],[0.03936242215685522],[0.06133873238029285],[0.07077584180456725],[0.09199909288185339],[0.1715561362474658],[-0.07068661817151528],[0.02019146292285706],[-0.1056504644419826],[0.0579574334844425],[-0.3630915538617184],[0.2499555625013109],[-0.04773102356503071],[0.08628404741786087],[-0.03528110540875782],[-0.04051576438358454],[0.2085900059017327],[-0.01436555195621945],[-0.1018020501300358],[0.2075925008543186],[-0.8782828605002623],[0.03759798268872776],[0.08854547425726556],[-0.1729619457125332],[-0.1296108010497158],[0.1079363487070343],[0.1473696375070451],[0.3808482116863212],[0.2109654515617999],[-0.08639590198399613],[0.3239606674909229],[-0.3672240234139741],[0.008880450979991898],[0.03515140217912156],[0.1217763350577271],[0.1316353823565813],[0.03462955273882215],[-0.01307372012726522],[-0.1893401452779302],[-0.1042210473509476],[0.1568604399963566],[-0.01806509196839315],[0.1602721069856834],[0.01016476971012716],[0.1670176058869375],[0.2224501433975661],[-0.6154916032715394],[-0.07570306121135696],[0.09671573782556658],[0.0657668644204604],[0.2950569475831017],[0.4830872870207306],[-0.1241484716909599],[-0.1522151986811612],[-0.3075191236629048],[-0.5282789226472759],[-0.07955565137174908],[-0.1289557575179321],[0.4767620265476862],[-0.07756060218847459],[0.7375432449396684],[-0.1277914430260719],[0.09850614599639876],[-0.261254389545328],[-0.06597827940999022],[-0.1283682621195325],[-0.6880530820697759],[-0.03412363015636054],[0.547080297579464],[0.1799129553069431],[-0.3718568507525142],[-0.1369391453707609],[0.01450836215634572],[-0.2711711042505517],[-0.2189139411998821],[-0.08688019849538575],[0.2190154411780457],[0.3500627104403941],[0.322261770987366],[0.03343853661928777],[0.08399736948154983],[-0.0407551952833696],[-0.0002904873772250835],[-0.1185152751118633],[-0.08945452860533259],[-0.09190730121183348],[-0.03190393030834938],[0.06733035556222963],[0.1880604562349055],[-0.0450048450007105],[0.3935142987592812],[-0.1549154430731211],[-0.1830281829672722],[0.1060598612856947],[-0.02368156171286528],[-0.1798410186270037],[0.5117445958267788],[-0.1250223103132354],[-0.2998253941775466],[-0.07140407341792528],[0.4122487006556672],[-0.5542867746680394],[0.06649073943269843],[-0.1046182103652304],[0.09207953079742739],[0.1612825681653834],[-0.1012261036819654],[0.1061562584251934],[-0.006722635343208248],[-0.2761570729271603],[0.2973581878411783],[0.26753945377762],[-0.1003501505539461],[0.6234108442237594],[0.4155605108171647],[0.2050416972002499],[0.06459462522328446],[-0.5977988063851675],[-0.8991992892169814]],[[2.521272636784217],[1.963751070901181],[2.880938742995773],[2.756597773632754],[2.537780750969615],[2.312867280733762],[2.297541915408226],[2.751685757086969],[2.84472369911079],[2.339673705710052],[2.151231697690664],[1.5160104112194],[2.277198836738551],[2.458505969486451],[2.242348708368691],[2.091237164768751],[2.173817448841613],[2.478515253482779],[2.574414368796646],[1.788813473939779],[1.296031626703585],[0.8880247093149647],[1.477532341028107],[1.710705785290345],[1.406714226284285],[1.323366516162277],[1.399609556000552],[1.36424565519709],[1.717851910894638],[1.098564339790822],[1.595904237717247],[1.042399941729111],[1.928373160384909],[1.841883708357367],[1.662470110909924],[1.436333996884011],[1.427785334381848],[1.883769958282684],[1.923542575027908],[1.342660433115115],[3.046657823605642],[1.828327153609086],[3.017134099090844],[3.279278724698182],[2.704342636298049],[2.643122819761572],[2.877355965990986],[3.123668108406515],[3.619874857188967],[2.956546453325469],[1.62497188990313],[1.902873150736073],[1.484614562123945],[2.071916170556711],[1.784758453325506],[1.766812425004817],[1.773357468776334],[1.883230492774094],[2.098255394511183],[1.428543325621541],[3.005172411202845],[3.133798589908174],[3.231799160236192],[3.621333493229069],[3.157797487523178],[3.210079362500694],[3.262197896483986],[2.6311350034304],[3.433651720093758],[3.112624875391705],[4.059534656307586],[4.156369430828253],[4.61732587255865],[4.221287247885759],[3.879791852465224],[3.619916966284186],[3.395843163772478],[4.051445288663523],[4.264773357120516],[4.377045497447159],[3.527146523031985],[4.209795061518152],[3.61738647584518],[4.054881198906451],[3.38169199493439],[3.472397143870434],[3.406693157633554],[3.053887191298829],[3.970544817815421],[4.058303101812269],[4.019847413860735],[3.335622299159303],[3.843466106833824],[4.206110748399731],[3.6070026135625],[3.554688815413875],[3.683408554591034],[4.196183047879984],[4.589958491745509],[4.068711908553504],[2.626086575419994],[2.54419009964028],[2.692363637168129],[2.944025479113074],[2.512372022948101],[2.436861808255338],[2.4310950321215],[2.697977256640503],[3.059939717114258],[2.687224174047957],[1.873325613553082],[2.179389448671098],[1.903885809131464],[2.086970203276113],[2.062629579098746],[1.828317194900892],[1.668843734459416],[2.567308202528717],[2.193269470991879],[1.525020743388592],[2.394406051802534],[2.745603517234151],[2.051994144203213],[2.883968792342751],[2.399431174114488],[2.491557954077851],[2.55744698791847],[2.50181716968664],[2.971927706396975],[2.365603168889597],[2.709877385626632],[3.150937337752995],[3.394044705982206],[3.23735223568944],[3.647684562036811],[3.335263267430922],[3.12143045028667],[3.187862231925223],[2.788196974919947],[1.993350848349157]],[2.45011779188712,2.317662483245145,2.590588585537919,2.80178571957673,2.488357051146386,2.383786089947085,2.380472086419751,2.587350940035293,2.850079114638447,2.356633470899463,2.104643791887125,1.97218848324515,2.245114585537918,2.456311719576718,2.142883051146383,2.03831208994709,2.034998086419752,2.241876940035271,2.504605114638447,2.011159470899471,1.297699125220459,1.165243816578483,1.438169918871252,1.649367052910052,1.335938384479718,1.231367423280423,1.228053419753087,1.434932273368605,1.697660447971781,1.204214804232805,1.537946804232805,1.405491495590829,1.678417597883598,1.889614731922397,1.576186063492063,1.471615102292769,1.468301098765432,1.675179952380951,1.937908126984127,1.44446248324515,2.839065322751324,2.706610014109348,2.979536116402116,3.190733250440917,2.877304582010582,2.772733620811288,2.769419617283951,2.97629847089947,3.239026645502646,2.745581001763669,1.711367791887126,1.57891248324515,1.851838585537919,2.063035719576719,1.749607051146384,1.64503608994709,1.641722086419753,1.848600940035272,2.111329114638448,1.617883470899472,3.109393458553793,2.976938149911817,3.249864252204585,3.461061386243386,3.147632717813051,3.043061756613757,3.03974775308642,3.246626606701939,3.509354781305115,3.015909137566138,3.993767791887126,3.861312483245151,4.134238585537919,4.345435719576719,4.032007051146385,3.927436089947091,3.924122086419754,4.131000940035272,4.393729114638449,3.900283470899472,3.604707125220459,3.472251816578484,3.745177918871252,3.956375052910052,3.642946384479718,3.538375423280424,3.535061419753087,3.741940273368605,4.004668447971781,3.511222804232805,3.839934458553792,3.707479149911817,3.980405252204585,4.191602386243385,3.878173717813051,3.773602756613757,3.77028875308642,3.977167606701939,4.239895781305115,3.746450137566138,2.592648038800706,2.460192730158731,2.733118832451499,2.944315966490299,2.630887298059965,2.52631633686067,2.523002333333333,2.729881186948852,2.992609361552028,2.499163717813051,1.918330458553793,1.785875149911817,2.058801252204586,2.269998386243385,1.956569717813051,1.851998756613757,1.84868475308642,2.055563606701939,2.318291781305115,1.824846137566138,2.465810125220459,2.333354816578484,2.606280918871252,2.817478052910052,2.504049384479718,2.399478423280424,2.396164419753087,2.603043273368605,2.865771447971782,2.372325804232805,2.986034458553792,2.853579149911817,3.126505252204586,3.337702386243385,3.024273717813051,2.919702756613757,2.91638875308642,3.123267606701939,3.385995781305115,2.892550137566138]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>TRAIT<\/th>\n      <th>ENV<\/th>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>RESIDUAL<\/th>\n      <th>Ypred<\/th>\n      <th>ResAMMI<\/th>\n      <th>YpredAMMI<\/th>\n      <th>AMMI0<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[3,4,5,6,7,8]},{"name":"TRAIT","targets":0},{"name":"ENV","targets":1},{"name":"GEN","targets":2},{"name":"Y","targets":3},{"name":"RESIDUAL","targets":4},{"name":"Ypred","targets":5},{"name":"ResAMMI","targets":6},{"name":"YpredAMMI","targets":7},{"name":"AMMI0","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script><p>The following values are presented: <strong>ENV</strong> is the
environment; <strong>GEN</strong> is the genotype; <strong>Y</strong> is
the response variable; <strong>resOLS</strong> is the residual
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>z</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\hat{z}_{ij}</annotation></semantics></math>)
estimated by the Ordinary Least Square (OLS), where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>z</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{z}_{ij} = y_{ij} - \bar{y}_{i.} - \bar{y}_{.j} + \bar{y}_{ij}</annotation></semantics></math>;
<strong>Ypred</strong> is the predicted value by OLS
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>z</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{y}_{ij} = y_{ij} -\hat{z}_{ij}</annotation></semantics></math>);
<strong>ResAMMI</strong> is the residual estimated by the AMMI model
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>a</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\hat{a}_{ij}</annotation></semantics></math>)
considering the number of multiplicative terms informed in the function
(in this case 5), where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>a</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>λ</mi><mn>1</mn></msub><msub><mi>α</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>τ</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><mo>+</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>+</mo><msub><mi>λ</mi><mn>5</mn></msub><msub><mi>α</mi><mrow><mi>i</mi><mn>5</mn></mrow></msub><msub><mi>τ</mi><mrow><mi>j</mi><mn>5</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{a}_{ij} = \lambda_1\alpha_{i1}\tau_{j1}+...+\lambda_5\alpha_{i5}\tau_{j5}</annotation></semantics></math>;
<strong>YpredAMMI</strong> is the predicted value by AMMI model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mrow><mi>y</mi><mi>a</mi></mrow><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>+</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mover><mi>a</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{ya}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{ij}+\hat{a}_{ij}</annotation></semantics></math>;
and <strong>AMMI0</strong> is the predicted value when no multiplicative
terms are used, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>.</mi></mrow></msub><mo>+</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>.</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{ij}</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="estimating-the-waas-index">Estimating the WAAS index<a class="anchor" aria-label="anchor" href="#estimating-the-waas-index"></a>
</h2>
<p>The <code><a href="../reference/waas.html">waas()</a></code> function computes the Weighted Average of
Absolute Scores <span class="citation">(<a href="#ref-Olivoto2019">Olivoto, Lúcio, Da silva, Marchioro, et al.
2019</a>)</span> considering (i) all principal component axes that were
significant
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">p &lt; 0.05</annotation></semantics></math>
by default); or (ii) declaring a specific number of axes to be used,
according to the following equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>A</mi><mi>A</mi><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mrow><mo stretchy="true" form="prefix">|</mo><mi>I</mi><mi>P</mi><mi>C</mi><msub><mi>A</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>×</mo><mi>E</mi><msub><mi>P</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mi>/</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mi>E</mi><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">
        WAAS_i  =
        \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k = 1}^{p}EP_k
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>A</mi><mi>A</mi><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">WAAS_i</annotation></semantics></math>
is the weighted average of absolute scores of the <em>i</em>th genotype;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>C</mi><msub><mi>A</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">PCA_{ik}</annotation></semantics></math>
is the score of the <em>i</em>th genotype in the <em>k</em>th IPCA; and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">EP_k</annotation></semantics></math>
is the explained variance of the <em>k</em>th IPCA for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mo>,</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">k = 1,2,..,p</annotation></semantics></math>,
considering <em>p</em> the number of significant PCAs, or a declared
number of PCAs. The following functions may be used to do that.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">waas_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/waas.html">waas</a></span><span class="op">(</span><span class="va">data_ge</span>,  <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="number-of-axes-based-on-f-test">Number of axes based on F-test<a class="anchor" aria-label="anchor" href="#number-of-axes-based-on-f-test"></a>
</h3>
<p>In this example only IPCAs with <em>P</em>-value &lt; 0.05 will be
considered in the WAAS estimation. This is the default setting and the
model was already fitted and stored into
<code>AMMI_model&gt;GY&gt;model</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_table</span><span class="op">(</span><span class="va">waas_index</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV"],["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","E1","E10","E11","E12","E13","E14","E2","E3","E4","E5","E6","E7","E8","E9"],[2.603676181657848,2.471220873015873,2.744146975308642,2.955344109347443,2.641915440917108,2.537344479717813,2.534030476190476,2.740909329805997,3.003637504409171,2.510191860670194,2.520683333333333,2.175209333333333,1.368264666666667,1.608512345679012,2.909630864197531,1.781933333333333,3.179959,4.064333333333334,3.675272666666667,3.9105,2.663213580246913,1.988896,2.536375666666667,3.0566],[0.3166341665129545,-1.000668698179801,0.1389670012537362,0.04340467959112725,-0.3250865575302165,-0.3259794677557881,-0.09836196373955022,0.2848546455842579,0.4994797180470508,0.4667564762162296,0.2464452646387239,0.2171494249910763,0.08229361282772386,0.2147567072822225,0.7249244484252308,-0.291243485810663,-0.2288261955321885,0.06575336463532211,-0.3247406258123263,0.5105345728888028,0.05806288142393013,-0.2658300931189951,-0.2641958887026942,-0.7450839881361646],[-0.04416734533008701,-0.5718014137112983,0.1987610922947805,-0.102838186267118,0.4782275705452904,0.2460838191590367,0.2428949787948718,0.5871134345605638,-0.1915803761041023,-0.8426935739419344,0.1976173460841483,0.3695743267061573,0.1660020668828892,0.2712762042118345,0.1312905132751692,0.003196976356163566,-0.238363163565269,-0.4197227569035683,-0.8162800230165249,-0.1312579299627643,-0.1917212631587406,0.1887427962188858,-0.2264589887129727,0.6961038955845917],[-0.03600112837198241,-0.1651692817054648,-0.7330731222911986,0.2284154745834972,-0.09073160997533893,0.245219282637067,0.5607357307397294,-0.2067993907991096,0.3191056986752969,-0.1217016534924926,-0.2320712690681489,0.1144876257570003,0.1527638581621901,-0.1816559921702184,0.2068948328741199,0.2870080639322979,0.2446004867220356,-0.7533493094235207,-0.002139773138762806,0.09311273181819492,-0.03687713361129219,-0.1871227656886489,0.46032602028338,-0.1659773764486273],[-0.0659500295579212,-0.3308736946371856,0.4734656027813239,0.1768855024042056,0.1417143758486899,0.1794075306420734,0.2376634020001501,-0.7085197723809419,-0.1676440391747277,0.06385112207433358,0.09863134388126939,0.02614435162787031,0.22582137175571,0.06975202986514198,0.1318596343287497,-0.2470893890325629,0.5077909822572682,0.01080154983400082,0.1647699141973475,-0.2398045238423295,-0.07973319999014482,-0.6181298597079338,-0.2853605300156956,0.2345463248413099],[-0.3125419453821727,-0.1242503666806486,-0.04815789474995501,-0.1270167955411481,-0.192422705973656,0.4662465548700773,0.05093937456329493,0.2314699104875181,-0.3261495459813798,0.3818834143880702,-0.08082930885945112,-0.0351722663338226,0.04646606913038857,0.3548308195874467,0.02074557591261549,0.1920227331364116,-0.09064327527498239,0.2694876523515466,-0.2375697241371646,-0.3999127535759104,-0.02537386375160901,-0.2376120913689747,0.3781700535240208,-0.1546096203405145],[-0.427168761338059,0.1063940790355554,0.2840647365525604,0.1400170238556874,-0.3549562965742241,-0.03314802616665868,0.1010650973952823,0.08405567190527438,0.2886024139127426,-0.1889259385781621,0.1768050567296026,-0.0749041958825261,-0.05809245674667193,0.2946802939432452,0.1046571204253524,-0.1102369760105517,-0.03071486612992469,-0.1713815854774644,0.2985359690483994,-0.1270907357796826,-0.4664560719263528,0.2101140402373603,0.04369699260172683,-0.08961258503251178],[0.1479400660273398,0.03450866884852493,0.07718620855195117,-0.4568066972783393,-0.08926475601406267,0.2922439380825601,-0.05894709615484443,-0.129043385707337,0.2738776444816036,-0.09169459083738703,-0.251008929277255,0.2507517515344215,0.141814970247761,0.2224238436407683,-0.3344367142516371,-0.1517109381651197,-0.01470635251748743,0.03065021171408843,0.03193700654301851,0.2685707899649353,-0.1434023700847637,-0.08165506825891364,0.04918396763409303,-0.01841216872391006],[-0.2543204067737284,-0.06876039202963967,-0.08656309028270216,0.09658774905411718,0.2919829686086961,0.1211984095784639,-0.3273158616459179,-0.04659002409286547,0.2222336525899992,0.05154699499357109,0.1693333409026424,-0.2373432575452968,-0.2321324416393951,0.2157789070157837,-0.1040240836659822,0.07868373257017845,-0.04940955736548103,-0.121653131374784,0.0007188228561077001,0.2331498425832997,0.09333400319571836,-0.2174455791480265,0.04779729889700131,0.1232121027182347],[-0.1669393838725962,0.01183206033676395,0.004828095769403257,-0.2271665211222944,0.1743989461726778,-0.1883109065930562,0.2010439841198301,0.009254331588890901,0.05578268495457167,0.1252767086458051,0.1498970475447768,-0.09557139647056226,0.1837420237326543,-0.03101968856609257,-0.1546231483673315,0.2171937176822937,0.09777721529259971,0.02190768620809654,-0.09536153041931791,0.05410867834408847,-0.124390556659332,0.01902484844887055,-0.1154121009692706,-0.1272727958014753],[0.1508150928594893,0.6521882352626476,0.2834384000328007,0.1062251163882729,0.3256451403192206,0.269523978474319,0.2325118576429857,0.4283511016621614,0.3265886766901312,0.5067465777229857,0.2105990466823799,0.2357200093044686,0.138284243213136,0.2141861216661305,0.3720315760233545,0.1827257569995339,0.2652786010407011,0.2860872968832978,0.4361207029526835,0.2844502818256497,0.1051878478393727,0.2656707809401048,0.2814901380006146,0.5872514646918583],[24.87813130392806,0,51.26175370940985,90.92939772836399,32.06033730661993,12.4195231333963,11.7970776025975,50.65364995912451,100,7.319641302777598,42.74441081248425,29.93041967526543,0,8.911037095704984,57.17088057095222,15.34340248010498,67.1976331957915,100,85.56933391656938,94.29416115267092,48.03100639054865,23.01986373739739,43.32645582963639,62.62211916956615],[91.83278596489289,0,67.54116211917525,100,59.81046771376586,70.0897631285565,76.86899776031002,40.99858138073073,59.63764718096945,26.63946565466225,78.13334274607502,72.92221256659586,93.13443408364692,77.38923452916136,44.64553663554377,83.91541978081115,66.7905339451666,62.47394685683541,31.35079198176074,62.81353171667954,100,66.70917955838163,63.42758839334034,0],[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],[6,10,3,2,5,7,8,4,1,9,9,10,14,13,6,12,4,1,3,2,7,11,8,5],[2,10,5,1,6,4,3,8,7,9,4,6,2,5,12,3,7,11,13,10,1,8,9,14],[5,10,3,1,6,7,2,4,9,8,7,5,3,4,13,10,6,2,11,12,1,9,8,14],[58.35545863441048,0,59.40145791429255,95.464698864182,45.93540251019289,41.2546431309764,44.33303768145376,45.82611566992762,79.81882359048473,16.97955347871992,60.43887677927964,51.42631612093064,46.56721704182346,43.15013581243317,50.90820860324799,49.62941113045807,66.99408357047905,81.2369734284177,58.46006294916506,78.55384643467524,74.01550319527432,44.86452164788952,53.37702211148837,31.31105958478307],[4,10,3,1,5,8,7,6,2,9,5,8,11,13,9,10,4,1,6,2,3,12,7,14]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>type<\/th>\n      <th>Code<\/th>\n      <th>Y<\/th>\n      <th>PC1<\/th>\n      <th>PC2<\/th>\n      <th>PC3<\/th>\n      <th>PC4<\/th>\n      <th>PC5<\/th>\n      <th>PC6<\/th>\n      <th>PC7<\/th>\n      <th>PC8<\/th>\n      <th>PC9<\/th>\n      <th>WAAS<\/th>\n      <th>PctResp<\/th>\n      <th>PctWAAS<\/th>\n      <th>wRes<\/th>\n      <th>wWAAS<\/th>\n      <th>OrResp<\/th>\n      <th>OrWAAS<\/th>\n      <th>OrPC1<\/th>\n      <th>WAASY<\/th>\n      <th>OrWAASY<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":21,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]},{"name":"type","targets":0},{"name":"Code","targets":1},{"name":"Y","targets":2},{"name":"PC1","targets":3},{"name":"PC2","targets":4},{"name":"PC3","targets":5},{"name":"PC4","targets":6},{"name":"PC5","targets":7},{"name":"PC6","targets":8},{"name":"PC7","targets":9},{"name":"PC8","targets":10},{"name":"PC9","targets":11},{"name":"WAAS","targets":12},{"name":"PctResp","targets":13},{"name":"PctWAAS","targets":14},{"name":"wRes","targets":15},{"name":"wWAAS","targets":16},{"name":"OrResp","targets":17},{"name":"OrWAAS","targets":18},{"name":"OrPC1","targets":19},{"name":"WAASY","targets":20},{"name":"OrWAASY","targets":21}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render"],"jsHooks":[]}</script><p>The output generated by the <code><a href="../reference/waas.html">waas()</a></code> function shows the
following results: <strong>type</strong>, genotype (GEN) or environment
(ENV); <strong>Code</strong>, the code attributed to each level of the
factors; <strong>Y</strong>, the response variable (in this case the
grain yield); <strong>WAAS</strong> the weighted average of the absolute
scores, estimated with all PCA axes with <em>P</em>-value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≤</mo><annotation encoding="application/x-tex">\le</annotation></semantics></math>
0.05; <strong>PctWAAS</strong> and <strong>PctResp</strong> that are the
percentage values for the WAAS and Y, respectively;
<strong>OrResp</strong> and <strong>OrWAAS</strong> that are the ranks
attributed to the genotype and environment regarding the Y or WAAS,
respectively; <strong>WAASY</strong> is the weighted average of absolute
scores and response variable. In this case, considering equal weights
for PctResp and PctWAAS, the WAASY for G1 is estimated by:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>A</mi><mi>A</mi><msub><mi>S</mi><mrow><mi>G</mi><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>24.87</mn><mo>×</mo><mn>50</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>91.83</mn><mo>×</mo><mn>50</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>/</mi><mn>50</mn><mo>+</mo><mn>50</mn><mo>=</mo><mn>58.35</mn></mrow><annotation encoding="application/x-tex">WAAS_{G1} = [(24.87\times50)+(91.83\times50)]/50+50 = 58.35</annotation></semantics></math>.
Then the <strong>OrWAASY</strong> is the rank for the WAASY value. The
genotype (or environment) with the largest WAASY value has the first
ranked.</p>
</div>
<div class="section level3">
<h3 id="number-of-axes-declared-manually">Number of axes declared manually<a class="anchor" aria-label="anchor" href="#number-of-axes-declared-manually"></a>
</h3>
<p>The second option to compute the WAAS is by manually declaring a
specific number of multiplicative terms. In this case, the number of
terms declared is used independently of its significance. Let us, for
the moment, assume that after a cross-validation procedure the AMMI7 was
the most predictively accurate AMMI model and the researcher will use
this model. The additional argument <code>naxis</code> in the function
<code>waas</code> is then used to overwrite the default chose of
significant terms.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">waas_index2</span> <span class="op">&lt;-</span> <span class="va">data_ge</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/waas.html">waas</a></span><span class="op">(</span><span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>,</span>
<span>       naxis <span class="op">=</span> <span class="fl">7</span>, <span class="co"># Use 7 IPCA for computing WAAS</span></span>
<span>       verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The only difference in this output is that here we declared that
seven IPCA axes should be used for computing the WAAS value. Thus, only
the values of WAAS, OrWAAS, WAASY and OrWAASY may have significant
changes.</p>
</div>
<div class="section level3">
<h3 id="biplots">Biplots<a class="anchor" aria-label="anchor" href="#biplots"></a>
</h3>
<p>Provided that an object of class <code>waas</code> or
<code>performs_ammi</code> is available in the global environment, the
graphics may be obtained using the function <code><a href="../reference/plot_scores.html">plot_scores()</a></code>.
To do that, we will revisit the previusly fitted model
<code>AMMI_model</code> . Please, refer to <code><a href="../reference/plot_scores.html">plot_scores()</a></code>
for more details.</p>
<div class="section level4">
<h4 id="biplot-type-1-gy-x-pc1">biplot type 1: GY x PC1<a class="anchor" aria-label="anchor" href="#biplot-type-1-gy-x-pc1"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>,</span>
<span>                 col.gen <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                 col.env <span class="op">=</span> <span class="st">"gray70"</span>,</span>
<span>                 col.segm.env <span class="op">=</span> <span class="st">"gray70"</span>,</span>
<span>                 axis.expand <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>                 plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="biplot-type-2-pc1-x-pc2">biplot type 2: PC1 x PC2<a class="anchor" aria-label="anchor" href="#biplot-type-2-pc1-x-pc2"></a>
</h4>
<ul>
<li>PC1 x PC2 By default, IPCA1 is shown in the x axis and IPCA2 in the
y axis.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>,</span>
<span>                 type <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 polygon <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 col.segm.env <span class="op">=</span> <span class="st">"transparent"</span>,</span>
<span>                 plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">d</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;"></p>
<ul>
<li>Change the default option To create a biplot showin other IPCAs use
the arguments <code>first</code> and <code>second</code>. For example to
produce a PC1 x PC3 biplot, use <code>second = "PC3</code>. A PC3 x PC4
biplot can be produced (provided that the model has at least four IPCAs)
with <code>first = "PC3"</code> and <code>second = "PC4"</code>..</li>
</ul>
</div>
<div class="section level4">
<h4 id="biplot-type-3-gy-x-waas">biplot type 3: GY x WAAS<a class="anchor" aria-label="anchor" href="#biplot-type-3-gy-x-waas"></a>
</h4>
<p>The quadrants proposed by <span class="citation">Olivoto, Lúcio, Da
silva, Marchioro, et al. (<a href="#ref-Olivoto2019">2019</a>)</span> in
the following biplot represent four classifications regarding the joint
interpretation of mean performance and stability. The genotypes or
environments included in quadrant I can be considered unstable genotypes
or environments with high discrimination ability, and with productivity
below the grand mean. In quadrant II are included unstable genotypes,
although with productivity above the grand mean. The environments
included in this quadrant deserve special attention since, in addition
to providing high magnitudes of the response variable, they present a
good discrimination ability. Genotypes within quadrant III have low
productivity, but can be considered stable due to the lower values of
WAASB. The lower this value, the more stable the genotype can be
considered. The environments included in this quadrant can be considered
as poorly productive and with low discrimination ability. The genotypes
within the quadrant IV are highly productive and broadly adapted due to
the high magnitude of the response variable and high stability
performance (lower values of WAASB). . To obtain this biplot must use an
object of class <code>waas</code> (in our example,
<code>waas_index</code>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waas_index</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waas_index</span>,</span>
<span>                 type <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 x.lab <span class="op">=</span> <span class="st">"My custom x label"</span>,</span>
<span>                 size.shape.gen <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Size of the shape for genotypes</span></span>
<span>                 col.gen <span class="op">=</span> <span class="st">"gray50"</span>, <span class="co"># Color for genotypes</span></span>
<span>                 size.tex.gen <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Size of the text for genotypes</span></span>
<span>                 col.alpha.env <span class="op">=</span> <span class="fl">0</span>, <span class="co"># Transparency of environment's point</span></span>
<span>                 x.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.4</span>, <span class="fl">3.1</span><span class="op">)</span>, <span class="co"># Limits of x axis</span></span>
<span>                 x.breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2.4</span>, <span class="fl">3.1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="co"># Markers of x axis</span></span>
<span>                 y.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"WAASB vs GY plot"</span>, subtitle <span class="op">=</span> <span class="st">"Zoom in genotypes' scores"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">e</span>, <span class="va">f</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="biplot-type-4-nominal-yield-and-environment-ipca1">biplot type 4: nominal yield and environment IPCA1<a class="anchor" aria-label="anchor" href="#biplot-type-4-nominal-yield-and-environment-ipca1"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>, type <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>,</span>
<span>                 type <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                 color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">h</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="st">"h"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simultaneous-selection-for-mean-performance-and-stability">Simultaneous selection for mean performance and stability<a class="anchor" aria-label="anchor" href="#simultaneous-selection-for-mean-performance-and-stability"></a>
</h2>
<p>The WAASY index <span class="citation">(<a href="#ref-Olivoto2019a">Olivoto, Lúcio, Da silva, Sari, et al.
2019</a>)</span> is used for genotype ranking considering both the
stability (WAAS) and mean performance based on the following model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>A</mi><mi>A</mi><mi>S</mi><mi>Y</mi><msub><mi></mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><msub><mi>G</mi><mi>i</mi></msub><mo>×</mo><msub><mi>θ</mi><mi>Y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><msub><mi>W</mi><mi>i</mi></msub><mo>×</mo><msub><mi>θ</mi><mi>S</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>θ</mi><mi>Y</mi></msub><mo>+</mo><msub><mi>θ</mi><mi>S</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
WAASY{_i} = \frac{{\left( {r{G_i} \times {\theta _Y}} \right) + \left( {r{W_i} \times {\theta _S}} \right)}}{{{\theta _Y} + {\theta _S}}}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>A</mi><mi>A</mi><mi>S</mi><msub><mi>Y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">WAASY_i</annotation></semantics></math>
is the superiority index for the <em>i</em>-th genotype that weights
between performance and stability;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><msub><mi>G</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">rG_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">rW_i</annotation></semantics></math>
are the rescaled values (0-100) for GY and WAASB, respectively;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>Y</mi></msub><annotation encoding="application/x-tex">\theta _Y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>S</mi></msub><annotation encoding="application/x-tex">\theta_S</annotation></semantics></math>
are the weights for GY and WAASB, respectively.</p>
<p>This index was also already computed and stored into
AMMI_model&gt;GY&gt;model. An intuitively plot may be obtained by
running</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_waasby.html">plot_waasby</a></span><span class="op">(</span><span class="va">waas_index</span><span class="op">)</span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_waasby.html">plot_waasby</a></span><span class="op">(</span><span class="va">waas_index</span>,</span>
<span>                 col.shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray20"</span>, <span class="st">"gray80"</span><span class="op">)</span>,</span>
<span>                 plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="st">"j"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The values of WAASY in the plot above were computed considering equal
weights for mean performance and stability. Different weights may be
assigned using the <code>wresp</code> argument of the
<code><a href="../reference/waas.html">waas()</a></code> function.</p>
</div>
<div class="section level2">
<h2 id="weighting-the-stability-and-mean-performance">Weighting the stability and mean performance<a class="anchor" aria-label="anchor" href="#weighting-the-stability-and-mean-performance"></a>
</h2>
<p>After fitting a model with the functions <code><a href="../reference/waas.html">waas()</a></code> or
<code><a href="../reference/waasb.html">waasb()</a></code> it is possible to compute the superiority indexes
WAASY or WAASBY in different scenarios of weights for stability and mean
performance. The number of scenarios is defined by the arguments
<code>increment</code>. By default, twenty-one different scenarios are
computed. In this case, the the superiority index is computed
considering the following weights: stability (waasb or waas) = 100; mean
performance = 0. In other words, only stability is considered for
genotype ranking. In the next iteration, the weights becomes 95/5 (since
increment = 5). In the third scenario, the weights become 90/10, and so
on up to these weights become 0/100. In the last iteration, the genotype
ranking for WAASY or WAASBY matches perfectly with the ranks of the
response variable.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WAASratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wsmp.html">wsmp</a></span><span class="op">(</span><span class="va">waas_index</span><span class="op">)</span></span>
<span><span class="co"># Ranks considering 0 for GY and 100 for WAASB |                   | 1% 00:00:00 Ranks considering 0 for GY and 100 for WAASB |                   | 1% 00:00:00 Ranks considering 0 for GY and 100 for WAASB |                   | 2% 00:00:00 Ranks considering 0 for GY and 100 for WAASB |                   | 2% 00:00:00 Ranks considering 0 for GY and 100 for WAASB |=                  | 3% 00:00:00 Ranks considering 0 for GY and 100 for WAASB |=                  | 3% 00:00:00 Ranks considering 0 for GY and 100 for WAASB |=                  | 4% 00:00:00 Ranks considering 0 for GY and 100 for WAASB |=                  | 4% 00:00:00 Ranks considering 0 for GY and 100 for WAASB |=                  | 5% 00:00:00 Ranks considering 5 for GY and 95 for WAASB |=                   | 5% 00:00:00 Ranks considering 5 for GY and 95 for WAASB |=                   | 6% 00:00:00 Ranks considering 5 for GY and 95 for WAASB |=                   | 6% 00:00:00 Ranks considering 5 for GY and 95 for WAASB |=                   | 7% 00:00:00 Ranks considering 5 for GY and 95 for WAASB |=                   | 7% 00:00:00 Ranks considering 5 for GY and 95 for WAASB |==                  | 8% 00:00:00 Ranks considering 5 for GY and 95 for WAASB |==                  | 8% 00:00:00 Ranks considering 5 for GY and 95 for WAASB |==                  | 9% 00:00:00 Ranks considering 5 for GY and 95 for WAASB |==                  | 10% 00:00:00 Ranks considering 10 for GY and 90 for WAASB |==                 | 10% 00:00:00 Ranks considering 10 for GY and 90 for WAASB |==                 | 11% 00:00:00 Ranks considering 10 for GY and 90 for WAASB |==                 | 11% 00:00:00 Ranks considering 10 for GY and 90 for WAASB |==                 | 12% 00:00:00 Ranks considering 10 for GY and 90 for WAASB |==                 | 12% 00:00:00 Ranks considering 10 for GY and 90 for WAASB |==                 | 13% 00:00:00 Ranks considering 10 for GY and 90 for WAASB |===                | 13% 00:00:00 Ranks considering 10 for GY and 90 for WAASB |===                | 14% 00:00:00 Ranks considering 10 for GY and 90 for WAASB |===                | 14% 00:00:00 Ranks considering 15 for GY and 85 for WAASB |===                | 15% 00:00:00 Ranks considering 15 for GY and 85 for WAASB |===                | 15% 00:00:00 Ranks considering 15 for GY and 85 for WAASB |===                | 16% 00:00:00 Ranks considering 15 for GY and 85 for WAASB |===                | 16% 00:00:00 Ranks considering 15 for GY and 85 for WAASB |===                | 17% 00:00:00 Ranks considering 15 for GY and 85 for WAASB |===                | 17% 00:00:00 Ranks considering 15 for GY and 85 for WAASB |===                | 18% 00:00:00 Ranks considering 15 for GY and 85 for WAASB |====               | 19% 00:00:00 Ranks considering 15 for GY and 85 for WAASB |====               | 19% 00:00:00 Ranks considering 20 for GY and 80 for WAASB |====               | 20% 00:00:00 Ranks considering 20 for GY and 80 for WAASB |====               | 20% 00:00:00 Ranks considering 20 for GY and 80 for WAASB |====               | 21% 00:00:00 Ranks considering 20 for GY and 80 for WAASB |====               | 21% 00:00:00 Ranks considering 20 for GY and 80 for WAASB |====               | 22% 00:00:00 Ranks considering 20 for GY and 80 for WAASB |====               | 22% 00:00:00 Ranks considering 20 for GY and 80 for WAASB |====               | 23% 00:00:00 Ranks considering 20 for GY and 80 for WAASB |====               | 23% 00:00:00 Ranks considering 20 for GY and 80 for WAASB |=====              | 24% 00:00:00 Ranks considering 25 for GY and 75 for WAASB |=====              | 24% 00:00:00 Ranks considering 25 for GY and 75 for WAASB |=====              | 25% 00:00:00 Ranks considering 25 for GY and 75 for WAASB |=====              | 25% 00:00:00 Ranks considering 25 for GY and 75 for WAASB |=====              | 26% 00:00:00 Ranks considering 25 for GY and 75 for WAASB |=====              | 26% 00:00:00 Ranks considering 25 for GY and 75 for WAASB |=====              | 27% 00:00:00 Ranks considering 25 for GY and 75 for WAASB |=====              | 28% 00:00:00 Ranks considering 25 for GY and 75 for WAASB |=====              | 28% 00:00:00 Ranks considering 25 for GY and 75 for WAASB |=====              | 29% 00:00:00 Ranks considering 30 for GY and 70 for WAASB |======             | 29% 00:00:00 Ranks considering 30 for GY and 70 for WAASB |======             | 30% 00:00:00 Ranks considering 30 for GY and 70 for WAASB |======             | 30% 00:00:00 Ranks considering 30 for GY and 70 for WAASB |======             | 31% 00:00:00 Ranks considering 30 for GY and 70 for WAASB |======             | 31% 00:00:00 Ranks considering 30 for GY and 70 for WAASB |======             | 32% 00:00:00 Ranks considering 30 for GY and 70 for WAASB |======             | 32% 00:00:00 Ranks considering 30 for GY and 70 for WAASB |======             | 33% 00:00:00 Ranks considering 30 for GY and 70 for WAASB |======             | 33% 00:00:00 Ranks considering 35 for GY and 65 for WAASB |======             | 34% 00:00:00 Ranks considering 35 for GY and 65 for WAASB |=======            | 34% 00:00:00 Ranks considering 35 for GY and 65 for WAASB |=======            | 35% 00:00:00 Ranks considering 35 for GY and 65 for WAASB |=======            | 35% 00:00:00 Ranks considering 35 for GY and 65 for WAASB |=======            | 36% 00:00:00 Ranks considering 35 for GY and 65 for WAASB |=======            | 37% 00:00:00 Ranks considering 35 for GY and 65 for WAASB |=======            | 37% 00:00:00 Ranks considering 35 for GY and 65 for WAASB |=======            | 38% 00:00:00 Ranks considering 35 for GY and 65 for WAASB |=======            | 38% 00:00:00 Ranks considering 40 for GY and 60 for WAASB |=======            | 39% 00:00:00 Ranks considering 40 for GY and 60 for WAASB |=======            | 39% 00:00:00 Ranks considering 40 for GY and 60 for WAASB |========           | 40% 00:00:00 Ranks considering 40 for GY and 60 for WAASB |========           | 40% 00:00:00 Ranks considering 40 for GY and 60 for WAASB |========           | 41% 00:00:00 Ranks considering 40 for GY and 60 for WAASB |========           | 41% 00:00:00 Ranks considering 40 for GY and 60 for WAASB |========           | 42% 00:00:00 Ranks considering 40 for GY and 60 for WAASB |========           | 42% 00:00:00 Ranks considering 40 for GY and 60 for WAASB |========           | 43% 00:00:00 Ranks considering 45 for GY and 55 for WAASB |========           | 43% 00:00:00 Ranks considering 45 for GY and 55 for WAASB |========           | 44% 00:00:00 Ranks considering 45 for GY and 55 for WAASB |========           | 44% 00:00:01 Ranks considering 45 for GY and 55 for WAASB |=========          | 45% 00:00:01 Ranks considering 45 for GY and 55 for WAASB |=========          | 46% 00:00:01 Ranks considering 45 for GY and 55 for WAASB |=========          | 46% 00:00:01 Ranks considering 45 for GY and 55 for WAASB |=========          | 47% 00:00:01 Ranks considering 45 for GY and 55 for WAASB |=========          | 47% 00:00:01 Ranks considering 45 for GY and 55 for WAASB |=========          | 48% 00:00:01 Ranks considering 50 for GY and 50 for WAASB |=========          | 48% 00:00:01 Ranks considering 50 for GY and 50 for WAASB |=========          | 49% 00:00:01 Ranks considering 50 for GY and 50 for WAASB |=========          | 49% 00:00:01 Ranks considering 50 for GY and 50 for WAASB |=========          | 50% 00:00:01 Ranks considering 50 for GY and 50 for WAASB |==========         | 50% 00:00:01 Ranks considering 50 for GY and 50 for WAASB |==========         | 51% 00:00:01 Ranks considering 50 for GY and 50 for WAASB |==========         | 51% 00:00:01 Ranks considering 50 for GY and 50 for WAASB |==========         | 52% 00:00:01 Ranks considering 50 for GY and 50 for WAASB |==========         | 52% 00:00:01 Ranks considering 55 for GY and 45 for WAASB |==========         | 53% 00:00:01 Ranks considering 55 for GY and 45 for WAASB |==========         | 53% 00:00:01 Ranks considering 55 for GY and 45 for WAASB |==========         | 54% 00:00:01 Ranks considering 55 for GY and 45 for WAASB |==========         | 54% 00:00:01 Ranks considering 55 for GY and 45 for WAASB |==========         | 55% 00:00:01 Ranks considering 55 for GY and 45 for WAASB |===========        | 56% 00:00:01 Ranks considering 55 for GY and 45 for WAASB |===========        | 56% 00:00:01 Ranks considering 55 for GY and 45 for WAASB |===========        | 57% 00:00:01 Ranks considering 55 for GY and 45 for WAASB |===========        | 57% 00:00:01 Ranks considering 60 for GY and 40 for WAASB |===========        | 58% 00:00:01 Ranks considering 60 for GY and 40 for WAASB |===========        | 58% 00:00:01 Ranks considering 60 for GY and 40 for WAASB |===========        | 59% 00:00:01 Ranks considering 60 for GY and 40 for WAASB |===========        | 59% 00:00:01 Ranks considering 60 for GY and 40 for WAASB |===========        | 60% 00:00:01 Ranks considering 60 for GY and 40 for WAASB |===========        | 60% 00:00:01 Ranks considering 60 for GY and 40 for WAASB |============       | 61% 00:00:01 Ranks considering 60 for GY and 40 for WAASB |============       | 61% 00:00:01 Ranks considering 60 for GY and 40 for WAASB |============       | 62% 00:00:01 Ranks considering 65 for GY and 35 for WAASB |============       | 62% 00:00:01 Ranks considering 65 for GY and 35 for WAASB |============       | 63% 00:00:01 Ranks considering 65 for GY and 35 for WAASB |============       | 63% 00:00:01 Ranks considering 65 for GY and 35 for WAASB |============       | 64% 00:00:01 Ranks considering 65 for GY and 35 for WAASB |============       | 65% 00:00:01 Ranks considering 65 for GY and 35 for WAASB |============       | 65% 00:00:01 Ranks considering 65 for GY and 35 for WAASB |============       | 66% 00:00:01 Ranks considering 65 for GY and 35 for WAASB |=============      | 66% 00:00:01 Ranks considering 65 for GY and 35 for WAASB |=============      | 67% 00:00:01 Ranks considering 70 for GY and 30 for WAASB |=============      | 67% 00:00:01 Ranks considering 70 for GY and 30 for WAASB |=============      | 68% 00:00:01 Ranks considering 70 for GY and 30 for WAASB |=============      | 68% 00:00:01 Ranks considering 70 for GY and 30 for WAASB |=============      | 69% 00:00:01 Ranks considering 70 for GY and 30 for WAASB |=============      | 69% 00:00:01 Ranks considering 70 for GY and 30 for WAASB |=============      | 70% 00:00:01 Ranks considering 70 for GY and 30 for WAASB |=============      | 70% 00:00:01 Ranks considering 70 for GY and 30 for WAASB |=============      | 71% 00:00:01 Ranks considering 70 for GY and 30 for WAASB |==============     | 71% 00:00:01 Ranks considering 75 for GY and 25 for WAASB |==============     | 72% 00:00:01 Ranks considering 75 for GY and 25 for WAASB |==============     | 72% 00:00:01 Ranks considering 75 for GY and 25 for WAASB |==============     | 73% 00:00:01 Ranks considering 75 for GY and 25 for WAASB |==============     | 74% 00:00:01 Ranks considering 75 for GY and 25 for WAASB |==============     | 74% 00:00:01 Ranks considering 75 for GY and 25 for WAASB |==============     | 75% 00:00:01 Ranks considering 75 for GY and 25 for WAASB |==============     | 75% 00:00:01 Ranks considering 75 for GY and 25 for WAASB |==============     | 76% 00:00:01 Ranks considering 75 for GY and 25 for WAASB |==============     | 76% 00:00:01 Ranks considering 80 for GY and 20 for WAASB |===============    | 77% 00:00:01 Ranks considering 80 for GY and 20 for WAASB |===============    | 77% 00:00:01 Ranks considering 80 for GY and 20 for WAASB |===============    | 78% 00:00:01 Ranks considering 80 for GY and 20 for WAASB |===============    | 78% 00:00:01 Ranks considering 80 for GY and 20 for WAASB |===============    | 79% 00:00:01 Ranks considering 80 for GY and 20 for WAASB |===============    | 79% 00:00:01 Ranks considering 80 for GY and 20 for WAASB |===============    | 80% 00:00:01 Ranks considering 80 for GY and 20 for WAASB |===============    | 80% 00:00:01 Ranks considering 80 for GY and 20 for WAASB |===============    | 81% 00:00:01 Ranks considering 85 for GY and 15 for WAASB |===============    | 81% 00:00:01 Ranks considering 85 for GY and 15 for WAASB |================   | 82% 00:00:01 Ranks considering 85 for GY and 15 for WAASB |================   | 83% 00:00:01 Ranks considering 85 for GY and 15 for WAASB |================   | 83% 00:00:01 Ranks considering 85 for GY and 15 for WAASB |================   | 84% 00:00:01 Ranks considering 85 for GY and 15 for WAASB |================   | 84% 00:00:01 Ranks considering 85 for GY and 15 for WAASB |================   | 85% 00:00:01 Ranks considering 85 for GY and 15 for WAASB |================   | 85% 00:00:01 Ranks considering 85 for GY and 15 for WAASB |================   | 86% 00:00:01 Ranks considering 90 for GY and 10 for WAASB |================   | 86% 00:00:01 Ranks considering 90 for GY and 10 for WAASB |================   | 87% 00:00:01 Ranks considering 90 for GY and 10 for WAASB |=================  | 87% 00:00:01 Ranks considering 90 for GY and 10 for WAASB |=================  | 88% 00:00:01 Ranks considering 90 for GY and 10 for WAASB |=================  | 88% 00:00:01 Ranks considering 90 for GY and 10 for WAASB |=================  | 89% 00:00:01 Ranks considering 90 for GY and 10 for WAASB |=================  | 89% 00:00:02 Ranks considering 90 for GY and 10 for WAASB |=================  | 90% 00:00:02 Ranks considering 90 for GY and 10 for WAASB |=================  | 90% 00:00:02 Ranks considering 95 for GY and 5 for WAASB |==================  | 91% 00:00:02 Ranks considering 95 for GY and 5 for WAASB |==================  | 92% 00:00:02 Ranks considering 95 for GY and 5 for WAASB |==================  | 92% 00:00:02 Ranks considering 95 for GY and 5 for WAASB |=================== | 93% 00:00:02 Ranks considering 95 for GY and 5 for WAASB |=================== | 93% 00:00:02 Ranks considering 95 for GY and 5 for WAASB |=================== | 94% 00:00:02 Ranks considering 95 for GY and 5 for WAASB |=================== | 94% 00:00:02 Ranks considering 95 for GY and 5 for WAASB |=================== | 95% 00:00:02 Ranks considering 95 for GY and 5 for WAASB |=================== | 95% 00:00:02 Ranks considering 100 for GY and 0 for WAASB |================== | 96% 00:00:02 Ranks considering 100 for GY and 0 for WAASB |================== | 96% 00:00:02 Ranks considering 100 for GY and 0 for WAASB |================== | 97% 00:00:02 Ranks considering 100 for GY and 0 for WAASB |================== | 97% 00:00:02 Ranks considering 100 for GY and 0 for WAASB |===================| 98% 00:00:02 Ranks considering 100 for GY and 0 for WAASB |===================| 98% 00:00:02 Ranks considering 100 for GY and 0 for WAASB |===================| 99% 00:00:02 Ranks considering 100 for GY and 0 for WAASB |===================| 99% 00:00:02 Ranks considering 100 for GY and 0 for WAASB |===================| 100% 00:00:02 </span></span></code></pre></div>
<div class="section level3">
<h3 id="printing-the-model-outputs">Printing the model outputs<a class="anchor" aria-label="anchor" href="#printing-the-model-outputs"></a>
</h3>
<p>The genotype ranking for each scenario of WAASY/GY weight ratio is
shown bellow</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_table</span><span class="op">(</span><span class="va">WAASratio</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">hetcomb</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-10b3b7155e8045a1b2ad" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[[2,10,5,1,6,4,3,8,7,9],[2,10,5,1,7,4,3,8,6,9],[2,10,4,1,7,5,3,8,6,9],[2,10,5,1,7,6,3,8,4,9],[2,10,4,1,7,6,5,8,3,9],[2,10,4,1,7,6,5,8,3,9],[2,10,4,1,7,6,5,8,3,9],[3,10,4,1,6,7,5,8,2,9],[3,10,4,1,6,7,5,8,2,9],[3,10,4,1,6,8,5,7,2,9],[4,10,3,1,5,8,7,6,2,9],[4,10,3,1,6,8,7,5,2,9],[4,10,3,1,6,8,7,5,2,9],[4,10,3,1,6,8,7,5,2,9],[5,10,3,1,6,8,7,4,2,9],[5,10,3,1,6,8,7,4,2,9],[5,10,3,1,6,8,7,4,2,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,7,8,4,1,9],[6,10,3,2,5,7,8,4,1,9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>100/0<\/th>\n      <th>95/5<\/th>\n      <th>90/10<\/th>\n      <th>85/15<\/th>\n      <th>80/20<\/th>\n      <th>75/25<\/th>\n      <th>70/30<\/th>\n      <th>65/35<\/th>\n      <th>60/40<\/th>\n      <th>55/45<\/th>\n      <th>50/50<\/th>\n      <th>45/55<\/th>\n      <th>40/60<\/th>\n      <th>35/65<\/th>\n      <th>30/70<\/th>\n      <th>25/75<\/th>\n      <th>20/80<\/th>\n      <th>15/85<\/th>\n      <th>10/90<\/th>\n      <th>5/95<\/th>\n      <th>0/100<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":0,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{"name":"100/0","targets":0},{"name":"95/5","targets":1},{"name":"90/10","targets":2},{"name":"85/15","targets":3},{"name":"80/20","targets":4},{"name":"75/25","targets":5},{"name":"70/30","targets":6},{"name":"65/35","targets":7},{"name":"60/40","targets":8},{"name":"55/45","targets":9},{"name":"50/50","targets":10},{"name":"45/55","targets":11},{"name":"40/60","targets":12},{"name":"35/65","targets":13},{"name":"30/70","targets":14},{"name":"25/75","targets":15},{"name":"20/80","targets":16},{"name":"15/85","targets":17},{"name":"10/90","targets":18},{"name":"5/95","targets":19},{"name":"0/100","targets":20}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render","options.columnDefs.20.render"],"jsHooks":[]}</script><p>In addition, the genotype ranking depending on the number of
multiplicative terms used to estimate the WAAS index is also
computed.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_table</span><span class="op">(</span><span class="va">WAASratio</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">hetdata</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-4018eef1a407a0df6b52" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4018eef1a407a0df6b52">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[[1,2,3,4,5,6,7,8,9,10],[1,2,3,4,5,6,7,8,9,10],[1,2,3,4,5,6,7,8,9,10],[1,2,3,4,5,6,7,8,9,10],[1,2,3,4,5,6,7,8,9,10],[2,10,5,1,6,4,3,8,7,9],[2,10,4,1,7,5,3,8,6,9],[4,10,2,1,7,5,3,8,6,9],[5,10,3,1,6,7,2,4,9,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>9PCA<\/th>\n      <th>8PCA<\/th>\n      <th>7PCA<\/th>\n      <th>6PCA<\/th>\n      <th>5PCA<\/th>\n      <th>4PCA<\/th>\n      <th>3PCA<\/th>\n      <th>2PCA<\/th>\n      <th>1PCA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":0,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8]},{"name":"9PCA","targets":0},{"name":"8PCA","targets":1},{"name":"7PCA","targets":2},{"name":"6PCA","targets":3},{"name":"5PCA","targets":4},{"name":"4PCA","targets":5},{"name":"3PCA","targets":6},{"name":"2PCA","targets":7},{"name":"1PCA","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render"],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="plotting-the-heat-map-graphics">Plotting the heat map graphics<a class="anchor" aria-label="anchor" href="#plotting-the-heat-map-graphics"></a>
</h3>
<p>The first type of heatmap shows the genotype ranking depending on the
number of principal component axes used for estimating the WAASB index.
An euclidean distance-based dendrogram is used for grouping the genotype
ranking for both genotypes and principal component axes. The second type
of heatmap shows the genotype ranking depending on the WAASB/GY ratio.
The ranks obtained with a ratio of 100/0 considers exclusively the
stability for genotype ranking. On the other hand, a ratio of 0/100
considers exclusively the productivity for genotype ranking.</p>
<div class="section level4">
<h4 id="ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waas">Ranks of genotypes depending on the number of PCA used to estimate
the WAAS<a class="anchor" aria-label="anchor" href="#ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waas"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">WAASratio</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-20-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="ranks-of-genotypes-depending-on-the-waasgy-ratio">Ranks of genotypes depending on the WAAS/GY ratio<a class="anchor" aria-label="anchor" href="#ranks-of-genotypes-depending-on-the-waasgy-ratio"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">WAASratio</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-21-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="getting-model-data">Getting model data<a class="anchor" aria-label="anchor" href="#getting-model-data"></a>
</h3>
<p>The function <code><a href="../reference/get_model_data.html">get_model_data()</a></code> may be used to easily get
the data from a model fitted with the function <code><a href="../reference/waas.html">waas()</a></code>,
especially when more than one variables are used. Select helpers can be
used in the argument <code>resp</code>. See the example below.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">waas_index_all</span> <span class="op">&lt;-</span></span>
<span><span class="fu"><a href="../reference/waas.html">waas</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>,</span>
<span>     resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"WAAS"</span><span class="op">)</span></span>
<span><span class="co"># variable PH </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  7.719  2.5728 127.913 4.25e-07         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8  0.161  0.0201   0.897 5.22e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12  1.865  0.1554   6.929 6.89e-09         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  5.397  0.1499   6.686 5.01e-14         NA          NA</span></span>
<span><span class="co">#        PC1  14  4.466  0.3190  14.230 0.00e+00       82.8        82.8</span></span>
<span><span class="co">#        PC2  12  0.653  0.0545   2.430 8.40e-03       12.1        94.9</span></span>
<span><span class="co">#        PC3  10  0.277  0.0277   1.240 2.76e-01        5.1       100.0</span></span>
<span><span class="co">#  Residuals  96  2.153  0.0224      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 22.692  0.1188      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable EH </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  5.061  1.6870 118.095 5.80e-07         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8  0.114  0.0143   0.689 7.01e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12  1.027  0.0856   4.127 3.43e-05         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  4.335  0.1204   5.805 2.87e-12         NA          NA</span></span>
<span><span class="co">#        PC1  14  3.734  0.2667  12.860 0.00e+00       86.2        86.2</span></span>
<span><span class="co">#        PC2  12  0.465  0.0387   1.870 4.77e-02       10.7        96.9</span></span>
<span><span class="co">#        PC3  10  0.136  0.0136   0.650 7.67e-01        3.1       100.0</span></span>
<span><span class="co">#  Residuals  96  1.991  0.0207      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 16.863  0.0883      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable EP </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3 0.1218 0.04061   17.65 6.92e-04         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8 0.0184 0.00230    1.51 1.64e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12 0.0335 0.00279    1.83 5.39e-02         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36 0.1720 0.00478    3.13 4.76e-06         NA          NA</span></span>
<span><span class="co">#        PC1  14 0.1285 0.00918    6.02 0.00e+00       74.7        74.7</span></span>
<span><span class="co">#        PC2  12 0.0274 0.00229    1.50 1.37e-01       15.9        90.7</span></span>
<span><span class="co">#        PC3  10 0.0161 0.00161    1.05 4.08e-01        9.3       100.0</span></span>
<span><span class="co">#  Residuals  96 0.1465 0.00153      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 0.6642 0.00348      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable EL </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  17.97   5.991   12.86 0.001990         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   3.73   0.466    0.43 0.900554         NA          NA</span></span>
<span><span class="co">#        GEN  12  26.07   2.173    2.00 0.031868         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  92.69   2.575    2.37 0.000437         NA          NA</span></span>
<span><span class="co">#        PC1  14  57.36   4.097    3.78 0.000000       61.9        61.9</span></span>
<span><span class="co">#        PC2  12  23.79   1.982    1.83 0.053800       25.7        87.5</span></span>
<span><span class="co">#        PC3  10  11.54   1.154    1.06 0.400600       12.5       100.0</span></span>
<span><span class="co">#  Residuals  96 104.09   1.084      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 337.25   1.766      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable ED </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  306.0  101.99  43.386 2.70e-05         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   18.8    2.35   0.906 5.15e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12  212.9   17.74   6.838 8.95e-09         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  398.2   11.06   4.263 7.60e-09         NA          NA</span></span>
<span><span class="co">#        PC1  14  212.2   15.16   5.840 0.00e+00       53.3        53.3</span></span>
<span><span class="co">#        PC2  12  134.7   11.23   4.330 0.00e+00       33.8        87.1</span></span>
<span><span class="co">#        PC3  10   51.3    5.13   1.980 4.38e-02       12.9       100.0</span></span>
<span><span class="co">#  Residuals  96  249.1    2.59      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 1583.2    8.29      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable CL </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3   50.1   16.70    5.73 2.16e-02         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   23.3    2.91    1.76 9.41e-02         NA          NA</span></span>
<span><span class="co">#        GEN  12   65.7    5.47    3.31 4.81e-04         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  527.3   14.65    8.86 7.16e-18         NA          NA</span></span>
<span><span class="co">#        PC1  14  320.6   22.90   13.86 0.00e+00       60.8        60.8</span></span>
<span><span class="co">#        PC2  12  129.1   10.76    6.51 0.00e+00       24.5        85.3</span></span>
<span><span class="co">#        PC3  10   77.5    7.75    4.69 0.00e+00       14.7       100.0</span></span>
<span><span class="co">#  Residuals  96  158.6    1.65      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 1352.2    7.08      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable CD </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3   9.72   3.241   6.921 0.012981         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   3.75   0.468   0.519 0.839734         NA          NA</span></span>
<span><span class="co">#        GEN  12  31.41   2.617   2.899 0.001851         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  81.59   2.266   2.511 0.000194         NA          NA</span></span>
<span><span class="co">#        PC1  14  48.25   3.446   3.820 0.000000       59.1        59.1</span></span>
<span><span class="co">#        PC2  12  20.72   1.727   1.910 0.042300       25.4        84.5</span></span>
<span><span class="co">#        PC3  10  12.62   1.262   1.400 0.192000       15.5       100.0</span></span>
<span><span class="co">#  Residuals  96  86.66   0.903      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 294.71   1.543      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable CW </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3 1258.2  419.41  45.225 2.31e-05         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   74.2    9.27   0.772 6.28e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12  531.6   44.30   3.686 1.43e-04         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36 3056.0   84.89   7.064 9.61e-15         NA          NA</span></span>
<span><span class="co">#        PC1  14 2223.8  158.84  13.220 0.00e+00       72.8        72.8</span></span>
<span><span class="co">#        PC2  12  502.5   41.88   3.480 3.00e-04       16.4        89.2</span></span>
<span><span class="co">#        PC3  10  329.7   32.97   2.740 5.20e-03       10.8       100.0</span></span>
<span><span class="co">#  Residuals  96 1153.7   12.02      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 9129.7   47.80      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable KW </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  55465   18488   95.58 1.32e-06         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   1547     193    0.50 8.53e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12  21350    1779    4.60 7.62e-06         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  50965    1416    3.66 2.21e-07         NA          NA</span></span>
<span><span class="co">#        PC1  14  33595    2400    6.20 0.00e+00       65.9        65.9</span></span>
<span><span class="co">#        PC2  12  10106     842    2.18 1.85e-02       19.8        85.7</span></span>
<span><span class="co">#        PC3  10   7264     726    1.88 5.73e-02       14.3       100.0</span></span>
<span><span class="co">#  Residuals  96  37134     387      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 217427    1138      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable NR </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  32.16   10.72   9.605 4.99e-03         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   8.93    1.12   0.678 7.09e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12  45.53    3.79   2.307 1.24e-02         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36 171.36    4.76   2.894 1.95e-05         NA          NA</span></span>
<span><span class="co">#        PC1  14  91.68    6.55   3.980 0.00e+00       53.5        53.5</span></span>
<span><span class="co">#        PC2  12  44.13    3.68   2.240 1.53e-02       25.8        79.2</span></span>
<span><span class="co">#        PC3  10  35.56    3.56   2.160 2.68e-02       20.8       100.0</span></span>
<span><span class="co">#  Residuals  96 157.90    1.64      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 587.24    3.07      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable NKR </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  237.0   79.01  15.843 0.000997         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   39.9    4.99   0.635 0.746348         NA          NA</span></span>
<span><span class="co">#        GEN  12  227.8   18.99   2.418 0.008726         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  602.7   16.74   2.132 0.001839         NA          NA</span></span>
<span><span class="co">#        PC1  14  337.4   24.10   3.070 0.000600       56.0        56.0</span></span>
<span><span class="co">#        PC2  12  192.2   16.02   2.040 0.028500       31.9        87.9</span></span>
<span><span class="co">#        PC3  10   73.1    7.31   0.930 0.509500       12.1       100.0</span></span>
<span><span class="co">#  Residuals  96  753.7    7.85      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 2463.8   12.90      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable CDED </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df  Sum Sq  Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3 0.00698 0.002328    2.73 1.14e-01         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8 0.00682 0.000852    1.96 6.01e-02         NA          NA</span></span>
<span><span class="co">#        GEN  12 0.00858 0.000715    1.64 9.24e-02         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36 0.10919 0.003033    6.97 1.46e-14         NA          NA</span></span>
<span><span class="co">#        PC1  14 0.05863 0.004190    9.62 0.00e+00       53.7        53.7</span></span>
<span><span class="co">#        PC2  12 0.04069 0.003390    7.79 0.00e+00       37.3        91.0</span></span>
<span><span class="co">#        PC3  10 0.00987 0.000990    2.27 1.97e-02        9.0       100.0</span></span>
<span><span class="co">#  Residuals  96 0.04179 0.000435      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 0.28255 0.001479      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable PERK </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3   10.1    3.35    2.61 1.24e-01         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   10.3    1.28    1.11 3.66e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12   31.4    2.62    2.26 1.45e-02         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  396.1   11.00    9.49 7.32e-19         NA          NA</span></span>
<span><span class="co">#        PC1  14  277.4   19.81   17.09 0.00e+00       70.0        70.0</span></span>
<span><span class="co">#        PC2  12   68.0    5.67    4.89 0.00e+00       17.2        87.2</span></span>
<span><span class="co">#        PC3  10   50.7    5.07    4.37 0.00e+00       12.8       100.0</span></span>
<span><span class="co">#  Residuals  96  111.3    1.16      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191  955.2    5.00      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable TKW </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  37013   12338   11.13 3.16e-03         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   8869    1109    1.21 3.03e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12  44633    3719    4.05 4.41e-05         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36 164572    4571    4.98 1.73e-10         NA          NA</span></span>
<span><span class="co">#        PC1  14 104276    7448    8.11 0.00e+00       63.4        63.4</span></span>
<span><span class="co">#        PC2  12  33361    2780    3.03 1.20e-03       20.3        83.6</span></span>
<span><span class="co">#        PC3  10  26935    2694    2.93 3.00e-03       16.4       100.0</span></span>
<span><span class="co">#  Residuals  96  88171     918      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 507829    2659      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># variable NKE </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  160680   53560  26.472 0.000166         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8   16186    2023   0.639 0.743419         NA          NA</span></span>
<span><span class="co">#        GEN  12   45377    3781   1.194 0.298797         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  291530    8098   2.556 0.000147         NA          NA</span></span>
<span><span class="co">#        PC1  14  153621   10973   3.460 0.000100       52.7        52.7</span></span>
<span><span class="co">#        PC2  12   87752    7313   2.310 0.012300       30.1        82.8</span></span>
<span><span class="co">#        PC3  10   50157    5016   1.580 0.124200       17.2       100.0</span></span>
<span><span class="co">#  Residuals  96  304127    3168      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 1109431    5809      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></span>
<span><span class="co"># Done!</span></span>
<span><span class="co"># Class of the model: waas</span></span>
<span><span class="co"># Variable extracted: WAAS</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_table</span><span class="op">(</span><span class="va">waas_index_all</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-5b1b2f4ad92281566982" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5b1b2f4ad92281566982">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["H1","H10","H11","H12","H13","H2","H3","H4","H5","H6","H7","H8","H9"],[0.317737230559106,0.2304925545038413,0.2005062650765562,0.3641172256512484,0.3629787297585104,0.3419320552995118,0.3740701613713339,0.2936568579404878,0.1679848997928831,0.2697806660441449,0.2275267422679403,0.3147920339718822,0.1456521395590858],[0.3147785533421918,0.2429411944619262,0.2169022188812487,0.3910769076085885,0.2568767900616022,0.403425082451245,0.3700313942675842,0.269653557722333,0.1132289297445619,0.1627038463509975,0.1792163070649516,0.3262970088305126,0.03413658759701612],[0.1311097825377484,0.09151969849997915,0.1209001673312562,0.2076465258146455,0.06627063992395148,0.1796227043279505,0.1724269640501267,0.1083249746219949,0.02878085760086686,0.001414388155100883,0.05454339097854068,0.1781003187952645,0.1001298463600509],[0.1070843036345055,0.2185169638576203,0.09432484176737767,0.4531302244304918,0.4034989005292651,0.2644063374383782,0.855956095067707,0.4913244003719885,0.339859685717258,0.585228673643224,0.8165844710871302,0.9985493352017079,0.8777675640389828],[0.6673539633213454,0.9734069300624566,0.6493734342966085,0.3149984654631748,0.8377823081593661,1.07984834261264,0.4855985845345458,0.3783896841163625,0.5668721316979554,0.4090157631096165,0.3844045832103997,0.6531704736426324,0.9066009477626972],[0.7994459365145525,0.9482711664319939,0.4073870670568139,0.5301540701688292,0.8658923751973476,1.164088824789963,0.6029304224135066,0.5107818552801561,0.4105913533485736,0.7327487126898969,0.4526698309242389,1.033304211409341,0.6986878219955206],[0.1303908553798875,0.3063111393689758,0.213683490297622,0.3505894265338332,0.519722185970231,0.5496883120533442,0.5521570507807881,0.4150173699770015,0.2372026123104026,0.5693222652842643,0.5952539167872054,0.7695880485151191,0.6080400995335536],[1.340045448786963,1.040627759563057,0.6917493435988576,0.2566441120832476,1.390125697668891,2.106143600718933,0.5068424418096954,0.5372009344464783,0.7662106340938144,0.9351128572981932,1.572479156589963,1.809415505324734,1.610404130526724],[0.7822880803887244,0.8947185179402489,0.3208283737691148,2.150319467709042,1.951808087664263,3.365828026206374,2.812767090828451,1.694489752935182,0.5193462153700875,3.217534635362123,3.027287802219304,3.886759549731321,3.105826768480957],[0.4271882853030274,0.3717474342932725,0.7939270764028988,0.3093012890643635,0.4981525908099957,0.7959560259350339,0.6108815935682539,0.4356847360682759,0.8366405255343163,0.3687429515236961,0.2836213608930668,0.3519239707498543,0.5024427145884257],[0.928744447585515,0.5058845439039295,0.8364187137100969,0.2278633840965987,0.9455438574811764,0.403560036905226,0.2517970967487076,0.2806930310596603,0.6105434751605213,1.597735822149969,0.5182683397792226,0.9412530679839551,0.8879998246755104],[0.06843714062661457,0.05351703663292888,0.04195069254272739,0.08401895616905707,0.1495063491374024,0.1261837850624183,0.07419055729057904,0.07070987528767589,0.03912567753975277,0.1345216451417591,0.04535782386750849,0.1047293888985663,0.03303256784375378],[0.5703535551628269,0.9074245210438767,0.5152753729073409,0.5287236815268115,1.095431771500922,0.8650645867540205,0.1530799071153106,0.03342442703767874,0.720209639990039,0.9432159243534193,1.016637904091686,0.8534818146875306,0.4200427061747232],[2.723188411550288,2.15423013701007,1.260452226017551,0.5581026540278153,0.5138626366345515,4.407244437094301,4.09701791059782,3.069843236562263,0.7378650934334918,1.636436082137891,3.44196589230443,4.908957950893436,5.499448448596376],[4.128381659798504,0.7557741716265336,1.002456140477239,2.532150031621413,6.862826801725401,2.952134673341627,2.492742339061787,0.664491211230652,1.034805315199935,6.08388960985312,1.053957745166007,3.416077194636608,4.915450022627099]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>GEN<\/th>\n      <th>PH<\/th>\n      <th>EH<\/th>\n      <th>EP<\/th>\n      <th>EL<\/th>\n      <th>ED<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>CW<\/th>\n      <th>KW<\/th>\n      <th>NR<\/th>\n      <th>NKR<\/th>\n      <th>CDED<\/th>\n      <th>PERK<\/th>\n      <th>TKW<\/th>\n      <th>NKE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]},{"name":"GEN","targets":0},{"name":"PH","targets":1},{"name":"EH","targets":2},{"name":"EP","targets":3},{"name":"EL","targets":4},{"name":"ED","targets":5},{"name":"CL","targets":6},{"name":"CD","targets":7},{"name":"CW","targets":8},{"name":"KW","targets":9},{"name":"NR","targets":10},{"name":"NKR","targets":11},{"name":"CDED","targets":12},{"name":"PERK","targets":13},{"name":"TKW","targets":14},{"name":"NKE","targets":15}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render"],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 id="other-ammi-based-stability-indexes">Other AMMI-based stability indexes<a class="anchor" aria-label="anchor" href="#other-ammi-based-stability-indexes"></a>
</h2>
<p>The following AMMI-based stability indexes may be computed using the
function <code><a href="https://tiagoolivoto.github.io/metan/reference/AMMI_indexes.html" class="external-link">AMMI_indexes()</a></code>:</p>
<ul>
<li><strong>AMMI stability value, ASV, <span class="citation">(<a href="#ref-Purchase2000">Purchase, Hatting, and Deventer
2000</a>)</span>.</strong></li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>S</mi><mi>V</mi><mo>=</mo><msqrt><mrow><msup><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mrow><mi>I</mi><mi>P</mi><mi>C</mi><mi>A</mi><msub><mn>1</mn><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow><mrow><mi>I</mi><mi>P</mi><mi>C</mi><mi>A</mi><msub><mn>2</mn><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow></mfrac><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mi>P</mi><mi>C</mi><mi>A</mi><msub><mn>1</mn><mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mi>P</mi><mi>C</mi><mi>A</mi><msub><mn>2</mn><mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">
ASV = \sqrt {{{\left[ {\frac{{IPCA{1_{ss}}}}{{IPCA{2_{ss}}}} \times \left( {IPCA{1_{score}}} \right)} \right]}^2} + {{\left( {IPCA{2_{score}}} \right)}^2}}
</annotation></semantics></math></p>
<ul>
<li><strong>Sums of the absolute value of the IPCA scores</strong></li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>I</mi><mi>P</mi><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></msubsup><mrow><mo stretchy="true" form="prefix">|</mo><msubsup><mo>λ</mo><mi>k</mi><mn>0.5</mn></msubsup><msub><mi>a</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">
SIP{C_i} = \sum\nolimits_{k = 1}^P {\left| {\mathop {\lambda }\nolimits_k^{0.5} {a_{ik}}} \right|}
</annotation></semantics></math></p>
<ul>
<li><strong>Averages of the squared eigenvector values</strong></li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><msub><mi>V</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></msubsup><msubsup><mo>a</mo><mrow><mi>i</mi><mi>k</mi></mrow><mn>2</mn></msubsup><mi>/</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">
E{V_i} = \sum\nolimits_{k = 1}^P {\mathop a\nolimits_{ik}^2 } /P
</annotation></semantics></math> described by <span class="citation">Sneller, Kilgore-Norquest, and Dombek (<a href="#ref-Sneller1997">1997</a>)</span>, where <em>P</em> is the number
of IPCA retained via F-tests;</p>
<ul>
<li><strong>absolute value of the relative contribution of IPCAs to the
interaction <span class="citation">(<a href="#ref-Zali2012">Zali et al.
2012</a>)</span>.</strong></li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>P</mi></msubsup><mrow><msub><mi>θ</mi><mi>k</mi></msub><msub><mi>a</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">
Z{a_i} = \sum\nolimits_{k = 1}^P {{\theta _k}{a_{ik}}}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{\theta _k}</annotation></semantics></math>
is the percentage sum of squares explained by the <em>k</em>-th IPCA.
Simultaneous selection indexes (ssi), are computed by summation of the
ranks of the ASV, SIPC, EV and Za indexes and the ranks of the mean
yields <span class="citation">(<a href="#ref-Farshadfar2008">Farshadfar
2008</a>)</span>, which results in ssiASV, ssiSIPC, ssiEV, and ssiZa,
respectively.</p>
<p>The <code>AMMI_index()</code> function has two arguments. The first
(x) is the model, which must be an object of the class <code>waas</code>
or <code>performs_ammi</code>. The second, (order.y) is the order for
ranking the response variable. By default, it is set to NULL, which
means that the response variable is ordered in descending order. If
<code>x</code> is a list with more than one variable,
<code>order.y</code> must be a vector of the same length of x. Each
element of the vector must be one of the “h” or “l”. If “h” is used, the
response variable will be ordered from maximum to minimum. If “l” is
used then the response variable will be ordered from minimum to maximum.
We will use the previously fitted model <code>AMMI_model</code> to
compute the AMMI-based stability indexes.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stab_indexes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ammi_indexes.html">ammi_indexes</a></span><span class="op">(</span><span class="va">AMMI_model</span><span class="op">)</span></span>
<span><span class="fu">print_table</span><span class="op">(</span><span class="va">stab_indexes</span><span class="op">$</span><span class="va">GY</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-25c3e940e6859592f801" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-25c3e940e6859592f801">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9"],[2.603676181657848,2.471220873015873,2.744146975308642,2.955344109347443,2.641915440917108,2.537344479717813,2.534030476190476,2.740909329805997,3.003637504409171,2.510191860670194],[6,10,3,2,5,7,8,4,1,9],[0.1078534374396072,1.465052993661059,0.820383678890519,0.09592176875511135,0.3626980684873982,0.2591394180783687,0.4395814990129651,0.9706106100420591,0.4161160000464176,0.9468823259057805],[2,10,7,1,4,3,6,9,5,8],[8,20,10,3,9,10,14,13,6,17],[0.109823966248448,0.389303866188856,0.07924825742547839,0.03594992850309207,0.1887673708167518,0.1367423985779789,0.08432686745301463,0.2108546975622032,0.182302008260824,0.3123976729999209],[4,10,2,1,7,5,3,8,6,9],[10,20,5,3,12,12,11,12,7,18],[0.3457960377618403,1.225459269848974,0.2493252309046935,0.1130752266472089,0.5938765939111372,0.4303801712013312,0.2652338623640165,0.6632496688623598,0.5739328746838265,0.9827171116144943],[4,10,2,1,7,5,3,8,6,9],[10,20,5,3,12,12,11,12,7,18],[1.324822082772178,5.401079713495453,2.799954233607461,1.001472524196821,2.161472247333335,1.882716300525543,2.277443276992283,3.173833977749787,1.988796506390389,3.683691481473576],[2,10,7,1,5,3,6,8,4,9],[8,20,10,3,10,10,14,12,5,18],[0.4463526139235288,1.62251663420402,0.9792244449093394,0.3391329168261613,0.8036683145236071,0.6431477375842475,0.7400220046445239,1.156845033876031,0.8280082985251324,1.313498834830523],[2,10,7,1,5,3,4,8,6,9],[8,20,10,3,10,10,12,12,7,18],[0.243826750411607,0.9167507844506081,0.8464766642069905,0.2875495408997907,0.4566288967796581,0.4159984061473462,0.6035952045874121,0.8747491803531174,0.5172047023385148,0.7227242949648611],[1,10,8,2,4,3,6,9,5,7],[7,20,11,4,9,10,14,13,6,16],[0.01486287105407102,0.2101080001977013,0.1791306857617486,0.02067118461792011,0.05212748734355191,0.0432636684792831,0.09108179275022997,0.1912965321321127,0.06687517603026792,0.1305826016331139],[1,10,8,2,4,3,6,9,5,7],[7,20,11,4,9,10,14,13,6,16],[0.1992306559563667,2.632560228268742,0.9588805135080036,0.11501113527502,0.6458827597692154,0.413639012359736,0.5476325673580998,1.338290432403635,0.6855977424264846,1.725279189101141],[2,10,7,1,5,3,4,8,6,9],[8,20,10,3,10,10,12,12,7,18],[0.1101119582496633,0.39123254275934,0.1318181402195553,0.04960960885957306,0.1896391033818053,0.1414506026439477,0.1135157741368525,0.2235902119132535,0.1876125402218569,0.3128544965204874],[2,10,4,1,7,5,3,8,6,9],[8,20,7,3,12,12,11,12,7,18],[0.3687644554611573,1.817974595633939,1.188814970661787,0.4329341461558653,1.240494757396407,0.7913555517115399,0.9833221052427,1.658860165494796,0.8474631265964395,2.138204343664835],[1,9,6,2,7,3,5,8,4,10],[7,19,9,4,12,10,13,12,5,19],[0.462752669772945,2.06851308823375,1.544266818621039,0.551543842845948,1.035760113899536,0.9966901001939652,1.139656075274301,1.787287243324873,1.177809832001178,1.49500282572499],[1,10,8,2,4,3,5,9,6,7],[7,20,11,4,9,10,13,13,7,16],[0.1003184308248191,0.4370368616988763,0.2155217439689424,0.07968530254390829,0.218715742300633,0.1863727769486793,0.1721686819027187,0.3034417372584856,0.224604157019444,0.3362018378219856],[2,10,5,1,6,4,3,8,7,9],[8,20,8,3,11,11,11,12,8,18],[0.1508150928594893,0.6521882352626476,0.2834384000328007,0.1062251163882729,0.3256451403192206,0.269523978474319,0.2325118576429857,0.4283511016621614,0.3265886766901312,0.5067465777229857],[2,10,5,1,6,4,3,8,7,9],[8,20,8,3,11,11,11,12,8,18]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>Y_R<\/th>\n      <th>ASTAB<\/th>\n      <th>ASTAB_R<\/th>\n      <th>ssiASTAB<\/th>\n      <th>ASI<\/th>\n      <th>ASI_R<\/th>\n      <th>ASI_SSI<\/th>\n      <th>ASV<\/th>\n      <th>ASV_R<\/th>\n      <th>ASV_SSI<\/th>\n      <th>AVAMGE<\/th>\n      <th>AVAMGE_R<\/th>\n      <th>AVAMGE_SSI<\/th>\n      <th>DA<\/th>\n      <th>DA_R<\/th>\n      <th>DA_SSI<\/th>\n      <th>DZ<\/th>\n      <th>DZ_R<\/th>\n      <th>DZ_SSI<\/th>\n      <th>EV<\/th>\n      <th>EV_R<\/th>\n      <th>EV_SSI<\/th>\n      <th>FA<\/th>\n      <th>FA_R<\/th>\n      <th>FA_SSI<\/th>\n      <th>MASI<\/th>\n      <th>MASI_R<\/th>\n      <th>MASI_SSI<\/th>\n      <th>MASV<\/th>\n      <th>MASV_R<\/th>\n      <th>MASV_SSI<\/th>\n      <th>SIPC<\/th>\n      <th>SIPC_R<\/th>\n      <th>SIPC_SSI<\/th>\n      <th>ZA<\/th>\n      <th>ZA_R<\/th>\n      <th>ZA_SSI<\/th>\n      <th>WAAS<\/th>\n      <th>WAAS_R<\/th>\n      <th>WAAS_SSI<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":21,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":22,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":23,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":24,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":25,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":26,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":27,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":28,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":29,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":30,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":31,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":32,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":33,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":34,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":35,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":36,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":37,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":38,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":39,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":40,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":41,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]},{"name":"GEN","targets":0},{"name":"Y","targets":1},{"name":"Y_R","targets":2},{"name":"ASTAB","targets":3},{"name":"ASTAB_R","targets":4},{"name":"ssiASTAB","targets":5},{"name":"ASI","targets":6},{"name":"ASI_R","targets":7},{"name":"ASI_SSI","targets":8},{"name":"ASV","targets":9},{"name":"ASV_R","targets":10},{"name":"ASV_SSI","targets":11},{"name":"AVAMGE","targets":12},{"name":"AVAMGE_R","targets":13},{"name":"AVAMGE_SSI","targets":14},{"name":"DA","targets":15},{"name":"DA_R","targets":16},{"name":"DA_SSI","targets":17},{"name":"DZ","targets":18},{"name":"DZ_R","targets":19},{"name":"DZ_SSI","targets":20},{"name":"EV","targets":21},{"name":"EV_R","targets":22},{"name":"EV_SSI","targets":23},{"name":"FA","targets":24},{"name":"FA_R","targets":25},{"name":"FA_SSI","targets":26},{"name":"MASI","targets":27},{"name":"MASI_R","targets":28},{"name":"MASI_SSI","targets":29},{"name":"MASV","targets":30},{"name":"MASV_R","targets":31},{"name":"MASV_SSI","targets":32},{"name":"SIPC","targets":33},{"name":"SIPC_R","targets":34},{"name":"SIPC_SSI","targets":35},{"name":"ZA","targets":36},{"name":"ZA_R","targets":37},{"name":"ZA_SSI","targets":38},{"name":"WAAS","targets":39},{"name":"WAAS_R","targets":40},{"name":"WAAS_SSI","targets":41}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render","options.columnDefs.20.render","options.columnDefs.21.render","options.columnDefs.22.render","options.columnDefs.23.render","options.columnDefs.24.render","options.columnDefs.25.render","options.columnDefs.26.render","options.columnDefs.27.render","options.columnDefs.28.render","options.columnDefs.29.render","options.columnDefs.30.render","options.columnDefs.31.render","options.columnDefs.32.render","options.columnDefs.33.render","options.columnDefs.34.render","options.columnDefs.35.render","options.columnDefs.36.render","options.columnDefs.37.render","options.columnDefs.38.render","options.columnDefs.39.render","options.columnDefs.40.render"],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="ammi-model-for-unbalanced-data">AMMI model for unbalanced data<a class="anchor" aria-label="anchor" href="#ammi-model-for-unbalanced-data"></a>
</h2>
<p>Singular Value Decomposition requires a complete two-way table (i.e.,
all genotypes in all environments). Sometimes (for several reasons), a
complete two-way table cannot be obtained in a multi-environment trial.
<code>metan</code> offers an option to impute the missing cells of the
two-way table using Expectation-Maximization algorithms. If an
incomplete two-way table is identified in <code><a href="../reference/performs_ammi.html">performs_ammi()</a></code> a
warning is issued, <code><a href="../reference/impute_missing_val.html">impute_missing_val()</a></code> is called
internally and the missing value(s) is(are) imputed using a low-rank
Singular Value Decomposition approximation estimated by the
Expectation-Maximization algorithm. The algorithm will (i) initialize
all NA values to the column means; (ii) compute the first axis terms of
the SVD of the completed matrix; (iii) replace the previously missing
values with their approximations from the SVD; (iv) iterate steps 2
through 3 until convergence or a maximum number of iterations be
achieved.</p>
<p>As an example we will run the AMMI model by omiting <code>H2</code>
from <code>E1</code> in `data_ge2.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">miss_val</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data_ge2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/utils_rows_cols.html">remove_rows</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_miss</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">miss_val</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">PH</span><span class="op">)</span></span>
<span><span class="co"># ----------------------------------------------</span></span>
<span><span class="co"># Convergence information</span></span>
<span><span class="co"># ----------------------------------------------</span></span>
<span><span class="co"># Number of iterations: 23</span></span>
<span><span class="co"># Final RMSE: 6.007683e-11</span></span>
<span><span class="co"># Number of axis: 1</span></span>
<span><span class="co"># Convergence: TRUE</span></span>
<span><span class="co"># ----------------------------------------------</span></span>
<span><span class="co"># Warning: Data imputation used to fill the GxE matrix</span></span>
<span><span class="co"># variable PH </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  6.952  2.3173 117.463 5.92e-07         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8  0.158  0.0197   0.863 5.51e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12  2.470  0.2058   9.000 3.03e-11         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  35  5.286  0.1510   6.603 1.39e-13         NA          NA</span></span>
<span><span class="co">#        PC1  14  4.413  0.3152  13.780 0.00e+00       83.4        83.4</span></span>
<span><span class="co">#        PC2  12  0.588  0.0490   2.140 2.12e-02       11.1        94.5</span></span>
<span><span class="co">#        PC3  10  0.290  0.0290   1.270 2.59e-01        5.5       100.0</span></span>
<span><span class="co">#  Residuals  94  2.150  0.0229      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 188 22.306  0.1187      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></span>
<span><span class="co"># Done!</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">mod_miss</span>, type <span class="op">=</span> <span class="fl">2</span>, title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_comp</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data_ge2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">PH</span><span class="op">)</span></span>
<span><span class="co"># variable PH </span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># AMMI analysis table</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span></span>
<span><span class="co">#        ENV   3  7.719  2.5728 127.913 4.25e-07         NA          NA</span></span>
<span><span class="co">#   REP(ENV)   8  0.161  0.0201   0.897 5.22e-01         NA          NA</span></span>
<span><span class="co">#        GEN  12  1.865  0.1554   6.929 6.89e-09         NA          NA</span></span>
<span><span class="co">#    GEN:ENV  36  5.397  0.1499   6.686 5.01e-14         NA          NA</span></span>
<span><span class="co">#        PC1  14  4.466  0.3190  14.230 0.00e+00       82.8        82.8</span></span>
<span><span class="co">#        PC2  12  0.653  0.0545   2.430 8.40e-03       12.1        94.9</span></span>
<span><span class="co">#        PC3  10  0.277  0.0277   1.240 2.76e-01        5.1       100.0</span></span>
<span><span class="co">#  Residuals  96  2.153  0.0224      NA       NA         NA          NA</span></span>
<span><span class="co">#      Total 191 22.692  0.1188      NA       NA         NA          NA</span></span>
<span><span class="co"># ---------------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span></span>
<span><span class="co"># Done!</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">mod_comp</span>, type <span class="op">=</span> <span class="fl">2</span>, title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span></span>
<span><span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Missing data"</span>, <span class="st">"Complete data"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-25-1.png" width="960"></p>
<hr>
</div>
<div class="section level2">
<h2 id="rendering">Rendering engine<a class="anchor" aria-label="anchor" href="#rendering"></a>
</h2>
<p>This vignette was built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>. All tables were produced
with the package <a href="https://rstudio.github.io/DT/" class="external-link"><code>DT</code></a> using the
following function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span> <span class="co"># Used to make the tables</span></span>
<span><span class="co"># Function to make HTML tables</span></span>
<span><span class="va">print_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table</span>, <span class="va">rownames</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">table</span>, rownames <span class="op">=</span> <span class="va">rownames</span>, extensions <span class="op">=</span> <span class="st">'Buttons'</span>,</span>
<span>          options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scrollX <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                         dom <span class="op">=</span> <span class="st">'&lt;&lt;t&gt;Bp&gt;'</span>,</span>
<span>                         buttons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'copy'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html" class="external-link">formatSignif</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">class</span><span class="op">)</span> <span class="op">==</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Farshadfar2008" class="csl-entry">
Farshadfar, E. 2008. <span>“<span class="nocase">Incorporation of AMMI
stability value and grain yield in a single non-parametric index (GSI)
in bread wheat.</span>”</span> <em>Pakistan Journal of Biological
Sciences</em> 11 (14): 1791–96. <a href="http://www.ncbi.nlm.nih.gov/pubmed/18817218" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/18817218</a>.
</div>
<div id="ref-Gollob:1968" class="csl-entry">
Gollob, H. F. 1968. <span>“<span class="nocase">A statistical model
which combines features of factor analytic and analysis of variance
techniques.</span>”</span> <em>Psychometrika</em> 33 (1): 73–115. <a href="https://doi.org/10.1007/BF02289676" class="external-link">https://doi.org/10.1007/BF02289676</a>.
</div>
<div id="ref-Olivoto2019" class="csl-entry">
Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, V. S. Marchioro, V. Q. de
Souza, and E. Jost. 2019. <span>“<span class="nocase">Mean performance
and stability in multi-environment trials I: Combining features of AMMI
and BLUP techniques</span>.”</span> <em>Agronomy Journal</em> 111 (6):
2949–60. <a href="https://doi.org/10.2134/agronj2019.03.0220" class="external-link">https://doi.org/10.2134/agronj2019.03.0220</a>.
</div>
<div id="ref-Olivoto2019a" class="csl-entry">
Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, B. G. Sari, and M. I.
Diel. 2019. <span>“<span class="nocase">Mean performance and stability
in multi-environment trials II: Selection based on multiple
traits</span>.”</span> <em>Agronomy Journal</em> 111 (6): 2961–69. <a href="https://doi.org/10.2134/agronj2019.03.0221" class="external-link">https://doi.org/10.2134/agronj2019.03.0221</a>.
</div>
<div id="ref-Piepho:1994" class="csl-entry">
Piepho, H. P. 1994. <span>“Best Linear Unbiased Prediction (BLUP) for
Regional Yield Trials: A Comparison to Additive Main Effects and
Multiplicative Interaction (AMMI) Analysis.”</span> <em>Theor. Appl.
Genet.</em> 89 (5): 647–54. <a href="https://doi.org/10.1007/BF00222462" class="external-link">https://doi.org/10.1007/BF00222462</a>.
</div>
<div id="ref-Purchase2000" class="csl-entry">
Purchase, J. L., Hesta Hatting, and C. S. van Deventer. 2000.
<span>“<span class="nocase">Genotype × environment interaction of winter
wheat ( Triticum aestivum L.) in South Africa: II. Stability analysis of
yield performance</span>.”</span> <em>South African Journal of Plant and
Soil</em> 17 (3): 101–7. <a href="https://doi.org/10.1080/02571862.2000.10634878" class="external-link">https://doi.org/10.1080/02571862.2000.10634878</a>.
</div>
<div id="ref-Sneller1997" class="csl-entry">
Sneller, C. H., L. Kilgore-Norquest, and D. Dombek. 1997. <span>“<span class="nocase">Repeatability of Yield Stability Statistics in
Soybean</span>.”</span> <em>Crop Science</em> 37 (2): 383–90. <a href="https://doi.org/10.2135/cropsci1997.0011183X003700020013x" class="external-link">https://doi.org/10.2135/cropsci1997.0011183X003700020013x</a>.
</div>
<div id="ref-Zali2012" class="csl-entry">
Zali, H., E. Farshadfar, S. H. Sabaghpour, and R. Karimizadeh. 2012.
<span>“<span class="nocase">Evaluation of genotype × environment
interaction in chickpea using measures of stability from AMMI
model</span>.”</span> <em>Annals of Biological Research</em> 3 (7):
3126–36. <a href="http://eprints.icrisat.ac.in/7173/" class="external-link">http://eprints.icrisat.ac.in/7173/</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
