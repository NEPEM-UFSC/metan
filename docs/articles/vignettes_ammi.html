<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing multienvironment trials using AMMI • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Analyzing multienvironment trials using AMMI">
<meta property="og:description" content="metan">
<meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.10.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignettes_helper.html">Helper functions</a>
    </li>
    <li>
      <a href="../articles/vignettes_utilities.html">Utilities</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    </li>
    <li>
      <a href="../articles/vignettes_biometry.html">Biometry</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/vignettes_ammi.html">AMMI</a>
    </li>
    <li>
      <a href="../articles/vignettes_blup.html">BLUP</a>
    </li>
    <li>
      <a href="../articles/vignettes_gge.html">GGE</a>
    </li>
    <li>
      <a href="../articles/vignettes_stability.html">Stability</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/vignettes_indexes.html">Multivariate indexes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="../CONTRIBUTING.html">Contributing</a>
    </li>
    <li>
      <a href="../ISSUE_TEMPLATE.html">Issues</a>
    </li>
    <li>
      <a href="../SUPPORT.html">Support</a>
    </li>
    <li>
      <a href="../LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">RG</a>
</li>
<li>
  <a href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignettes_ammi_files/header-attrs-2.5/header-attrs.js"></script><script src="vignettes_ammi_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="vignettes_ammi_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="vignettes_ammi_files/anchor-sections-1.0/anchor-sections.js"></script><script src="vignettes_ammi_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="vignettes_ammi_files/jquery-1.12.4/jquery.min.js"></script><link href="vignettes_ammi_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="vignettes_ammi_files/datatables-binding-0.16/datatables.js"></script><link href="vignettes_ammi_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="vignettes_ammi_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="vignettes_ammi_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="vignettes_ammi_files/jszip-1.10.20/jszip.min.js"></script><script src="vignettes_ammi_files/pdfmake-1.10.20/pdfmake.js"></script><script src="vignettes_ammi_files/pdfmake-1.10.20/vfs_fonts.js"></script><link href="vignettes_ammi_files/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="vignettes_ammi_files/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="vignettes_ammi_files/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="vignettes_ammi_files/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="vignettes_ammi_files/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="vignettes_ammi_files/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="vignettes_ammi_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="vignettes_ammi_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analyzing multienvironment trials using AMMI</h1>
                        <h4 class="author">Tiago Olivoto</h4>
            
            <h4 class="date">2020-11-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/master/vignettes/vignettes_ammi.Rmd"><code>vignettes/vignettes_ammi.Rmd</code></a></small>
      <div class="hidden name"><code>vignettes_ammi.Rmd</code></div>

    </div>

    
    
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>In this section, we will use the data in <code>data_ge</code>. For more information, please, see <code><a href="../reference/data_ge.html">?data_ge</a></code>. Other data sets can be used provided that the following columns are in the dataset: environment, genotype, block/replicate and response variable(s).</p>
<p>The first step is to inspect the data with the function <code><a href="../reference/inspect.html">inspect()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan">metan</a></span><span class="op">)</span>
<span class="va">insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data_ge</span>,
                verbose <span class="op">=</span> <span class="cn">FALSE</span>,
                plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu">print_table</span><span class="op">(</span><span class="va">insp</span><span class="op">)</span></pre></div>
<div id="htmlwidget-41aee9819fcaca9f19ab" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-41aee9819fcaca9f19ab">{"x":{"filter":"none","extensions":["Buttons"],"data":[["ENV","GEN","REP","GY","HM"],["factor","factor","factor","numeric","numeric"],["No","No","No","No","No"],["14","10","3","-","-"],[420,420,420,420,420],[null,null,null,0.67,38],[null,null,null,2.61,48],[null,null,null,5.09,58],[null,null,null,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Class<\/th>\n      <th>Missing<\/th>\n      <th>Levels<\/th>\n      <th>Valid_n<\/th>\n      <th>Min<\/th>\n      <th>Median<\/th>\n      <th>Max<\/th>\n      <th>Outlier<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[4,5,6,7,8]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script>
</div>
<div id="individual-and-joint-anova" class="section level1">
<h1 class="hasAnchor">
<a href="#individual-and-joint-anova" class="anchor"></a>Individual and joint ANOVA</h1>
<p>It is suggested to check if genotype-vs-environment interaction is significant before proceeding with the AMMI analysis. A within-environment ANOVA considering a fixed-effect model is computed with the function <code><a href="../reference/anova_ind.html">anova_ind()</a></code>. For each environment the Mean Squares for block, genotypes and error are shown. Estimated F-value and the probability error are also shown for block and genotype effects. Some measures of experimental precision are calculated, namely, coefficient of variation, <span class="math inline">\(CV = (\sqrt{MS_{res}}/Mean) \times 100\)</span>; the heritability, <span class="math inline">\(h2 = (MS_{gen} - MS_{res})/MS_{gen}\)</span>, and the accuracy of selection, <span class="math inline">\(As = \sqrt{h2}\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">indiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anova_ind.html">anova_ind</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span><span class="op">)</span>
<span class="fu">print_table</span><span class="op">(</span><span class="va">indiv</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">individual</span><span class="op">)</span></pre></div>
<div id="htmlwidget-72fe9ef0db2e2703ec1c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-72fe9ef0db2e2703ec1c">{"x":{"filter":"none","extensions":["Buttons"],"data":[["E1","E10","E11","E12","E13","E14","E2","E3","E4","E5","E6","E7","E8","E9"],[2.52068333333333,2.17520933333333,1.36826466666667,1.60851234567901,2.90963086419753,1.78193333333333,3.179959,4.06433333333333,3.67527266666667,3.9105,2.66321358024691,1.988896,2.53637566666667,3.0566],[0.337385600511111,0.295786904124444,0.150921619764444,0.320152203144846,0.713410667220444,0.130501734715237,0.206625286385556,0.335055037037037,0.531337007835556,0.52611928407763,0.134643290865213,0.336918349131852,0.214624108163334,0.679253170370371],[2.34281845209055,11.0898305532791,1.43768230597274,5.98214130743372,7.17901402626545,1.73233225179312,1.15746910139125,1.87248355848638,3.85883461642741,7.92860085889109,2.29901084385307,3.70115230765708,7.71741966353919,6.12412906106611],[0.0593574917952736,1.0970350320199e-05,0.244311554211091,0.000647365356199633,0.000209508445197139,0.153470092398705,0.376321723486467,0.123033433442803,0.00712269621177561,0.000110130278465621,0.0634540304937545,0.00872663166797165,0.000131419549959098,0.000562178071560829],[0.065221556893333,0.653673984253333,0.377309521973333,0.0918950897576592,0.0767378734339277,0.103520823182442,0.698288836170001,0.488644133333333,0.116459789293333,0.2188069,0.159851193598536,0.380985642759999,0.816771729123333,0.5825911],[0.452900973640521,24.5079603639463,3.59425789666678,1.717087707002,0.772209184752379,1.37417683467911,3.91165943845359,2.7308292801948,0.845789131417026,3.29741301597171,2.72943141187616,4.18524516257069,29.3693483779665,5.25262632824084],[0.642830700563802,7.2752956639331e-06,0.0485992251143208,0.207726316764299,0.476702896151918,0.278355473744947,0.0388457957964554,0.0920924770160349,0.4455821792576,0.0602363642850226,0.0921913011470679,0.0321653810606605,2.14942735527917e-06,0.0159635138493332],[0.144008427204444,0.0266719047422222,0.104975639706667,0.053517994091348,0.0993744634862572,0.0753329706701214,0.178514731958889,0.178936170370371,0.137693646048889,0.0663571408677538,0.058565748493624,0.0910306631896296,0.0278103456233333,0.110914248148148],[15.0548233431901,7.50802928071276,23.679588597476,14.3822063347019,10.8342662375011,15.4028503127406,13.2866504788877,10.4078194586283,10.0964194610813,6.58736218553517,9.0869021680466,15.1698672047828,6.57490701293982,10.895698095095],[0.573163682782301,0.909827296711552,0.304436038584063,0.832835777590652,0.860705105695384,0.42274353031013,0.136046051857436,0.465949916906962,0.74085440310323,0.873874342043766,0.56503032481394,0.729813875010989,0.870423011369398,0.836711475210825],[0.757075744415512,0.953848676002411,0.551757227940027,0.912598365980704,0.927741939170254,0.650187304021026,0.368844210822721,0.682605242367038,0.860728995156565,0.934812463568905,0.751684990414163,0.854291446176882,0.932964635647782,0.914719342318082]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ENV<\/th>\n      <th>MEAN<\/th>\n      <th>MSG<\/th>\n      <th>FCG<\/th>\n      <th>PFG<\/th>\n      <th>MSB<\/th>\n      <th>FCB<\/th>\n      <th>PFB<\/th>\n      <th>MSE<\/th>\n      <th>CV<\/th>\n      <th>h2<\/th>\n      <th>AS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render"],"jsHooks":[]}</script><p>The joint ANOVA is performed with the function <code><a href="../reference/anova_joint.html">anova_joint()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan">metan</a></span><span class="op">)</span>
<span class="va">joint</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anova_joint.html">anova_joint</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">print_table</span><span class="op">(</span><span class="va">joint</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">anova</span><span class="op">)</span></pre></div>
<div id="htmlwidget-7be641aaeeee52c8e576" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7be641aaeeee52c8e576">{"x":{"filter":"none","extensions":["Buttons"],"data":[["ENV","REP(ENV)","GEN","GEN:ENV","Residuals","CV(%)","MSR+/MSR-","OVmean"],[13,28,9,117,252,11.6277903583014,6.70878859608069,2.67424172310406],[279.573552025248,9.66151634754513,12.9950437035309,31.2195646665927,24.3666737028305,null,null,null],[21.505657848096,0.345054155269469,1.44389374483677,0.266833886039254,0.0966931496144068,null,null,null],[62.3254568005455,3.56854809927567,14.9327408466342,2.75959452250066,null,null,null,null],[0,3.59319101417938e-08,2.19011792959017e-19,1.00519093513147e-11,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Source<\/th>\n      <th>Df<\/th>\n      <th>Sum Sq<\/th>\n      <th>Mean Sq<\/th>\n      <th>F value<\/th>\n      <th>Pr(&gt;F)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[1,2,3,4,5]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script><p>The genotype-vs-environment interaction was highly significant. So we’ll proceed with the AMMI analysis.</p>
<div id="the-ammi-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ammi-model" class="anchor"></a>The AMMI model</h2>
<p>The estimate of the response variable for the <em>i</em>th genotype in the <em>j</em>th environment using The Additive Main Effect and Multiplicative interaction (AMMI) model, is given as follows:</p>
<p><span class="math display">\[
{y_{ij}} = \mu  + {\alpha_i} + {\tau_j} + \sum\limits_{k = 1}^p {{\lambda _k}{a_{ik}}} {t_{jk}} + {\rho _{ij}} + {\varepsilon _{ij}}
\]</span></p>
<p>where <span class="math inline">\({\lambda_k}\)</span> is the singular value for the <em>k</em>-th interaction principal component axis (IPCA); <span class="math inline">\(a_{ik}\)</span> is the <em>i</em>-th element of the <em>k</em>-th eigenvector; <span class="math inline">\(t_{jk}\)</span> is the <em>j</em>th element of the <em>k</em>th eigenvector. A residual <span class="math inline">\(\rho _{ij}\)</span> remains, if not all <em>p</em> IPCA are used, where <span class="math inline">\(p \le min(g - 1; e - 1)\)</span>.</p>
<p>The AMMI model is fitted with the <code><a href="../reference/performs_ammi.html">performs_ammi()</a></code> function. The first argument is the data, in our example <code>data_ge</code>. The second argument (<code>resp</code>) is the response variable to be analyzed. The function allow a single variable (in this case GY) or a vector of response variables. The arguments (<code>gen</code>, <code>env</code>, and <code>rep</code>) are the name of the columns that contains the levels for genotypes, environments, and replications, respectively. The last argument (<code>verbose</code>) control if the code will run silently.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">AMMI_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">data_ge</span>,
                            env <span class="op">=</span> <span class="va">ENV</span>,
                            gen <span class="op">=</span> <span class="va">GEN</span>,
                            rep <span class="op">=</span> <span class="va">REP</span>,
                            resp <span class="op">=</span> <span class="va">GY</span>,
                            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<p>Note that using the arguments in the correct order, the model above may be fitted cleanly with:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">AMMI_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
</div>
<div id="the-ammi-table" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ammi-table" class="anchor"></a>The AMMI table</h2>
<p>The following comand creates the well-known ANOVA table for the AMMI model. Note that since</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu">print_table</span><span class="op">(</span><span class="va">AMMI_model</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">ANOVA</span><span class="op">)</span></pre></div>
<div id="htmlwidget-9daf83535b7d80518314" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9daf83535b7d80518314">{"x":{"filter":"none","extensions":["Buttons"],"data":[["ENV","REP(ENV)","GEN","GEN:ENV","PC1","PC2","PC3","PC4","PC5","PC6","PC7","PC8","PC9","Residuals","Total"],[13,28,9,117,21,19,17,15,13,11,9,7,5,252,536],[279.573552025248,9.66151634754513,12.9950437035309,31.2195646665927,10.74914,9.92392,4.03918,3.07377,1.44644,0.93224,0.5667,0.36232,0.12586,24.3666737028305,389.035920445748],[21.505657848096,0.345054155269469,1.44389374483677,0.266833886039254,0.51186,0.52231,0.2376,0.20492,0.11126,0.08475,0.06297,0.05176,0.02517,0.0966931496144068,0.725813284413708],[62.3254568005455,3.56854809927567,14.9327408466342,2.75959452250066,5.29,5.4,2.46,2.12,1.15,0.88,0.65,0.54,0.26,null,null],[0,3.59319101417938e-08,2.19011792959017e-19,1.00519093513147e-11,0,0,0.0014,0.0096,0.3176,0.5606,0.7535,0.8037,0.9345,null,null],[".",".",".",".","34.4","31.8","12.9","9.8","4.6","3","1.8","1.2","0.4",".",null],[".",".",".",".","34.4","66.2","79.2","89","93.6","96.6","98.4","99.6","100",".",null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Source<\/th>\n      <th>Df<\/th>\n      <th>Sum Sq<\/th>\n      <th>Mean Sq<\/th>\n      <th>F value<\/th>\n      <th>Pr(&gt;F)<\/th>\n      <th>Proportion<\/th>\n      <th>Accumulated<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[1,2,3,4,5]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script><p>Nine interaction principal component axis (IPCA) were fitted and four were significant at 5% probability error. Based on this result, the AMMI4 model would be the best model to predict the yielding of the genotypes in the studied environments.</p>
</div>
</div>
<div id="estimating-the-response-variable-based-on-significant-ipca-axes" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-the-response-variable-based-on-significant-ipca-axes" class="anchor"></a>Estimating the response variable based on significant IPCA axes</h1>
<p>The response variable of a two-way table (for example, the yield of <em>m</em> genotypes in <em>n</em> environments) may be estimated using the S3 method <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> applyed to an object of class <code>waas</code>. This estimation is based on the number of multiplicative terms declared in the function. If <code>naxis = 1</code>, the AMMI1 (with one multiplicative term) is used for estimating the response variable. If <code>naxis = min(g - 1; e - 1)</code>, the AMMIF is fitted. A summary of all possible AMMI models is presented below.</p>
<table class="table">
<colgroup>
<col width="24%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th align="left">Member of AMMI family</th>
<th align="left">Espected response of the <em>i</em>-th genotype in the <em>j</em>th environment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AMMI0</td>
<td align="left"><span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..}\)</span></td>
</tr>
<tr class="even">
<td align="left">AMMI1</td>
<td align="left"><span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..} +\lambda_1 a_{i1}t_{j1}\)</span></td>
</tr>
<tr class="odd">
<td align="left">AMMI2</td>
<td align="left"><span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..} +\lambda_1 a_{i1}t_{j1}+\lambda_2 a_{i2}t_{j2}\)</span></td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">AMMIF</td>
<td align="left"><span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..} +\lambda_1 a_{i1}t_{j1}+\lambda_2 a_{i2}t_{j2}+...+\lambda_p a_{ip}t_{jp}\)</span></td>
</tr>
</tbody>
</table>
<p>Procedures based on postdictive success, such as Gollobs’s test <span class="citation">(Gollob <a href="#ref-Gollob:1968" role="doc-biblioref">1968</a>)</span> or predictive success, such as cross-validation <span class="citation">(Piepho <a href="#ref-Piepho:1994" role="doc-biblioref">1994</a>)</span> should be used to define the number of IPCA used for estimating the response variable in AMMI analysis. This package provides both. The <code><a href="../reference/waas.html">waas()</a></code> function compute traditional AMMI analysis showing the number of significant axes according to Gollobs’s test. On the other hand, <code><a href="../reference/cv_ammif.html">cv_ammif()</a></code> function provides cross-validation of AMMI-model family, considering a completely randomized design (CRD) or a randomized complete block design (RCBD).</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">AMMI_model</span>, naxis <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu">print_table</span><span class="op">(</span><span class="va">predicted</span><span class="op">$</span><span class="va">GY</span><span class="op">)</span></pre></div>
<div id="htmlwidget-e1d83bcffa7ffbc0ece9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e1d83bcffa7ffbc0ece9">{"x":{"filter":"none","extensions":["Buttons"],"data":[["E1","E1","E1","E1","E1","E1","E1","E1","E1","E1","E10","E10","E10","E10","E10","E10","E10","E10","E10","E10","E11","E11","E11","E11","E11","E11","E11","E11","E11","E11","E12","E12","E12","E12","E12","E12","E12","E12","E12","E12","E13","E13","E13","E13","E13","E13","E13","E13","E13","E13","E14","E14","E14","E14","E14","E14","E14","E14","E14","E14","E2","E2","E2","E2","E2","E2","E2","E2","E2","E2","E3","E3","E3","E3","E3","E3","E3","E3","E3","E3","E4","E4","E4","E4","E4","E4","E4","E4","E4","E4","E5","E5","E5","E5","E5","E5","E5","E5","E5","E5","E6","E6","E6","E6","E6","E6","E6","E6","E6","E6","E7","E7","E7","E7","E7","E7","E7","E7","E7","E7","E8","E8","E8","E8","E8","E8","E8","E8","E8","E8","E9","E9","E9","E9","E9","E9","E9","E9","E9","E9"],["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","G1","G10","G2","G3","G4","G5","G6","G7","G8","G9"],[2.36578666666667,1.97407333333333,2.90174666666667,2.88858666666667,2.58856666666667,2.18826,2.3008,2.77372666666667,2.89936,2.32592666666667,2.30763333333333,1.53625333333333,2.29705333333333,2.33672666666667,2.16735333333333,2.13983333333333,2.20814666666667,2.44189333333333,2.57486666666667,1.74233333333333,1.35566666666667,0.8991,1.49072,1.56772666666667,1.37,1.32566666666667,1.50066666666667,1.36433333333333,1.68343333333333,1.12533333333333,1.34233333333333,1.02213580246914,1.99333333333333,1.76435802469136,1.52733333333333,1.689,1.38566666666667,1.95162962962963,2,1.40933333333333,2.99825925925926,1.83066666666667,3.02830864197531,3.46914814814815,2.63571604938272,2.5680987654321,2.91166666666667,3.18383950617284,3.51997530864198,2.95062962962963,1.53333333333333,1.85920987654321,1.42658024691358,2.05965432098765,1.86133333333333,1.7842962962963,1.79885185185185,1.93633333333333,1.99186419753086,1.56787654320988,3.04069,3.14584,3.23105333333333,3.60828,3.19008,3.14013666666667,3.29117333333333,2.61267666666667,3.44479666666667,3.09486333333333,4.08033333333333,4.11433333333333,4.56866666666667,4.13233333333333,3.85433333333333,3.74133333333333,3.43466666666667,4.10133333333333,4.11,4.506,3.49433333333333,4.271,3.71557333333333,4.134,3.30216666666667,3.37911333333333,3.40347333333333,3.01895333333333,4.13777333333333,3.89634,4.17053086419753,3.36566666666667,3.82743209876543,4.12665432098765,3.7826049382716,3.469,3.56892592592593,4.04791358024691,4.8120987654321,3.93417283950617,2.80908641975309,2.48487654320988,2.54133333333333,2.98471604938272,2.70118518518518,2.43332098765432,2.33555555555556,2.6659012345679,2.90812345679012,2.76803703703704,1.89788,2.24362666666667,1.98762666666667,2.15854666666667,1.98088666666667,1.65676666666667,1.75778666666667,2.55081333333333,2.26178,1.39324666666667,2.27193333333333,2.70031,2.04529666666667,2.85042,2.30059,2.70833,2.53938,2.58338333333333,2.87885333333333,2.48526,2.78366666666667,3.15,3.36333333333333,3.29366666666667,3.72466666666667,3.29966666666667,3.03966666666667,3.14,2.828,1.94333333333333],[-0.0843311252204642,-0.34358914991182,0.311158081128763,0.0868009470899455,0.100209615520273,-0.195526089947104,-0.0796720864197511,0.186375726631401,0.0492808853615568,-0.0307068042327998,0.202989541446209,-0.435935149911815,0.0519387477954141,-0.119585052910052,0.0244702821869504,0.101521243386245,0.173148580246914,0.20001639329806,0.0702615520282187,-0.268826137566137,0.0579675414462077,-0.266143816578484,0.0525500811287461,-0.0816403862433868,0.0340616155202826,0.0942992433862442,0.27261324691358,-0.0705989400352743,-0.0142271146384486,-0.0788814708994716,-0.195613470899471,-0.383355693121693,0.314915735449734,-0.125256707231041,-0.0488527301587294,0.217384897707232,-0.0826344320987656,0.276449677248677,0.0620918730158727,-0.035129149911817,0.159193936507938,-0.87594334744268,0.0487725255731907,0.278414897707231,-0.241588532627865,-0.204634855379188,0.142247049382716,0.207541035273368,0.280948663139329,0.205048627865961,-0.178034458553792,0.28029739329806,-0.42525833862434,-0.00338139858906549,0.111726282186949,0.139260206349207,0.157129765432098,0.0877323932980591,-0.119464917107584,-0.0500069276895948,-0.0687034585537921,0.168901850088184,-0.0188109188712538,0.147218613756614,0.0424472821869495,0.0970749100529111,0.251425580246914,-0.633949940035274,-0.0645581146384485,0.078954195767195,0.0865655414462088,0.253020850088183,0.434428081128747,-0.213102386243386,-0.17767371781305,-0.186102756613756,-0.489455419753086,-0.0296676067019403,-0.283729114638448,0.605716529100529,-0.110373791887125,0.798748183421517,-0.02960458553792,0.177624947089947,-0.34077971781305,-0.159262089947089,-0.131588086419753,-0.722986940035274,0.133104885361552,0.385117195767196,0.330596405643739,-0.341812483245149,-0.152973153439154,-0.0649480652557326,-0.0955687795414455,-0.304602756613755,-0.201362827160494,0.0707459735449732,0.572202984126984,0.187722701940035,0.216438380952381,0.0246838130511468,-0.191785499118167,0.0404000828924163,0.0702978871252209,-0.0929953492063478,-0.187446777777778,-0.0639799523809531,-0.0844859047619051,0.268873319223986,-0.0204504585537914,0.457751516754851,-0.0711745855379199,-0.111451719576719,0.0243169488536165,-0.195232089947089,-0.0908980864197529,0.495249726631393,-0.0565117813051149,-0.431599470899471,-0.193876791887125,0.366955183421517,-0.560984252204587,0.0329419470899473,-0.203459384479717,0.308851576719578,0.143215580246913,-0.0196599400352739,0.013081885361552,0.112934195767195,-0.202367791887125,0.296420850088184,0.236828081128747,-0.0440357195767193,0.700392948853616,0.379963910052911,0.123277913580247,0.0167323932980595,-0.557995781305115,-0.949216804232804],[2.45011779188713,2.31766248324515,2.5905885855379,2.80178571957672,2.48835705114639,2.3837860899471,2.38047208641975,2.58735094003527,2.85007911463844,2.35663347089947,2.10464379188712,1.97218848324515,2.24511458553792,2.45631171957672,2.14288305114638,2.03831208994709,2.03499808641975,2.24187694003527,2.50460511463845,2.01115947089947,1.29769912522046,1.16524381657848,1.43816991887125,1.64936705291005,1.33593838447972,1.23136742328042,1.22805341975309,1.43493227336861,1.69766044797178,1.2042148042328,1.5379468042328,1.40549149559083,1.6784175978836,1.8896147319224,1.57618606349206,1.47161510229277,1.46830109876543,1.67517995238095,1.93790812698413,1.44446248324515,2.83906532275132,2.70661001410935,2.97953611640212,3.19073325044092,2.87730458201058,2.77273362081129,2.76941961728395,2.97629847089947,3.23902664550265,2.74558100176367,1.71136779188713,1.57891248324515,1.85183858553792,2.06303571957672,1.74960705114638,1.64503608994709,1.64172208641975,1.84860094003527,2.11132911463845,1.61788347089947,3.10939345855379,2.97693814991182,3.24986425220459,3.46106138624339,3.14763271781305,3.04306175661376,3.03974775308642,3.24662660670194,3.50935478130511,3.01590913756614,3.99376779188712,3.86131248324515,4.13423858553792,4.34543571957672,4.03200705114638,3.92743608994709,3.92412208641975,4.13100094003527,4.39372911463845,3.90028347089947,3.60470712522046,3.47225181657848,3.74517791887125,3.95637505291005,3.64294638447972,3.53837542328042,3.53506141975309,3.74194027336861,4.00466844797178,3.5112228042328,3.83993445855379,3.70747914991182,3.98040525220459,4.19160238624339,3.87817371781305,3.77360275661376,3.77028875308642,3.97716760670194,4.23989578130512,3.74645013756614,2.59264803880071,2.46019273015873,2.7331188324515,2.9443159664903,2.63088729805996,2.52631633686067,2.52300233333333,2.72988118694885,2.99260936155203,2.49916371781305,1.91833045855379,1.78587514991182,2.05880125220459,2.26999838624339,1.95656971781305,1.85199875661376,1.84868475308642,2.05556360670194,2.31829178130511,1.82484613756614,2.46581012522046,2.33335481657848,2.60628091887125,2.81747805291005,2.50404938447972,2.39947842328042,2.39616441975309,2.60304327336861,2.86577144797178,2.3723258042328,2.98603445855379,2.85357914991182,3.12650525220459,3.33770238624339,3.02427371781305,2.91970275661376,2.91638875308642,3.12326760670194,3.38599578130512,2.89255013756614],[[0.071154844897099],[-0.353911412343976],[0.290350157457865],[-0.0451879459439795],[0.0494236998232277],[-0.0709188092133328],[-0.0829301710115345],[0.164334817051698],[-0.00535541552765447],[-0.0169597651894122],[0.0465879058035375],[-0.456178072025748],[0.0320842512006316],[0.00219424990973509],[0.0994656572223068],[0.052925074821661],[0.138819362421862],[0.236638313447506],[0.0698092541581988],[-0.222345996959692],[-0.0016674985168748],[-0.277219107263518],[0.0393624221568539],[0.0613387323802929],[0.0707758418045666],[0.0919990928818543],[0.171556136247467],[-0.0706866181715166],[0.020191462922857],[-0.105650464441983],[0.0579574334844391],[-0.363091553861717],[0.249955562501312],[-0.0477310235650278],[0.0862840474178597],[-0.0352811054087592],[-0.0405157643835825],[0.208590005901732],[-0.0143655519562191],[-0.101802050130036],[0.207592500854316],[-0.878282860500262],[0.0375979826887295],[0.0885454742572666],[-0.172961945712534],[-0.129610801049717],[0.107936348707034],[0.147369637507045],[0.380848211686321],[0.210965451561799],[-0.0863959019839935],[0.323960667490923],[-0.367224023413976],[0.00888045097998974],[0.0351514021791232],[0.12177633505773],[0.13163538235658],[0.0346295527388192],[-0.0130737201272664],[-0.18934014527793],[-0.104221047350945],[0.156860439996357],[-0.0180650919683951],[0.16027210698568],[0.0101647697101268],[0.16701760588694],[0.222450143397566],[-0.61549160327154],[-0.0757030612113581],[0.0967157378255665],[0.0657668644204563],[0.295056947583104],[0.48308728702073],[-0.124148471690955],[-0.152215198681162],[-0.307519123662906],[-0.528278922647271],[-0.0795556513717496],[-0.12895575751793],[0.476762026547686],[-0.077560602188471],[0.737543244939668],[-0.127791443026072],[0.098506145996396],[-0.261254389545326],[-0.065978279409987],[-0.128368262119533],[-0.688053082069778],[-0.0341236301563618],[0.547080297579465],[0.179912955306942],[-0.371856850752513],[-0.136939145370763],[0.0145083621563472],[-0.271171104250551],[-0.218913941199882],[-0.0868801984953847],[0.219015441178044],[0.350062710440394],[0.322261770987366],[0.0334385366192876],[0.0839973694815515],[-0.0407551952833728],[-0.000290487377224162],[-0.118515275111863],[-0.0894545286053315],[-0.0919073012118317],[-0.0319039303083512],[0.0673303555622305],[0.188060456234906],[-0.045004845000711],[0.393514298759282],[-0.15491544307312],[-0.183028182967271],[0.106059861285696],[-0.0236815617128658],[-0.179841018627004],[0.511744595826777],[-0.125022310313236],[-0.299825394177546],[-0.0714040734179211],[0.412248700655668],[-0.554286774668042],[0.0664907394326949],[-0.104618210365228],[0.0920795307974317],[0.161282568165382],[-0.10122610368197],[0.106156258425192],[-0.00672263534320739],[-0.276157072927162],[0.29735818784118],[0.267539453777619],[-0.100350150553946],[0.623410844223758],[0.415560510817165],[0.205041697200251],[0.0645946252232835],[-0.597798806385168],[-0.899199289216982]],[[2.52127263678423],[1.96375107090118],[2.88093874299577],[2.75659777363274],[2.53778075096962],[2.31286728073377],[2.29754191540822],[2.75168575708696],[2.84472369911079],[2.33967370571005],[2.15123169769066],[1.5160104112194],[2.27719883673855],[2.45850596948645],[2.24234870836869],[2.09123716476875],[2.17381744884162],[2.47851525348278],[2.57441436879665],[1.78881347393978],[1.29603162670358],[0.888024709314965],[1.47753234102811],[1.71070578529035],[1.40671422628428],[1.32336651616228],[1.39960955600055],[1.36424565519709],[1.71785191089464],[1.09856433979082],[1.59590423771724],[1.04239994172911],[1.92837316038491],[1.84188370835737],[1.66247011090992],[1.43633399688401],[1.42778533438185],[1.88376995828268],[1.92354257502791],[1.34266043311511],[3.04665782360564],[1.82832715360909],[3.01713409909085],[3.27927872469818],[2.70434263629805],[2.64312281976157],[2.87735596599099],[3.12366810840652],[3.61987485718897],[2.95654645332547],[1.62497188990313],[1.90287315073607],[1.48461456212394],[2.07191617055671],[1.78475845332551],[1.76681242500482],[1.77335746877633],[1.88323049277409],[2.09825539451118],[1.42854332562154],[3.00517241120285],[3.13379858990817],[3.23179916023619],[3.62133349322907],[3.15779748752318],[3.2100793625007],[3.26219789648399],[2.6311350034304],[3.43365172009376],[3.1126248753917],[4.05953465630758],[4.15636943082825],[4.61732587255865],[4.22128724788576],[3.87979185246522],[3.61991696628418],[3.39584316377248],[4.05144528866352],[4.26477335712052],[4.37704549744716],[3.52714652303199],[4.20979506151815],[3.61738647584518],[4.05488119890645],[3.38169199493439],[3.47239714387044],[3.40669315763355],[3.05388719129883],[3.97054481781542],[4.05830310181227],[4.01984741386073],[3.3356222991593],[3.84346610683382],[4.20611074839973],[3.6070026135625],[3.55468881541387],[3.68340855459103],[4.19618304787998],[4.58995849174551],[4.0687119085535],[2.62608657541999],[2.54419009964028],[2.69236363716813],[2.94402547911308],[2.5123720229481],[2.43686180825534],[2.4310950321215],[2.6979772566405],[3.05993971711426],[2.68722417404796],[1.87332561355308],[2.1793894486711],[1.90388580913147],[2.08697020327612],[2.06262957909875],[1.82831719490089],[1.66884373445942],[2.56730820252872],[2.19326947099188],[1.52502074338859],[2.39440605180254],[2.74560351723415],[2.05199414420321],[2.88396879234275],[2.39943117411449],[2.49155795407785],[2.55744698791847],[2.50181716968664],[2.97192770639697],[2.3656031688896],[2.70987738562663],[3.150937337753],[3.39404470598221],[3.23735223568944],[3.64768456203681],[3.33526326743092],[3.12143045028667],[3.18786223192522],[2.78819697491995],[1.99335084834916]],[2.45011779188713,2.31766248324515,2.5905885855379,2.80178571957672,2.48835705114639,2.3837860899471,2.38047208641975,2.58735094003527,2.85007911463844,2.35663347089947,2.10464379188712,1.97218848324515,2.24511458553792,2.45631171957672,2.14288305114638,2.03831208994709,2.03499808641975,2.24187694003527,2.50460511463845,2.01115947089947,1.29769912522046,1.16524381657848,1.43816991887125,1.64936705291005,1.33593838447972,1.23136742328042,1.22805341975309,1.43493227336861,1.69766044797178,1.2042148042328,1.5379468042328,1.40549149559083,1.6784175978836,1.8896147319224,1.57618606349206,1.47161510229277,1.46830109876543,1.67517995238095,1.93790812698413,1.44446248324515,2.83906532275132,2.70661001410935,2.97953611640212,3.19073325044092,2.87730458201058,2.77273362081129,2.76941961728395,2.97629847089947,3.23902664550265,2.74558100176367,1.71136779188713,1.57891248324515,1.85183858553792,2.06303571957672,1.74960705114638,1.64503608994709,1.64172208641975,1.84860094003527,2.11132911463845,1.61788347089947,3.10939345855379,2.97693814991182,3.24986425220459,3.46106138624339,3.14763271781305,3.04306175661376,3.03974775308642,3.24662660670194,3.50935478130511,3.01590913756614,3.99376779188712,3.86131248324515,4.13423858553792,4.34543571957672,4.03200705114638,3.92743608994709,3.92412208641975,4.13100094003527,4.39372911463845,3.90028347089947,3.60470712522046,3.47225181657848,3.74517791887125,3.95637505291005,3.64294638447972,3.53837542328042,3.53506141975309,3.74194027336861,4.00466844797178,3.5112228042328,3.83993445855379,3.70747914991182,3.98040525220459,4.19160238624339,3.87817371781305,3.77360275661376,3.77028875308642,3.97716760670194,4.23989578130512,3.74645013756614,2.59264803880071,2.46019273015873,2.7331188324515,2.9443159664903,2.63088729805996,2.52631633686067,2.52300233333333,2.72988118694885,2.99260936155203,2.49916371781305,1.91833045855379,1.78587514991182,2.05880125220459,2.26999838624339,1.95656971781305,1.85199875661376,1.84868475308642,2.05556360670194,2.31829178130511,1.82484613756614,2.46581012522046,2.33335481657848,2.60628091887125,2.81747805291005,2.50404938447972,2.39947842328042,2.39616441975309,2.60304327336861,2.86577144797178,2.3723258042328,2.98603445855379,2.85357914991182,3.12650525220459,3.33770238624339,3.02427371781305,2.91970275661376,2.91638875308642,3.12326760670194,3.38599578130512,2.89255013756614]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>ENV<\/th>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>RESIDUAL<\/th>\n      <th>Ypred<\/th>\n      <th>ResAMMI<\/th>\n      <th>YpredAMMI<\/th>\n      <th>AMMI0<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script><p>The following values are presented: <strong>ENV</strong> is the environment; <strong>GEN</strong> is the genotype; <strong>Y</strong> is the response variable; <strong>resOLS</strong> is the residual (<span class="math inline">\(\hat{z}_{ij}\)</span>) estimated by the Ordinary Least Square (OLS), where <span class="math inline">\(\hat{z}_{ij} = y_{ij} - \bar{y}_{i.} - \bar{y}_{.j} + \bar{y}_{ij}\)</span>; <strong>Ypred</strong> is the predicted value by OLS (<span class="math inline">\(\hat{y}_{ij} = y_{ij} -\hat{z}_{ij}\)</span>); <strong>ResAMMI</strong> is the residual estimated by the AMMI model (<span class="math inline">\(\hat{a}_{ij}\)</span>) considering the number of multiplicative terms informed in the function (in this case 5), where <span class="math inline">\(\hat{a}_{ij} = \lambda_1\alpha_{i1}\tau_{j1}+...+\lambda_5\alpha_{i5}\tau_{j5}\)</span>; <strong>YpredAMMI</strong> is the predicted value by AMMI model <span class="math inline">\(\hat{ya}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{ij}+\hat{a}_{ij}\)</span>; and <strong>AMMI0</strong> is the predicted value when no multiplicative terms are used, i.e., <span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{ij}\)</span>.</p>
</div>
<div id="estimating-the-waas-index" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-the-waas-index" class="anchor"></a>Estimating the WAAS index</h1>
<p>The <code><a href="../reference/waas.html">waas()</a></code> function computes the Weighted Average of Absolute Scores <span class="citation">(Olivoto, Lúcio, Da silva, Marchioro, et al. <a href="#ref-Olivoto2019" role="doc-biblioref">2019</a>)</span> considering (i) all principal component axes that were significant (<span class="math inline">\(p &lt; 0.05\)</span> by default); or (ii) declaring a specific number of axes to be used, according to the following equation:</p>
<p><span class="math display">\[
        WAAS_i  =
        \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k = 1}^{p}EP_k
\]</span></p>
<p>where <span class="math inline">\(WAAS_i\)</span> is the weighted average of absolute scores of the <em>i</em>th genotype; <span class="math inline">\(PCA_{ik}\)</span> is the score of the <em>i</em>th genotype in the <em>k</em>th IPCA; and <span class="math inline">\(EP_k\)</span> is the explained variance of the <em>k</em>th IPCA for <span class="math inline">\(k = 1,2,..,p\)</span>, considering <em>p</em> the number of significant PCAs, or a declared number of PCAs. The following functions may be used to do that.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">waas_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/waas.html">waas</a></span><span class="op">(</span><span class="va">data_ge</span>,  <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<div id="number-of-axes-based-on-f-test" class="section level2">
<h2 class="hasAnchor">
<a href="#number-of-axes-based-on-f-test" class="anchor"></a>Number of axes based on F-test</h2>
<p>In this example only IPCAs with <em>P</em>-value &lt; 0.05 will be considered in the WAAS estimation. This is the default setting and the model was already fitted and stored into <code>AMMI_model&gt;GY&gt;model</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu">print_table</span><span class="op">(</span><span class="va">waas_index</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></pre></div>
<div id="htmlwidget-e6a908503e512f03159c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e6a908503e512f03159c">{"x":{"filter":"none","extensions":["Buttons"],"data":[["GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","GEN","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV","ENV"],["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9","E1","E10","E11","E12","E13","E14","E2","E3","E4","E5","E6","E7","E8","E9"],[2.60367618165785,2.47122087301587,2.74414697530864,2.95534410934744,2.64191544091711,2.53734447971781,2.53403047619048,2.740909329806,3.00363750440917,2.51019186067019,2.52068333333333,2.17520933333333,1.36826466666667,1.60851234567901,2.90963086419753,1.78193333333333,3.179959,4.06433333333333,3.67527266666667,3.9105,2.66321358024691,1.988896,2.53637566666667,3.0566],[0.31663416651295,-1.00066869817982,0.138967001253749,0.0434046795911251,-0.3250865575302,-0.325979467755784,-0.0983619637395438,0.284854645584283,0.499479718047043,0.466756476216199,0.246445264638745,0.217149424991087,0.0822936128277283,0.214756707282231,0.724924448425234,-0.291243485810665,-0.228826195532199,0.0657533646353086,-0.324740625812355,0.510534572888796,0.0580628814239221,-0.265830093118988,-0.264195888702705,-0.745083988136141],[-0.0441673453301012,-0.571801413711262,0.19876109229478,-0.102838186267119,0.478227570545301,0.246083819159044,0.242894978794873,0.587113434560557,-0.191580376104121,-0.842693573941951,0.19761734608415,0.369574326706147,0.166002066882885,0.271276204211826,0.131290513275142,0.00319697635617264,-0.238363163565262,-0.419722756903569,-0.816280023016513,-0.131257929962784,-0.191721263158744,0.188742796218896,-0.226458988712965,0.696103895584618],[-0.0360011283719757,-0.165169281705474,-0.733073122291199,0.228415474583492,-0.0907316099753356,0.245219282637073,0.560735730739729,-0.206799390799114,0.319105698675295,-0.121701653492493,-0.232071269068161,0.114487625757006,0.152763858162195,-0.181655992170214,0.206894832874124,0.287008063932295,0.244600486722036,-0.753349309423518,-0.00213977313876906,0.0931127318181978,-0.0368771336112897,-0.187122765688654,0.460326020283376,-0.165977376448625],[-0.0659500295579217,-0.330873694637186,0.473465602781329,0.176885502404203,0.141714375848688,0.179407530642072,0.237663402000148,-0.708519772380938,-0.16764403917473,0.0638511220743331,0.09863134388126,0.0261443516278711,0.22582137175571,0.0697520298651451,0.131859634328751,-0.247089389032564,0.507790982257266,0.0108015498340058,0.164769914197348,-0.23980452384233,-0.079733199990145,-0.618129859707931,-0.285360530015698,0.234546324841311],[-0.312541945382165,-0.12425036668065,-0.0481578947499575,-0.127016795541153,-0.192422705973652,0.466246554870079,0.0509393745632916,0.231469910487517,-0.326149545981382,0.381883414388071,-0.080829308859455,-0.03517226633382,0.0464660691303896,0.354830819587445,0.0207455759126133,0.192022733136411,-0.0906432752749837,0.26948765235155,-0.237569724137168,-0.399912753575907,-0.0253738637516044,-0.237612091368976,0.378170053524019,-0.154609620340514],[0.427168761338079,-0.106394079035555,-0.28406473655255,-0.140017023855714,0.354956296574217,0.0331480261666723,-0.101065097395289,-0.0840556719052832,-0.288602413912729,0.188925938578151,-0.17680505672964,0.0749041958825443,0.0580924567466812,-0.294680293943231,-0.104657120425361,0.110236976010536,0.0307148661299223,0.171381585477471,-0.298535969048396,0.127090735779701,0.466456071926345,-0.210114040237356,-0.0436969926017352,0.0896125850325159],[-0.147940066027328,-0.0345086688485296,-0.0771862085519693,0.456806697278334,0.0892647560140871,-0.292243938082559,0.0589470961548426,0.129043385707333,-0.273877644481616,0.0916945908374023,0.251008929277267,-0.250751751534422,-0.141814970247758,-0.222423843640787,0.33443671425162,0.151710938165132,0.0147063525174921,-0.0306502117140848,-0.0319370065430355,-0.268570789964929,0.143402370084789,0.0816550682588931,-0.0491839676340883,0.0184121687239114],[0.254320406773723,0.0687603920296397,0.0865630902827023,-0.0965877490541115,-0.291982968608698,-0.121198409578467,0.327315861645917,0.0465900240928677,-0.22223365259,-0.0515469949935721,-0.16933334090263,0.237343257545292,0.232132441639392,-0.215778907015784,0.104024083665988,-0.0786837325701777,0.0494095573654789,0.121653131374781,-0.000718822856106079,-0.233149842583305,-0.0933340031957222,0.217445579148032,-0.0477972988970011,-0.123212102718237],[0.166939383872594,-0.0118320603367635,-0.00482809576940151,0.227166521122301,-0.174398946172678,0.188310906593054,-0.20104398411983,-0.00925433158888847,-0.0557826849545722,-0.125276708645805,-0.149897047544776,0.0955713964705568,-0.183742023732658,0.0310196885660937,0.154623148367341,-0.217193717682293,-0.0977772152926014,-0.0219076862080975,0.0953615304193194,-0.0541086783440931,0.124390556659328,-0.0190248484488648,0.115412100969267,0.127272795801475],[0.150815092859492,0.652188235262644,0.283438400032806,0.106225116388271,0.325645140319217,0.269523978474321,0.232511857642983,0.428351101662169,0.326588676690135,0.50674657772298,0.210599046682389,0.23572000930447,0.138284243213137,0.214186121666131,0.372031576023347,0.182725756999538,0.265278601040702,0.286087296883293,0.436120702952691,0.284450281825655,0.10518784783937,0.265670780940106,0.281490138000616,0.587251464691858],[24.8781313039281,0,51.2617537094098,90.929397728364,32.0603373066199,12.4195231333963,11.7970776025975,50.6536499591245,100,7.3196413027776,42.7444108124842,29.9304196752654,0,8.91103709570498,57.1708805709522,15.343402480105,67.1976331957915,100,85.5693339165694,94.2941611526709,48.0310063905487,23.0198637373974,43.3264558296364,62.6221191695661],[91.8327859648922,0,67.5411621191739,100,59.810467713766,70.0897631285558,76.8689977603101,40.9985813807289,59.6376471809683,26.6394656546627,78.1333427460727,72.9222125665952,93.1344340836462,77.3892345291609,44.6455366355452,83.91541978081,66.790533945166,62.4739468568361,31.3507919817589,62.8135317166782,100,66.7091795583811,63.4275883933397,0],[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],[6,10,3,2,5,7,8,4,1,9,9,10,14,13,6,12,4,1,3,2,7,11,8,5],[2,10,5,1,6,4,3,8,7,9,4,6,2,5,12,3,7,11,13,10,1,8,9,14],[5,10,3,1,6,7,2,4,9,8,7,5,3,4,13,10,6,2,11,12,1,9,8,14],[58.3554586344101,0,59.4014579142919,95.464698864182,45.935402510193,41.254643130976,44.3330376814538,45.8261156699267,79.8188235904841,16.9795534787201,60.4388767792785,51.4263161209303,46.5672170418231,43.1501358124329,50.9082086032487,49.6294111304575,66.9940835704787,81.2369734284181,58.4600629491642,78.5538464346746,74.0155031952743,44.8645216478892,53.3770221114881,31.3110595847831],[4,10,3,1,5,8,7,6,2,9,5,8,11,13,9,10,4,1,6,2,3,12,7,14]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>type<\/th>\n      <th>Code<\/th>\n      <th>Y<\/th>\n      <th>PC1<\/th>\n      <th>PC2<\/th>\n      <th>PC3<\/th>\n      <th>PC4<\/th>\n      <th>PC5<\/th>\n      <th>PC6<\/th>\n      <th>PC7<\/th>\n      <th>PC8<\/th>\n      <th>PC9<\/th>\n      <th>WAAS<\/th>\n      <th>PctResp<\/th>\n      <th>PctWAAS<\/th>\n      <th>wRes<\/th>\n      <th>wWAAS<\/th>\n      <th>OrResp<\/th>\n      <th>OrWAAS<\/th>\n      <th>OrPC1<\/th>\n      <th>WAASY<\/th>\n      <th>OrWAASY<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":21,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render"],"jsHooks":[]}</script><p>The output generated by the <code><a href="../reference/waas.html">waas()</a></code> function shows the following results: <strong>type</strong>, genotype (GEN) or environment (ENV); <strong>Code</strong>, the code attributed to each level of the factors; <strong>Y</strong>, the response variable (in this case the grain yield); <strong>WAAS</strong> the weighted average of the absolute scores, estimated with all PCA axes with <em>P</em>-value <span class="math inline">\(\le\)</span> 0.05; <strong>PctWAAS</strong> and <strong>PctResp</strong> that are the percentage values for the WAAS and Y, respectively; <strong>OrResp</strong> and <strong>OrWAAS</strong> that are the ranks attributed to the genotype and environment regarding the Y or WAAS, respectively; <strong>WAASY</strong> is the weighted average of absolute scores and response variable. In this case, considering equal weights for PctResp and PctWAAS, the WAASY for G1 is estimated by: <span class="math inline">\(WAAS_{G1} = [(24.87\times50)+(91.83\times50)]/50+50 = 58.35\)</span>. Then the <strong>OrWAASY</strong> is the rank for the WAASY value. The genotype (or environment) with the largest WAASY value has the first ranked.</p>
</div>
<div id="number-of-axes-declared-manually" class="section level2">
<h2 class="hasAnchor">
<a href="#number-of-axes-declared-manually" class="anchor"></a>Number of axes declared manually</h2>
<p>The second option to compute the WAAS is by manually declaring a specific number of multiplicative terms. In this case, the number of terms declared is used independently of its significance. Let us, for the moment, assume that after a cross-validation procedure the AMMI7 was the most predictively accurate AMMI model and the researcher will use this model. The additional argument <code>naxis</code> in the function <code>waas</code> is then used to overwrite the default chose of significant terms.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">waas_index2</span> <span class="op">&lt;-</span> <span class="va">data_ge</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/waas.html">waas</a></span><span class="op">(</span><span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>,
       naxis <span class="op">=</span> <span class="fl">7</span>, <span class="co"># Use 7 IPCA for computing WAAS</span>
       verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<p>The only difference in this output is that here we declared that seven IPCA axes should be used for computing the WAAS value. Thus, only the values of WAAS, OrWAAS, WAASY and OrWAASY may have significant changes.</p>
</div>
<div id="biplots" class="section level2">
<h2 class="hasAnchor">
<a href="#biplots" class="anchor"></a>Biplots</h2>
<p>Provided that an object of class <code>waas</code> or <code>performs_ammi</code> is available in the global environment, the graphics may be obtained using the function <code><a href="../reference/plot_scores.html">plot_scores()</a></code>. To do that, we will revisit the previusly fitted model <code>AMMI_model</code> . Please, refer to <code><a href="../reference/plot_scores.html">plot_scores()</a></code> for more details.</p>
<div id="biplot-type-1-gy-x-pc1" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-1-gy-x-pc1" class="anchor"></a>biplot type 1: GY x PC1</h3>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>,
                 col.gen <span class="op">=</span> <span class="st">"black"</span>,
                 col.env <span class="op">=</span> <span class="st">"gray70"</span>,
                 col.segm.env <span class="op">=</span> <span class="st">"gray70"</span>,
                 axis.expand <span class="op">=</span> <span class="fl">1.5</span>,
                 plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-2" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-2" class="anchor"></a>biplot type 2:</h3>
<ul>
<li>PC1 x PC2 By default, IPCA1 is shown in the x axis and IPCA2 in the y axis.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>,
                 type <span class="op">=</span> <span class="fl">2</span>,
                 polygon <span class="op">=</span> <span class="cn">T</span>,
                 col.segm.env <span class="op">=</span> <span class="st">"transparent"</span>,
                 plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">d</span>, labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;"></p>
<ul>
<li>Change the default option To create a biplot showin other IPCAs use the arguments <code>first</code> and <code>second</code>. For example to produce a PC1 x PC3 biplot, use <code>second = "PC3</code>. A PC3 x PC4 biplot can be produced (provided that the model has at least four IPCAs) with <code>first = "PC3"</code> and <code>second = "PC4"</code>..</li>
</ul>
</div>
<div id="biplot-type-3-gy-x-waas" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-3-gy-x-waas" class="anchor"></a>biplot type 3: GY x WAAS</h3>
<p>The quadrants proposed by <span class="citation">Olivoto, Lúcio, Da silva, Marchioro, et al. (<a href="#ref-Olivoto2019" role="doc-biblioref">2019</a>)</span> in the following biplot represent four classifications regarding the joint interpretation of mean performance and stability. The genotypes or environments included in quadrant I can be considered unstable genotypes or environments with high discrimination ability, and with productivity below the grand mean. In quadrant II are included unstable genotypes, although with productivity above the grand mean. The environments included in this quadrant deserve special attention since, in addition to providing high magnitudes of the response variable, they present a good discrimination ability. Genotypes within quadrant III have low productivity, but can be considered stable due to the lower values of WAASB. The lower this value, the more stable the genotype can be considered. The environments included in this quadrant can be considered as poorly productive and with low discrimination ability. The genotypes within the quadrant IV are highly productive and broadly adapted due to the high magnitude of the response variable and high stability performance (lower values of WAASB). . To obtain this biplot must use an object of class <code>waas</code> (in our example, <code>waas_index</code>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit">

<span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waas_index</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">waas_index</span>,
                 type <span class="op">=</span> <span class="fl">3</span>,
                 x.lab <span class="op">=</span> <span class="st">"My custom x label"</span>,
                 size.shape <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Size of the shape point</span>
                 col.gen <span class="op">=</span> <span class="st">"gray50"</span>, <span class="co"># Color for genotypes</span>
                 size.tex.pa <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Size of the text</span>
                 col.alpha.env <span class="op">=</span> <span class="fl">0</span>, <span class="co"># Transparency of environment's point</span>
                 x.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.4</span>, <span class="fl">3.1</span><span class="op">)</span>, <span class="co"># Limits of x axis</span>
                 x.breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2.4</span>, <span class="fl">3.1</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="co"># Markers of x axis</span>
                 y.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"WAASB vs GY plot"</span>, subtitle <span class="op">=</span> <span class="st">"Zoom in genotypes' scores"</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">e</span>, <span class="va">f</span>, labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-4-nominal-yield-and-environment-ipca1" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-4-nominal-yield-and-environment-ipca1" class="anchor"></a>biplot type 4: nominal yield and environment IPCA1</h3>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>, type <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">AMMI_model</span>,
                 type <span class="op">=</span> <span class="fl">4</span>,
                 color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">h</span>, labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="simultaneous-selection-for-mean-performance-and-stability" class="section level1">
<h1 class="hasAnchor">
<a href="#simultaneous-selection-for-mean-performance-and-stability" class="anchor"></a>Simultaneous selection for mean performance and stability</h1>
<p>The WAASY index <span class="citation">(Olivoto, Lúcio, Da silva, Sari, et al. <a href="#ref-Olivoto2019a" role="doc-biblioref">2019</a>)</span> is used for genotype ranking considering both the stability (WAAS) and mean performance based on the following model:</p>
<p><span class="math display">\[
WAASY{_i} = \frac{{\left( {r{G_i} \times {\theta _Y}} \right) + \left( {r{W_i} \times {\theta _S}} \right)}}{{{\theta _Y} + {\theta _S}}}
\]</span></p>
<p>where <span class="math inline">\(WAASY_i\)</span> is the superiority index for the <em>i</em>-th genotype that weights between performance and stability; <span class="math inline">\(rG_i\)</span> and <span class="math inline">\(rW_i\)</span> are the rescaled values (0-100) for GY and WAASB, respectively; <span class="math inline">\(\theta _Y\)</span> and <span class="math inline">\(\theta_S\)</span> are the weights for GY and WAASB, respectively.</p>
<p>This index was also already computed and stored into AMMI_model&gt;GY&gt;model. An intuitively plot may be obtained by running</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_waasby.html">plot_waasby</a></span><span class="op">(</span><span class="va">waas_index</span><span class="op">)</span>
<span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_waasby.html">plot_waasby</a></span><span class="op">(</span><span class="va">waas_index</span>,
                 col.shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray20"</span>, <span class="st">"gray80"</span><span class="op">)</span>,
                 plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span>, labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The values of WAASY in the plot above were computed considering equal weights for mean performance and stability. Different weights may be assigned using the <code>wresp</code> argument of the <code><a href="../reference/waas.html">waas()</a></code> function.</p>
</div>
<div id="weighting-the-stability-and-mean-performance" class="section level1">
<h1 class="hasAnchor">
<a href="#weighting-the-stability-and-mean-performance" class="anchor"></a>Weighting the stability and mean performance</h1>
<p>After fitting a model with the functions <code><a href="../reference/waas.html">waas()</a></code> or <code><a href="../reference/waasb.html">waasb()</a></code> it is possible to compute the superiority indexes WAASY or WAASBY in different scenarios of weights for stability and mean performance. The number of scenarios is defined by the arguments <code>increment</code>. By default, twenty-one different scenarios are computed. In this case, the the superiority index is computed considering the following weights: stability (waasb or waas) = 100; mean performance = 0. In other words, only stability is considered for genotype ranking. In the next iteration, the weights becomes 95/5 (since increment = 5). In the third scenario, the weights become 90/10, and so on up to these weights become 0/100. In the last iteration, the genotype ranking for WAASY or WAASBY matches perfectly with the ranks of the response variable.</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="va">WAASratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wsmp.html">wsmp</a></span><span class="op">(</span><span class="va">waas_index</span><span class="op">)</span></pre></div>
<div id="printing-the-model-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#printing-the-model-outputs" class="anchor"></a>Printing the model outputs</h2>
<p>The genotype ranking for each scenario of WAASY/GY weight ratio is shown bellow</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu">print_table</span><span class="op">(</span><span class="va">WAASratio</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">hetcomb</span><span class="op">)</span></pre></div>
<div id="htmlwidget-20477e2fb5cd10d6b3fb" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-20477e2fb5cd10d6b3fb">{"x":{"filter":"none","extensions":["Buttons"],"data":[[2,10,5,1,6,4,3,8,7,9],[2,10,5,1,7,4,3,8,6,9],[2,10,4,1,7,5,3,8,6,9],[2,10,5,1,7,6,3,8,4,9],[2,10,4,1,7,6,5,8,3,9],[2,10,4,1,7,6,5,8,3,9],[2,10,4,1,7,6,5,8,3,9],[3,10,4,1,6,7,5,8,2,9],[3,10,4,1,6,7,5,8,2,9],[3,10,4,1,6,8,5,7,2,9],[4,10,3,1,5,8,7,6,2,9],[4,10,3,1,6,8,7,5,2,9],[4,10,3,1,6,8,7,5,2,9],[4,10,3,1,6,8,7,5,2,9],[5,10,3,1,6,8,7,4,2,9],[5,10,3,1,6,8,7,4,2,9],[5,10,3,1,6,8,7,4,2,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,8,7,4,1,9],[6,10,3,2,5,7,8,4,1,9],[6,10,3,2,5,7,8,4,1,9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>100/0<\/th>\n      <th>95/5<\/th>\n      <th>90/10<\/th>\n      <th>85/15<\/th>\n      <th>80/20<\/th>\n      <th>75/25<\/th>\n      <th>70/30<\/th>\n      <th>65/35<\/th>\n      <th>60/40<\/th>\n      <th>55/45<\/th>\n      <th>50/50<\/th>\n      <th>45/55<\/th>\n      <th>40/60<\/th>\n      <th>35/65<\/th>\n      <th>30/70<\/th>\n      <th>25/75<\/th>\n      <th>20/80<\/th>\n      <th>15/85<\/th>\n      <th>10/90<\/th>\n      <th>5/95<\/th>\n      <th>0/100<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":0,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render","options.columnDefs.17.render","options.columnDefs.18.render","options.columnDefs.19.render","options.columnDefs.20.render"],"jsHooks":[]}</script><p>In addition, the genotype ranking depending on the number of multiplicative terms used to estimate the WAAS index is also computed.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu">print_table</span><span class="op">(</span><span class="va">WAASratio</span><span class="op">$</span><span class="va">GY</span><span class="op">$</span><span class="va">hetdata</span><span class="op">)</span></pre></div>
<div id="htmlwidget-71085a67dfa1f12bdd8e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-71085a67dfa1f12bdd8e">{"x":{"filter":"none","extensions":["Buttons"],"data":[[1,2,3,4,5,6,7,8,9,10],[1,2,3,4,5,6,7,8,9,10],[1,2,3,4,5,6,7,8,9,10],[1,2,3,4,5,6,7,8,9,10],[1,2,3,4,5,6,7,8,9,10],[2,10,5,1,6,4,3,8,7,9],[2,10,4,1,7,5,3,8,6,9],[4,10,2,1,7,5,3,8,6,9],[5,10,3,1,6,7,2,4,9,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>9PCA<\/th>\n      <th>8PCA<\/th>\n      <th>7PCA<\/th>\n      <th>6PCA<\/th>\n      <th>5PCA<\/th>\n      <th>4PCA<\/th>\n      <th>3PCA<\/th>\n      <th>2PCA<\/th>\n      <th>1PCA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":0,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render"],"jsHooks":[]}</script>
</div>
<div id="plotting-the-heat-map-graphics" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-heat-map-graphics" class="anchor"></a>Plotting the heat map graphics</h2>
<p>The first type of heatmap shows the genotype ranking depending on the number of principal component axes used for estimating the WAASB index. An euclidean distance-based dendrogram is used for grouping the genotype ranking for both genotypes and principal component axes. The second type of heatmap shows the genotype ranking depending on the WAASB/GY ratio. The ranks obtained with a ratio of 100/0 considers exclusively the stability for genotype ranking. On the other hand, a ratio of 0/100 considers exclusively the productivity for genotype ranking.</p>
<div id="ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waas" class="section level3">
<h3 class="hasAnchor">
<a href="#ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waas" class="anchor"></a>Ranks of genotypes depending on the number of PCA used to estimate the WAAS</h3>
<div class="sourceCode" id="cb20"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">WAASratio</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-20-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div id="ranks-of-genotypes-depending-on-the-waasgy-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#ranks-of-genotypes-depending-on-the-waasgy-ratio" class="anchor"></a>Ranks of genotypes depending on the WAAS/GY ratio</h3>
<div class="sourceCode" id="cb21"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">WAASratio</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-21-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="getting-model-data" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-model-data" class="anchor"></a>Getting model data</h2>
<p>The function <code><a href="../reference/get_model_data.html">get_model_data()</a></code> may be used to easily get the data from a model fitted with the function <code><a href="../reference/waas.html">waas()</a></code>, especially when more than one variables are used. Select helpers can be used in the argument <code>resp</code>. See the example below.</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">waas_index_all</span> <span class="op">&lt;-</span>
<span class="fu"><a href="../reference/waas.html">waas</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>,
     resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
 <span class="fu"><a href="../reference/get_model_data.html">get_model_data</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"WAASB"</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="fu">print_table</span><span class="op">(</span><span class="va">waas_index_all</span><span class="op">)</span></pre></div>
<div id="htmlwidget-dc689da1b362cc9ccd3c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-dc689da1b362cc9ccd3c">{"x":{"filter":"none","extensions":["Buttons"],"data":[["H1","H10","H11","H12","H13","H2","H3","H4","H5","H6","H7","H8","H9"],[0.317737230559106,0.230492554503841,0.200506265076556,0.364117225651248,0.36297872975851,0.341932055299512,0.374070161371334,0.293656857940488,0.167984899792883,0.269780666044145,0.22752674226794,0.314792033971882,0.145652139559086],[0.314778553342192,0.242941194461926,0.216902218881249,0.391076907608588,0.256876790061602,0.403425082451245,0.370031394267584,0.269653557722333,0.113228929744562,0.162703846350998,0.179216307064952,0.326297008830512,0.034136587597016],[0.131109782537748,0.091519698499979,0.120900167331256,0.207646525814646,0.0662706399239515,0.17962270432795,0.172426964050127,0.108324974621995,0.0287808576008669,0.00141438815510092,0.0545433909785407,0.178100318795265,0.100129846360051],[0.107084303634505,0.218516963857621,0.0943248417673776,0.453130224430492,0.403498900529265,0.264406337438378,0.855956095067708,0.491324400371989,0.339859685717258,0.585228673643224,0.816584471087131,0.998549335201708,0.877767564038983],[0.667353963321345,0.973406930062456,0.649373434296609,0.314998465463175,0.837782308159367,1.07984834261264,0.485598584534546,0.378389684116363,0.566872131697955,0.409015763109617,0.3844045832104,0.653170473642632,0.906600947762697],[0.799445936514553,0.948271166431994,0.407387067056814,0.530154070168829,0.865892375197347,1.16408882478996,0.602930422413506,0.510781855280157,0.410591353348573,0.732748712689898,0.452669830924239,1.03330421140934,0.698687821995521],[0.130390855379887,0.306311139368976,0.213683490297622,0.350589426533834,0.519722185970231,0.549688312053344,0.552157050780789,0.415017369977002,0.237202612310403,0.569322265284265,0.595253916787206,0.769588048515119,0.608040099533554],[1.34004544878696,1.04062775956306,0.691749343598858,0.256644112083248,1.39012569766889,2.10614360071893,0.506842441809694,0.537200934446478,0.766210634093814,0.935112857298192,1.57247915658996,1.80941550532473,1.61040413052672],[0.782288080388726,0.894718517940244,0.320828373769115,2.15031946770904,1.95180808766426,3.36582802620637,2.81276709082845,1.69448975293518,0.519346215370089,3.21753463536213,3.02728780221931,3.88675954973132,3.10582676848096],[0.427188285303027,0.371747434293272,0.793927076402899,0.309301289064363,0.498152590809995,0.795956025935034,0.610881593568255,0.435684736068276,0.836640525534316,0.368742951523696,0.283621360893067,0.351923970749855,0.502442714588426],[0.928744447585516,0.505884543903929,0.836418713710096,0.227863384096598,0.945543857481176,0.403560036905226,0.251797096748708,0.280693031059661,0.610543475160522,1.59773582214997,0.518268339779223,0.941253067983955,0.887999824675511],[0.0684371406266146,0.0535170366329289,0.0419506925427273,0.0840189561690569,0.149506349137402,0.126183785062418,0.0741905572905791,0.0707098752876759,0.0391256775397528,0.134521645141759,0.0453578238675085,0.104729388898566,0.0330325678437537],[0.570353555162827,0.907424521043876,0.515275372907341,0.528723681526811,1.09543177150092,0.865064586754021,0.153079907115311,0.0334244270376786,0.720209639990038,0.943215924353419,1.01663790409169,0.85348181468753,0.420042706174723],[2.72318841155029,2.15423013701007,1.26045222601755,0.558102654027818,0.513862636634552,4.4072444370943,4.09701791059782,3.06984323656226,0.737865093433491,1.63643608213789,3.44196589230443,4.90895795089343,5.49944844859638],[4.12838165979851,0.755774171626535,1.00245614047724,2.53215003162141,6.8628268017254,2.95213467334163,2.49274233906179,0.664491211230655,1.03480531519994,6.08388960985312,1.05395774516601,3.41607719463661,4.9154500226271]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>gen<\/th>\n      <th>PH<\/th>\n      <th>EH<\/th>\n      <th>EP<\/th>\n      <th>EL<\/th>\n      <th>ED<\/th>\n      <th>CL<\/th>\n      <th>CD<\/th>\n      <th>CW<\/th>\n      <th>KW<\/th>\n      <th>NR<\/th>\n      <th>NKR<\/th>\n      <th>CDED<\/th>\n      <th>PERK<\/th>\n      <th>TKW<\/th>\n      <th>NKE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render"],"jsHooks":[]}</script>
</div>
</div>
<div id="other-ammi-based-stability-indexes" class="section level1">
<h1 class="hasAnchor">
<a href="#other-ammi-based-stability-indexes" class="anchor"></a>Other AMMI-based stability indexes</h1>
<p>The following AMMI-based stability indexes may be computed using the function <code><a href="../reference/AMMI_indexes.html">AMMI_indexes()</a></code>:</p>
<ul>
<li><strong>AMMI stability value, ASV, <span class="citation">(Purchase, Hatting, and Deventer <a href="#ref-Purchase2000" role="doc-biblioref">2000</a>)</span>.</strong></li>
</ul>
<p><span class="math display">\[
ASV = \sqrt {{{\left[ {\frac{{IPCA{1_{ss}}}}{{IPCA{2_{ss}}}} \times \left( {IPCA{1_{score}}} \right)} \right]}^2} + {{\left( {IPCA{2_{score}}} \right)}^2}}
\]</span></p>
<ul>
<li><strong>Sums of the absolute value of the IPCA scores</strong></li>
</ul>
<p><span class="math display">\[
SIP{C_i} = \sum\nolimits_{k = 1}^P {\left| {\mathop {\lambda }\nolimits_k^{0.5} {a_{ik}}} \right|}
\]</span></p>
<ul>
<li><strong>Averages of the squared eigenvector values</strong></li>
</ul>
<p><span class="math display">\[
E{V_i} = \sum\nolimits_{k = 1}^P {\mathop a\nolimits_{ik}^2 } /P
\]</span> described by <span class="citation">Sneller, Kilgore-Norquest, and Dombek (<a href="#ref-Sneller1997" role="doc-biblioref">1997</a>)</span>, where <em>P</em> is the number of IPCA retained via F-tests;</p>
<ul>
<li><strong>absolute value of the relative contribution of IPCAs to the interaction <span class="citation">(Zali et al. <a href="#ref-Zali2012" role="doc-biblioref">2012</a>)</span>.</strong></li>
</ul>
<p><span class="math display">\[
Z{a_i} = \sum\nolimits_{k = 1}^P {{\theta _k}{a_{ik}}}
\]</span></p>
<p>where <span class="math inline">\({\theta _k}\)</span> is the percentage sum of squares explained by the <em>k</em>-th IPCA. Simultaneous selection indexes (ssi), are computed by summation of the ranks of the ASV, SIPC, EV and Za indexes and the ranks of the mean yields <span class="citation">(Farshadfar <a href="#ref-Farshadfar2008" role="doc-biblioref">2008</a>)</span>, which results in ssiASV, ssiSIPC, ssiEV, and ssiZa, respectively.</p>
<p>The <code>AMMI_index()</code> function has two arguments. The first (x) is the model, which must be an object of the class <code>waas</code> or <code>performs_ammi</code>. The second, (order.y) is the order for ranking the response variable. By default, it is set to NULL, which means that the response variable is ordered in descending order. If <code>x</code> is a list with more than one variable, <code>order.y</code> must be a vector of the same length of x. Each element of the vector must be one of the “h” or “l”. If “h” is used, the response variable will be ordered from maximum to minimum. If “l” is used then the response variable will be ordered from minimum to maximum. We will use the previously fitted model <code>AMMI_model</code> to compute the AMMI-based stability indexes.</p>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="va">stab_indexes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AMMI_indexes.html">AMMI_indexes</a></span><span class="op">(</span><span class="va">AMMI_model</span><span class="op">)</span>
<span class="fu">print_table</span><span class="op">(</span><span class="va">stab_indexes</span><span class="op">$</span><span class="va">GY</span><span class="op">)</span></pre></div>
<div id="htmlwidget-9339f49d959d53c25eca" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9339f49d959d53c25eca">{"x":{"filter":"none","extensions":["Buttons"],"data":[["G1","G10","G2","G3","G4","G5","G6","G7","G8","G9"],[2.60367618165785,2.47122087301587,2.74414697530864,2.95534410934744,2.64191544091711,2.53734447971781,2.53403047619048,2.740909329806,3.00363750440917,2.51019186067019],[6,10,3,2,5,7,8,4,1,9],[0.345796037761837,1.22545926984898,0.249325230904701,0.113075226647209,0.593876593911135,0.430380171201332,0.265233862364015,0.663249668862366,0.573932874683825,0.982717111614492],[4,10,2,1,7,5,3,8,6,9],[10,20,5,3,12,12,11,12,7,18],[0.462752669772948,2.06851308823374,1.54426681862106,0.551543842845939,1.03576011389952,0.996690100193973,1.13965607527429,1.78728724332489,1.17780983200119,1.49500282572498],[1,10,8,2,4,3,5,9,6,7],[7,20,11,4,9,10,13,13,7,16],[0.0148628710540707,0.210108000197701,0.17913068576175,0.0206711846179194,0.0521274873435515,0.0432636684792836,0.0910817927502293,0.191296532132113,0.0668751760302677,0.130582601633114],[1,10,8,2,4,3,6,9,5,7],[7,20,11,4,9,10,14,13,6,16],[0.10031843082482,0.437036861698873,0.215521743968946,0.0796853025439071,0.21871574230063,0.18637277694868,0.172168681902717,0.30344173725849,0.224604157019446,0.336201837821982],[2,10,5,1,6,4,3,8,7,9],[8,20,8,3,11,11,11,12,8,18],[0.150815092859492,0.652188235262644,0.283438400032806,0.106225116388271,0.325645140319217,0.269523978474321,0.232511857642983,0.428351101662169,0.326588676690135,0.50674657772298],[2,10,5,1,6,4,3,8,7,9],[8,20,8,3,11,11,11,12,8,18]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>GEN<\/th>\n      <th>Y<\/th>\n      <th>Y_R<\/th>\n      <th>ASV<\/th>\n      <th>ASV_R<\/th>\n      <th>ASV_SSI<\/th>\n      <th>SIPC<\/th>\n      <th>SIPC_R<\/th>\n      <th>SIPC_SSI<\/th>\n      <th>EV<\/th>\n      <th>EV_R<\/th>\n      <th>EV_SSI<\/th>\n      <th>ZA<\/th>\n      <th>ZA_R<\/th>\n      <th>ZA_SSI<\/th>\n      <th>WAAS<\/th>\n      <th>WAAS_R<\/th>\n      <th>WAAS_SSI<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render","options.columnDefs.13.render","options.columnDefs.14.render","options.columnDefs.15.render","options.columnDefs.16.render"],"jsHooks":[]}</script>
</div>
<div id="ammi-model-for-unbalanced-data" class="section level1">
<h1 class="hasAnchor">
<a href="#ammi-model-for-unbalanced-data" class="anchor"></a>AMMI model for unbalanced data</h1>
<p>Singular Value Decomposition requires a complete two-way table (i.e., all genotypes in all environments). Sometimes (for several reasons), a complete two-way table cannot be obtained in a multi-environment trial. <code>metan</code> offers an option to impute the missing cells of the two-way table using Expectation-Maximization algorithms. If an incomplete two-way table is identified in <code><a href="../reference/performs_ammi.html">performs_ammi()</a></code> a warning is issued, <code><a href="../reference/impute_missing_val.html">impute_missing_val()</a></code> is called internally and the missing value(s) is(are) imputed using a low-rank Singular Value Decomposition approximation estimated by the Expectation-Maximization algorithm. The algorithm will (i) initialize all NA values to the column means; (ii) compute the first axis terms of the SVD of the completed matrix; (iii) replace the previously missing values with their approximations from the SVD; (iv) iterate steps 2 through 3 until convergence or a maximum number of iterations be achieved.</p>
<p>As an example we will run the AMMI model by omiting <code>H2</code> from <code>E1</code> in `data_ge2.</p>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="va">miss_val</span> <span class="op">&lt;-</span> 
  <span class="va">data_ge2</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/utils_rows_cols.html">remove_rows</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">mod_miss</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">miss_val</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">PH</span><span class="op">)</span>
<span class="co"># ----------------------------------------------</span>
<span class="co"># Convergence information</span>
<span class="co"># ----------------------------------------------</span>
<span class="co"># Number of iterations: 23</span>
<span class="co"># Final RMSE: 6.007683e-11</span>
<span class="co"># Number of axis: 1</span>
<span class="co"># Convergence: TRUE</span>
<span class="co"># ----------------------------------------------</span>
<span class="co"># Warning: Data imputation used to fill the GxE matrix</span>
<span class="co"># variable PH </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># AMMI analysis table</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="co">#        ENV   3  6.952  2.3173 117.463 5.92e-07          .           .</span>
<span class="co">#   REP(ENV)   8  0.158  0.0197   0.863 5.51e-01          .           .</span>
<span class="co">#        GEN  12  2.470  0.2058   9.000 3.03e-11          .           .</span>
<span class="co">#    GEN:ENV  35  5.286  0.1510   6.603 1.39e-13          .           .</span>
<span class="co">#        PC1  14  4.413  0.3152  13.780 0.00e+00       83.4        83.4</span>
<span class="co">#        PC2  12  0.588  0.0490   2.140 2.12e-02       11.1        94.5</span>
<span class="co">#        PC3  10  0.290  0.0290   1.270 2.59e-01        5.5         100</span>
<span class="co">#  Residuals  94  2.150  0.0229      NA       NA          .           .</span>
<span class="co">#      Total 188 22.306  0.1187      NA       NA       &lt;NA&gt;        &lt;NA&gt;</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="co"># Done!</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">mod_miss</span>, type <span class="op">=</span> <span class="fl">2</span>, title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">mod_comp</span> <span class="op">&lt;-</span> 
  <span class="va">data_ge2</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">PH</span><span class="op">)</span>
<span class="co"># variable PH </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># AMMI analysis table</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#     Source  Df Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="co">#        ENV   3  7.719  2.5728 127.913 4.25e-07          .           .</span>
<span class="co">#   REP(ENV)   8  0.161  0.0201   0.897 5.22e-01          .           .</span>
<span class="co">#        GEN  12  1.865  0.1554   6.929 6.89e-09          .           .</span>
<span class="co">#    GEN:ENV  36  5.397  0.1499   6.686 5.01e-14          .           .</span>
<span class="co">#        PC1  14  4.466  0.3190  14.230 0.00e+00       82.8        82.8</span>
<span class="co">#        PC2  12  0.653  0.0545   2.430 8.40e-03       12.1        94.9</span>
<span class="co">#        PC3  10  0.277  0.0277   1.240 2.76e-01        5.1         100</span>
<span class="co">#  Residuals  96  2.153  0.0224      NA       NA          .           .</span>
<span class="co">#      Total 191 22.692  0.1188      NA       NA       &lt;NA&gt;        &lt;NA&gt;</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="co"># Done!</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">mod_comp</span>, type <span class="op">=</span> <span class="fl">2</span>, title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  

<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Missing data"</span>, <span class="st">"Complete data"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="vignettes_ammi_files/figure-html/unnamed-chunk-25-1.png" width="960"></p>
<hr>
</div>
<div id="rendering-engine" class="section level1">
<h1 class="hasAnchor">
<a href="#rendering-engine" class="anchor"></a>Rendering engine</h1>
<p>This vignette was built with <a href="https://pkgdown.r-lib.org/">pkgdown</a>. All tables were produced with the package <a href="https://rstudio.github.io/DT/"><code>DT</code></a> using the following function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT">DT</a></span><span class="op">)</span> <span class="co"># Used to make the tables</span>
<span class="co"># Function to make HTML tables</span>
<span class="va">print_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table</span>, <span class="va">rownames</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">table</span>, rownames <span class="op">=</span> <span class="va">rownames</span>, extensions <span class="op">=</span> <span class="st">'Buttons'</span>,
          options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>scrollX <span class="op">=</span> <span class="cn">TRUE</span>, 
                         dom <span class="op">=</span> <span class="st">'&lt;&lt;t&gt;Bp&gt;'</span>,
                         buttons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'copy'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html">formatSignif</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">class</span><span class="op">)</span> <span class="op">==</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span><span class="op">}</span></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references hanging-indent">
<div id="ref-Farshadfar2008">
<p>Farshadfar, E. 2008. “Incorporation of AMMI stability value and grain yield in a single non-parametric index (GSI) in bread wheat.” <em>Pakistan Journal of Biological Sciences</em> 11 (14): 1791–6. <a href="http://www.ncbi.nlm.nih.gov/pubmed/18817218">http://www.ncbi.nlm.nih.gov/pubmed/18817218</a>.</p>
</div>
<div id="ref-Gollob:1968">
<p>Gollob, H. F. 1968. “A statistical model which combines features of factor analytic and analysis of variance techniques.” <em>Psychometrika</em> 33 (1): 73–115. <a href="https://doi.org/10.1007/BF02289676">https://doi.org/10.1007/BF02289676</a>.</p>
</div>
<div id="ref-Olivoto2019">
<p>Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, V. S. Marchioro, V. Q. de Souza, and E. Jost. 2019. “Mean performance and stability in multi-environment trials I: Combining features of AMMI and BLUP techniques.” <em>Agronomy Journal</em> 111 (6): 2949–60. <a href="https://doi.org/10.2134/agronj2019.03.0220">https://doi.org/10.2134/agronj2019.03.0220</a>.</p>
</div>
<div id="ref-Olivoto2019a">
<p>Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, B. G. Sari, and M. I. Diel. 2019. “Mean performance and stability in multi-environment trials II: Selection based on multiple traits.” <em>Agronomy Journal</em> 111 (6): 2961–9. <a href="https://doi.org/10.2134/agronj2019.03.0221">https://doi.org/10.2134/agronj2019.03.0221</a>.</p>
</div>
<div id="ref-Piepho:1994">
<p>Piepho, H. P. 1994. “Best Linear Unbiased Prediction (Blup) for Regional Yield Trials: A Comparison to Additive Main Effects and Multiplicative Interaction (Ammi) Analysis.” <em>Theor. Appl. Genet.</em> 89 (5): 647–54. <a href="https://doi.org/10.1007/BF00222462">https://doi.org/10.1007/BF00222462</a>.</p>
</div>
<div id="ref-Purchase2000">
<p>Purchase, J. L., Hesta Hatting, and C. S. van Deventer. 2000. “Genotype × environment interaction of winter wheat ( Triticum aestivum L.) in South Africa: II. Stability analysis of yield performance.” <em>South African Journal of Plant and Soil</em> 17 (3): 101–7. <a href="https://doi.org/10.1080/02571862.2000.10634878">https://doi.org/10.1080/02571862.2000.10634878</a>.</p>
</div>
<div id="ref-Sneller1997">
<p>Sneller, C. H., L. Kilgore-Norquest, and D. Dombek. 1997. “Repeatability of Yield Stability Statistics in Soybean.” <em>Crop Science</em> 37 (2): 383–90. <a href="https://doi.org/10.2135/cropsci1997.0011183X003700020013x">https://doi.org/10.2135/cropsci1997.0011183X003700020013x</a>.</p>
</div>
<div id="ref-Zali2012">
<p>Zali, H., E. Farshadfar, S. H. Sabaghpour, and R. Karimizadeh. 2012. “Evaluation of genotype × environment interaction in chickpea using measures of stability from AMMI model.” <em>Annals of Biological Research</em> 3 (7): 3126–36. <a href="http://eprints.icrisat.ac.in/7173/">http://eprints.icrisat.ac.in/7173/</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ef40e3bab94bb0e1d687fd3844052701',
    indexName: 'metan',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
