<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metan">
<title>Cross-validation procedures for AMMI and BLUP • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-validation procedures for AMMI and BLUP">
<meta property="og:description" content="metan">
<meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.16.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a>
    <a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    <a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    <a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a>
    <a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a>
    <a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a>
    <a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="../SUPPORT.html">Support</a>
    <a class="dropdown-item" href="../LICENSE.html">Licence</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="vignettes_cross-validation_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="vignettes_cross-validation_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="vignettes_cross-validation_files/datatables-binding-0.20/datatables.js"></script><script src="vignettes_cross-validation_files/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="vignettes_cross-validation_files/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="vignettes_cross-validation_files/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="vignettes_cross-validation_files/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><script src="vignettes_cross-validation_files/jszip-1.11.3/jszip.min.js"></script><script src="vignettes_cross-validation_files/pdfmake-1.11.3/pdfmake.js"></script><script src="vignettes_cross-validation_files/pdfmake-1.11.3/vfs_fonts.js"></script><link href="vignettes_cross-validation_files/dt-ext-buttons-1.11.3/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="vignettes_cross-validation_files/dt-ext-buttons-1.11.3/js/dataTables.buttons.min.js"></script><script src="vignettes_cross-validation_files/dt-ext-buttons-1.11.3/js/buttons.html5.min.js"></script><script src="vignettes_cross-validation_files/dt-ext-buttons-1.11.3/js/buttons.colVis.min.js"></script><script src="vignettes_cross-validation_files/dt-ext-buttons-1.11.3/js/buttons.print.min.js"></script><link href="vignettes_cross-validation_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="vignettes_cross-validation_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cross-validation procedures for AMMI and BLUP</h1>
                        <h4 data-toc-skip class="author">Tiago Olivoto</h4>
            
            <h4 data-toc-skip class="date">2021-12-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/HEAD/vignettes/vignettes_cross-validation.Rmd" class="external-link"><code>vignettes/vignettes_cross-validation.Rmd</code></a></small>
      <div class="d-none name"><code>vignettes_cross-validation.Rmd</code></div>
    </div>

    
    
<div class="section level1">
<h1 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h1>
<p>In this section, we will use the data in <code>data_ge</code>. For more information, please, see <code><a href="../reference/data_ge.html">?data_ge</a></code>. Other data sets can be used provided that the following columns are in the dataset: environment, genotype, block/replicate and response variable(s). See the section <a href="#rendering">Rendering engine</a> to know how HTML tables were generated.</p>
<style>
  .col2 {
    columns: 2 200px;         /* number of columns and width in pixels*/
    -webkit-columns: 2 200px; /* chrome, safari */
    -moz-columns: 2 200px;    /* firefox */
  }
  .col3 {
    columns: 3 100px;
    -webkit-columns: 3 100px;
    -moz-columns: 3 100px;
  }
</style>
</div>
<div class="section level1">
<h1 id="predictive-accuracy">Predictive accuracy<a class="anchor" aria-label="anchor" href="#predictive-accuracy"></a>
</h1>
<div class="col2">
<p>The predictive accucary of both AMMI and BLUP models may be obtained using a cross-validation procedure implemented by the functions <code><a href="../reference/cv_ammif.html">cv_ammif()</a></code> and <code><a href="../reference/cv_blup.html">cv_blup()</a></code> The <code><a href="../reference/cv_ammif.html">cv_ammif()</a></code> function provides a complete cross-validation procedure for all member of AMMI model family (AMMI0-AMMIF) using replicate-based data, according to the diagram below. Automatically the first validation is carried out considering the AMMIF (all possible axis used). Considering this model, the original data set is split up into two sets: training set and validation set.</p>
<div class="figure">
<img src="validation.png" alt=""><p class="caption">Diagram for cross-validation of AMMI models.</p>
</div>
<p>The training set has all combinations (genotype x environment) with the number of replications informed in <code>nrepval</code> argument. The validation set has one replication that were not included in the training set. The splitting of the data set into training and validation sets depends on the design considered. For a Randomized Complete Block Design (default option) and the procedure we used in the article, completely blocks are randomly selected within environments, as suggested by <span class="citation"><a href="#ref-Piepho:1994" role="doc-biblioref">Piepho</a> (<a href="#ref-Piepho:1994" role="doc-biblioref">1994</a>)</span>. The remaining block serves as validation data. If <code>design = "CRD"</code> is informed, thus declaring that a completely randomized design was used, single observations are randomized for each treatment (genotype-by-environment combination). This is the same procedure suggested by <span class="citation"><a href="#ref-Gauch:1988" role="doc-biblioref">Gauch and Zobel</a> (<a href="#ref-Gauch:1988" role="doc-biblioref">1988</a>)</span>. The estimated values for each member of the AMMI model family in each re-sampling cycle are compared with the observed values in the validation data. Then, the Root Mean Square Prediction Difference is computed as follows:</p>
<p><span class="math display">\[
   RMSPD = 
   {\left[ {\left( {\sum\nolimits_{i = 1}^n {{{\left( {{{\hat y}_{ij}} - {y_{ij}}} \right)}^2}} } \right)/n} \right]^{0.5}}
\]</span></p>
<p>where <span class="math inline">\(\widehat{y}_{ij}\)</span> is the model predicted value; and <span class="math inline">\(y_{ij}\)</span> is the observed value in the validation set. The number of random selection of blocks/replicates (<em>n</em>) is defined in the argument <code>nboot</code>. At the end of the <em>n</em> cycles for all models, a list with all estimated RMSPD and the average of RMSPD is returned.</p>
</div>
</div>
<div class="section level1">
<h1 id="cross-validation-for-ammi-model">Cross-validation for AMMI model<a class="anchor" aria-label="anchor" href="#cross-validation-for-ammi-model"></a>
</h1>
<p>The following code computes the cross-validation of the oat data using the AMMI model. There are two options for doing that. The first is to perform the cross-validation for a specific member of the AMMI-family model. The second (and more realistic) is to perform the cross-validation for all AMMI-family models in the same procedure.</p>
<div class="section level2">
<h2 id="declaring-the-number-of-axes">Declaring the number of axes<a class="anchor" aria-label="anchor" href="#declaring-the-number-of-axes"></a>
</h2>
<p>The function <code><a href="../reference/cv_ammi.html">cv_ammi()</a></code> is used to compute a cross-validation procedure for the AMMI0, AMMI2 and AMMIF (9 axes) models.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span>
<span class="va">AMMI0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_ammi.html">cv_ammi</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, naxis <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># AMMI0</span>
<span class="va">AMMI2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_ammi.html">cv_ammi</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, naxis <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># AMMI2</span>
<span class="va">AMMI9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_ammi.html">cv_ammi</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, naxis <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="co"># AMMIF</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ammi0-to-ammif">AMMI0 to AMMIF<a class="anchor" aria-label="anchor" href="#ammi0-to-ammif"></a>
</h2>
<p>The function <code><a href="../reference/cv_ammif.html">cv_ammif()</a></code> is used to compute a cross-validation procedure for all members of the AMMI-family model. In this case, AMMI0-AMMI9.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AMMIF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_ammif.html">cv_ammif</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="cross-validation-for-blup-prediction">Cross-validation for BLUP prediction<a class="anchor" aria-label="anchor" href="#cross-validation-for-blup-prediction"></a>
</h1>
<p>The function <code><a href="../reference/cv_blup.html">cv_blup()</a></code> provides a cross-validation of replicate-based data using mixed models. By default, complete blocks are randomly selected for each environment. Using the argument <code>random</code> it is possible to chose the random effects of the model, as shown bellow.</p>
<div class="section level2">
<h2 id="genotype-and-genotype-vs-environment-as-random-effects">Genotype and genotype-vs-environment as random effects<a class="anchor" aria-label="anchor" href="#genotype-and-genotype-vs-environment-as-random-effects"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">BLUP_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_blup.html">cv_blup</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, random <span class="op">=</span> <span class="st">"gen"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="environment-replication-within-environment-and-interaction-as-random-effects">Environment, replication-within-environment and interaction as random effects<a class="anchor" aria-label="anchor" href="#environment-replication-within-environment-and-interaction-as-random-effects"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">BLUP_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_blup.html">cv_blup</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, random <span class="op">=</span> <span class="st">"env"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-random-model-all-terms-as-random-effects">A random model (all terms as random effects)<a class="anchor" aria-label="anchor" href="#a-random-model-all-terms-as-random-effects"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">BLUP_ge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_blup.html">cv_blup</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span>, random <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="printing-the-means-of-rmspd-estimates">Printing the means of RMSPD estimates<a class="anchor" aria-label="anchor" href="#printing-the-means-of-rmspd-estimates"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bind_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_cv.html">bind_cv</a></span><span class="op">(</span><span class="va">AMMIF</span>, <span class="va">BLUP_g</span>, bind <span class="op">=</span> <span class="st">"means"</span><span class="op">)</span>
<span class="fu">print_table</span><span class="op">(</span><span class="va">bind_mod</span><span class="op">$</span><span class="va">RMSPD</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-f80773d6b1e30163dd1a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f80773d6b1e30163dd1a">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["BLUP_g_RCBD","AMMI2","AMMI4","AMMI3","AMMI5","AMMI6","AMMI7","AMMI8","AMMIF","AMMI1","AMMI0"],[0.404681668056524,0.411040845900402,0.416071568146498,0.416255851959942,0.422031346727222,0.422274307596015,0.424590464312707,0.426862037304913,0.428805502634446,0.4296313888519,0.430402664844616],[0.0248897101801363,0.0241510688204166,0.0234418133642197,0.0215284525461124,0.0231680057804939,0.0219187989313897,0.0199459668856834,0.0204452219334058,0.0212757803158497,0.0251248133408539,0.0283365505988242],[0.00175996828501422,0.00170773845358196,0.00165758651931492,0.00152229147838088,0.00163822539939564,0.00154989313598501,0.0014103928442189,0.00144569550719752,0.00150442485363726,0.0017765925889364,0.00200369670838643],[0.357358506764501,0.368823454351105,0.373238739150609,0.376828922924084,0.376804980505544,0.380589108887797,0.380801772964028,0.387499582505626,0.389570350448628,0.383501079409614,0.370266825058589],[0.452853066597751,0.459999161654668,0.462038278972195,0.456584798471462,0.464424759046059,0.461875295681503,0.458260708085074,0.462121320835647,0.468906306149461,0.478683805107634,0.484730005962345]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>MODEL<\/th>\n      <th>mean<\/th>\n      <th>sd<\/th>\n      <th>se<\/th>\n      <th>Q2.5<\/th>\n      <th>Q97.5<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"<<t>Bp>","buttons":["copy","excel","pdf","print"],"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[1,2,3,4,5]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script><p>The table above showns the descriptive statistics (mean, standard deviation, standar error of the mean, and quantiles 2.5% and 97.5%) of the 100 RMSPD estimates for each model, and are presented from the most accurate model (smallest RMSPD mean) to the least accurate model (highest RMSPD mean).</p>
</div>
<div class="section level2">
<h2 id="plotting-the-rmspd-values">Plotting the RMSPD values<a class="anchor" aria-label="anchor" href="#plotting-the-rmspd-values"></a>
</h2>
<p>The values of the RMSPD estimates obtained in the cross-validation process may be plotted using the function<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bind1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_cv.html">bind_cv</a></span><span class="op">(</span><span class="va">AMMI0</span>, <span class="va">AMMI2</span>, <span class="va">AMMI9</span><span class="op">)</span>
<span class="va">bind2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_cv.html">bind_cv</a></span><span class="op">(</span><span class="va">AMMIF</span>, <span class="va">BLUP_g</span>, <span class="va">BLUP_e</span>, <span class="va">BLUP_ge</span><span class="op">)</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bind1</span>, violin <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bind2</span>,
          width.boxplot <span class="op">=</span> <span class="fl">0.6</span>,
          order_box <span class="op">=</span> <span class="cn">TRUE</span>,
          plot_theme <span class="op">=</span> <span class="fu"><a href="../reference/themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></code></pre></div>
<p><img src="vignettes_cross-validation_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Six statistics are shown in this boxplot. The mean (black rhombus), the median (black line), the lower and upper hinges that correspond sto the first and third quartiles (the 25th and 75th percentiles, respectively). The upper whisker extends from the hinge to the largest value no further than <span class="math inline">\(1.5\times{IQR}\)</span> from the hinge (where IQR is the inter-quartile range). The lower whisker extends from the hinge to the smallest value at most <span class="math inline">\(1.5\times{IQR}\)</span> of the hinge. Data beyond the end of the whiskers are considered outlying points. If the condition <code>violin = TRUE</code>, a violin plot is added along with the boxplot. A violin plot is a compact display of a continuous distribution displayed in the same way as a boxplot.</p>
<hr>
</div>
</div>
<div class="section level1">
<h1 id="rendering">Rendering engine<a class="anchor" aria-label="anchor" href="#rendering"></a>
</h1>
<p>This vignette was built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>. All tables were produced with the package <a href="https://rstudio.github.io/DT/" class="external-link"><code>DT</code></a> using the following function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span> <span class="co"># Used to make the tables</span>
<span class="co"># Function to make HTML tables</span>
<span class="va">print_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table</span>, <span class="va">rownames</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span>
  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">table</span>, rownames <span class="op">=</span> <span class="va">rownames</span>, extensions <span class="op">=</span> <span class="st">'Buttons'</span>,
                  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scrollX <span class="op">=</span> <span class="cn">TRUE</span>, 
                                 dom <span class="op">=</span> <span class="st">'&lt;&lt;t&gt;Bp&gt;'</span>,
                                 buttons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'copy'</span>, <span class="st">'excel'</span>, <span class="st">'pdf'</span>, <span class="st">'print'</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>
  <span class="va">num_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">class</span><span class="op">)</span> <span class="op">==</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">num_cols</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html" class="external-link">formatSignif</a></span><span class="op">(</span><span class="va">df</span>, columns <span class="op">=</span> <span class="va">num_cols</span>, digits <span class="op">=</span> <span class="va">digits</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span><span class="op">{</span>
    <span class="va">df</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level1 unnumbered">
<h1 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gauch:1988" class="csl-entry">
Gauch, H.G, and Zobel R. W. 1988. <span>“Predictive and Postdictive Success of Statistical Analyses of Yield Trials.”</span> <em>Theor. Appl. Genet.</em> 76 (1): 1–10. <a href="https://doi.org/10.1007/BF00288824" class="external-link">https://doi.org/10.1007/BF00288824</a>.
</div>
<div id="ref-Piepho:1994" class="csl-entry">
Piepho, H. P. 1994. <span>“Best Linear Unbiased Prediction (BLUP) for Regional Yield Trials: A Comparison to Additive Main Effects and Multiplicative Interaction (AMMI) Analysis.”</span> <em>Theor. Appl. Genet.</em> 89 (5): 647–54. <a href="https://doi.org/10.1007/BF00222462" class="external-link">https://doi.org/10.1007/BF00222462</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
