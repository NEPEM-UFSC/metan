<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Performs stability analysis of multi-environment trial data using parametric and non-parametric methods">
<title>metan • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="metan">
<meta property="og:description" content="Performs stability analysis of multi-environment trial data using parametric and non-parametric methods">
<meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="articles/vignettes_helper.html">Helper functions</a>
    <a class="dropdown-item" href="articles/vignettes_utilities.html">Utilities</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="articles/vignettes_descriptive.html">Descriptive statistics</a>
    <a class="dropdown-item" href="articles/vignettes_biometry.html">Biometry</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="articles/vignettes_cross-validation.html">Cross-validation</a>
    <a class="dropdown-item" href="articles/vignettes_ammi.html">AMMI</a>
    <a class="dropdown-item" href="articles/vignettes_blup.html">BLUP</a>
    <a class="dropdown-item" href="articles/vignettes_gge.html">GGE</a>
    <a class="dropdown-item" href="articles/vignettes_stability.html">Stability</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="articles/vignettes_indexes.html">Multivariate indexes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="SUPPORT.html">Support</a>
    <a class="dropdown-item" href="LICENSE.html">Licence</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="metan-">metan <a class="anchor" aria-label="anchor" href="#metan-"></a>
</h1>
</div>
<!-- badges: start -->

<!-- badges: end -->
<p><code>metan</code> (<strong>m</strong>ulti-<strong>e</strong>nvironment <strong>t</strong>rials <strong>an</strong>alysis) provides useful functions for analyzing multi-environment trial data using parametric and non-parametric methods. The package will help you to:</p>
<ul>
<li>
<a href="https://tiagoolivoto.github.io/metan/reference/inspect.html">Inspect</a> data for possible common errors;</li>
<li>Manipulate <a href="https://tiagoolivoto.github.io/metan/reference/utils_rows_cols.html">rows and columns</a>;</li>
<li>Manipulate <a href="https://tiagoolivoto.github.io/metan/reference/utils_num_str.html">numbers and strings</a>;</li>
<li>Manipulate <a href="https://tiagoolivoto.github.io/metan/reference/utils_na_zero.html"><code>NA</code>s and <code>0</code>s</a>;</li>
<li>Compute <a href="https://tiagoolivoto.github.io/metan/reference/desc_stat.html">descriptive statistics</a>;</li>
<li>Compute <a href="https://tiagoolivoto.github.io/metan/reference/anova_ind.html">within-environment</a> and <a href="https://tiagoolivoto.github.io/metan/reference/anova_joint.html">joint-analysis of variance</a>;</li>
<li>Compute <a href="https://tiagoolivoto.github.io/metan/reference/performs_ammi.html">AMMI analysis</a> with prediction considering different numbers of interaction principal component axes;</li>
<li>Compute <a href="https://tiagoolivoto.github.io/metan/reference/ammi_indexes.html">AMMI-based stability indexes</a>;</li>
<li>Compute <a href="https://tiagoolivoto.github.io/metan/reference/gge.html">GGE biplot analysis</a>;</li>
<li>Compute <a href="https://tiagoolivoto.github.io/metan/reference/gtb.html">GT</a> and <a href="https://tiagoolivoto.github.io/metan/reference/gytb.html">GYT</a> biplot analysis;</li>
<li>Compute <a href="https://tiagoolivoto.github.io/metan/reference/blup_indexes.html">BLUP-based stability indexes</a>;</li>
<li>Compute variance components and genetic parameters in <a href="https://tiagoolivoto.github.io/metan/reference/gamem.html">single environment</a> and <a href="https://tiagoolivoto.github.io/metan/reference/gamem_met.html">multi-environment</a> trials using mixed-effect models;</li>
<li>Perform cross-validation procedures for <a href="https://tiagoolivoto.github.io/metan/reference/cv_ammif.html">AMMI-family</a> and <a href="https://tiagoolivoto.github.io/metan/reference/cv_blup.html">BLUP</a> models;</li>
<li>Compute parametric and nonparametric <a href="https://tiagoolivoto.github.io/metan/reference/ge_stats.html">stability statistics</a>;</li>
<li>Implement <a href="https://tiagoolivoto.github.io/metan/reference/index.html#section-biometry">biometrical models</a>.</li>
</ul>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>Install the released version of <code>metan</code> from <a href="https://CRAN.R-project.org/package=metan" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"metan"</span><span class="op">)</span></code></pre></div>
<p>Or install the development version from <a href="https://github.com/TiagoOlivoto/metan" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"TiagoOlivoto/metan"</span><span class="op">)</span>

<span class="co"># To build the HTML vignette use</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"TiagoOlivoto/metan"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><em>Note</em>: If you are a Windows user, you should also first download and install the latest version of <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a>.</p>
<p>For the latest release notes on this development version, see the <a href="https://tiagoolivoto.github.io/metan/news/index.html">NEWS file</a>.</p>
<div class="section level2">
<h2 id="cheatsheet">Cheatsheet<a class="anchor" aria-label="anchor" href="#cheatsheet"></a>
</h2>
<p><a href="https://github.com/TiagoOlivoto/metan/raw/master/metan_cheat_sheet.pdf" class="external-link"><img src="https://raw.githubusercontent.com/TiagoOlivoto/metan/master/man/figures/metan_cheat_sheet.png" width="935" height="640"></a></p>
</div>
</div>
<div class="section level1">
<h1 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h1>
<p><code>metan</code> offers a set of functions that can be used to manipulate, summarize, analyze and plot typical multi-environment trial data. Maybe, one of the first functions users should use would be <a href="https://tiagoolivoto.github.io/metan/reference/inspect.html"><code>inspect()</code></a>. Here, we will inspect the example dataset <code>data_ge</code> that contains data on two variables assessed in 10 genotypes growing in 14 environments.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span>
<span class="fu"><a href="reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data_ge</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># # A tibble: 5 × 10</span>
<span class="co">#   Variable Class   Missing Levels Valid_n   Min Median   Max Outlier Text </span>
<span class="co">#   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;lgl&gt;</span>
<span class="co"># 1 ENV      factor  No      14         420 NA     NA    NA         NA NA   </span>
<span class="co"># 2 GEN      factor  No      10         420 NA     NA    NA         NA NA   </span>
<span class="co"># 3 REP      factor  No      3          420 NA     NA    NA         NA NA   </span>
<span class="co"># 4 GY       numeric No      -          420  0.67   2.61  5.09       0 NA   </span>
<span class="co"># 5 HM       numeric No      -          420 38     48    58          0 NA</span></code></pre></div>
<p><img src="reference/figures/README-INSPECT-1.png" style="display: block; margin: auto;"></p>
<p>No issues while inspecting the data. If any issue is given here (like outliers, missing values, etc.) consider using <a href="https://tiagoolivoto.github.io/metan/reference/find_outliers.html"><code>find_outliers()</code></a> to find possible outliers in the data set or any <code>metan</code>’s data manipulation tool such as <a href="https://tiagoolivoto.github.io/metan/reference/utils_na.html">remove_rows_na()</a> to remove rows with <code>NA</code> values, <a href="https://tiagoolivoto.github.io/metan/reference/utils_na_zero.html">replace_zero()</a> to replace 0’s with <code>NA</code>, <a href="https://tiagoolivoto.github.io/metan/reference/utils_as.html">as_factor()</a> to convert desired columns to factor, <a href="https://tiagoolivoto.github.io/metan/reference/utils_num_str.html"><code>find_text_in_num()</code></a> to find text fragments in columns assumed to be numeric, or even <a href="https://tiagoolivoto.github.io/metan/reference/utils_num_str.html"><code>tidy_strings()</code></a> to tidy up strings.</p>
</div>
<div class="section level1">
<h1 id="descriptive-statistics">Descriptive statistics<a class="anchor" aria-label="anchor" href="#descriptive-statistics"></a>
</h1>
<p><code>metan</code> provides <a href="https://tiagoolivoto.github.io/metan/reference/utils_stats.html">a set of functions</a> to compute descriptive statistics. The easiest way to do that is by using <a href="https://tiagoolivoto.github.io/metan/reference/desc_stat.html"><code>desc_stat()</code></a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/desc_stat.html">desc_stat</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span>
<span class="co"># # A tibble: 15 × 10</span>
<span class="co">#    variable    cv     max    mean  median     min  sd.amo     se    ci.t n.valid</span>
<span class="co">#    &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#  1 CD        7.34  18.6    16.0    16      12.9    1.17   0.0939  0.186      156</span>
<span class="co">#  2 CDED      5.71   0.694   0.586   0.588   0.495  0.0334 0.0027  0.0053     156</span>
<span class="co">#  3 CL        7.95  34.7    29.0    28.7    23.5    2.31   0.185   0.365      156</span>
<span class="co">#  4 CW       25.2   38.5    24.8    24.5    11.1    6.26   0.501   0.99       156</span>
<span class="co">#  5 ED        5.58  54.9    49.5    49.9    43.5    2.76   0.221   0.437      156</span>
<span class="co">#  6 EH       21.2    1.88    1.34    1.41    0.752  0.284  0.0228  0.045      156</span>
<span class="co">#  7 EL        8.28  17.9    15.2    15.1    11.5    1.26   0.101   0.199      156</span>
<span class="co">#  8 EP       10.5    0.660   0.537   0.544   0.386  0.0564 0.0045  0.0089     156</span>
<span class="co">#  9 KW       18.9  251.    173.    175.    106.    32.8    2.62    5.18       156</span>
<span class="co"># 10 NKE      14.2  697.    512.    509.    332.    72.6    5.82   11.5        156</span>
<span class="co"># 11 NKR      10.7   42      32.2    32      23.2    3.47   0.277   0.548      156</span>
<span class="co"># 12 NR       10.2   21.2    16.1    16      12.4    1.64   0.131   0.259      156</span>
<span class="co"># 13 PERK      2.17  91.8    87.4    87.5    81.2    1.90   0.152   0.300      156</span>
<span class="co"># 14 PH       13.4    3.04    2.48    2.52    1.71   0.334  0.0267  0.0528     156</span>
<span class="co"># 15 TKW      13.9  452.    339.    342.    218.    47.1    3.77    7.44       156</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="ammi-model">AMMI model<a class="anchor" aria-label="anchor" href="#ammi-model"></a>
</h1>
<div class="section level2">
<h2 id="fitting-the-model">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h2>
<p>The AMMI model is fitted with the function <a href="https://tiagoolivoto.github.io/metan/reference/performs_ammi.html"><code>performs_ammi()</code></a>. To analyze multiple variables at once we can use a comma-separated vector of unquoted variable names, or use any select helper in the argument <code>resp</code>. Here, using <code><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything()</a></code> we apply the function to all numeric variables in the data. For more details, see the <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_ammi.html">complete vignette</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/performs_ammi.html">performs_ammi</a></span><span class="op">(</span><span class="va">data_ge</span>,
                       env <span class="op">=</span> <span class="va">ENV</span>,
                       gen <span class="op">=</span> <span class="va">GEN</span>,
                       rep <span class="op">=</span> <span class="va">REP</span>,
                       resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,
                       verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># Significance of IPCAs</span>
<span class="fu"><a href="reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"ipca_pval"</span><span class="op">)</span>
<span class="co"># Class of the model: performs_ammi</span>
<span class="co"># Variable extracted: Pr(&gt;F)</span>
<span class="co"># # A tibble: 9 × 4</span>
<span class="co">#   PC       DF     GY     HM</span>
<span class="co">#   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co"># 1 PC1      21 0      0     </span>
<span class="co"># 2 PC2      19 0      0     </span>
<span class="co"># 3 PC3      17 0.0014 0.0021</span>
<span class="co"># 4 PC4      15 0.0096 0.0218</span>
<span class="co"># 5 PC5      13 0.318  0.0377</span>
<span class="co"># 6 PC6      11 0.561  0.041 </span>
<span class="co"># 7 PC7       9 0.754  0.0633</span>
<span class="co"># 8 PC8       7 0.804  0.232 </span>
<span class="co"># 9 PC9       5 0.934  0.944</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="biplots">Biplots<a class="anchor" aria-label="anchor" href="#biplots"></a>
</h2>
<p>The well-known AMMI1 and AMMI2 biplots can be created with <a href="file:///D:/Desktop/metan/docs/reference/plot_scores.html"><code>plot_scores()</code></a>. Note that since <a href="https://tiagoolivoto.github.io/metan/reference/performs_ammi.html"><code>performs_ammi</code></a> allows analyzing multiple variables at once, e.g., <code>resp = c(v1, v2, ...)</code>, the output <code>model</code> is a list, in this case with two elements (GY and HM). By default, the biplots are created for the first variable of the model. To choose another variable use the argument <code>var</code> (e.g., <code>var = "HM"</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">model</span>,
                 type <span class="op">=</span> <span class="fl">2</span>, <span class="co"># AMMI 2 biplot</span>
                 polygon <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># show a polygon</span>
                 highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G4"</span>, <span class="st">"G5"</span>, <span class="st">"G6"</span><span class="op">)</span>, <span class="co">#highlight genotypes</span>
                 col.alpha.env <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># alpha for environments</span>
                 col.alpha.gen <span class="op">=</span> <span class="fl">0</span>, <span class="co"># remove the other genotypes</span>
                 col.env <span class="op">=</span> <span class="st">"gray"</span>, <span class="co"># color for environment point</span>
                 col.segm.env <span class="op">=</span> <span class="st">"gray"</span>, <span class="co"># color for environment segment</span>
                 plot_theme <span class="op">=</span> <span class="fu"><a href="reference/themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># theme</span>
<span class="fu"><a href="reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-AMMI-1.png"><!-- --></p>
</div>
</div>
<div class="section level1">
<h1 id="gge-model">GGE model<a class="anchor" aria-label="anchor" href="#gge-model"></a>
</h1>
<p>The GGE model is fitted with the function <a href="https://tiagoolivoto.github.io/metan/reference/gge.html"><code>gge()</code></a>. For more details, see the <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_gge.html">complete vignette</a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span><span class="op">)</span>
<span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span>, svp <span class="op">=</span> <span class="st">"genotype"</span><span class="op">)</span>
<span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gge.html">gge</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span>, svp <span class="op">=</span> <span class="st">"symmetrical"</span><span class="op">)</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model2</span>, type <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model2</span>,
          type <span class="op">=</span> <span class="fl">2</span>,
          col.gen <span class="op">=</span> <span class="st">"black"</span>,
          col.env <span class="op">=</span> <span class="st">"gray70"</span>,
          axis.expand <span class="op">=</span> <span class="fl">1.5</span>,
          plot_theme <span class="op">=</span> <span class="fu"><a href="reference/themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-GGE-1.png"><!-- --></p>
</div>
<div class="section level1">
<h1 id="blup-model">BLUP model<a class="anchor" aria-label="anchor" href="#blup-model"></a>
</h1>
<p>Linear-mixed effect models to predict the response variable in METs are fitted using the function <a href="https://tiagoolivoto.github.io/metan/reference/gamem_met.html">gamem_met()</a>. Here we will obtain the predicted means for genotypes in the variables <code>GY</code> and <code>HM</code>. For more details, see the <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_blup.html">complete vignette</a>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model2</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="reference/gamem_met.html">gamem_met</a></span><span class="op">(</span><span class="va">data_ge</span>,
            env <span class="op">=</span> <span class="va">ENV</span>,
            gen <span class="op">=</span> <span class="va">GEN</span>,
            rep <span class="op">=</span> <span class="va">REP</span>,
            resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Evaluating trait GY |======================                      | 50% 00:00:00 Evaluating trait HM |============================================| 100% 00:00:01 </span>
<span class="co"># Method: REML/BLUP</span>
<span class="co"># Random effects: GEN, GEN:ENV</span>
<span class="co"># Fixed effects: ENV, REP(ENV)</span>
<span class="co"># Denominador DF: Satterthwaite's method</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#     model       GY       HM</span>
<span class="co">#  COMPLETE       NA       NA</span>
<span class="co">#       GEN 1.11e-05 5.07e-03</span>
<span class="co">#   GEN:ENV 2.15e-11 2.27e-15</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="co"># Get the variance components</span>
<span class="fu"><a href="reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model2</span>, what <span class="op">=</span> <span class="st">"vcomp"</span><span class="op">)</span>
<span class="co"># Class of the model: waasb</span>
<span class="co"># Variable extracted: vcomp</span>
<span class="co"># # A tibble: 3 × 3</span>
<span class="co">#   Group        GY    HM</span>
<span class="co">#   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co"># 1 GEN      0.0280 0.490</span>
<span class="co"># 2 GEN:ENV  0.0567 2.19 </span>
<span class="co"># 3 Residual 0.0967 2.84</span></code></pre></div>
<div class="section level2">
<h2 id="plotting-the-blups-for-genotypes">Plotting the BLUPs for genotypes<a class="anchor" aria-label="anchor" href="#plotting-the-blups-for-genotypes"></a>
</h2>
<p>To produce a plot with the predicted means, use the function <a href="https://tiagoolivoto.github.io/metan/reference/plot_blup.html"><code>plot_blup()</code></a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_blup.html">plot_blup</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_blup.html">plot_blup</a></span><span class="op">(</span><span class="va">model2</span>,
               prob <span class="op">=</span> <span class="fl">0.2</span>,
               col.shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray20"</span>, <span class="st">"gray80"</span><span class="op">)</span>,
               invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="reference/arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-BLUP-1.png"><!-- --></p>
</div>
</div>
<div class="section level1">
<h1 id="computing-parametric-and-non-parametric-stability-indexes">Computing parametric and non-parametric stability indexes<a class="anchor" aria-label="anchor" href="#computing-parametric-and-non-parametric-stability-indexes"></a>
</h1>
<p>The easiest way to compute parametric and non-parametric stability indexes in <code>metan</code> is by using the function <a href="https://tiagoolivoto.github.io/metan/reference/ge_stats.html"><code>ge_stats()</code></a>. It is a wrapper function around a lot of specific functions for stability indexes. To get the results into a <em>“ready-to-read”</em> file, use <a href="https://tiagoolivoto.github.io/metan/reference/get_model_data.html">get_model_data()</a> or its shortcut <a href="https://tiagoolivoto.github.io/metan/reference/get_model_data.html"><code>gmd()</code></a>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ge_stats.html">ge_stats</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span><span class="op">)</span>
<span class="co"># Evaluating trait GY |============================================| 100% 00:00:06 </span>
<span class="fu"><a href="reference/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span>
<span class="co"># Class of the model: ge_stats</span>
<span class="co"># Variable extracted: stats</span>
<span class="co"># # A tibble: 10 × 44</span>
<span class="co">#    var   GEN       Y    CV   ACV   POLAR   Var Shukla  Wi_g  Wi_f  Wi_u Ecoval</span>
<span class="co">#    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#  1 GY    G1     2.60  35.2  34.1  0.0298 10.9  0.0280  84.4  89.2  81.1  1.22 </span>
<span class="co">#  2 GY    G10    2.47  42.3  38.6  0.136  14.2  0.244   59.2  64.6  54.4  7.96 </span>
<span class="co">#  3 GY    G2     2.74  34.0  35.2  0.0570 11.3  0.0861  82.8  95.3  75.6  3.03 </span>
<span class="co">#  4 GY    G3     2.96  29.9  33.8  0.0216 10.1  0.0121 104.   99.7 107.   0.725</span>
<span class="co">#  5 GY    G4     2.64  31.4  31.0 -0.0537  8.93 0.0640  85.9  79.5  91.9  2.34 </span>
<span class="co">#  6 GY    G5     2.54  30.6  28.8 -0.119   7.82 0.0480  82.7  82.2  82.4  1.84 </span>
<span class="co">#  7 GY    G6     2.53  29.7  27.8 -0.147   7.34 0.0468  83.0  83.7  81.8  1.81 </span>
<span class="co">#  8 GY    G7     2.74  27.4  28.3 -0.133   7.33 0.122   83.9  77.6  93.4  4.16 </span>
<span class="co">#  9 GY    G8     3.00  30.4  35.1  0.0531 10.8  0.0712  98.8  90.5 107.   2.57 </span>
<span class="co"># 10 GY    G9     2.51  42.4  39.4  0.154  14.7  0.167   68.8  68.9  70.3  5.56 </span>
<span class="co"># # … with 32 more variables: bij &lt;dbl&gt;, Sij &lt;dbl&gt;, R2 &lt;dbl&gt;, ASTAB &lt;dbl&gt;,</span>
<span class="co"># #   ASI &lt;dbl&gt;, ASV &lt;dbl&gt;, AVAMGE &lt;dbl&gt;, DA &lt;dbl&gt;, DZ &lt;dbl&gt;, EV &lt;dbl&gt;, FA &lt;dbl&gt;,</span>
<span class="co"># #   MASI &lt;dbl&gt;, MASV &lt;dbl&gt;, SIPC &lt;dbl&gt;, ZA &lt;dbl&gt;, WAAS &lt;dbl&gt;, WAASB &lt;dbl&gt;,</span>
<span class="co"># #   HMGV &lt;dbl&gt;, RPGV &lt;dbl&gt;, HMRPGV &lt;dbl&gt;, Pi_a &lt;dbl&gt;, Pi_f &lt;dbl&gt;, Pi_u &lt;dbl&gt;,</span>
<span class="co"># #   Gai &lt;dbl&gt;, S1 &lt;dbl&gt;, S2 &lt;dbl&gt;, S3 &lt;dbl&gt;, S6 &lt;dbl&gt;, N1 &lt;dbl&gt;, N2 &lt;dbl&gt;,</span>
<span class="co"># #   N3 &lt;dbl&gt;, N4 &lt;dbl&gt;</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"metan"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Please, support this project by citing it <span class="cf">in</span> your publications<span class="sc">!</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  Olivoto, T., and Lúcio, <span class="fu">A.D.</span> (<span class="dv">2020</span>). metan<span class="sc">:</span> an R package <span class="cf">for</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  multi<span class="sc">-</span>environment trial analysis. Methods Ecol Evol. <span class="dv">11</span><span class="sc">:</span><span class="dv">783-789</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  doi<span class="sc">:</span><span class="fl">10.1111</span><span class="sc">/</span><span class="dv">2041</span><span class="sc">-</span>210X<span class="fl">.13384</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>A BibTeX entry <span class="cf">for</span> LaTeX users is</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">@</span>Article{Olivoto2020,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    author <span class="ot">=</span> {Tiago Olivoto and Alessandro Dal<span class="st">'Col L{'</span>{u}}cio},</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">=</span> {metan<span class="sc">:</span> an R package <span class="cf">for</span> multi<span class="sc">-</span>environment trial analysis},</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    journal <span class="ot">=</span> {Methods <span class="cf">in</span> Ecology and Evolution},</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    volume <span class="ot">=</span> {<span class="dv">11</span>},</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    number <span class="ot">=</span> {<span class="dv">6</span>},</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    pages <span class="ot">=</span> {<span class="dv">783-789</span>},</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    year <span class="ot">=</span> {<span class="dv">2020</span>},</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    doi <span class="ot">=</span> {<span class="fl">10.1111</span><span class="sc">/</span><span class="dv">2041</span><span class="sc">-</span>210X<span class="fl">.13384</span>},</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="er">}</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h1>
<ul>
<li><p>If you encounter a clear bug, please file a minimal reproducible example on <a href="https://github.com/TiagoOlivoto/metan/issues" class="external-link">github</a></p></li>
<li><p>Suggestions and criticisms to improve the quality and usability of the package are welcome!</p></li>
</ul>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=metan" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/TiagoOlivoto/metan/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/TiagoOlivoto/metan/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing metan</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a> <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-0241-9636" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=metan" class="external-link"><img src="https://www.r-pkg.org/badges/version-ago/metan" alt="CRAN status"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable-1" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/130062661" class="external-link"><img src="https://zenodo.org/badge/130062661.svg" alt="DOI" width="186"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
