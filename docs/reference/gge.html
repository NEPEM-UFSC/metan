<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Produces genotype plus genotype-by-environment model based on a multi-environment
trial dataset containing at least the columns for genotypes, environments and one
response variable or a two-way table."><title>Genotype plus genotype-by-environment model — gge • metan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Genotype plus genotype-by-environment model — gge"><meta property="og:description" content="
Produces genotype plus genotype-by-environment model based on a multi-environment
trial dataset containing at least the columns for genotypes, environments and one
response variable or a two-way table."><meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.18.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a>
    <a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    <a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    <a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a>
    <a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a>
    <a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a>
    <a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="../SUPPORT.html">Support</a>
    <a class="dropdown-item" href="../LICENSE.html">Licence</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Genotype plus genotype-by-environment model</h1>
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/HEAD/R/gge.R" class="external-link"><code>R/gge.R</code></a></small>
      <div class="d-none name"><code>gge.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Produces genotype plus genotype-by-environment model based on a multi-environment
trial dataset containing at least the columns for genotypes, environments and one
response variable or a two-way table.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gge</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">env</span>,</span>
<span>  <span class="va">gen</span>,</span>
<span>  <span class="va">resp</span>,</span>
<span>  centering <span class="op">=</span> <span class="st">"environment"</span>,</span>
<span>  scaling <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  svp <span class="op">=</span> <span class="st">"environment"</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.data</dt>
<dd><p>The dataset containing the columns related to Environments, Genotypes
and the response variable(s).</p></dd>


<dt>env</dt>
<dd><p>The name of the column that contains the levels of the environments.</p></dd>


<dt>gen</dt>
<dd><p>The name of the column that contains the levels of the genotypes.</p></dd>


<dt>resp</dt>
<dd><p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also supported.</p></dd>


<dt>centering</dt>
<dd><p>The centering method. Must be one of the <code>'none | 0'</code>, for no
centering; <code>'global | 1'</code>, for global centered (E+G+GE); <code>'environment | 2'</code> (default),
for environment-centered (G+GE); or <code>'double | 3'</code>, for double centered (GE).
A biplot cannot be produced with models produced without centering.</p></dd>


<dt>scaling</dt>
<dd><p>The scaling method. Must be one of the <code>'none | 0'</code> (default), for no scaling;
or <code>'sd | 1'</code>, where each value is divided by the standard deviation of its corresponding
environment (column). This will put all environments roughly he same rang of values.</p></dd>


<dt>svp</dt>
<dd><p>The method for singular value partitioning. Must be one of the <code>'genotype | 1'</code>,
(The singular value is entirely partitioned into the genotype eigenvectors, also called row
metric preserving); <code>'environment | 2'</code>, default, (The singular value is entirely partitioned into the
environment eigenvectors, also called column metric preserving); or <code>'symmetrical | 3'</code>
(The singular value is symmetrically partitioned into the genotype and the environment eigenvectors
This SVP is most often used in AMMI analysis and other biplot analysis, but it is not ideal for
visualizing either the relationship among genotypes or that among the environments).</p></dd>


<dt>by</dt>
<dd><p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">dplyr::group_by()</a></code>.This is especially useful, for example,
when the researcher want to produce GGE biplots for each level of a
categorical variable. In this case, an object of class gge_grouped is
returned.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed to the function
<code><a href="impute_missing_val.html">impute_missing_val()</a></code> for imputation of missing values in case
of unbalanced data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The function returns a list of class <code>gge</code> containing the following objects</p><ul><li><p><strong>coordgen</strong> The coordinates for genotypes for all components.</p></li>
<li><p><strong>coordenv</strong> The coordinates for environments for all components.</p></li>
<li><p><strong>eigenvalues</strong> The vector of eigenvalues.</p></li>
<li><p><strong>totalvar</strong> The overall variance.</p></li>
<li><p><strong>labelgen</strong> The name of the genotypes.</p></li>
<li><p><strong>labelenv</strong> The names of the environments.</p></li>
<li><p><strong>labelaxes</strong> The axes labels.</p></li>
<li><p><strong>ge_mat</strong> The data used to produce the model (scaled and centered).</p></li>
<li><p><strong>centering</strong> The centering method.</p></li>
<li><p><strong>scaling</strong> The scaling method.</p></li>
<li><p><strong>svp</strong> The singular value partitioning method.</p></li>
<li><p><strong>d</strong> The factor used to generate in which the ranges of genotypes and environments
are comparable when singular value partitioning is set to 'genotype' or 'environment'.</p></li>
<li><p><strong>grand_mean</strong> The grand mean of the trial.</p></li>
<li><p><strong>mean_gen</strong> A vector with the means of the genotypes.</p></li>
<li><p><strong>mean_env</strong> A vector with the means of the environments.</p></li>
<li><p><strong>scale_var</strong> The scaling vector when the scaling method is <code>'sd'</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Yan, W., and M.S. Kang. 2003. GGE biplot analysis: a graphical tool for breeders,
geneticists, and agronomists. CRC Press.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">gge</span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">GY</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gge-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># GGE model for all numeric variables</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">gge</span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span>, var <span class="op">=</span> <span class="st">"ED"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gge-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If we have a two-way table with the mean values for</span></span></span>
<span class="r-in"><span><span class="co"># genotypes and environments</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_mat.html">make_mat</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">GEN</span>, <span class="va">ENV</span>, <span class="va">GY</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">table</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       E1  E10  E11  E12  E13  E14   E2   E3   E4   E5   E6   E7   E8   E9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1  2.37 2.31 1.36 1.34 3.00 1.53 3.04 4.08 3.49 4.17 2.81 1.90 2.27 2.78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G10 1.97 1.54 0.90 1.02 1.83 1.86 3.15 4.11 4.27 3.37 2.48 2.24 2.70 3.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2  2.90 2.30 1.49 1.99 3.03 1.43 3.23 4.57 3.72 3.83 2.54 1.99 2.05 3.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G3  2.89 2.34 1.57 1.76 3.47 2.06 3.61 4.13 4.13 4.13 2.98 2.16 2.85 3.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G4  2.59 2.17 1.37 1.53 2.64 1.86 3.19 3.85 3.30 3.78 2.70 1.98 2.30 3.72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G5  2.19 2.14 1.33 1.69 2.57 1.78 3.14 3.74 3.38 3.47 2.43 1.66 2.71 3.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G6  2.30 2.21 1.50 1.39 2.91 1.80 3.29 3.43 3.40 3.57 2.34 1.76 2.54 3.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G7  2.77 2.44 1.36 1.95 3.18 1.94 2.61 4.10 3.02 4.05 2.67 2.55 2.58 3.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G8  2.90 2.57 1.68 2.00 3.52 1.99 3.44 4.11 4.14 4.81 2.91 2.26 2.88 2.83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G9  2.33 1.74 1.13 1.41 2.95 1.57 3.09 4.51 3.90 3.93 2.77 1.39 2.49 1.94</span>
<span class="r-in"><span><span class="fu"><a href="make_long.html">make_long</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu">gge</span><span class="op">(</span><span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">Y</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gge-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

