<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Compute the Weighted Average of Absolute Scores for AMMI analysis (Olivoto et
al., 2019).
This function compute the weighted average of absolute scores, estimated as
follows:


\[WAAS_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k =
1}^{p}EP_k\]
where \(WAAS_i\) is the weighted average of absolute scores of the
ith genotype; \(IPCA_{ik}\) is the score of the ith genotype
in the kth IPCA; and \(EP_k\) is the explained variance of the kth
IPCA for k = 1,2,..,p, considering p the number of significant
PCAs, or a declared number of PCAs. For example if prob = 0.05, all
axis that are significant considering this probability level are used. The
number of axis can be also informed by declaring naxis = x. This will
override the number of significant axes according to the argument codeprob."><title>Weighted Average of Absolute Scores — waas • metan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weighted Average of Absolute Scores — waas"><meta property="og:description" content="
Compute the Weighted Average of Absolute Scores for AMMI analysis (Olivoto et
al., 2019).
This function compute the weighted average of absolute scores, estimated as
follows:


\[WAAS_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k =
1}^{p}EP_k\]
where \(WAAS_i\) is the weighted average of absolute scores of the
ith genotype; \(IPCA_{ik}\) is the score of the ith genotype
in the kth IPCA; and \(EP_k\) is the explained variance of the kth
IPCA for k = 1,2,..,p, considering p the number of significant
PCAs, or a declared number of PCAs. For example if prob = 0.05, all
axis that are significant considering this probability level are used. The
number of axis can be also informed by declaring naxis = x. This will
override the number of significant axes according to the argument codeprob."><meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a>
    <a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    <a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    <a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a>
    <a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a>
    <a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a>
    <a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="../SUPPORT.html">Support</a>
    <a class="dropdown-item" href="../LICENSE.html">Licence</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Weighted Average of Absolute Scores</h1>
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/HEAD/R/waas.R" class="external-link"><code>R/waas.R</code></a></small>
      <div class="d-none name"><code>waas.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Compute the Weighted Average of Absolute Scores for AMMI analysis (Olivoto et
al., 2019).</p>
<p>This function compute the weighted average of absolute scores, estimated as
follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>

\[WAAS_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k =
1}^{p}EP_k\]</p>
<p>where <em></em>\(WAAS_i\) is the weighted average of absolute scores of the
<em>i</em>th genotype; <em></em>\(IPCA_{ik}\) is the score of the <em>i</em>th genotype
in the <em>k</em>th IPCA; and <em></em>\(EP_k\) is the explained variance of the <em>k</em>th
IPCA for <em>k = 1,2,..,p</em>, considering <em>p</em> the number of significant
PCAs, or a declared number of PCAs. For example if <code>prob = 0.05</code>, all
axis that are significant considering this probability level are used. The
number of axis can be also informed by declaring <code>naxis = x</code>. This will
override the number of significant axes according to the argument codeprob.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">waas</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">env</span>,</span>
<span>  <span class="va">gen</span>,</span>
<span>  <span class="va">rep</span>,</span>
<span>  <span class="va">resp</span>,</span>
<span>  block <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mresp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  wresp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  naxis <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ind_anova <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.data</dt>
<dd><p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p></dd>


<dt>env</dt>
<dd><p>The name of the column that contains the levels of the
environments.</p></dd>


<dt>gen</dt>
<dd><p>The name of the column that contains the levels of the genotypes.</p></dd>


<dt>rep</dt>
<dd><p>The name of the column that contains the levels of the
replications/blocks.</p></dd>


<dt>resp</dt>
<dd><p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p></dd>


<dt>block</dt>
<dd><p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p></dd>


<dt>mresp</dt>
<dd><p>The new maximum value after rescaling the response variable. By
default, all variables in <code>resp</code> are rescaled so that de maximum value
is 100 and the minimum value is 0 (i.e., <code>mresp = NULL</code>). It must be a
character vector of the same length of <code>resp</code> if rescaling is assumed
to be different across variables, e.g., if for the first variable smaller
values are better and for the second one, higher values are better, then
<code>mresp = c("l, h")</code> must be used. Character value of length 1 will be
recycled with a warning message.</p></dd>


<dt>wresp</dt>
<dd><p>The weight for the response variable(s) for computing the WAASBY
index. By default, all variables in <code>resp</code> have equal weights for mean
performance and stability (i.e., <code>wresp = 50</code>). It must be a numeric
vector of the same length of <code>resp</code> to assign different weights across
variables, e.g., if for the first variable equal weights for mean
performance and stability are assumed and for the second one, a higher
weight for mean performance (e.g. 65) is assumed, then <code>wresp = c(50, 65)</code> must be used. Numeric value of length 1 will be recycled with a
warning message.</p></dd>


<dt>prob</dt>
<dd><p>The p-value for considering an interaction principal component
axis significant.</p></dd>


<dt>naxis</dt>
<dd><p>The number of IPCAs to be used for computing the WAAS index.
Default is <code>NULL</code> (Significant IPCAs are used). If values are
informed, the number of IPCAS will be used independently on its
significance. Note that if two or more variables are included in
<code>resp</code>, then <code>naxis</code> must be a vector.</p></dd>


<dt>ind_anova</dt>
<dd><p>Logical argument set to <code>FALSE</code>. If <code>TRUE</code> an
within-environment ANOVA is performed.</p></dd>


<dt>verbose</dt>
<dd><p>Logical argument. If <code>verbose = FALSE</code> the code is run
silently.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>waas</code> with the following items for each
variable:</p><ul><li><p><strong>individual</strong> A within-environments ANOVA considering a fixed-effect
model.</p></li>
<li><p><strong>model</strong> A data frame with the response variable, the scores of all
Principal Components, the estimates of Weighted Average of Absolute Scores,
and WAASY (the index that consider the weights for stability and productivity
in the genotype ranking.</p></li>
<li><p><strong>MeansGxE</strong> The means of genotypes in the environments</p></li>
<li><p><strong>PCA</strong> Principal Component Analysis.</p></li>
<li><p><strong>ANOVA</strong> Joint analysis of variance for the main effects and
Principal Component analysis of the interaction effect.</p></li>
<li><p><strong>Details</strong> A list summarizing the results. The following information
are showed. <code>WgtResponse</code>, the weight for the response variable in
estimating WAASB, <code>WgtWAAS</code> the weight for stability, <code>Ngen</code> the
number of genotypes, <code>Nenv</code> the number of environments, <code>OVmean</code>
the overall mean, <code>Min</code> the minimum observed (returning the genotype and
environment), <code>Max</code> the maximum observed, <code>Max</code> the maximum
observed, <code>MinENV</code> the environment with the lower mean, <code>MaxENV</code>
the environment with the larger mean observed, <code>MinGEN</code> the genotype
with the lower mean, <code>MaxGEN</code> the genotype with the larger.</p></li>
<li><p><strong>augment:</strong> Information about each observation in the dataset. This
includes predicted values in the <code>fitted</code> column, residuals in the
<code>resid</code> column, standardized residuals in the <code>stdres</code> column,
the diagonal of the 'hat' matrix in the <code>hat</code>, and standard errors for
the fitted values in the <code>se.fit</code> column.</p></li>
<li><p><strong>probint</strong> The p-value for the genotype-vs-environment interaction.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, V.S. Marchioro,
V.Q. de Souza, and E. Jost. 2019a. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960. <a href="https://doi.org/10.2134/agronj2019.03.0220" class="external-link">doi:10.2134/agronj2019.03.0220</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="waas_means.html">waas_means()</a></code> <code><a href="waasb.html">waasb()</a></code> <code><a href="get_model_data.html">get_model_data()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#===============================================================#</span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Analyzing all numeric variables considering p-value#</span></span></span>
<span class="r-in"><span><span class="co"># &lt;= 0.05 to compute the WAAS.                                  #</span></span></span>
<span class="r-in"><span><span class="co">#===============================================================#</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">waas</span><span class="op">(</span><span class="va">data_ge</span>,</span></span>
<span class="r-in"><span>             env <span class="op">=</span> <span class="va">ENV</span>,</span></span>
<span class="r-in"><span>             gen <span class="op">=</span> <span class="va">GEN</span>,</span></span>
<span class="r-in"><span>             rep <span class="op">=</span> <span class="va">REP</span>,</span></span>
<span class="r-in"><span>             resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variable GY </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMMI analysis table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ENV  13 279.574 21.5057   62.33 0.00e+00         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   REP(ENV)  28   9.662  0.3451    3.57 3.59e-08         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        GEN   9  12.995  1.4439   14.93 2.19e-19         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN:ENV 117  31.220  0.2668    2.76 1.01e-11         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC1  21  10.749  0.5119    5.29 0.00e+00       34.4        34.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC2  19   9.924  0.5223    5.40 0.00e+00       31.8        66.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC3  17   4.039  0.2376    2.46 1.40e-03       12.9        79.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC4  15   3.074  0.2049    2.12 9.60e-03        9.8        89.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC5  13   1.446  0.1113    1.15 3.18e-01        4.6        93.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC6  11   0.932  0.0848    0.88 5.61e-01        3.0        96.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC7   9   0.567  0.0630    0.65 7.53e-01        1.8        98.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC8   7   0.362  0.0518    0.54 8.04e-01        1.2        99.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC9   5   0.126  0.0252    0.26 9.34e-01        0.4       100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residuals 252  24.367  0.0967      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total 536 389.036  0.7258      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variable HM </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMMI analysis table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ENV  13 5710.32 439.255   57.22 1.11e-16         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   REP(ENV)  28  214.93   7.676    2.70 2.20e-05         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        GEN   9  269.81  29.979   10.56 7.41e-14         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN:ENV 117 1100.73   9.408    3.31 1.06e-15         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC1  21  381.13  18.149    6.39 0.00e+00       34.6        34.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC2  19  319.43  16.812    5.92 0.00e+00       29.0        63.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC3  17  114.26   6.721    2.37 2.10e-03       10.4        74.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC4  15   81.96   5.464    1.92 2.18e-02        7.4        81.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC5  13   68.11   5.240    1.84 3.77e-02        6.2        87.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC6  11   59.07   5.370    1.89 4.10e-02        5.4        93.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC7   9   46.69   5.188    1.83 6.33e-02        4.2        97.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC8   7   26.65   3.808    1.34 2.32e-01        2.4        99.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC9   5    3.41   0.682    0.24 9.45e-01        0.3       100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residuals 252  715.69   2.840      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total 536 9112.21  17.000      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done!</span>
<span class="r-in"><span><span class="co"># Residual plot (first variable)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="waas-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the WAAS index</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"WAAS"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Class of the model: waas</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Variable extracted: WAAS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN      GY    HM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> G1    0.151 0.455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> G10   0.652 1.33 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> G2    0.283 0.985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> G3    0.106 0.418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> G4    0.326 0.752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> G5    0.270 1.16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> G6    0.233 0.478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> G7    0.428 0.766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> G8    0.327 0.541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> G9    0.507 0.701</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot WAAS and response variable</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="waas-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#===============================================================#</span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Declaring the number of axis to be used for        #</span></span></span>
<span class="r-in"><span><span class="co"># computing WAAS and assigning a larger weight for the response #</span></span></span>
<span class="r-in"><span><span class="co"># variable when computing the WAASBY index.                     #</span></span></span>
<span class="r-in"><span><span class="co">#===============================================================#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu">waas</span><span class="op">(</span><span class="va">data_ge</span>,</span></span>
<span class="r-in"><span>               env <span class="op">=</span> <span class="va">ENV</span>,</span></span>
<span class="r-in"><span>               gen <span class="op">=</span> <span class="va">GEN</span>,</span></span>
<span class="r-in"><span>               rep <span class="op">=</span> <span class="va">REP</span>,</span></span>
<span class="r-in"><span>               resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               naxis <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Only to compare with PC1</span></span></span>
<span class="r-in"><span>               wresp <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Invalid length in 'naxis'. Setting naxis = 1 to all the 2 variables.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Invalid length in 'wresp'. Setting wresp = 60 to all the 2 variables.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variable GY </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMMI analysis table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ENV  13 279.574 21.5057   62.33 0.00e+00         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   REP(ENV)  28   9.662  0.3451    3.57 3.59e-08         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        GEN   9  12.995  1.4439   14.93 2.19e-19         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN:ENV 117  31.220  0.2668    2.76 1.01e-11         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC1  21  10.749  0.5119    5.29 0.00e+00       34.4        34.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC2  19   9.924  0.5223    5.40 0.00e+00       31.8        66.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC3  17   4.039  0.2376    2.46 1.40e-03       12.9        79.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC4  15   3.074  0.2049    2.12 9.60e-03        9.8        89.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC5  13   1.446  0.1113    1.15 3.18e-01        4.6        93.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC6  11   0.932  0.0848    0.88 5.61e-01        3.0        96.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC7   9   0.567  0.0630    0.65 7.53e-01        1.8        98.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC8   7   0.362  0.0518    0.54 8.04e-01        1.2        99.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC9   5   0.126  0.0252    0.26 9.34e-01        0.4       100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residuals 252  24.367  0.0967      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total 536 389.036  0.7258      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variable HM </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMMI analysis table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ENV  13 5710.32 439.255   57.22 1.11e-16         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   REP(ENV)  28  214.93   7.676    2.70 2.20e-05         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        GEN   9  269.81  29.979   10.56 7.41e-14         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN:ENV 117 1100.73   9.408    3.31 1.06e-15         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC1  21  381.13  18.149    6.39 0.00e+00       34.6        34.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC2  19  319.43  16.812    5.92 0.00e+00       29.0        63.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC3  17  114.26   6.721    2.37 2.10e-03       10.4        74.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC4  15   81.96   5.464    1.92 2.18e-02        7.4        81.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC5  13   68.11   5.240    1.84 3.77e-02        6.2        87.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC6  11   59.07   5.370    1.89 4.10e-02        5.4        93.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC7   9   46.69   5.188    1.83 6.33e-02        4.2        97.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC8   7   26.65   3.808    1.34 2.32e-01        2.4        99.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC9   5    3.41   0.682    0.24 9.45e-01        0.3       100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residuals 252  715.69   2.840      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total 536 9112.21  17.000      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done!</span>
<span class="r-in"><span><span class="co"># Get the WAAS index (it will be |PC1|)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Class of the model: waas</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Variable extracted: WAAS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN       GY     HM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> G1    0.317  0.280 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> G10   1.00   1.78  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> G2    0.139  1.56  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> G3    0.043<span style="text-decoration: underline;">4</span> 0.342 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> G4    0.325  0.202 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> G5    0.326  1.58  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> G6    0.098<span style="text-decoration: underline;">4</span> 0.547 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> G7    0.285  1.22  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> G8    0.499  0.041<span style="text-decoration: underline;">8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> G9    0.467  1.07  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get values for IPCA1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model2</span>, <span class="st">"PC1"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Class of the model: waas</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Variable extracted: PC1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN        GY      HM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> G1     0.317   0.280 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> G10   -<span style="color: #BB0000;">1.00</span>   -<span style="color: #BB0000;">1.78</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> G2     0.139   1.56  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> G3     0.043<span style="text-decoration: underline;">4</span>  0.342 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> G4    -<span style="color: #BB0000;">0.325</span>  -<span style="color: #BB0000;">0.202</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> G5    -<span style="color: #BB0000;">0.326</span>   1.58  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> G6    -<span style="color: #BB0000;">0.098</span><span style="color: #BB0000; text-decoration: underline;">4</span>  0.547 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> G7     0.285  -<span style="color: #BB0000;">1.22</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> G8     0.499  -<span style="color: #BB0000;">0.041</span><span style="color: #BB0000; text-decoration: underline;">8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> G9     0.467  -<span style="color: #BB0000;">1.07</span>  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#===============================================================#</span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Analyzing GY and HM assuming a random-effect model.#</span></span></span>
<span class="r-in"><span><span class="co"># Smaller values for HM and higher values for GY are better.    #</span></span></span>
<span class="r-in"><span><span class="co"># To estimate WAASBY, higher weight for the GY (60%) and lower  #</span></span></span>
<span class="r-in"><span><span class="co"># weight for HM (40%) are considered for mean performance.      #</span></span></span>
<span class="r-in"><span><span class="co">#===============================================================#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu">waas</span><span class="op">(</span><span class="va">data_ge</span>,</span></span>
<span class="r-in"><span>               env <span class="op">=</span> <span class="va">ENV</span>,</span></span>
<span class="r-in"><span>               gen <span class="op">=</span> <span class="va">GEN</span>,</span></span>
<span class="r-in"><span>               rep <span class="op">=</span> <span class="va">REP</span>,</span></span>
<span class="r-in"><span>               resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">GY</span>, <span class="va">HM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               mresp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h, l"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               wresp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variable GY </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMMI analysis table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ENV  13 279.574 21.5057   62.33 0.00e+00         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   REP(ENV)  28   9.662  0.3451    3.57 3.59e-08         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        GEN   9  12.995  1.4439   14.93 2.19e-19         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN:ENV 117  31.220  0.2668    2.76 1.01e-11         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC1  21  10.749  0.5119    5.29 0.00e+00       34.4        34.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC2  19   9.924  0.5223    5.40 0.00e+00       31.8        66.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC3  17   4.039  0.2376    2.46 1.40e-03       12.9        79.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC4  15   3.074  0.2049    2.12 9.60e-03        9.8        89.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC5  13   1.446  0.1113    1.15 3.18e-01        4.6        93.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC6  11   0.932  0.0848    0.88 5.61e-01        3.0        96.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC7   9   0.567  0.0630    0.65 7.53e-01        1.8        98.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC8   7   0.362  0.0518    0.54 8.04e-01        1.2        99.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC9   5   0.126  0.0252    0.26 9.34e-01        0.4       100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residuals 252  24.367  0.0967      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total 536 389.036  0.7258      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variable HM </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMMI analysis table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ENV  13 5710.32 439.255   57.22 1.11e-16         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   REP(ENV)  28  214.93   7.676    2.70 2.20e-05         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        GEN   9  269.81  29.979   10.56 7.41e-14         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN:ENV 117 1100.73   9.408    3.31 1.06e-15         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC1  21  381.13  18.149    6.39 0.00e+00       34.6        34.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC2  19  319.43  16.812    5.92 0.00e+00       29.0        63.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC3  17  114.26   6.721    2.37 2.10e-03       10.4        74.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC4  15   81.96   5.464    1.92 2.18e-02        7.4        81.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC5  13   68.11   5.240    1.84 3.77e-02        6.2        87.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC6  11   59.07   5.370    1.89 4.10e-02        5.4        93.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC7   9   46.69   5.188    1.83 6.33e-02        4.2        97.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC8   7   26.65   3.808    1.34 2.32e-01        2.4        99.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC9   5    3.41   0.682    0.24 9.45e-01        0.3       100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residuals 252  715.69   2.840      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total 536 9112.21  17.000      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the ranks for the WAASY index</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model3</span>, what <span class="op">=</span> <span class="st">"OrWAASY"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Class of the model: waas</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Variable extracted: OrWAASY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN      GY    HM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> G1        4     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> G10      10     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> G2        3     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> G3        1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> G4        6     7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> G5        8    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> G6        7     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> G7        5     6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> G8        2     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> G9        9     5</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

