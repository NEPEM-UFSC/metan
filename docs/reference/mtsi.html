<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Computes the multi-trait stability index proposed by Olivoto et al. (2019)"><title>Multi-trait stability index — mtsi • metan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-trait stability index — mtsi"><meta property="og:description" content="
Computes the multi-trait stability index proposed by Olivoto et al. (2019)"><meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.18.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a>
    <a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    <a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    <a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a>
    <a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a>
    <a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a>
    <a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="../SUPPORT.html">Support</a>
    <a class="dropdown-item" href="../LICENSE.html">Licence</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multi-trait stability index</h1>
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/HEAD/R/mtsi.R" class="external-link"><code>R/mtsi.R</code></a></small>
      <div class="d-none name"><code>mtsi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Computes the multi-trait stability index proposed by Olivoto et al. (2019)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mtsi</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  index <span class="op">=</span> <span class="st">"waasby"</span>,</span>
<span>  ideotype <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  SI <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  mineval <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.data</dt>
<dd><p>An object of class <code>waasb</code> or <code>waas</code>.</p></dd>


<dt>index</dt>
<dd><p>If <code>index = 'waasby'</code> (default) both stability and mean
performance are considered. If <code>index = 'waasb'</code> the multi-trait index
will be computed considering the stability of genotypes only.  More details
can be seen in <code><a href="waasb.html">waasb()</a></code> and <code><a href="waas.html">waas()</a></code> functions.</p></dd>


<dt>ideotype</dt>
<dd><p>A vector of length <code>nvar</code> where <code>nvar</code> is the
number of variables used to plan the ideotype. Use <code>'h'</code> to indicate
the traits in which higher values are desired or <code>'l'</code> to indicate the
variables in which lower values are desired. For example, <code>ideotype = c("h, h, h, h, l")</code> will consider that the ideotype has higher values for
the first four traits and lower values for the last trait.</p></dd>


<dt>SI</dt>
<dd><p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p></dd>


<dt>mineval</dt>
<dd><p>The minimum value so that an eigenvector is retained in the
factor analysis.</p></dd>


<dt>verbose</dt>
<dd><p>If <code>verbose = TRUE</code> (Default) then some results are
shown in the console.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>mtsi</code> with the following items:</p><ul><li><p><strong>data</strong> The data used to compute the factor analysis.</p></li>
<li><p><strong>cormat</strong> The correlation matrix among the environments.</p></li>
<li><p><strong>PCA</strong> The eigenvalues and explained variance.</p></li>
<li><p><strong>FA</strong> The factor analysis.</p></li>
<li><p><strong>KMO</strong> The result for the Kaiser-Meyer-Olkin test.</p></li>
<li><p><strong>MSA</strong> The measure of sampling adequacy for individual variable.</p></li>
<li><p><strong>communalities</strong> The communalities.</p></li>
<li><p><strong>communalities_mean</strong> The communalities' mean.</p></li>
<li><p><strong>initial_loadings</strong> The initial loadings.</p></li>
<li><p><strong>finish_loadings</strong> The final loadings after varimax rotation.</p></li>
<li><p><strong>canonical_loadings</strong> The canonical loadings.</p></li>
<li><p><strong>scores_gen</strong> The scores for genotypes in all retained factors.</p></li>
<li><p><strong>scores_ide</strong> The scores for the ideotype in all retained factors.</p></li>
<li><p><strong>MTSI</strong> The multi-trait stability index.</p></li>
<li><p><strong>contri_fac</strong> The relative contribution of each factor on the MTSI
value. The lower the contribution of a factor, the close of the ideotype the
variables in such factor are.</p></li>
<li><p><strong>contri_fac_rank, contri_fac_rank_sel</strong> The rank for the contribution
of each factor for all genotypes and selected genotypes, respectively.</p></li>
<li><p><strong>sel_dif_trait, sel_dif_stab, sel_dif_mps</strong> A data frame containing the
selection differential (gains) for the traits, for the stability (WAASB
index) WAASB, and for the mean performance and stability (WAASBY indexes).
The following variables are shown.</p><ul><li><p><code>VAR</code>: the trait's name.</p></li>
<li><p><code>Factor</code>: The factor that traits where grouped into.</p></li>
<li><p><code>Xo</code>: The original population mean.</p></li>
<li><p><code>Xs</code>: The mean of selected genotypes.</p></li>
<li><p><code>SD</code> and <code>SDperc</code>: The selection differential and selection differential in
percentage, respectively.</p></li>
<li><p><code>h2</code>: The broad-sense heritability.</p></li>
<li><p><code>SG</code> and <code>SGperc</code>: The selection gains and selection gains in percentage,
respectively.</p></li>
<li><p><code>sense</code>: The desired selection sense.</p></li>
<li><p><code>goal</code>: selection gains match desired sense? 100 for yes and 0 for no.</p></li>
</ul></li>
<li><p><strong>stat_dif_var, stat_dif_stab, stat_dif_mps</strong> A data frame with the
descriptive statistic for the selection gains for the traits, for the
stability (WAASB index) WAASB, and for the mean performance and stability
(WAASBY index).
The following variables are shown.</p><ul><li><p><code>sense</code>: The desired selection sense.</p></li>
<li><p><code>variable</code>: the trait's name.</p></li>
<li><p><code>min</code>: the minimum value for the selection gain.</p></li>
<li><p><code>mean</code>: the mean value for the selection gain.</p></li>
<li><p><code>ci</code>: the confidence interval for the selection gain.</p></li>
<li><p><code>sd.amo</code>: the standard deviation for the selection gain.</p></li>
<li><p><code>max</code>: the maximum value for the selection gain.</p></li>
<li><p><code>sum</code>: the sum of the selection gain.</p></li>
</ul></li>
<li><p><strong>sel_gen</strong> The selected genotypes.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, B.G. Sari, and
M.I. Diel. 2019. Mean performance and stability in multi-environment trials
II: Selection based on multiple traits. Agron. J. 111:2961-2969.
<a href="https://doi.org/10.2134/agronj2019.03.0220" class="external-link">doi:10.2134/agronj2019.03.0220</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mgidi.html">mgidi()</a></code>, <code><a href="waasb.html">waasb()</a></code>, <code><a href="get_model_data.html">get_model_data()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Based on stability only, for both GY and HM, higher is better</span></span></span>
<span class="r-in"><span><span class="va">mtsi_model</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="waasb.html">waasb</a></span><span class="op">(</span><span class="va">data_ge</span>,</span></span>
<span class="r-in"><span>    env <span class="op">=</span> <span class="va">ENV</span>,</span></span>
<span class="r-in"><span>    gen <span class="op">=</span> <span class="va">GEN</span>,</span></span>
<span class="r-in"><span>    rep <span class="op">=</span> <span class="va">REP</span>,</span></span>
<span class="r-in"><span>    resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">GY</span>, <span class="va">HM</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Evaluating trait GY |======================                      | 50% 00:00:02 Evaluating trait HM |============================================| 100% 00:00:04 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Method: REML/BLUP</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Random effects: GEN, GEN:ENV</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effects: ENV, REP(ENV)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Denominador DF: Satterthwaite's method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model       GY       HM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  COMPLETE       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       GEN 1.11e-05 5.07e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GEN:ENV 2.15e-11 2.27e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-in"><span><span class="va">mtsi_index</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">mtsi</span><span class="op">(</span><span class="va">mtsi_model</span>, index <span class="op">=</span> <span class="st">'waasb'</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Row(s) 2 with NA values deleted.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Non-numeric variable(s) ENV, GEN, Y will not be selected.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Use 'find_text_in_num()' to see rows with non-numeric characteres.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Principal Component Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PC    Eigenvalues `Variance (%)` `Cum. variance (%)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> PC1         1.66            82.8                82.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> PC2         0.343           17.2               100  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Analysis - factorial loadings after rotation-</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   VAR     FA1 Communality Uniquenesses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> GY    0.910       0.828        0.172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> HM    0.910       0.828        0.172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comunalit Mean: 0.8283129 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selection differential for the  waasb index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   VAR   Factor    Xo    Xs     SD SDperc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> GY    FA 1   0.250 0.117 -<span style="color: #BB0000;">0.134</span>  -<span style="color: #BB0000;">53.5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> HM    FA 1   0.614 0.373 -<span style="color: #BB0000;">0.241</span>  -<span style="color: #BB0000;">39.2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selection differential for the mean of the variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   VAR   Factor    Xo    Xs     SD SDperc    h2      SG SGperc sense     goal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> GY    FA 1    2.67  2.78  0.105   3.94 0.815  0.085<span style="text-decoration: underline;">8</span>   3.21 increase   100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> HM    FA 1   48.1  47.3  -<span style="color: #BB0000;">0.747</span>  -<span style="color: #BB0000;">1.55</span> 0.686 -<span style="color: #BB0000;">0.512</span>   -<span style="color: #BB0000;">1.07</span> increase     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selected genotypes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G3 G1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Row(s) 4 with NA values deleted.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Non-numeric variable(s) ENV, GEN, Y will not be selected.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Use 'find_text_in_num()' to see rows with non-numeric characteres.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Based on mean performance and stability (using pipe operator %&gt;%)</span></span></span>
<span class="r-in"><span><span class="co"># GY: higher is better</span></span></span>
<span class="r-in"><span><span class="co"># HM: lower is better</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mtsi_index2</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span> <span class="va">data_ge</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="waasb.html">waasb</a></span><span class="op">(</span><span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>,</span></span>
<span class="r-in"><span>       resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">GY</span>, <span class="va">HM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       mresp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h, l"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">mtsi</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Evaluating trait GY |======================                      | 50% 00:00:02 Evaluating trait HM |============================================| 100% 00:00:04 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Method: REML/BLUP</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Random effects: GEN, GEN:ENV</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effects: ENV, REP(ENV)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Denominador DF: Satterthwaite's method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model       GY       HM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  COMPLETE       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       GEN 1.11e-05 5.07e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GEN:ENV 2.15e-11 2.27e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were 2 warnings in `mutate()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> The first warning was:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `across(...)`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by warning:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> There were 2 warnings in `summarise()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> The first warning was:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `across(...)`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In group 1: `variable = "SDperc"`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by warning in `qt()`:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Principal Component Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PC    Eigenvalues `Variance (%)` `Cum. variance (%)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> PC1         1.58            79.2                79.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> PC2         0.415           20.8               100  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Analysis - factorial loadings after rotation-</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   VAR     FA1 Communality Uniquenesses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> GY    0.890       0.792        0.208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> HM    0.890       0.792        0.208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comunalit Mean: 0.7922501 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selection differential for the  waasby index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   VAR   Factor    Xo    Xs    SD SDperc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> GY    FA 1    48.3  76.5  28.2   58.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> HM    FA 1    54.1  86.2  32.1   59.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selection differential for the mean of the variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   VAR   Factor    Xo    Xs     SD SDperc    h2      SG SGperc sense     goal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> GY    FA 1    2.67  2.78  0.105   3.94 0.815  0.085<span style="text-decoration: underline;">8</span>   3.21 increase   100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> HM    FA 1   48.1  47.3  -<span style="color: #BB0000;">0.747</span>  -<span style="color: #BB0000;">1.55</span> 0.686 -<span style="color: #BB0000;">0.512</span>   -<span style="color: #BB0000;">1.07</span> decrease   100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Selected genotypes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G3 G1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

