<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='
Compute the Weighted Average of Absolute Scores (Olivoto et al., 2019) for
quantifying the stability of g genotypes conducted in e
environments using linear mixed-effect models.
The weighted average of absolute scores is computed considering all
Interaction Principal Component Axis (IPCA) from the Singular Value Decomposition (SVD) of the
matrix of genotype-environment interaction (GEI) effects generated by a linear
mixed-effect model, as follows:


\[WAASB_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k = 1}^{p}EP_k\]
where \(WAASB_i\) is the weighted average of absolute scores of the
ith genotype; \(IPCA_{ik}\) is the score of the ith genotype
in the kth Interaction Principal Component Axis (IPCA); and \(EP_k\) is the explained variance of the kth
IPCA for k = 1,2,..,p, considering \(p = min(g - 1; e - 1)\).
The nature of the effects in the model is
chosen with the argument random. By default, the experimental design
considered in each environment is a randomized complete block design. If
block is informed, a resolvable alpha-lattice design (Patterson and
Williams, 1976) is implemented. The following six models can be fitted
depending on the values of random and block arguments.
Model 1: block = NULL and random = "gen" (The
default option). This model considers a Randomized Complete Block Design in
each environment assuming genotype and genotype-environment interaction as
random effects. Environments and blocks nested within environments are
assumed to fixed factors.
Model 2: block = NULL and random = "env". This
model considers a Randomized Complete Block Design in each environment
treating environment, genotype-environment interaction, and blocks nested
within environments as random factors. Genotypes are assumed to be fixed
factors.
Model 3: block = NULL and random = "all". This
model considers a Randomized Complete Block Design in each environment
assuming a random-effect model, i.e., all effects (genotypes, environments,
genotype-vs-environment interaction and blocks nested within environments)
are assumed to be random factors.
Model 4: block is not NULL and random =   "gen". This model considers an alpha-lattice design in each environment
assuming genotype, genotype-environment interaction, and incomplete blocks
nested within complete replicates as random to make use of inter-block
information (Mohring et al., 2015). Complete replicates nested within
environments and environments are assumed to be fixed factors.
Model 5: block is not NULL and random =   "env". This model considers an alpha-lattice design in each environment
assuming genotype as fixed. All other sources of variation (environment,
genotype-environment interaction, complete replicates nested within
environments, and incomplete blocks nested within replicates) are assumed
to be random factors.
Model 6: block is not NULL and random =   "all". This model considers an alpha-lattice design in each environment
assuming all effects, except the intercept, as random factors.

'><title>Weighted Average of Absolute Scores — waasb • metan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weighted Average of Absolute Scores — waasb"><meta property="og:description" content='
Compute the Weighted Average of Absolute Scores (Olivoto et al., 2019) for
quantifying the stability of g genotypes conducted in e
environments using linear mixed-effect models.
The weighted average of absolute scores is computed considering all
Interaction Principal Component Axis (IPCA) from the Singular Value Decomposition (SVD) of the
matrix of genotype-environment interaction (GEI) effects generated by a linear
mixed-effect model, as follows:


\[WAASB_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k = 1}^{p}EP_k\]
where \(WAASB_i\) is the weighted average of absolute scores of the
ith genotype; \(IPCA_{ik}\) is the score of the ith genotype
in the kth Interaction Principal Component Axis (IPCA); and \(EP_k\) is the explained variance of the kth
IPCA for k = 1,2,..,p, considering \(p = min(g - 1; e - 1)\).
The nature of the effects in the model is
chosen with the argument random. By default, the experimental design
considered in each environment is a randomized complete block design. If
block is informed, a resolvable alpha-lattice design (Patterson and
Williams, 1976) is implemented. The following six models can be fitted
depending on the values of random and block arguments.
Model 1: block = NULL and random = "gen" (The
default option). This model considers a Randomized Complete Block Design in
each environment assuming genotype and genotype-environment interaction as
random effects. Environments and blocks nested within environments are
assumed to fixed factors.
Model 2: block = NULL and random = "env". This
model considers a Randomized Complete Block Design in each environment
treating environment, genotype-environment interaction, and blocks nested
within environments as random factors. Genotypes are assumed to be fixed
factors.
Model 3: block = NULL and random = "all". This
model considers a Randomized Complete Block Design in each environment
assuming a random-effect model, i.e., all effects (genotypes, environments,
genotype-vs-environment interaction and blocks nested within environments)
are assumed to be random factors.
Model 4: block is not NULL and random =   "gen". This model considers an alpha-lattice design in each environment
assuming genotype, genotype-environment interaction, and incomplete blocks
nested within complete replicates as random to make use of inter-block
information (Mohring et al., 2015). Complete replicates nested within
environments and environments are assumed to be fixed factors.
Model 5: block is not NULL and random =   "env". This model considers an alpha-lattice design in each environment
assuming genotype as fixed. All other sources of variation (environment,
genotype-environment interaction, complete replicates nested within
environments, and incomplete blocks nested within replicates) are assumed
to be random factors.
Model 6: block is not NULL and random =   "all". This model considers an alpha-lattice design in each environment
assuming all effects, except the intercept, as random factors.

'><meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.16.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a>
    <a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    <a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    <a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a>
    <a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a>
    <a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a>
    <a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="../SUPPORT.html">Support</a>
    <a class="dropdown-item" href="../LICENSE.html">Licence</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Weighted Average of Absolute Scores</h1>
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/HEAD/R/waasb.R" class="external-link"><code>R/waasb.R</code></a></small>
      <div class="d-none name"><code>waasb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Compute the Weighted Average of Absolute Scores (Olivoto et al., 2019) for
quantifying the stability of <em>g</em> genotypes conducted in <em>e</em>
environments using linear mixed-effect models.</p>
<p>The weighted average of absolute scores is computed considering all
Interaction Principal Component Axis (IPCA) from the Singular Value Decomposition (SVD) of the
matrix of genotype-environment interaction (GEI) effects generated by a linear
mixed-effect model, as follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>

\[WAASB_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k = 1}^{p}EP_k\]</p>
<p>where \(WAASB_i\) is the weighted average of absolute scores of the
<em>i</em>th genotype; \(IPCA_{ik}\) is the score of the <em>i</em>th genotype
in the <em>k</em>th Interaction Principal Component Axis (IPCA); and \(EP_k\) is the explained variance of the <em>k</em>th
IPCA for <em>k = 1,2,..,p</em>, considering \(p = min(g - 1; e - 1)\).</p>
<p>The nature of the effects in the model is
chosen with the argument <code>random</code>. By default, the experimental design
considered in each environment is a randomized complete block design. If
<code>block</code> is informed, a resolvable alpha-lattice design (Patterson and
Williams, 1976) is implemented. The following six models can be fitted
depending on the values of <code>random</code> and <code>block</code> arguments.</p><ul><li><p><strong>Model 1:</strong> <code>block = NULL</code> and <code>random = "gen"</code> (The
default option). This model considers a Randomized Complete Block Design in
each environment assuming genotype and genotype-environment interaction as
random effects. Environments and blocks nested within environments are
assumed to fixed factors.</p></li>
<li><p><strong>Model 2:</strong> <code>block = NULL</code> and <code>random = "env"</code>. This
model considers a Randomized Complete Block Design in each environment
treating environment, genotype-environment interaction, and blocks nested
within environments as random factors. Genotypes are assumed to be fixed
factors.</p></li>
<li><p><strong>Model 3:</strong> <code>block = NULL</code> and <code>random = "all"</code>. This
model considers a Randomized Complete Block Design in each environment
assuming a random-effect model, i.e., all effects (genotypes, environments,
genotype-vs-environment interaction and blocks nested within environments)
are assumed to be random factors.</p></li>
<li><p><strong>Model 4:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "gen"</code>. This model considers an alpha-lattice design in each environment
assuming genotype, genotype-environment interaction, and incomplete blocks
nested within complete replicates as random to make use of inter-block
information (Mohring et al., 2015). Complete replicates nested within
environments and environments are assumed to be fixed factors.</p></li>
<li><p><strong>Model 5:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "env"</code>. This model considers an alpha-lattice design in each environment
assuming genotype as fixed. All other sources of variation (environment,
genotype-environment interaction, complete replicates nested within
environments, and incomplete blocks nested within replicates) are assumed
to be random factors.</p></li>
<li><p><strong>Model 6:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "all"</code>. This model considers an alpha-lattice design in each environment
assuming all effects, except the intercept, as random factors.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">waasb</span><span class="op">(</span>
  <span class="va">.data</span>,
  <span class="va">env</span>,
  <span class="va">gen</span>,
  <span class="va">rep</span>,
  <span class="va">resp</span>,
  block <span class="op">=</span> <span class="cn">NULL</span>,
  by <span class="op">=</span> <span class="cn">NULL</span>,
  mresp <span class="op">=</span> <span class="cn">NULL</span>,
  wresp <span class="op">=</span> <span class="cn">NULL</span>,
  random <span class="op">=</span> <span class="st">"gen"</span>,
  prob <span class="op">=</span> <span class="fl">0.05</span>,
  ind_anova <span class="op">=</span> <span class="cn">FALSE</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.data</dt>
<dd><p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p></dd>
<dt>env</dt>
<dd><p>The name of the column that contains the levels of the
environments.</p></dd>
<dt>gen</dt>
<dd><p>The name of the column that contains the levels of the genotypes.</p></dd>
<dt>rep</dt>
<dd><p>The name of the column that contains the levels of the
replications/blocks.</p></dd>
<dt>resp</dt>
<dd><p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p></dd>
<dt>block</dt>
<dd><p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then an alpha-lattice
design is employed considering block as random to make use of inter-block
information, whereas the complete replicate effect is always taken as
fixed, as no inter-replicate information was to be recovered (Mohring et
al., 2015).</p></dd>
<dt>by</dt>
<dd><p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">dplyr::group_by()</a></code>.This is especially useful, for example,
when the researcher want to compute the indexes by mega-environments. In
this case, an object of class waasb_grouped is returned.
<code><a href="mtsi.html">mtsi()</a></code> can then be used to compute the mtsi index within each
mega-environment.</p></dd>
<dt>mresp</dt>
<dd><p>The new maximum value after rescaling the response variable. By
default, all variables in <code>resp</code> are rescaled so that de maximum value
is 100 and the minimum value is 0 (i.e., <code>mresp = NULL</code>). It must be a
character vector of the same length of <code>resp</code> if rescaling is assumed
to be different across variables, e.g., if for the first variable smaller
values are better and for the second one, higher values are better, then
<code>mresp = c("l, h")</code> must be used. Character value of length 1 will be
recycled with a warning message.</p></dd>
<dt>wresp</dt>
<dd><p>The weight for the response variable(s) for computing the WAASBY
index. By default, all variables in <code>resp</code> have equal weights for mean
performance and stability (i.e., <code>wresp = 50</code>). It must be a numeric
vector of the same length of <code>resp</code> to assign different weights across
variables, e.g., if for the first variable equal weights for mean
performance and stability are assumed and for the second one, a higher
weight for mean performance (e.g. 65) is assumed, then <code>wresp = c(50, 65)</code> must be used. Numeric value of length 1 will be recycled with a
warning message.</p></dd>
<dt>random</dt>
<dd><p>The effects of the model assumed to be random. Defaults to
<code>random = "gen"</code>. See <strong>Details</strong> to see the random effects
assumed depending on the experimental design of the trials.</p></dd>
<dt>prob</dt>
<dd><p>The probability for estimating confidence interval for BLUP's
prediction.</p></dd>
<dt>ind_anova</dt>
<dd><p>Logical argument set to <code>FALSE</code>. If <code>TRUE</code> an
within-environment ANOVA is performed.</p></dd>
<dt>verbose</dt>
<dd><p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p></dd>
<dt>...</dt>
<dd><p>Arguments passed to the function
<code><a href="impute_missing_val.html">impute_missing_val()</a></code> for imputation of missing values in the
matrix of BLUPs for genotype-environment interaction, thus allowing the
computation of the WAASB index.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>waasb</code> with the following items for each
variable:</p><ul><li><p><strong>individual</strong> A within-environments ANOVA considering a
fixed-effect model.</p></li>
<li><p><strong>fixed</strong> Test for fixed effects.</p></li>
<li><p><strong>random</strong> Variance components for random effects.</p></li>
<li><p><strong>LRT</strong> The Likelihood Ratio Test for the random effects.</p></li>
<li><p><strong>model</strong> A tibble with the response variable, the scores of all
IPCAs, the estimates of Weighted Average of Absolute Scores, and WAASBY (the
index that considers the weights for stability and mean performance in the
genotype ranking), and their respective ranks.</p></li>
<li><p><strong>BLUPgen</strong> The random effects and estimated BLUPS for genotypes (If
<code>random = "gen"</code> or <code>random = "all"</code>)</p></li>
<li><p><strong>BLUPenv</strong> The random effects and estimated BLUPS for environments,
(If <code>random = "env"</code> or <code>random = "all"</code>).</p></li>
<li><p><strong>BLUPint</strong> The random effects and estimated BLUPS of all genotypes in
all environments.</p></li>
<li><p><strong>PCA</strong> The results of Principal Component Analysis with the
eigenvalues and explained variance of the matrix of genotype-environment
effects estimated by the linear fixed-effect model.</p></li>
<li><p><strong>MeansGxE</strong> The phenotypic means of genotypes in the environments.</p></li>
<li><p><strong>Details</strong> A list summarizing the results. The following information
are shown: <code>Nenv</code>, the number of environments in the analysis;
<code>Ngen</code> the number of genotypes in the analysis; <code>mresp</code> The value
attributed to the highest value of the response variable after rescaling it;
<code>wresp</code> The weight of the response variable for estimating the WAASBY
index. <code>Mean</code> the grand mean; <code>SE</code> the standard error of the mean;
<code>SD</code> the standard deviation. <code>CV</code> the coefficient of variation of
the phenotypic means, estimating WAASB, <code>Min</code> the minimum value observed
(returning the genotype and environment), <code>Max</code> the maximum value
observed (returning the genotype and environment); <code>MinENV</code> the
environment with the lower mean, <code>MaxENV</code> the environment with the
larger mean observed, <code>MinGEN</code> the genotype with the lower mean,
<code>MaxGEN</code> the genotype with the larger.</p></li>
<li><p><strong>ESTIMATES</strong> A tibble with the genetic parameters (if <code>random = "gen"</code> or <code>random = "all"</code>) with the following columns: <code>Phenotypic variance</code> the phenotypic variance; <code>Heritability</code> the broad-sense
heritability; <code>GEr2</code> the coefficient of determination of the interaction
effects; <code>h2mg</code> the heritability on the mean basis;
<code>Accuracy</code> the selective accuracy; <code>rge</code> the genotype-environment
correlation; <code>CVg</code> the genotypic coefficient of variation; <code>CVr</code>
the residual coefficient of variation; <code>CV ratio</code> the ratio between
genotypic and residual coefficient of variation.</p></li>
<li><p><strong>residuals</strong> The residuals of the model.</p></li>
<li><p><strong>formula</strong> The formula used to fit the model.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in multi-environment
trials I: Combining features of AMMI and BLUP techniques. Agron. J.
111:2949-2960.
doi: <a href="https://doi.org/10.2134/agronj2019.03.0220" class="external-link">10.2134/agronj2019.03.0220</a></p>
<p>Mohring, J., E. Williams, and H.-P. Piepho. 2015. Inter-block information: to
recover or not to recover it? TAG. Theor. Appl. Genet. 128:1541-54.
doi: <a href="https://doi.org/10.1007/s00122-015-2530-0" class="external-link">10.1007/s00122-015-2530-0</a></p>
<p>Patterson, H.D., and E.R. Williams. 1976. A new class of resolvable
incomplete block designs. Biometrika 63:83-92.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mtsi.html">mtsi()</a></code> <code><a href="waas.html">waas()</a></code>
<code><a href="get_model_data.html">get_model_data()</a></code> <code><a href="plot_scores.html">plot_scores()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co">#===============================================================#</span></span>
<span class="r-in"><span class="co"># Example 1: Analyzing all numeric variables assuming genotypes #</span></span>
<span class="r-in"><span class="co"># as random effects with equal weights for mean performance and #</span></span>
<span class="r-in"><span class="co"># stability                                                     #</span></span>
<span class="r-in"><span class="co">#===============================================================#</span></span>
<span class="r-in"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">waasb</span><span class="op">(</span><span class="va">data_ge</span>,</span>
<span class="r-in">              env <span class="op">=</span> <span class="va">ENV</span>,</span>
<span class="r-in">              gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span class="r-in">              rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span class="r-in">              resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Evaluating trait GY |======================                      | 50% 00:00:00 Evaluating trait HM |============================================| 100% 00:00:01 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Method: REML/BLUP</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Random effects: GEN, GEN:ENV</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effects: ENV, REP(ENV)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Denominador DF: Satterthwaite's method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model       GY       HM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  COMPLETE       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       GEN 1.11e-05 5.07e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GEN:ENV 2.15e-11 2.27e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Genetic parameters</span></span>
<span class="r-in"><span class="fu"><a href="get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"genpar"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Class of the model: waasb</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Variable extracted: genpar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 9 x 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Parameters              GY     HM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Phenotypic variance  0.181 5.52  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Heritability         0.154 0.088<span style="text-decoration: underline;">7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> GEIr2                0.313 0.397 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> h2mg                 0.815 0.686 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> Accuracy             0.903 0.828 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> rge                  0.370 0.435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> CVg                  6.26  1.46  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> CVr                 11.6   3.50  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">9</span> CV ratio             0.538 0.415 </span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#===============================================================#</span></span>
<span class="r-in"><span class="co"># Example 2: Analyzing variables that starts with "N"           #</span></span>
<span class="r-in"><span class="co"># assuming environment as random effects with higher weight for #</span></span>
<span class="r-in"><span class="co"># response variable (65) for the three traits.                  #</span></span>
<span class="r-in"><span class="co">#===============================================================#</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu">waasb</span><span class="op">(</span><span class="va">data_ge2</span>,</span>
<span class="r-in">               env <span class="op">=</span> <span class="va">ENV</span>,</span>
<span class="r-in">               gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span class="r-in">               rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span class="r-in">               random <span class="op">=</span> <span class="st">"env"</span>,</span>
<span class="r-in">               resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"N"</span><span class="op">)</span>,</span>
<span class="r-in">               wresp <span class="op">=</span> <span class="fl">65</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Invalid length in 'wresp'. Setting wresp = 65 to all the 3 variables.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Evaluating trait NR |===============                             | 33% 00:00:00 Evaluating trait NKR |=============================              | 67% 00:00:01 Evaluating trait NKE |===========================================| 100% 00:00:01 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Method: REML/BLUP</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Random effects: REP(ENV), ENV, GEN:ENV</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effects: GEN</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Denominador DF: Satterthwaite's method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model       NR     NKR      NKE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  COMPLETE       NA      NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  REP(ENV) 1.00e+00 1.00000 0.999984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ENV 2.84e-01 0.02314 0.003903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GEN:ENV 2.03e-05 0.00242 0.000165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Get the index WAASBY</span></span>
<span class="r-in"><span class="fu"><a href="get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">model2</span>, what <span class="op">=</span> <span class="st">"WAASBY"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Class of the model: waasb</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Variable extracted: WAASBY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 13 x 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN      NR   NKR   NKE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> H1    69.2   42.7  33.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> H10   35.7   53.7  49.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> H11    9.63  58.2  47.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> H12   63.6   35    36.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> H13   84.6   27.0  60.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> H2    39.7   50.8  62.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> H3    18.4   48.4  16.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> H4    28.4   97.6  88.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> H5    28.5   74.0  94.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> H6    55.8   34.5  32.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> H7    52.0   42.0  40.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> H8    42.1   27.3  21.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> H9    26.4   48.2  14.9</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#===============================================================#</span></span>
<span class="r-in"><span class="co"># Example 3: Analyzing GY and HM assuming a random-effect model.#</span></span>
<span class="r-in"><span class="co"># Smaller values for HM and higher values for GY are better.    #</span></span>
<span class="r-in"><span class="co"># To estimate WAASBY, higher weight for the GY (60%) and lower  #</span></span>
<span class="r-in"><span class="co"># weight for HM (40%) are considered for mean performance.      #</span></span>
<span class="r-in"><span class="co">#===============================================================#</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu">waasb</span><span class="op">(</span><span class="va">data_ge</span>,</span>
<span class="r-in">                env <span class="op">=</span> <span class="va">ENV</span>,</span>
<span class="r-in">                gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span class="r-in">                rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span class="r-in">                resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">GY</span>, <span class="va">HM</span><span class="op">)</span>,</span>
<span class="r-in">                random <span class="op">=</span> <span class="st">"all"</span>,</span>
<span class="r-in">                mresp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h, l"</span><span class="op">)</span>,</span>
<span class="r-in">                wresp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Evaluating trait GY |======================                      | 50% 00:00:00 Evaluating trait HM |============================================| 100% 00:00:02 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Method: REML/BLUP</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Random effects: GEN, REP(ENV), ENV, GEN:ENV</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effects: -</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Denominador DF: Satterthwaite's method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model       GY       HM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  COMPLETE       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       GEN 1.11e-05 5.07e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  REP(ENV) 9.91e-08 5.73e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ENV 8.26e-17 3.55e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GEN:ENV 2.15e-11 2.27e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot the scores (response x WAASB)</span></span>
<span class="r-in"><span class="fu"><a href="plot_scores.html">plot_scores</a></span><span class="op">(</span><span class="va">model3</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-plt img"><img src="waasb-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

