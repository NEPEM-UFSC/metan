<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot scores in different graphical interpretations — plot_scores • metan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot scores in different graphical interpretations — plot_scores"><meta name="description" content="
Plot scores of genotypes and environments in different graphical
interpretations.
Biplots type 1 and 2 are well known in AMMI analysis. In the plot type 3, the
scores of both genotypes and environments are plotted considering the
response variable and the WAASB, an stability index that considers all
significant principal component axis of traditional AMMI models or all
principal component axis estimated with BLUP-interaction effects (Olivoto et
al. 2019). Plot type 4 may be used to better understand the well known
'which-won-where' pattern, facilitating the recommendation of appropriate
genotypes targeted for specific environments, thus allowing the exploitation
of narrow adaptations."><meta property="og:description" content="
Plot scores of genotypes and environments in different graphical
interpretations.
Biplots type 1 and 2 are well known in AMMI analysis. In the plot type 3, the
scores of both genotypes and environments are plotted considering the
response variable and the WAASB, an stability index that considers all
significant principal component axis of traditional AMMI models or all
principal component axis estimated with BLUP-interaction effects (Olivoto et
al. 2019). Plot type 4 may be used to better understand the well known
'which-won-where' pattern, facilitating the recommendation of appropriate
genotypes targeted for specific environments, thus allowing the exploitation
of narrow adaptations."><meta property="og:image" content="https://nepem-ufsc.github.io/metan/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples"><li><a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><a class="dropdown-item" href="../news/index.html">Package news</a></li>
    <li><a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">More</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-more"><li><a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
    <li><a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a></li>
    <li><a class="dropdown-item" href="../SUPPORT.html">Support</a></li>
    <li><a class="dropdown-item" href="../LICENSE.html">Licence</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/TiagoOlivoto"><span class="fa fa-github fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/tolivoto"><span class="fa fab fa-twitter fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/"><span class="fa fab fa-mendeley fa-2x"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot scores in different graphical interpretations</h1>
      <small class="dont-index">Source: <a href="https://github.com/nepem-ufsc/metan/blob/HEAD/R/plot_scores.R" class="external-link"><code>R/plot_scores.R</code></a></small>
      <div class="d-none name"><code>plot_scores.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Plot scores of genotypes and environments in different graphical
interpretations.</p>
<p>Biplots type 1 and 2 are well known in AMMI analysis. In the plot type 3, the
scores of both genotypes and environments are plotted considering the
response variable and the WAASB, an stability index that considers all
significant principal component axis of traditional AMMI models or all
principal component axis estimated with BLUP-interaction effects (Olivoto et
al. 2019). Plot type 4 may be used to better understand the well known
'which-won-where' pattern, facilitating the recommendation of appropriate
genotypes targeted for specific environments, thus allowing the exploitation
of narrow adaptations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_scores</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  var <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  first <span class="op">=</span> <span class="st">"PC1"</span>,</span>
<span>  second <span class="op">=</span> <span class="st">"PC2"</span>,</span>
<span>  repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  repulsion <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max_overlaps <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  polygon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_theme <span class="op">=</span> <span class="fu"><a href="themes.html">theme_metan</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  axis.expand <span class="op">=</span> <span class="fl">1.1</span>,</span>
<span>  x.lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y.lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x.breaks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html" class="external-link">waiver</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  y.breaks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html" class="external-link">waiver</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  x.lab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y.lab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shape.gen <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  shape.env <span class="op">=</span> <span class="fl">23</span>,</span>
<span>  size.shape.gen <span class="op">=</span> <span class="fl">2.2</span>,</span>
<span>  size.shape.env <span class="op">=</span> <span class="fl">2.2</span>,</span>
<span>  size.bor.tick <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  size.tex.lab <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  size.tex.gen <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>  size.tex.env <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>  size.line <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  size.segm.line <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  col.bor.gen <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  col.bor.env <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  col.line <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  col.gen <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  col.env <span class="op">=</span> <span class="st">"forestgreen"</span>,</span>
<span>  col.alpha.gen <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.alpha.env <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.segm.gen <span class="op">=</span> <span class="fu"><a href="themes.html">transparent_color</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  col.segm.env <span class="op">=</span> <span class="st">"forestgreen"</span>,</span>
<span>  highlight <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col.highlight <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  col.alpha.highlight <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  size.tex.highlight <span class="op">=</span> <span class="fl">5.5</span>,</span>
<span>  size.shape.highlight <span class="op">=</span> <span class="fl">3.2</span>,</span>
<span>  leg.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Env"</span>, <span class="st">"Gen"</span><span class="op">)</span>,</span>
<span>  line.type <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>  line.alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  file.type <span class="op">=</span> <span class="st">"png"</span>,</span>
<span>  export <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  file.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  color <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object fitted with the functions <code><a href="performs_ammi.html">performs_ammi()</a></code>,
<code><a href="waas.html">waas()</a></code>, <code><a href="waas_means.html">waas_means()</a></code>, or <code><a href="waasb.html">waasb()</a></code>.</p></dd>


<dt id="arg-var">var<a class="anchor" aria-label="anchor" href="#arg-var"></a></dt>
<dd><p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>type of biplot to produce</p><ul><li><p><code>type = 1</code> The default. Produces an AMMI1 biplot (Y x PC1) to make
inferences related to stability and productivity.</p></li>
<li><p><code>type = 2</code> Produces an AMMI2 biplot (PC1 x PC2) to make inferences
related to the interaction effects. Use the arguments <code>first</code> or
<code>second</code> to change the default IPCA shown in the plot.</p></li>
<li><p><code>type = 3</code> Valid for objects of class <code>waas</code> or <code>waasb</code>,
produces a biplot showing the GY x WAASB.</p></li>
<li><p><code>type = 4</code> Produces a plot with the Nominal yield x Environment PC.</p></li>
</ul></dd>


<dt id="arg-first-second">first, second<a class="anchor" aria-label="anchor" href="#arg-first-second"></a></dt>
<dd><p>The IPCA to be shown in the first (x) and second (y)
axis. By default, IPCA1 is shown in the <code>x</code> axis and IPCA2 in the
<code>y</code> axis. For example, use <code>second = "PC3"</code> to shown the IPCA3 in
the <code>y</code> axis.</p></dd>


<dt id="arg-repel">repel<a class="anchor" aria-label="anchor" href="#arg-repel"></a></dt>
<dd><p>If <code>TRUE</code> (default), the text labels repel away from each
other and away from the data points.</p></dd>


<dt id="arg-repulsion">repulsion<a class="anchor" aria-label="anchor" href="#arg-repulsion"></a></dt>
<dd><p>Force of repulsion between overlapping text labels. Defaults
to <code>1</code>.</p></dd>


<dt id="arg-max-overlaps">max_overlaps<a class="anchor" aria-label="anchor" href="#arg-max-overlaps"></a></dt>
<dd><p>Exclude text labels that overlap too many things. Defaults to 20.</p></dd>


<dt id="arg-polygon">polygon<a class="anchor" aria-label="anchor" href="#arg-polygon"></a></dt>
<dd><p>Logical argument. If <code>TRUE</code>, a polygon is drawn when
<code>type = 2</code>.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Logical values (Defaults to <code>TRUE</code>) to include
automatically generated titles</p></dd>


<dt id="arg-plot-theme">plot_theme<a class="anchor" aria-label="anchor" href="#arg-plot-theme"></a></dt>
<dd><p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code>.</p></dd>


<dt id="arg-axis-expand">axis.expand<a class="anchor" aria-label="anchor" href="#arg-axis-expand"></a></dt>
<dd><p>Multiplication factor to expand the axis limits by to
enable fitting of labels. Default is <code>1.1</code>.</p></dd>


<dt id="arg-x-lim-y-lim">x.lim, y.lim<a class="anchor" aria-label="anchor" href="#arg-x-lim-y-lim"></a></dt>
<dd><p>The range of x and y axes, respectively. Default is
<code>NULL</code> (maximum and minimum values of the data set). New values can be
inserted as <code>x.lim = c(x.min, x.max)</code> or <code>y.lim = c(y.min, y.max)</code>.</p></dd>


<dt id="arg-x-breaks-y-breaks">x.breaks, y.breaks<a class="anchor" aria-label="anchor" href="#arg-x-breaks-y-breaks"></a></dt>
<dd><p>The breaks to be plotted in the x and y axes,
respectively. Defaults to <code><a href="https://ggplot2.tidyverse.org/reference/waiver.html" class="external-link">waiver()</a></code> (automatic breaks). New values
can be inserted, for example, as <code>x.breaks = c(0.1, 0.2, 0.3)</code> or
<code>x.breaks = seq(0, 1, by = 0.2)</code></p></dd>


<dt id="arg-x-lab-y-lab">x.lab, y.lab<a class="anchor" aria-label="anchor" href="#arg-x-lab-y-lab"></a></dt>
<dd><p>The label of x and y axes, respectively. Defaults to
<code>NULL</code>, i.e., each plot has a default axis label. New values can be
inserted as <code>x.lab = 'my label'</code>.</p></dd>


<dt id="arg-shape-gen-shape-env">shape.gen, shape.env<a class="anchor" aria-label="anchor" href="#arg-shape-gen-shape-env"></a></dt>
<dd><p>The shape for genotypes and environments
indication in the biplot. Default is <code>21</code> (circle) for genotypes and
<code>23</code> (diamond) for environments. Values must be between <code>21-25</code>:
<code>21</code> (circle), <code>22</code> (square), <code>23</code> (diamond), <code>24</code> (up
triangle), and <code>25</code> (low triangle).</p></dd>


<dt id="arg-size-shape-gen-size-shape-env">size.shape.gen, size.shape.env<a class="anchor" aria-label="anchor" href="#arg-size-shape-gen-size-shape-env"></a></dt>
<dd><p>The size of the shapes for genotypes and
environments respectively. Defaults to <code>2.2</code>.</p></dd>


<dt id="arg-size-bor-tick">size.bor.tick<a class="anchor" aria-label="anchor" href="#arg-size-bor-tick"></a></dt>
<dd><p>The size of tick of shape. Default is <code>0.1</code>. The
size of the shape will be <code>max(size.shape.gen, size.shape.env) + size.bor.tick</code></p></dd>


<dt id="arg-size-tex-lab-size-tex-gen-size-tex-env">size.tex.lab, size.tex.gen, size.tex.env<a class="anchor" aria-label="anchor" href="#arg-size-tex-lab-size-tex-gen-size-tex-env"></a></dt>
<dd><p>The size of the text for axis
labels (Defaults to 12), genotypes labels, and environments labels
(Defaults to 3.5).</p></dd>


<dt id="arg-size-line">size.line<a class="anchor" aria-label="anchor" href="#arg-size-line"></a></dt>
<dd><p>The size of the line that indicate the means in the biplot.
Default is <code>0.5</code>.</p></dd>


<dt id="arg-size-segm-line">size.segm.line<a class="anchor" aria-label="anchor" href="#arg-size-segm-line"></a></dt>
<dd><p>The size of the segment that start in the origin of the
biplot and end in the scores values. Default is <code>0.5</code>.</p></dd>


<dt id="arg-col-bor-gen-col-bor-env">col.bor.gen, col.bor.env<a class="anchor" aria-label="anchor" href="#arg-col-bor-gen-col-bor-env"></a></dt>
<dd><p>The color of the shape's border for genotypes
and environments, respectively.</p></dd>


<dt id="arg-col-line">col.line<a class="anchor" aria-label="anchor" href="#arg-col-line"></a></dt>
<dd><p>The color of the line that indicate the means in the biplot.
Default is <code>'gray'</code></p></dd>


<dt id="arg-col-gen-col-env">col.gen, col.env<a class="anchor" aria-label="anchor" href="#arg-col-gen-col-env"></a></dt>
<dd><p>The shape color for genotypes (Defaults to
<code>'blue'</code>) and environments (<code>'forestgreen'</code>). Must be length
one or a vector of colors with the same length of the number of
genotypes/environments.</p></dd>


<dt id="arg-col-alpha-gen-col-alpha-env">col.alpha.gen, col.alpha.env<a class="anchor" aria-label="anchor" href="#arg-col-alpha-gen-col-alpha-env"></a></dt>
<dd><p>The alpha value for the color for
genotypes and environments, respectively. Defaults to <code>NA</code>. Values must be
between <code>0</code> (full transparency) to <code>1</code> (full color).</p></dd>


<dt id="arg-col-segm-gen-col-segm-env">col.segm.gen, col.segm.env<a class="anchor" aria-label="anchor" href="#arg-col-segm-gen-col-segm-env"></a></dt>
<dd><p>The color of segment for genotypes (Defaults
to <code><a href="themes.html">transparent_color()</a></code>) and environments (Defaults to 'forestgreen'),
respectively. Valid arguments for plots with <code>type = 1</code> or <code>type = 2</code> graphics.</p></dd>


<dt id="arg-highlight">highlight<a class="anchor" aria-label="anchor" href="#arg-highlight"></a></dt>
<dd><p>Genotypes/environments to be highlight in the plot. Defaults
to <code>NULL</code>.</p></dd>


<dt id="arg-col-highlight">col.highlight<a class="anchor" aria-label="anchor" href="#arg-col-highlight"></a></dt>
<dd><p>The color for shape/labels when a value is provided in
<code>highlight.</code> Defaults to <code>"red"</code>.</p></dd>


<dt id="arg-col-alpha-highlight">col.alpha.highlight<a class="anchor" aria-label="anchor" href="#arg-col-alpha-highlight"></a></dt>
<dd><p>The alpha value for the color of the highlighted
genotypes. Defaults to <code>1</code>.</p></dd>


<dt id="arg-size-tex-highlight">size.tex.highlight<a class="anchor" aria-label="anchor" href="#arg-size-tex-highlight"></a></dt>
<dd><p>The size of the text for the highlighted genotypes.
Defaults to <code>5.5</code>.</p></dd>


<dt id="arg-size-shape-highlight">size.shape.highlight<a class="anchor" aria-label="anchor" href="#arg-size-shape-highlight"></a></dt>
<dd><p>The size of the shape for the highlighted
genotypes. Defaults to <code>3.2</code>.</p></dd>


<dt id="arg-leg-lab">leg.lab<a class="anchor" aria-label="anchor" href="#arg-leg-lab"></a></dt>
<dd><p>The labs of legend. Default is <code>Gen</code> and <code>Env</code>.</p></dd>


<dt id="arg-line-type">line.type<a class="anchor" aria-label="anchor" href="#arg-line-type"></a></dt>
<dd><p>The type of the line that indicate the means in the biplot.
Default is <code>'solid'</code>. Other values that can be attributed are:
<code>'blank'</code>, no lines in the biplot, <code>'dashed', 'dotted', 'dotdash', 'longdash', and 'twodash'</code>.</p></dd>


<dt id="arg-line-alpha">line.alpha<a class="anchor" aria-label="anchor" href="#arg-line-alpha"></a></dt>
<dd><p>The alpha value that combine the line with the background
to create the appearance of partial or full transparency. Default is
<code>0.4</code>. Values must be between '0' (full transparency) to '1' (full
color).</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p>deprecated</p></dd>


<dt id="arg-file-type">file.type<a class="anchor" aria-label="anchor" href="#arg-file-type"></a></dt>
<dd><p>The type of file to be exported. Currently recognises the extensions
eps/ps, tex, pdf, jpeg, tiff, png (default), bmp, svg and wmf (windows only).</p></dd>


<dt id="arg-export">export<a class="anchor" aria-label="anchor" href="#arg-export"></a></dt>
<dd><p>Export (or not) the plot. Default is <code>FALSE</code>. If <code>TRUE</code>, calls the
<code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggplot2::ggsave()</a></code> function.</p></dd>


<dt id="arg-file-name">file.name<a class="anchor" aria-label="anchor" href="#arg-file-name"></a></dt>
<dd><p>The name of the file for exportation, default is
<code>NULL</code>, i.e. the files are automatically named.</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>The width 'inch' of the plot. Default is <code>8</code>.</p></dd>


<dt id="arg-height">height<a class="anchor" aria-label="anchor" href="#arg-height"></a></dt>
<dd><p>The height 'inch' of the plot. Default is <code>7</code>.</p></dd>


<dt id="arg-color">color<a class="anchor" aria-label="anchor" href="#arg-color"></a></dt>
<dd><p>Should type 4 plot have colors? Default to <code>TRUE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently not used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>gg, ggplot</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in multi-environment
trials I: Combining features of AMMI and BLUP techniques. Agron. J.
111:2949-2960. <a href="https://doi.org/10.2134/agronj2019.03.0220" class="external-link">doi:10.2134/agronj2019.03.0220</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot_eigen.html">plot_eigen()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nepem-ufsc/metan" class="external-link">metan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># AMMI model</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="waas.html">waas</a></span><span class="op">(</span><span class="va">data_ge</span>,</span></span>
<span class="r-in"><span>             env <span class="op">=</span> <span class="va">ENV</span>,</span></span>
<span class="r-in"><span>             gen <span class="op">=</span> <span class="va">GEN</span>,</span></span>
<span class="r-in"><span>             rep <span class="op">=</span> <span class="va">REP</span>,</span></span>
<span class="r-in"><span>             resp <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variable GY </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMMI analysis table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ENV  13 279.574 21.5057   62.33 0.00e+00         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   REP(ENV)  28   9.662  0.3451    3.57 3.59e-08         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        GEN   9  12.995  1.4439   14.93 2.19e-19         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN:ENV 117  31.220  0.2668    2.76 1.01e-11         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC1  21  10.749  0.5119    5.29 0.00e+00       34.4        34.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC2  19   9.924  0.5223    5.40 0.00e+00       31.8        66.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC3  17   4.039  0.2376    2.46 1.40e-03       12.9        79.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC4  15   3.074  0.2049    2.12 9.60e-03        9.8        89.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC5  13   1.446  0.1113    1.15 3.18e-01        4.6        93.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC6  11   0.932  0.0848    0.88 5.61e-01        3.0        96.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC7   9   0.567  0.0630    0.65 7.53e-01        1.8        98.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC8   7   0.362  0.0518    0.54 8.04e-01        1.2        99.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC9   5   0.126  0.0252    0.26 9.34e-01        0.4       100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residuals 252  24.367  0.0967      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total 536 389.036  0.7258      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variable HM </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AMMI analysis table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Source  Df  Sum Sq Mean Sq F value   Pr(&gt;F) Proportion Accumulated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ENV  13 5710.32 439.255   57.22 1.11e-16         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   REP(ENV)  28  214.93   7.676    2.70 2.20e-05         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        GEN   9  269.81  29.979   10.56 7.41e-14         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    GEN:ENV 117 1100.73   9.408    3.31 1.06e-15         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC1  21  381.13  18.149    6.39 0.00e+00       34.6        34.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC2  19  319.43  16.812    5.92 0.00e+00       29.0        63.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC3  17  114.26   6.721    2.37 2.10e-03       10.4        74.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC4  15   81.96   5.464    1.92 2.18e-02        7.4        81.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC5  13   68.11   5.240    1.84 3.77e-02        6.2        87.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC6  11   59.07   5.370    1.89 4.10e-02        5.4        93.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC7   9   46.69   5.188    1.83 6.33e-02        4.2        97.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC8   7   26.65   3.808    1.34 2.32e-01        2.4        99.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC9   5    3.41   0.682    0.24 9.45e-01        0.3       100.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residuals 252  715.69   2.840      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total 536 9112.21  17.000      NA       NA         NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># GY x PC1 for variable GY (default plot)</span></span></span>
<span class="r-in"><span><span class="fu">plot_scores</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_scores-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PC1 x PC2 (variable HM)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu">plot_scores</span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>            polygon <span class="op">=</span> <span class="cn">TRUE</span>,            <span class="co"># Draw a convex hull polygon</span></span></span>
<span class="r-in"><span>            var <span class="op">=</span> <span class="st">"HM"</span>,                <span class="co"># or var = 2 to select variable</span></span></span>
<span class="r-in"><span>            highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span><span class="op">)</span>, <span class="co"># Highlight genotypes 2 and 3</span></span></span>
<span class="r-in"><span>            type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>                  <span class="co"># type of biplot</span></span></span>
<span class="r-plt img"><img src="plot_scores-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PC3 x PC4 (variable HM)</span></span></span>
<span class="r-in"><span><span class="co"># Change size of plot fonts and colors</span></span></span>
<span class="r-in"><span><span class="co"># Minimal theme</span></span></span>
<span class="r-in"><span><span class="fu">plot_scores</span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>           var <span class="op">=</span> <span class="st">"HM"</span>,</span></span>
<span class="r-in"><span>           type <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>           first <span class="op">=</span> <span class="st">"PC3"</span>,</span></span>
<span class="r-in"><span>           second <span class="op">=</span> <span class="st">"PC4"</span>,</span></span>
<span class="r-in"><span>           col.gen <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>           col.env <span class="op">=</span> <span class="st">"gray"</span>,</span></span>
<span class="r-in"><span>           col.segm.env <span class="op">=</span> <span class="st">"gray"</span>,</span></span>
<span class="r-in"><span>           size.tex.gen <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>           size.tex.env <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>           size.tex.lab <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>           plot_theme <span class="op">=</span> <span class="fu"><a href="themes.html">theme_metan_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_scores-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># WAASB index</span></span></span>
<span class="r-in"><span><span class="va">waasb_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="waasb.html">waasb</a></span><span class="op">(</span><span class="va">data_ge</span>, <span class="va">ENV</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">GY</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Evaluating trait GY |============================================| 100% 00:00:01 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Method: REML/BLUP</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Random effects: GEN, GEN:ENV</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effects: ENV, REP(ENV)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Denominador DF: Satterthwaite's method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model       GY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  COMPLETE       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       GEN 1.11e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GEN:ENV 2.15e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># GY x WAASB</span></span></span>
<span class="r-in"><span><span class="co"># Highlight genotypes 2 and 8</span></span></span>
<span class="r-in"><span><span class="fu">plot_scores</span><span class="op">(</span><span class="va">waasb_model</span>,</span></span>
<span class="r-in"><span>            type <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>            highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G2"</span>, <span class="st">"G8"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_scores-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

