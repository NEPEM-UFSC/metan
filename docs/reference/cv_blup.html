<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Cross-validation for blup prediction.
This function provides a cross-validation procedure for mixed models using
replicate-based data. By default, complete blocks are randomly selected
within each environment. In each iteration, the original dataset is split up
into two datasets: training and validation data. The 'training' set has all
combinations (genotype x environment) with R - 1 replications. The
'validation' set has the remaining replication. The estimated values are
compared with the 'validation' data and the Root Means Square Prediction
Difference (Olivoto et al. 2019) is computed. At the end of boots, a list is
returned."><title>Cross-validation procedure — cv_blup • metan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-validation procedure — cv_blup"><meta property="og:description" content="
Cross-validation for blup prediction.
This function provides a cross-validation procedure for mixed models using
replicate-based data. By default, complete blocks are randomly selected
within each environment. In each iteration, the original dataset is split up
into two datasets: training and validation data. The 'training' set has all
combinations (genotype x environment) with R - 1 replications. The
'validation' set has the remaining replication. The estimated values are
compared with the 'validation' data and the Root Means Square Prediction
Difference (Olivoto et al. 2019) is computed. At the end of boots, a list is
returned."><meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a>
    <a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a>
    <a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    <a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a>
    <a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a>
    <a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a>
    <a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <a class="dropdown-item" href="../news/index.html">Package news</a>
    <a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    <a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a>
    <a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a>
    <a class="dropdown-item" href="../SUPPORT.html">Support</a>
    <a class="dropdown-item" href="../LICENSE.html">Licence</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://www.researchgate.net/profile/Tiago_Olivoto2">
    <span class="fab fa fab fa-researchgate fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/TiagoOlivoto">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/tolivoto">
    <span class="fab fa fab fa-twitter fa-2x"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/">
    <span class="fab fa fab fa-mendeley fa-2x"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cross-validation procedure</h1>
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/HEAD/R/cv_blup.R" class="external-link"><code>R/cv_blup.R</code></a></small>
      <div class="d-none name"><code>cv_blup.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Cross-validation for blup prediction.</p>
<p>This function provides a cross-validation procedure for mixed models using
replicate-based data. By default, complete blocks are randomly selected
within each environment. In each iteration, the original dataset is split up
into two datasets: training and validation data. The 'training' set has all
combinations (genotype x environment) with R - 1 replications. The
'validation' set has the remaining replication. The estimated values are
compared with the 'validation' data and the Root Means Square Prediction
Difference (Olivoto et al. 2019) is computed. At the end of boots, a list is
returned.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">cv_blup</span><span class="op">(</span>
  <span class="va">.data</span>,
  <span class="va">env</span>,
  <span class="va">gen</span>,
  <span class="va">rep</span>,
  <span class="va">resp</span>,
  block <span class="op">=</span> <span class="cn">NULL</span>,
  nboot <span class="op">=</span> <span class="fl">200</span>,
  random <span class="op">=</span> <span class="st">"gen"</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.data</dt>
<dd><p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p></dd>
<dt>env</dt>
<dd><p>The name of the column that contains the levels of the
environments.</p></dd>
<dt>gen</dt>
<dd><p>The name of the column that contains the levels of the genotypes.</p></dd>
<dt>rep</dt>
<dd><p>The name of the column that contains the levels of the
replications/blocks. <strong>AT LEAST THREE REPLICATES ARE REQUIRED TO
PERFORM THE CROSS-VALIDATION</strong>.</p></dd>
<dt>resp</dt>
<dd><p>The response variable.</p></dd>
<dt>block</dt>
<dd><p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed. See how
fixed and random effects are considered, see the section <strong>Details</strong>.</p></dd>
<dt>nboot</dt>
<dd><p>The number of resamples to be used in the cross-validation.
Defaults to 200</p></dd>
<dt>random</dt>
<dd><p>The effects of the model assumed to be random. See
<strong>Details</strong> for more information.</p></dd>
<dt>verbose</dt>
<dd><p>A logical argument to define if a progress bar is shown.
Default is <code>TRUE</code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>cv_blup</code> with the following items: *
<strong>RMSPD</strong>: A vector with nboot-estimates of the root mean squared
prediction difference between predicted and validating data. *
<strong>RMSPDmean</strong> The mean of RMSPDmean estimates.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Six models may be fitted depending upon the values in <code>block</code>
and <code>random</code> arguments.</p><ul><li><p><strong>Model 1:</strong> <code>block = NULL</code> and <code>random = "gen"</code> (The
default option). This model considers a Randomized Complete Block Design in
each environment assuming genotype and genotype-environment interaction as
random effects. Environments and blocks nested within environments are
assumed to fixed factors.</p></li>
<li><p><strong>Model 2:</strong> <code>block = NULL</code> and <code>random = "env"</code>. This
model considers a Randomized Complete Block Design in each environment
treating environment, genotype-environment interaction, and blocks nested
within environments as random factors. Genotypes are assumed to be fixed
factors.</p></li>
<li><p><strong>Model 3:</strong> <code>block = NULL</code> and <code>random = "all"</code>. This
model considers a Randomized Complete Block Design in each environment
assuming a random-effect model, i.e., all effects (genotypes, environments,
genotype-vs-environment interaction and blocks nested within environments)
are assumed to be random factors.</p></li>
<li><p><strong>Model 4:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "gen"</code>. This model considers an alpha-lattice design in each environment
assuming genotype, genotype-environment interaction, and incomplete blocks
nested within complete replicates as random to make use of inter-block
information (Mohring et al., 2015). Complete replicates nested within
environments and environments are assumed to be fixed factors.</p></li>
<li><p><strong>Model 5:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "env"</code>. This model considers an alpha-lattice design in each environment
assuming genotype as fixed. All other sources of variation (environment,
genotype-environment interaction, complete replicates nested within
environments, and incomplete blocks nested within replicates) are assumed
to be random factors.</p></li>
<li><p><strong>Model 6:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "all"</code>. This model considers an alpha-lattice design in each environment
assuming all effects, except the intercept, as random factors.</p></li>
</ul><p><strong>IMPORTANT:</strong>  An error is returned if any combination of
genotype-environment has a different number of replications than observed in
the trial.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, V.S. Marchioro,
V.Q. de Souza, and E. Jost. 2019. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960.
<a href="https://doi.org/10.2134/agronj2019.03.0220" class="external-link">doi:10.2134/agronj2019.03.0220</a></p>
<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.</p>
<p>Mohring, J., E. Williams, and H.-P. Piepho. 2015. Inter-block
information: to recover or not to recover it? TAG. Theor. Appl. Genet.
128:1541-54.
<a href="https://doi.org/10.1007/s00122-015-2530-0" class="external-link">doi:10.1007/s00122-015-2530-0</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cv_ammi.html">cv_ammi()</a></code>, <code><a href="cv_ammif.html">cv_ammif()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan" class="external-link">metan</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">cv_blup</span><span class="op">(</span><span class="va">data_ge</span>,</span>
<span class="r-in">                 env <span class="op">=</span> <span class="va">ENV</span>,</span>
<span class="r-in">                 gen <span class="op">=</span> <span class="va">GEN</span>,</span>
<span class="r-in">                 rep <span class="op">=</span> <span class="va">REP</span>,</span>
<span class="r-in">                 resp <span class="op">=</span> <span class="va">GY</span>,</span>
<span class="r-in">                 nboot <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Validating 1 of 5 sets |========                                 | 20% 00:00:00 Validating 2 of 5 sets |================                         | 40% 00:00:01 Validating 3 of 5 sets |=========================                | 60% 00:00:01 Validating 4 of 5 sets |=================================        | 80% 00:00:02 Validating 5 of 5 sets |=========================================| 100% 00:00:03 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

