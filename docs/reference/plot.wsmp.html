<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot heat maps with genotype ranking — plot.wsmp • metan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot heat maps with genotype ranking — plot.wsmp"><meta name="description" content="Plot heat maps with genotype ranking in two ways."><meta property="og:description" content="Plot heat maps with genotype ranking in two ways."><meta property="og:image" content="https://nepem-ufsc.github.io/metan/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples"><li><a class="dropdown-item" href="../articles/vignettes_helper.html">Helper functions</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_utilities.html">Utilities</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_descriptive.html">Descriptive statistics</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_biometry.html">Biometry</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_cross-validation.html">Cross-validation</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_ammi.html">AMMI</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_blup.html">BLUP</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_gge.html">GGE</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes_stability.html">Stability</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/vignettes_indexes.html">Multivariate indexes</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><a class="dropdown-item" href="../news/index.html">Package news</a></li>
    <li><a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">More</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-more"><li><a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
    <li><a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a></li>
    <li><a class="dropdown-item" href="../SUPPORT.html">Support</a></li>
    <li><a class="dropdown-item" href="../LICENSE.html">Licence</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/TiagoOlivoto"><span class="fa fa-github fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/tolivoto"><span class="fa fab fa-twitter fa-2x"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.mendeley.com/profiles/tiago-olivoto/"><span class="fa fab fa-mendeley fa-2x"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot heat maps with genotype ranking</h1>
      <small class="dont-index">Source: <a href="https://github.com/nepem-ufsc/metan/blob/HEAD/R/wsmp.R" class="external-link"><code>R/wsmp.R</code></a></small>
      <div class="d-none name"><code>plot.wsmp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot heat maps with genotype ranking in two ways.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'wsmp'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, var <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="fl">1</span>, y.lab <span class="op">=</span> <span class="cn">NULL</span>, x.lab <span class="op">=</span> <span class="cn">NULL</span>, size.lab <span class="op">=</span> <span class="fl">12</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object returned by the function <code>wsmp</code>.</p></dd>


<dt id="arg-var">var<a class="anchor" aria-label="anchor" href="#arg-var"></a></dt>
<dd><p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p><code>1 = Heat map Ranks</code>: this graphic shows the genotype
ranking considering the WAASB index estimated with different numbers of
Principal Components; <code>2 = Heat map WAASY-GY ratio</code>: this graphic
shows the genotype ranking considering the different combinations in the
WAASB/GY ratio.</p></dd>


<dt id="arg-y-lab">y.lab<a class="anchor" aria-label="anchor" href="#arg-y-lab"></a></dt>
<dd><p>The label of y axis. Default is 'Genotypes'.</p></dd>


<dt id="arg-x-lab">x.lab<a class="anchor" aria-label="anchor" href="#arg-x-lab"></a></dt>
<dd><p>The label of x axis. Default is 'Number of axes'.</p></dd>


<dt id="arg-size-lab">size.lab<a class="anchor" aria-label="anchor" href="#arg-size-lab"></a></dt>
<dd><p>The size of the labels.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently not used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>gg</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The first type of heatmap shows the genotype ranking depending on the number
of principal component axis used for estimating the WAASB index. The second type of heatmap shows the
genotype ranking depending on the WAASB/GY ratio. The ranks obtained with a
ratio of 100/0 considers exclusively the stability for the genotype ranking.
On the other hand, a ratio of 0/100 considers exclusively the productivity
for the genotype ranking.  Four clusters of genotypes are shown by label colors (red) unproductive and
unstable genotypes; (blue) productive, but unstable genotypes; (black) stable, but
unproductive genotypes; and (green), productive and stable genotypes.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nepem-ufsc/metan" class="external-link">metan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="waasb.html">waasb</a></span><span class="op">(</span><span class="va">data_ge2</span>,</span></span>
<span class="r-in"><span>               env <span class="op">=</span> <span class="va">ENV</span>,</span></span>
<span class="r-in"><span>               gen <span class="op">=</span> <span class="va">GEN</span>,</span></span>
<span class="r-in"><span>               rep <span class="op">=</span> <span class="va">REP</span>,</span></span>
<span class="r-in"><span>               resp <span class="op">=</span> <span class="va">PH</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>         <span class="fu"><a href="wsmp.html">wsmp</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Evaluating trait PH |============================================| 100% 00:00:00 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Method: REML/BLUP</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Random effects: GEN, GEN:ENV</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effects: ENV, REP(ENV)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Denominador DF: Satterthwaite's method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model       PH</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  COMPLETE       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       GEN 9.39e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GEN:ENV 1.09e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All variables with significant (p &lt; 0.05) genotype-vs-environment interaction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ranks considering 0 for Y and 100 for WAASB |                    | 2% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 3% 00:00:00 Ranks considering 0 for Y and 100 for WAASB |=                   | 5% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |=                    | 6% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 8% 00:00:00 Ranks considering 5 for Y and 95 for WAASB |==                   | 10% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |==                  | 11% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 13% 00:00:00 Ranks considering 10 for Y and 90 for WAASB |===                 | 14% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 16% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |===                 | 17% 00:00:00 Ranks considering 15 for Y and 85 for WAASB |====                | 19% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 21% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |====                | 22% 00:00:00 Ranks considering 20 for Y and 80 for WAASB |=====               | 24% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 25% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |=====               | 27% 00:00:00 Ranks considering 25 for Y and 75 for WAASB |======              | 29% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 30% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |======              | 32% 00:00:00 Ranks considering 30 for Y and 70 for WAASB |=======             | 33% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 35% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |=======             | 37% 00:00:00 Ranks considering 35 for Y and 65 for WAASB |========            | 38% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 40% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |========            | 41% 00:00:00 Ranks considering 40 for Y and 60 for WAASB |=========           | 43% 00:00:00 Ranks considering 45 for Y and 55 for WAASB |=========           | 44% 00:00:00 Ranks considering 45 for Y and 55 for WAASB |=========           | 46% 00:00:00 Ranks considering 45 for Y and 55 for WAASB |==========          | 48% 00:00:00 Ranks considering 50 for Y and 50 for WAASB |==========          | 49% 00:00:00 Ranks considering 50 for Y and 50 for WAASB |==========          | 51% 00:00:00 Ranks considering 50 for Y and 50 for WAASB |==========          | 52% 00:00:00 Ranks considering 55 for Y and 45 for WAASB |===========         | 54% 00:00:00 Ranks considering 55 for Y and 45 for WAASB |===========         | 56% 00:00:00 Ranks considering 55 for Y and 45 for WAASB |===========         | 57% 00:00:00 Ranks considering 60 for Y and 40 for WAASB |============        | 59% 00:00:00 Ranks considering 60 for Y and 40 for WAASB |============        | 60% 00:00:00 Ranks considering 60 for Y and 40 for WAASB |============        | 62% 00:00:00 Ranks considering 65 for Y and 35 for WAASB |=============       | 63% 00:00:00 Ranks considering 65 for Y and 35 for WAASB |=============       | 65% 00:00:00 Ranks considering 65 for Y and 35 for WAASB |=============       | 67% 00:00:00 Ranks considering 70 for Y and 30 for WAASB |==============      | 68% 00:00:00 Ranks considering 70 for Y and 30 for WAASB |==============      | 70% 00:00:00 Ranks considering 70 for Y and 30 for WAASB |==============      | 71% 00:00:00 Ranks considering 75 for Y and 25 for WAASB |===============     | 73% 00:00:00 Ranks considering 75 for Y and 25 for WAASB |===============     | 75% 00:00:00 Ranks considering 75 for Y and 25 for WAASB |===============     | 76% 00:00:00 Ranks considering 80 for Y and 20 for WAASB |================    | 78% 00:00:00 Ranks considering 80 for Y and 20 for WAASB |================    | 79% 00:00:00 Ranks considering 80 for Y and 20 for WAASB |================    | 81% 00:00:00 Ranks considering 85 for Y and 15 for WAASB |=================   | 83% 00:00:00 Ranks considering 85 for Y and 15 for WAASB |=================   | 84% 00:00:00 Ranks considering 85 for Y and 15 for WAASB |=================   | 86% 00:00:00 Ranks considering 90 for Y and 10 for WAASB |=================   | 87% 00:00:00 Ranks considering 90 for Y and 10 for WAASB |==================  | 89% 00:00:00 Ranks considering 90 for Y and 10 for WAASB |==================  | 90% 00:00:00 Ranks considering 95 for Y and 5 for WAASB |===================  | 92% 00:00:00 Ranks considering 95 for Y and 5 for WAASB |==================== | 94% 00:00:00 Ranks considering 95 for Y and 5 for WAASB |==================== | 95% 00:00:00 Ranks considering 100 for Y and 0 for WAASB |=================== | 97% 00:00:00 Ranks considering 100 for Y and 0 for WAASB |====================| 98% 00:00:00 Ranks considering 100 for Y and 0 for WAASB |====================| 100% 00:00:00 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Vectorized input to `element_text()` is not officially supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Vectorized input to `element_text()` is not officially supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Results may be unexpected or may change in future versions of ggplot2.</span>
<span class="r-in"><span><span class="fu"><a href="arrange_ggplot.html">arrange_ggplot</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.wsmp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

